var t,e,n,s=Object.defineProperty,i=Object.defineProperties,r=Object.getOwnPropertyDescriptors,a=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,h=Math.pow,c=(t,e,n)=>e in t?s(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,u=(t,e)=>{for(var n in e||(e={}))o.call(e,n)&&c(t,n,e[n]);if(a)for(var n of a(e))l.call(e,n)&&c(t,n,e[n]);return t},d=(t,e)=>i(t,r(e)),f=(t,e)=>{var n={};for(var s in t)o.call(t,s)&&e.indexOf(s)<0&&(n[s]=t[s]);if(null!=t&&a)for(var s of a(t))e.indexOf(s)<0&&l.call(t,s)&&(n[s]=t[s]);return n},p=(t,e,n)=>(c(t,"symbol"!=typeof e?e+"":e,n),n),m=(t,e,n)=>new Promise(((s,i)=>{var r=t=>{try{o(n.next(t))}catch(_m){i(_m)}},a=t=>{try{o(n.throw(t))}catch(_m){i(_m)}},o=t=>t.done?s(t.value):Promise.resolve(t.value).then(r,a);o((n=n.apply(t,e)).next())}));!function(){const t=document.createElement("link").relList;if(!(t&&t.supports&&t.supports("modulepreload"))){for(const t of document.querySelectorAll('link[rel="modulepreload"]'))e(t);new MutationObserver((t=>{for(const n of t)if("childList"===n.type)for(const t of n.addedNodes)"LINK"===t.tagName&&"modulepreload"===t.rel&&e(t)})).observe(document,{childList:!0,subtree:!0})}function e(t){if(t.ep)return;t.ep=!0;const e=function(t){const e={};return t.integrity&&(e.integrity=t.integrity),t.referrerpolicy&&(e.referrerPolicy=t.referrerpolicy),"use-credentials"===t.crossorigin?e.credentials="include":"anonymous"===t.crossorigin?e.credentials="omit":e.credentials="same-origin",e}(t);fetch(t.href,e)}}();const g={},v=function(t,e,n){if(!e||0===e.length)return t();const s=document.getElementsByTagName("link");return Promise.all(e.map((t=>{if(t=function(t,e){return new URL(t,e).href}(t,n),t in g)return;g[t]=!0;const e=t.endsWith(".css"),i=e?'[rel="stylesheet"]':"";if(!!n)for(let n=s.length-1;n>=0;n--){const i=s[n];if(i.href===t&&(!e||"stylesheet"===i.rel))return}else if(document.querySelector(`link[href="${t}"]${i}`))return;const r=document.createElement("link");return r.rel=e?"stylesheet":"modulepreload",e||(r.as="script",r.crossOrigin=""),r.href=t,document.head.appendChild(r),e?new Promise(((e,n)=>{r.addEventListener("load",e),r.addEventListener("error",(()=>n(new Error(`Unable to preload CSS for ${t}`))))})):void 0}))).then((()=>t()))};function x(t,e){const n=Object.create(null),s=t.split(",");for(let i=0;i<s.length;i++)n[s[i]]=!0;return e?t=>!!n[t.toLowerCase()]:t=>!!n[t]}function y(t){if(Y(t)){const e={};for(let n=0;n<t.length;n++){const s=t[n],i=j(s)?E(s):y(s);if(i)for(const t in i)e[t]=i[t]}return e}return j(t)||q(t)?t:void 0}const _=/;(?![^(]*\))/g,b=/:([^]+)/,w=new RegExp("\\/\\*.*?\\*\\/","gs");function E(t){const e={};return t.replace(w,"").split(_).forEach((t=>{if(t){const n=t.split(b);n.length>1&&(e[n[0].trim()]=n[1].trim())}})),e}function T(t){let e="";if(j(t))e=t;else if(Y(t))for(let n=0;n<t.length;n++){const s=T(t[n]);s&&(e+=s+" ")}else if(q(t))for(const n in t)t[n]&&(e+=n+" ");return e.trim()}const S=x("itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly");function A(t){return!!t||""===t}function C(t,e){if(t===e)return!0;let n=G(t),s=G(e);if(n||s)return!(!n||!s)&&t.getTime()===e.getTime();if(n=$(t),s=$(e),n||s)return t===e;if(n=Y(t),s=Y(e),n||s)return!(!n||!s)&&function(t,e){if(t.length!==e.length)return!1;let n=!0;for(let s=0;n&&s<t.length;s++)n=C(t[s],e[s]);return n}(t,e);if(n=q(t),s=q(e),n||s){if(!n||!s)return!1;if(Object.keys(t).length!==Object.keys(e).length)return!1;for(const n in t){const s=t.hasOwnProperty(n),i=e.hasOwnProperty(n);if(s&&!i||!s&&i||!C(t[n],e[n]))return!1}}return String(t)===String(e)}function I(t,e){return t.findIndex((t=>C(t,e)))}const M=t=>j(t)?t:null==t?"":Y(t)||q(t)&&(t.toString===Z||!H(t.toString))?JSON.stringify(t,R,2):String(t),R=(t,e)=>e&&e.__v_isRef?R(t,e.value):W(e)?{[`Map(${e.size})`]:[...e.entries()].reduce(((t,[e,n])=>(t[`${e} =>`]=n,t)),{})}:z(e)?{[`Set(${e.size})`]:[...e.values()]}:!q(e)||Y(e)||tt(e)?e:String(e),P={},k=[],F=()=>{},O=()=>!1,D=/^on[^a-z]/,L=t=>D.test(t),N=t=>t.startsWith("onUpdate:"),B=Object.assign,V=(t,e)=>{const n=t.indexOf(e);n>-1&&t.splice(n,1)},U=Object.prototype.hasOwnProperty,X=(t,e)=>U.call(t,e),Y=Array.isArray,W=t=>"[object Map]"===Q(t),z=t=>"[object Set]"===Q(t),G=t=>"[object Date]"===Q(t),H=t=>"function"==typeof t,j=t=>"string"==typeof t,$=t=>"symbol"==typeof t,q=t=>null!==t&&"object"==typeof t,K=t=>q(t)&&H(t.then)&&H(t.catch),Z=Object.prototype.toString,Q=t=>Z.call(t),J=t=>Q(t).slice(8,-1),tt=t=>"[object Object]"===Q(t),et=t=>j(t)&&"NaN"!==t&&"-"!==t[0]&&""+parseInt(t,10)===t,nt=x(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),st=t=>{const e=Object.create(null);return n=>e[n]||(e[n]=t(n))},it=/-(\w)/g,rt=st((t=>t.replace(it,((t,e)=>e?e.toUpperCase():"")))),at=/\B([A-Z])/g,ot=st((t=>t.replace(at,"-$1").toLowerCase())),lt=st((t=>t.charAt(0).toUpperCase()+t.slice(1))),ht=st((t=>t?`on${lt(t)}`:"")),ct=(t,e)=>!Object.is(t,e),ut=(t,e)=>{for(let n=0;n<t.length;n++)t[n](e)},dt=(t,e,n)=>{Object.defineProperty(t,e,{configurable:!0,enumerable:!1,value:n})},ft=t=>{const e=parseFloat(t);return isNaN(e)?t:e};let pt;const mt=()=>pt||(pt="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{});let gt;class vt{constructor(t=!1){this.detached=t,this._active=!0,this.effects=[],this.cleanups=[],this.parent=gt,!t&&gt&&(this.index=(gt.scopes||(gt.scopes=[])).push(this)-1)}get active(){return this._active}run(t){if(this._active){const e=gt;try{return gt=this,t()}finally{gt=e}}}on(){gt=this}off(){gt=this.parent}stop(t){if(this._active){let e,n;for(e=0,n=this.effects.length;e<n;e++)this.effects[e].stop();for(e=0,n=this.cleanups.length;e<n;e++)this.cleanups[e]();if(this.scopes)for(e=0,n=this.scopes.length;e<n;e++)this.scopes[e].stop(!0);if(!this.detached&&this.parent&&!t){const t=this.parent.scopes.pop();t&&t!==this&&(this.parent.scopes[this.index]=t,t.index=this.index)}this.parent=void 0,this._active=!1}}}const xt=t=>{const e=new Set(t);return e.w=0,e.n=0,e},yt=t=>(t.w&Et)>0,_t=t=>(t.n&Et)>0,bt=new WeakMap;let wt=0,Et=1;const Tt=30;let St;const At=Symbol(""),Ct=Symbol("");class It{constructor(t,e=null,n){this.fn=t,this.scheduler=e,this.active=!0,this.deps=[],this.parent=void 0,function(t,e=gt){e&&e.active&&e.effects.push(t)}(this,n)}run(){if(!this.active)return this.fn();let t=St,e=Rt;for(;t;){if(t===this)return;t=t.parent}try{return this.parent=St,St=this,Rt=!0,Et=1<<++wt,wt<=Tt?(({deps:t})=>{if(t.length)for(let e=0;e<t.length;e++)t[e].w|=Et})(this):Mt(this),this.fn()}finally{wt<=Tt&&(t=>{const{deps:e}=t;if(e.length){let n=0;for(let s=0;s<e.length;s++){const i=e[s];yt(i)&&!_t(i)?i.delete(t):e[n++]=i,i.w&=~Et,i.n&=~Et}e.length=n}})(this),Et=1<<--wt,St=this.parent,Rt=e,this.parent=void 0,this.deferStop&&this.stop()}}stop(){St===this?this.deferStop=!0:this.active&&(Mt(this),this.onStop&&this.onStop(),this.active=!1)}}function Mt(t){const{deps:e}=t;if(e.length){for(let n=0;n<e.length;n++)e[n].delete(t);e.length=0}}let Rt=!0;const Pt=[];function kt(){Pt.push(Rt),Rt=!1}function Ft(){const t=Pt.pop();Rt=void 0===t||t}function Ot(t,e,n){if(Rt&&St){let e=bt.get(t);e||bt.set(t,e=new Map);let s=e.get(n);s||e.set(n,s=xt()),Dt(s)}}function Dt(t,e){let n=!1;wt<=Tt?_t(t)||(t.n|=Et,n=!yt(t)):n=!t.has(St),n&&(t.add(St),St.deps.push(t))}function Lt(t,e,n,s,i,r){const a=bt.get(t);if(!a)return;let o=[];if("clear"===e)o=[...a.values()];else if("length"===n&&Y(t)){const t=Number(s);a.forEach(((e,n)=>{("length"===n||n>=t)&&o.push(e)}))}else switch(void 0!==n&&o.push(a.get(n)),e){case"add":Y(t)?et(n)&&o.push(a.get("length")):(o.push(a.get(At)),W(t)&&o.push(a.get(Ct)));break;case"delete":Y(t)||(o.push(a.get(At)),W(t)&&o.push(a.get(Ct)));break;case"set":W(t)&&o.push(a.get(At))}if(1===o.length)o[0]&&Nt(o[0]);else{const t=[];for(const e of o)e&&t.push(...e);Nt(xt(t))}}function Nt(t,e){const n=Y(t)?t:[...t];for(const s of n)s.computed&&Bt(s);for(const s of n)s.computed||Bt(s)}function Bt(t,e){(t!==St||t.allowRecurse)&&(t.scheduler?t.scheduler():t.run())}const Vt=x("__proto__,__v_isRef,__isVue"),Ut=new Set(Object.getOwnPropertyNames(Symbol).filter((t=>"arguments"!==t&&"caller"!==t)).map((t=>Symbol[t])).filter($)),Xt=jt(),Yt=jt(!1,!0),Wt=jt(!0),zt=Gt();function Gt(){const t={};return["includes","indexOf","lastIndexOf"].forEach((e=>{t[e]=function(...t){const n=Re(this);for(let e=0,i=this.length;e<i;e++)Ot(n,0,e+"");const s=n[e](...t);return-1===s||!1===s?n[e](...t.map(Re)):s}})),["push","pop","shift","unshift","splice"].forEach((e=>{t[e]=function(...t){kt();const n=Re(this)[e].apply(this,t);return Ft(),n}})),t}function Ht(t){const e=Re(this);return Ot(e,0,t),e.hasOwnProperty(t)}function jt(t=!1,e=!1){return function(n,s,i){if("__v_isReactive"===s)return!t;if("__v_isReadonly"===s)return t;if("__v_isShallow"===s)return e;if("__v_raw"===s&&i===(t?e?we:be:e?_e:ye).get(n))return n;const r=Y(n);if(!t){if(r&&X(zt,s))return Reflect.get(zt,s,i);if("hasOwnProperty"===s)return Ht}const a=Reflect.get(n,s,i);return($(s)?Ut.has(s):Vt(s))?a:(t||Ot(n,0,s),e?a:Le(a)?r&&et(s)?a:a.value:q(a)?t?Te(a):Ee(a):a)}}function $t(t=!1){return function(e,n,s,i){let r=e[n];if(Ce(r)&&Le(r)&&!Le(s))return!1;if(!t&&(Ie(s)||Ce(s)||(r=Re(r),s=Re(s)),!Y(e)&&Le(r)&&!Le(s)))return r.value=s,!0;const a=Y(e)&&et(n)?Number(n)<e.length:X(e,n),o=Reflect.set(e,n,s,i);return e===Re(i)&&(a?ct(s,r)&&Lt(e,"set",n,s):Lt(e,"add",n,s)),o}}const qt={get:Xt,set:$t(),deleteProperty:function(t,e){const n=X(t,e);t[e];const s=Reflect.deleteProperty(t,e);return s&&n&&Lt(t,"delete",e,void 0),s},has:function(t,e){const n=Reflect.has(t,e);return $(e)&&Ut.has(e)||Ot(t,0,e),n},ownKeys:function(t){return Ot(t,0,Y(t)?"length":At),Reflect.ownKeys(t)}},Kt={get:Wt,set:(t,e)=>!0,deleteProperty:(t,e)=>!0},Zt=B({},qt,{get:Yt,set:$t(!0)}),Qt=t=>t,Jt=t=>Reflect.getPrototypeOf(t);function te(t,e,n=!1,s=!1){const i=Re(t=t.__v_raw),r=Re(e);n||(e!==r&&Ot(i,0,e),Ot(i,0,r));const{has:a}=Jt(i),o=s?Qt:n?Fe:ke;return a.call(i,e)?o(t.get(e)):a.call(i,r)?o(t.get(r)):void(t!==i&&t.get(e))}function ee(t,e=!1){const n=this.__v_raw,s=Re(n),i=Re(t);return e||(t!==i&&Ot(s,0,t),Ot(s,0,i)),t===i?n.has(t):n.has(t)||n.has(i)}function ne(t,e=!1){return t=t.__v_raw,!e&&Ot(Re(t),0,At),Reflect.get(t,"size",t)}function se(t){t=Re(t);const e=Re(this);return Jt(e).has.call(e,t)||(e.add(t),Lt(e,"add",t,t)),this}function ie(t,e){e=Re(e);const n=Re(this),{has:s,get:i}=Jt(n);let r=s.call(n,t);r||(t=Re(t),r=s.call(n,t));const a=i.call(n,t);return n.set(t,e),r?ct(e,a)&&Lt(n,"set",t,e):Lt(n,"add",t,e),this}function re(t){const e=Re(this),{has:n,get:s}=Jt(e);let i=n.call(e,t);i||(t=Re(t),i=n.call(e,t)),s&&s.call(e,t);const r=e.delete(t);return i&&Lt(e,"delete",t,void 0),r}function ae(){const t=Re(this),e=0!==t.size,n=t.clear();return e&&Lt(t,"clear",void 0,void 0),n}function oe(t,e){return function(n,s){const i=this,r=i.__v_raw,a=Re(r),o=e?Qt:t?Fe:ke;return!t&&Ot(a,0,At),r.forEach(((t,e)=>n.call(s,o(t),o(e),i)))}}function le(t,e,n){return function(...s){const i=this.__v_raw,r=Re(i),a=W(r),o="entries"===t||t===Symbol.iterator&&a,l="keys"===t&&a,h=i[t](...s),c=n?Qt:e?Fe:ke;return!e&&Ot(r,0,l?Ct:At),{next(){const{value:t,done:e}=h.next();return e?{value:t,done:e}:{value:o?[c(t[0]),c(t[1])]:c(t),done:e}},[Symbol.iterator](){return this}}}}function he(t){return function(...e){return"delete"!==t&&this}}function ce(){const t={get(t){return te(this,t)},get size(){return ne(this)},has:ee,add:se,set:ie,delete:re,clear:ae,forEach:oe(!1,!1)},e={get(t){return te(this,t,!1,!0)},get size(){return ne(this)},has:ee,add:se,set:ie,delete:re,clear:ae,forEach:oe(!1,!0)},n={get(t){return te(this,t,!0)},get size(){return ne(this,!0)},has(t){return ee.call(this,t,!0)},add:he("add"),set:he("set"),delete:he("delete"),clear:he("clear"),forEach:oe(!0,!1)},s={get(t){return te(this,t,!0,!0)},get size(){return ne(this,!0)},has(t){return ee.call(this,t,!0)},add:he("add"),set:he("set"),delete:he("delete"),clear:he("clear"),forEach:oe(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach((i=>{t[i]=le(i,!1,!1),n[i]=le(i,!0,!1),e[i]=le(i,!1,!0),s[i]=le(i,!0,!0)})),[t,n,e,s]}const[ue,de,fe,pe]=ce();function me(t,e){const n=e?t?pe:fe:t?de:ue;return(e,s,i)=>"__v_isReactive"===s?!t:"__v_isReadonly"===s?t:"__v_raw"===s?e:Reflect.get(X(n,s)&&s in e?n:e,s,i)}const ge={get:me(!1,!1)},ve={get:me(!1,!0)},xe={get:me(!0,!1)},ye=new WeakMap,_e=new WeakMap,be=new WeakMap,we=new WeakMap;function Ee(t){return Ce(t)?t:Se(t,!1,qt,ge,ye)}function Te(t){return Se(t,!0,Kt,xe,be)}function Se(t,e,n,s,i){if(!q(t))return t;if(t.__v_raw&&(!e||!t.__v_isReactive))return t;const r=i.get(t);if(r)return r;const a=(o=t).__v_skip||!Object.isExtensible(o)?0:function(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}(J(o));var o;if(0===a)return t;const l=new Proxy(t,2===a?s:n);return i.set(t,l),l}function Ae(t){return Ce(t)?Ae(t.__v_raw):!(!t||!t.__v_isReactive)}function Ce(t){return!(!t||!t.__v_isReadonly)}function Ie(t){return!(!t||!t.__v_isShallow)}function Me(t){return Ae(t)||Ce(t)}function Re(t){const e=t&&t.__v_raw;return e?Re(e):t}function Pe(t){return dt(t,"__v_skip",!0),t}const ke=t=>q(t)?Ee(t):t,Fe=t=>q(t)?Te(t):t;function Oe(t){Rt&&St&&Dt((t=Re(t)).dep||(t.dep=xt()))}function De(t,e){const n=(t=Re(t)).dep;n&&Nt(n)}function Le(t){return!(!t||!0!==t.__v_isRef)}function Ne(t){return Be(t,!1)}function Be(t,e){return Le(t)?t:new Ve(t,e)}class Ve{constructor(t,e){this.__v_isShallow=e,this.dep=void 0,this.__v_isRef=!0,this._rawValue=e?t:Re(t),this._value=e?t:ke(t)}get value(){return Oe(this),this._value}set value(t){const e=this.__v_isShallow||Ie(t)||Ce(t);t=e?t:Re(t),ct(t,this._rawValue)&&(this._rawValue=t,this._value=e?t:ke(t),De(this))}}function Ue(t){return Le(t)?t.value:t}const Xe={get:(t,e,n)=>Ue(Reflect.get(t,e,n)),set:(t,e,n,s)=>{const i=t[e];return Le(i)&&!Le(n)?(i.value=n,!0):Reflect.set(t,e,n,s)}};function Ye(t){return Ae(t)?t:new Proxy(t,Xe)}var We;class ze{constructor(t,e,n,s){this._setter=e,this.dep=void 0,this.__v_isRef=!0,this[We]=!1,this._dirty=!0,this.effect=new It(t,(()=>{this._dirty||(this._dirty=!0,De(this))})),this.effect.computed=this,this.effect.active=this._cacheable=!s,this.__v_isReadonly=n}get value(){const t=Re(this);return Oe(t),!t._dirty&&t._cacheable||(t._dirty=!1,t._value=t.effect.run()),t._value}set value(t){this._setter(t)}}function Ge(t,e,n,s){let i;try{i=s?t(...s):t()}catch(r){je(r,e,n)}return i}function He(t,e,n,s){if(H(t)){const i=Ge(t,e,n,s);return i&&K(i)&&i.catch((t=>{je(t,e,n)})),i}const i=[];for(let r=0;r<t.length;r++)i.push(He(t[r],e,n,s));return i}function je(t,e,n,s=!0){e&&e.vnode;if(e){let s=e.parent;const i=e.proxy,r=n;for(;s;){const e=s.ec;if(e)for(let n=0;n<e.length;n++)if(!1===e[n](t,i,r))return;s=s.parent}const a=e.appContext.config.errorHandler;if(a)return void Ge(a,null,10,[t,i,r])}!function(t,e,n,s=!0){console.error(t)}(t,0,0,s)}We="__v_isReadonly";let $e=!1,qe=!1;const Ke=[];let Ze=0;const Qe=[];let Je=null,tn=0;const en=Promise.resolve();let nn=null;function sn(t){const e=nn||en;return t?e.then(this?t.bind(this):t):e}function rn(t){Ke.length&&Ke.includes(t,$e&&t.allowRecurse?Ze+1:Ze)||(null==t.id?Ke.push(t):Ke.splice(function(t){let e=Ze+1,n=Ke.length;for(;e<n;){const s=e+n>>>1;hn(Ke[s])<t?e=s+1:n=s}return e}(t.id),0,t),an())}function an(){$e||qe||(qe=!0,nn=en.then(un))}function on(t,e=($e?Ze+1:0)){for(;e<Ke.length;e++){const t=Ke[e];t&&t.pre&&(Ke.splice(e,1),e--,t())}}function ln(t){if(Qe.length){const t=[...new Set(Qe)];if(Qe.length=0,Je)return void Je.push(...t);for(Je=t,Je.sort(((t,e)=>hn(t)-hn(e))),tn=0;tn<Je.length;tn++)Je[tn]();Je=null,tn=0}}const hn=t=>null==t.id?1/0:t.id,cn=(t,e)=>{const n=hn(t)-hn(e);if(0===n){if(t.pre&&!e.pre)return-1;if(e.pre&&!t.pre)return 1}return n};function un(t){qe=!1,$e=!0,Ke.sort(cn);try{for(Ze=0;Ze<Ke.length;Ze++){const t=Ke[Ze];t&&!1!==t.active&&Ge(t,null,14)}}finally{Ze=0,Ke.length=0,ln(),$e=!1,nn=null,(Ke.length||Qe.length)&&un()}}function dn(t,e,...n){if(t.isUnmounted)return;const s=t.vnode.props||P;let i=n;const r=e.startsWith("update:"),a=r&&e.slice(7);if(a&&a in s){const t=`${"modelValue"===a?"model":a}Modifiers`,{number:e,trim:r}=s[t]||P;r&&(i=n.map((t=>j(t)?t.trim():t))),e&&(i=n.map(ft))}let o,l=s[o=ht(e)]||s[o=ht(rt(e))];!l&&r&&(l=s[o=ht(ot(e))]),l&&He(l,t,6,i);const h=s[o+"Once"];if(h){if(t.emitted){if(t.emitted[o])return}else t.emitted={};t.emitted[o]=!0,He(h,t,6,i)}}function fn(t,e,n=!1){const s=e.emitsCache,i=s.get(t);if(void 0!==i)return i;const r=t.emits;let a={},o=!1;if(!H(t)){const s=t=>{const n=fn(t,e,!0);n&&(o=!0,B(a,n))};!n&&e.mixins.length&&e.mixins.forEach(s),t.extends&&s(t.extends),t.mixins&&t.mixins.forEach(s)}return r||o?(Y(r)?r.forEach((t=>a[t]=null)):B(a,r),q(t)&&s.set(t,a),a):(q(t)&&s.set(t,null),null)}function pn(t,e){return!(!t||!L(e))&&(e=e.slice(2).replace(/Once$/,""),X(t,e[0].toLowerCase()+e.slice(1))||X(t,ot(e))||X(t,e))}let mn=null,gn=null;function vn(t){const e=mn;return mn=t,gn=t&&t.type.__scopeId||null,e}function xn(t){gn=t}function yn(){gn=null}function _n(t){const{type:e,vnode:n,proxy:s,withProxy:i,props:r,propsOptions:[a],slots:o,attrs:l,emit:h,render:c,renderCache:u,data:d,setupState:f,ctx:p,inheritAttrs:m}=t;let g,v;const x=vn(t);try{if(4&n.shapeFlag){const t=i||s;g=ui(c.call(t,t,u,r,f,d,p)),v=l}else{const t=e;0,g=ui(t.length>1?t(r,{attrs:l,slots:o,emit:h}):t(r,null)),v=e.props?l:bn(l)}}catch(_){js.length=0,je(_,t,1),g=oi(Gs)}let y=g;if(v&&!1!==m){const t=Object.keys(v),{shapeFlag:e}=y;t.length&&7&e&&(a&&t.some(N)&&(v=wn(v,a)),y=li(y,v))}return n.dirs&&(y=li(y),y.dirs=y.dirs?y.dirs.concat(n.dirs):n.dirs),n.transition&&(y.transition=n.transition),g=y,vn(x),g}const bn=t=>{let e;for(const n in t)("class"===n||"style"===n||L(n))&&((e||(e={}))[n]=t[n]);return e},wn=(t,e)=>{const n={};for(const s in t)N(s)&&s.slice(9)in e||(n[s]=t[s]);return n};function En(t,e,n){const s=Object.keys(e);if(s.length!==Object.keys(t).length)return!0;for(let i=0;i<s.length;i++){const r=s[i];if(e[r]!==t[r]&&!pn(n,r))return!0}return!1}const Tn=t=>t.__isSuspense;function Sn(t,e,n=!1){const s=vi||mn;if(s){const i=null==s.parent?s.vnode.appContext&&s.vnode.appContext.provides:s.parent.provides;if(i&&t in i)return i[t];if(arguments.length>1)return n&&H(e)?e.call(s.proxy):e}}const An={};function Cn(t,e,n){return In(t,e,n)}function In(t,e,{immediate:n,deep:s,flush:i,onTrack:r,onTrigger:a}=P){const o=gt===(null==vi?void 0:vi.scope)?vi:null;let l,h,c=!1,u=!1;if(Le(t)?(l=()=>t.value,c=Ie(t)):Ae(t)?(l=()=>t,s=!0):Y(t)?(u=!0,c=t.some((t=>Ae(t)||Ie(t))),l=()=>t.map((t=>Le(t)?t.value:Ae(t)?Pn(t):H(t)?Ge(t,o,2):void 0))):l=H(t)?e?()=>Ge(t,o,2):()=>{if(!o||!o.isUnmounted)return h&&h(),He(t,o,3,[f])}:F,e&&s){const t=l;l=()=>Pn(t())}let d,f=t=>{h=v.onStop=()=>{Ge(t,o,4)}};if(Ei){if(f=F,e?n&&He(e,o,3,[l(),u?[]:void 0,f]):l(),"sync"!==i)return F;{const t=Ri();d=t.__watcherHandles||(t.__watcherHandles=[])}}let p=u?new Array(t.length).fill(An):An;const m=()=>{if(v.active)if(e){const t=v.run();(s||c||(u?t.some(((t,e)=>ct(t,p[e]))):ct(t,p)))&&(h&&h(),He(e,o,3,[t,p===An?void 0:u&&p[0]===An?[]:p,f]),p=t)}else v.run()};let g;m.allowRecurse=!!e,"sync"===i?g=m:"post"===i?g=()=>Bs(m,o&&o.suspense):(m.pre=!0,o&&(m.id=o.uid),g=()=>rn(m));const v=new It(l,g);e?n?m():p=v.run():"post"===i?Bs(v.run.bind(v),o&&o.suspense):v.run();const x=()=>{v.stop(),o&&o.scope&&V(o.scope.effects,v)};return d&&d.push(x),x}function Mn(t,e,n){const s=this.proxy,i=j(t)?t.includes(".")?Rn(s,t):()=>s[t]:t.bind(s,s);let r;H(e)?r=e:(r=e.handler,n=e);const a=vi;yi(this);const o=In(i,r.bind(s),n);return a?yi(a):_i(),o}function Rn(t,e){const n=e.split(".");return()=>{let e=t;for(let t=0;t<n.length&&e;t++)e=e[n[t]];return e}}function Pn(t,e){if(!q(t)||t.__v_skip)return t;if((e=e||new Set).has(t))return t;if(e.add(t),Le(t))Pn(t.value,e);else if(Y(t))for(let n=0;n<t.length;n++)Pn(t[n],e);else if(z(t)||W(t))t.forEach((t=>{Pn(t,e)}));else if(tt(t))for(const n in t)Pn(t[n],e);return t}function kn(t){return H(t)?{setup:t,name:t.name}:t}const Fn=t=>!!t.type.__asyncLoader,On=t=>t.type.__isKeepAlive;function Dn(t,e){Nn(t,"a",e)}function Ln(t,e){Nn(t,"da",e)}function Nn(t,e,n=vi){const s=t.__wdc||(t.__wdc=()=>{let e=n;for(;e;){if(e.isDeactivated)return;e=e.parent}return t()});if(Vn(e,s,n),n){let t=n.parent;for(;t&&t.parent;)On(t.parent.vnode)&&Bn(s,e,n,t),t=t.parent}}function Bn(t,e,n,s){const i=Vn(e,t,s,!0);Hn((()=>{V(s[e],i)}),n)}function Vn(t,e,n=vi,s=!1){if(n){const i=n[t]||(n[t]=[]),r=e.__weh||(e.__weh=(...s)=>{if(n.isUnmounted)return;kt(),yi(n);const i=He(e,n,t,s);return _i(),Ft(),i});return s?i.unshift(r):i.push(r),r}}const Un=t=>(e,n=vi)=>(!Ei||"sp"===t)&&Vn(t,((...t)=>e(...t)),n),Xn=Un("bm"),Yn=Un("m"),Wn=Un("bu"),zn=Un("u"),Gn=Un("bum"),Hn=Un("um"),jn=Un("sp"),$n=Un("rtg"),qn=Un("rtc");function Kn(t,e=vi){Vn("ec",t,e)}function Zn(t,e){const n=mn;if(null===n)return t;const s=Ai(n)||n.proxy,i=t.dirs||(t.dirs=[]);for(let r=0;r<e.length;r++){let[t,n,a,o=P]=e[r];t&&(H(t)&&(t={mounted:t,updated:t}),t.deep&&Pn(n),i.push({dir:t,instance:s,value:n,oldValue:void 0,arg:a,modifiers:o}))}return t}function Qn(t,e,n,s){const i=t.dirs,r=e&&e.dirs;for(let a=0;a<i.length;a++){const o=i[a];r&&(o.oldValue=r[a].value);let l=o.dir[s];l&&(kt(),He(l,n,8,[t.el,o,t,e]),Ft())}}const Jn="components";function ts(t,e){return function(t,e,n=!0,s=!1){const i=mn||vi;if(i){const n=i.type;if(t===Jn){const t=function(t,e=!0){return H(t)?t.displayName||t.name:t.name||e&&t.__name}(n,!1);if(t&&(t===e||t===rt(e)||t===lt(rt(e))))return n}const r=ns(i[t]||n[t],e)||ns(i.appContext[t],e);return!r&&s?n:r}}(Jn,t,!0,e)||t}const es=Symbol();function ns(t,e){return t&&(t[e]||t[rt(e)]||t[lt(rt(e))])}function ss(t,e,n,s){let i;const r=n&&n[s];if(Y(t)||j(t)){i=new Array(t.length);for(let n=0,s=t.length;n<s;n++)i[n]=e(t[n],n,void 0,r&&r[n])}else if("number"==typeof t){i=new Array(t);for(let n=0;n<t;n++)i[n]=e(n+1,n,void 0,r&&r[n])}else if(q(t))if(t[Symbol.iterator])i=Array.from(t,((t,n)=>e(t,n,void 0,r&&r[n])));else{const n=Object.keys(t);i=new Array(n.length);for(let s=0,a=n.length;s<a;s++){const a=n[s];i[s]=e(t[a],a,s,r&&r[s])}}else i=[];return n&&(n[s]=i),i}const is=t=>t?bi(t)?Ai(t)||t.proxy:is(t.parent):null,rs=B(Object.create(null),{$:t=>t,$el:t=>t.vnode.el,$data:t=>t.data,$props:t=>t.props,$attrs:t=>t.attrs,$slots:t=>t.slots,$refs:t=>t.refs,$parent:t=>is(t.parent),$root:t=>is(t.root),$emit:t=>t.emit,$options:t=>ds(t),$forceUpdate:t=>t.f||(t.f=()=>rn(t.update)),$nextTick:t=>t.n||(t.n=sn.bind(t.proxy)),$watch:t=>Mn.bind(t)}),as=(t,e)=>t!==P&&!t.__isScriptSetup&&X(t,e),os={get({_:t},e){const{ctx:n,setupState:s,data:i,props:r,accessCache:a,type:o,appContext:l}=t;let h;if("$"!==e[0]){const o=a[e];if(void 0!==o)switch(o){case 1:return s[e];case 2:return i[e];case 4:return n[e];case 3:return r[e]}else{if(as(s,e))return a[e]=1,s[e];if(i!==P&&X(i,e))return a[e]=2,i[e];if((h=t.propsOptions[0])&&X(h,e))return a[e]=3,r[e];if(n!==P&&X(n,e))return a[e]=4,n[e];ls&&(a[e]=0)}}const c=rs[e];let u,d;return c?("$attrs"===e&&Ot(t,0,e),c(t)):(u=o.__cssModules)&&(u=u[e])?u:n!==P&&X(n,e)?(a[e]=4,n[e]):(d=l.config.globalProperties,X(d,e)?d[e]:void 0)},set({_:t},e,n){const{data:s,setupState:i,ctx:r}=t;return as(i,e)?(i[e]=n,!0):s!==P&&X(s,e)?(s[e]=n,!0):!X(t.props,e)&&(("$"!==e[0]||!(e.slice(1)in t))&&(r[e]=n,!0))},has({_:{data:t,setupState:e,accessCache:n,ctx:s,appContext:i,propsOptions:r}},a){let o;return!!n[a]||t!==P&&X(t,a)||as(e,a)||(o=r[0])&&X(o,a)||X(s,a)||X(rs,a)||X(i.config.globalProperties,a)},defineProperty(t,e,n){return null!=n.get?t._.accessCache[e]=0:X(n,"value")&&this.set(t,e,n.value,null),Reflect.defineProperty(t,e,n)}};let ls=!0;function hs(t){const e=ds(t),n=t.proxy,s=t.ctx;ls=!1,e.beforeCreate&&cs(e.beforeCreate,t,"bc");const{data:i,computed:r,methods:a,watch:o,provide:l,inject:h,created:c,beforeMount:u,mounted:d,beforeUpdate:f,updated:p,activated:m,deactivated:g,beforeDestroy:v,beforeUnmount:x,destroyed:y,unmounted:_,render:b,renderTracked:w,renderTriggered:E,errorCaptured:T,serverPrefetch:S,expose:A,inheritAttrs:C,components:I,directives:M,filters:R}=e;if(h&&function(t,e,n=F,s=!1){Y(t)&&(t=gs(t));for(const i in t){const n=t[i];let r;r=q(n)?"default"in n?Sn(n.from||i,n.default,!0):Sn(n.from||i):Sn(n),Le(r)&&s?Object.defineProperty(e,i,{enumerable:!0,configurable:!0,get:()=>r.value,set:t=>r.value=t}):e[i]=r}}(h,s,null,t.appContext.config.unwrapInjectedRef),a)for(const k in a){const t=a[k];H(t)&&(s[k]=t.bind(n))}if(i){const e=i.call(n,n);q(e)&&(t.data=Ee(e))}if(ls=!0,r)for(const k in r){const t=r[k],e=H(t)?t.bind(n,n):H(t.get)?t.get.bind(n,n):F,i=!H(t)&&H(t.set)?t.set.bind(n):F,a=Ci({get:e,set:i});Object.defineProperty(s,k,{enumerable:!0,configurable:!0,get:()=>a.value,set:t=>a.value=t})}if(o)for(const k in o)us(o[k],s,n,k);if(l){const t=H(l)?l.call(n):l;Reflect.ownKeys(t).forEach((e=>{!function(t,e){if(vi){let n=vi.provides;const s=vi.parent&&vi.parent.provides;s===n&&(n=vi.provides=Object.create(s)),n[t]=e}}(e,t[e])}))}function P(t,e){Y(e)?e.forEach((e=>t(e.bind(n)))):e&&t(e.bind(n))}if(c&&cs(c,t,"c"),P(Xn,u),P(Yn,d),P(Wn,f),P(zn,p),P(Dn,m),P(Ln,g),P(Kn,T),P(qn,w),P($n,E),P(Gn,x),P(Hn,_),P(jn,S),Y(A))if(A.length){const e=t.exposed||(t.exposed={});A.forEach((t=>{Object.defineProperty(e,t,{get:()=>n[t],set:e=>n[t]=e})}))}else t.exposed||(t.exposed={});b&&t.render===F&&(t.render=b),null!=C&&(t.inheritAttrs=C),I&&(t.components=I),M&&(t.directives=M)}function cs(t,e,n){He(Y(t)?t.map((t=>t.bind(e.proxy))):t.bind(e.proxy),e,n)}function us(t,e,n,s){const i=s.includes(".")?Rn(n,s):()=>n[s];if(j(t)){const n=e[t];H(n)&&Cn(i,n)}else if(H(t))Cn(i,t.bind(n));else if(q(t))if(Y(t))t.forEach((t=>us(t,e,n,s)));else{const s=H(t.handler)?t.handler.bind(n):e[t.handler];H(s)&&Cn(i,s,t)}}function ds(t){const e=t.type,{mixins:n,extends:s}=e,{mixins:i,optionsCache:r,config:{optionMergeStrategies:a}}=t.appContext,o=r.get(e);let l;return o?l=o:i.length||n||s?(l={},i.length&&i.forEach((t=>fs(l,t,a,!0))),fs(l,e,a)):l=e,q(e)&&r.set(e,l),l}function fs(t,e,n,s=!1){const{mixins:i,extends:r}=e;r&&fs(t,r,n,!0),i&&i.forEach((e=>fs(t,e,n,!0)));for(const a in e)if(s&&"expose"===a);else{const s=ps[a]||n&&n[a];t[a]=s?s(t[a],e[a]):e[a]}return t}const ps={data:ms,props:xs,emits:xs,methods:xs,computed:xs,beforeCreate:vs,created:vs,beforeMount:vs,mounted:vs,beforeUpdate:vs,updated:vs,beforeDestroy:vs,beforeUnmount:vs,destroyed:vs,unmounted:vs,activated:vs,deactivated:vs,errorCaptured:vs,serverPrefetch:vs,components:xs,directives:xs,watch:function(t,e){if(!t)return e;if(!e)return t;const n=B(Object.create(null),t);for(const s in e)n[s]=vs(t[s],e[s]);return n},provide:ms,inject:function(t,e){return xs(gs(t),gs(e))}};function ms(t,e){return e?t?function(){return B(H(t)?t.call(this,this):t,H(e)?e.call(this,this):e)}:e:t}function gs(t){if(Y(t)){const e={};for(let n=0;n<t.length;n++)e[t[n]]=t[n];return e}return t}function vs(t,e){return t?[...new Set([].concat(t,e))]:e}function xs(t,e){return t?B(B(Object.create(null),t),e):e}function ys(t,e,n,s=!1){const i={},r={};dt(r,si,1),t.propsDefaults=Object.create(null),_s(t,e,i,r);for(const a in t.propsOptions[0])a in i||(i[a]=void 0);n?t.props=s?i:Se(i,!1,Zt,ve,_e):t.type.props?t.props=i:t.props=r,t.attrs=r}function _s(t,e,n,s){const[i,r]=t.propsOptions;let a,o=!1;if(e)for(let l in e){if(nt(l))continue;const h=e[l];let c;i&&X(i,c=rt(l))?r&&r.includes(c)?(a||(a={}))[c]=h:n[c]=h:pn(t.emitsOptions,l)||l in s&&h===s[l]||(s[l]=h,o=!0)}if(r){const e=Re(n),s=a||P;for(let a=0;a<r.length;a++){const o=r[a];n[o]=bs(i,e,o,s[o],t,!X(s,o))}}return o}function bs(t,e,n,s,i,r){const a=t[n];if(null!=a){const t=X(a,"default");if(t&&void 0===s){const t=a.default;if(a.type!==Function&&H(t)){const{propsDefaults:r}=i;n in r?s=r[n]:(yi(i),s=r[n]=t.call(null,e),_i())}else s=t}a[0]&&(r&&!t?s=!1:!a[1]||""!==s&&s!==ot(n)||(s=!0))}return s}function ws(t,e,n=!1){const s=e.propsCache,i=s.get(t);if(i)return i;const r=t.props,a={},o=[];let l=!1;if(!H(t)){const s=t=>{l=!0;const[n,s]=ws(t,e,!0);B(a,n),s&&o.push(...s)};!n&&e.mixins.length&&e.mixins.forEach(s),t.extends&&s(t.extends),t.mixins&&t.mixins.forEach(s)}if(!r&&!l)return q(t)&&s.set(t,k),k;if(Y(r))for(let c=0;c<r.length;c++){const t=rt(r[c]);Es(t)&&(a[t]=P)}else if(r)for(const c in r){const t=rt(c);if(Es(t)){const e=r[c],n=a[t]=Y(e)||H(e)?{type:e}:Object.assign({},e);if(n){const e=As(Boolean,n.type),s=As(String,n.type);n[0]=e>-1,n[1]=s<0||e<s,(e>-1||X(n,"default"))&&o.push(t)}}}const h=[a,o];return q(t)&&s.set(t,h),h}function Es(t){return"$"!==t[0]}function Ts(t){const e=t&&t.toString().match(/^\s*(function|class) (\w+)/);return e?e[2]:null===t?"null":""}function Ss(t,e){return Ts(t)===Ts(e)}function As(t,e){return Y(e)?e.findIndex((e=>Ss(e,t))):H(e)&&Ss(e,t)?0:-1}const Cs=t=>"_"===t[0]||"$stable"===t,Is=t=>Y(t)?t.map(ui):[ui(t)],Ms=(t,e,n)=>{if(e._n)return e;const s=function(t,e=mn,n){if(!e)return t;if(t._n)return t;const s=(...n)=>{s._d&&Zs(-1);const i=vn(e);let r;try{r=t(...n)}finally{vn(i),s._d&&Zs(1)}return r};return s._n=!0,s._c=!0,s._d=!0,s}(((...t)=>Is(e(...t))),n);return s._c=!1,s},Rs=(t,e,n)=>{const s=t._ctx;for(const i in t){if(Cs(i))continue;const n=t[i];if(H(n))e[i]=Ms(0,n,s);else if(null!=n){const t=Is(n);e[i]=()=>t}}},Ps=(t,e)=>{const n=Is(e);t.slots.default=()=>n},ks=(t,e)=>{if(32&t.vnode.shapeFlag){const n=e._;n?(t.slots=Re(e),dt(e,"_",n)):Rs(e,t.slots={})}else t.slots={},e&&Ps(t,e);dt(t.slots,si,1)},Fs=(t,e,n)=>{const{vnode:s,slots:i}=t;let r=!0,a=P;if(32&s.shapeFlag){const t=e._;t?n&&1===t?r=!1:(B(i,e),n||1!==t||delete i._):(r=!e.$stable,Rs(e,i)),a=e}else e&&(Ps(t,e),a={default:1});if(r)for(const o in i)Cs(o)||o in a||delete i[o]};function Os(){return{app:null,config:{isNativeTag:O,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let Ds=0;function Ls(t,e){return function(n,s=null){H(n)||(n=Object.assign({},n)),null==s||q(s)||(s=null);const i=Os(),r=new Set;let a=!1;const o=i.app={_uid:Ds++,_component:n,_props:s,_container:null,_context:i,_instance:null,version:Pi,get config(){return i.config},set config(t){},use:(t,...e)=>(r.has(t)||(t&&H(t.install)?(r.add(t),t.install(o,...e)):H(t)&&(r.add(t),t(o,...e))),o),mixin:t=>(i.mixins.includes(t)||i.mixins.push(t),o),component:(t,e)=>e?(i.components[t]=e,o):i.components[t],directive:(t,e)=>e?(i.directives[t]=e,o):i.directives[t],mount(r,l,h){if(!a){const c=oi(n,s);return c.appContext=i,l&&e?e(c,r):t(c,r,h),a=!0,o._container=r,r.__vue_app__=o,Ai(c.component)||c.component.proxy}},unmount(){a&&(t(null,o._container),delete o._container.__vue_app__)},provide:(t,e)=>(i.provides[t]=e,o)};return o}}function Ns(t,e,n,s,i=!1){if(Y(t))return void t.forEach(((t,r)=>Ns(t,e&&(Y(e)?e[r]:e),n,s,i)));if(Fn(s)&&!i)return;const r=4&s.shapeFlag?Ai(s.component)||s.component.proxy:s.el,a=i?null:r,{i:o,r:l}=t,h=e&&e.r,c=o.refs===P?o.refs={}:o.refs,u=o.setupState;if(null!=h&&h!==l&&(j(h)?(c[h]=null,X(u,h)&&(u[h]=null)):Le(h)&&(h.value=null)),H(l))Ge(l,o,12,[a,c]);else{const e=j(l),s=Le(l);if(e||s){const o=()=>{if(t.f){const n=e?X(u,l)?u[l]:c[l]:l.value;i?Y(n)&&V(n,r):Y(n)?n.includes(r)||n.push(r):e?(c[l]=[r],X(u,l)&&(u[l]=c[l])):(l.value=[r],t.k&&(c[t.k]=l.value))}else e?(c[l]=a,X(u,l)&&(u[l]=a)):s&&(l.value=a,t.k&&(c[t.k]=a))};a?(o.id=-1,Bs(o,n)):o()}}}const Bs=function(t,e){var n;e&&e.pendingBranch?Y(t)?e.effects.push(...t):e.effects.push(t):(Y(n=t)?Qe.push(...n):Je&&Je.includes(n,n.allowRecurse?tn+1:tn)||Qe.push(n),an())};function Vs(t){return function(t,e){mt().__VUE__=!0;const{insert:n,remove:s,patchProp:i,createElement:r,createText:a,createComment:o,setText:l,setElementText:h,parentNode:c,nextSibling:u,setScopeId:d=F,insertStaticContent:f}=t,p=(t,e,n,s=null,i=null,r=null,a=!1,o=null,l=!!e.dynamicChildren)=>{if(t===e)return;t&&!ni(t,e)&&(s=H(t),U(t,i,r,!0),t=null),-2===e.patchFlag&&(l=!1,e.dynamicChildren=null);const{type:h,ref:c,shapeFlag:u}=e;switch(h){case zs:m(t,e,n,s);break;case Gs:g(t,e,n,s);break;case Hs:null==t&&v(e,n,s,a);break;case Ws:C(t,e,n,s,i,r,a,o,l);break;default:1&u?_(t,e,n,s,i,r,a,o,l):6&u?I(t,e,n,s,i,r,a,o,l):(64&u||128&u)&&h.process(t,e,n,s,i,r,a,o,l,$)}null!=c&&i&&Ns(c,t&&t.ref,r,e||t,!e)},m=(t,e,s,i)=>{if(null==t)n(e.el=a(e.children),s,i);else{const n=e.el=t.el;e.children!==t.children&&l(n,e.children)}},g=(t,e,s,i)=>{null==t?n(e.el=o(e.children||""),s,i):e.el=t.el},v=(t,e,n,s)=>{[t.el,t.anchor]=f(t.children,e,n,s,t.el,t.anchor)},x=({el:t,anchor:e},s,i)=>{let r;for(;t&&t!==e;)r=u(t),n(t,s,i),t=r;n(e,s,i)},y=({el:t,anchor:e})=>{let n;for(;t&&t!==e;)n=u(t),s(t),t=n;s(e)},_=(t,e,n,s,i,r,a,o,l)=>{a=a||"svg"===e.type,null==t?b(e,n,s,i,r,a,o,l):T(t,e,i,r,a,o,l)},b=(t,e,s,a,o,l,c,u)=>{let d,f;const{type:p,props:m,shapeFlag:g,transition:v,dirs:x}=t;if(d=t.el=r(t.type,l,m&&m.is,m),8&g?h(d,t.children):16&g&&E(t.children,d,null,a,o,l&&"foreignObject"!==p,c,u),x&&Qn(t,null,a,"created"),w(d,t,t.scopeId,c,a),m){for(const e in m)"value"===e||nt(e)||i(d,e,null,m[e],l,t.children,a,o,G);"value"in m&&i(d,"value",null,m.value),(f=m.onVnodeBeforeMount)&&pi(f,a,t)}x&&Qn(t,null,a,"beforeMount");const y=(!o||o&&!o.pendingBranch)&&v&&!v.persisted;y&&v.beforeEnter(d),n(d,e,s),((f=m&&m.onVnodeMounted)||y||x)&&Bs((()=>{f&&pi(f,a,t),y&&v.enter(d),x&&Qn(t,null,a,"mounted")}),o)},w=(t,e,n,s,i)=>{if(n&&d(t,n),s)for(let r=0;r<s.length;r++)d(t,s[r]);if(i){if(e===i.subTree){const e=i.vnode;w(t,e,e.scopeId,e.slotScopeIds,i.parent)}}},E=(t,e,n,s,i,r,a,o,l=0)=>{for(let h=l;h<t.length;h++){const l=t[h]=o?di(t[h]):ui(t[h]);p(null,l,e,n,s,i,r,a,o)}},T=(t,e,n,s,r,a,o)=>{const l=e.el=t.el;let{patchFlag:c,dynamicChildren:u,dirs:d}=e;c|=16&t.patchFlag;const f=t.props||P,p=e.props||P;let m;n&&Us(n,!1),(m=p.onVnodeBeforeUpdate)&&pi(m,n,e,t),d&&Qn(e,t,n,"beforeUpdate"),n&&Us(n,!0);const g=r&&"foreignObject"!==e.type;if(u?S(t.dynamicChildren,u,l,n,s,g,a):o||L(t,e,l,null,n,s,g,a,!1),c>0){if(16&c)A(l,e,f,p,n,s,r);else if(2&c&&f.class!==p.class&&i(l,"class",null,p.class,r),4&c&&i(l,"style",f.style,p.style,r),8&c){const a=e.dynamicProps;for(let e=0;e<a.length;e++){const o=a[e],h=f[o],c=p[o];c===h&&"value"!==o||i(l,o,h,c,r,t.children,n,s,G)}}1&c&&t.children!==e.children&&h(l,e.children)}else o||null!=u||A(l,e,f,p,n,s,r);((m=p.onVnodeUpdated)||d)&&Bs((()=>{m&&pi(m,n,e,t),d&&Qn(e,t,n,"updated")}),s)},S=(t,e,n,s,i,r,a)=>{for(let o=0;o<e.length;o++){const l=t[o],h=e[o],u=l.el&&(l.type===Ws||!ni(l,h)||70&l.shapeFlag)?c(l.el):n;p(l,h,u,null,s,i,r,a,!0)}},A=(t,e,n,s,r,a,o)=>{if(n!==s){if(n!==P)for(const l in n)nt(l)||l in s||i(t,l,n[l],null,o,e.children,r,a,G);for(const l in s){if(nt(l))continue;const h=s[l],c=n[l];h!==c&&"value"!==l&&i(t,l,c,h,o,e.children,r,a,G)}"value"in s&&i(t,"value",n.value,s.value)}},C=(t,e,s,i,r,o,l,h,c)=>{const u=e.el=t?t.el:a(""),d=e.anchor=t?t.anchor:a("");let{patchFlag:f,dynamicChildren:p,slotScopeIds:m}=e;m&&(h=h?h.concat(m):m),null==t?(n(u,s,i),n(d,s,i),E(e.children,s,d,r,o,l,h,c)):f>0&&64&f&&p&&t.dynamicChildren?(S(t.dynamicChildren,p,s,r,o,l,h),(null!=e.key||r&&e===r.subTree)&&Xs(t,e,!0)):L(t,e,s,d,r,o,l,h,c)},I=(t,e,n,s,i,r,a,o,l)=>{e.slotScopeIds=o,null==t?512&e.shapeFlag?i.ctx.activate(e,n,s,a,l):M(e,n,s,i,r,a,l):R(t,e,l)},M=(t,e,n,s,i,r,a)=>{const o=t.component=function(t,e,n){const s=t.type,i=(e?e.appContext:t.appContext)||mi,r={uid:gi++,vnode:t,type:s,parent:e,appContext:i,root:null,next:null,subTree:null,effect:null,update:null,scope:new vt(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(i.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:ws(s,i),emitsOptions:fn(s,i),emit:null,emitted:null,propsDefaults:P,inheritAttrs:s.inheritAttrs,ctx:P,data:P,props:P,attrs:P,slots:P,refs:P,setupState:P,setupContext:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};r.ctx={_:r},r.root=e?e.root:r,r.emit=dn.bind(null,r),t.ce&&t.ce(r);return r}(t,s,i);if(On(t)&&(o.ctx.renderer=$),function(t,e=!1){Ei=e;const{props:n,children:s}=t.vnode,i=bi(t);ys(t,n,i,e),ks(t,s);const r=i?function(t,e){const n=t.type;t.accessCache=Object.create(null),t.proxy=Pe(new Proxy(t.ctx,os));const{setup:s}=n;if(s){const n=t.setupContext=s.length>1?function(t){const e=e=>{t.exposed=e||{}};let n;return{get attrs(){return n||(n=function(t){return new Proxy(t.attrs,{get:(e,n)=>(Ot(t,0,"$attrs"),e[n])})}(t))},slots:t.slots,emit:t.emit,expose:e}}(t):null;yi(t),kt();const i=Ge(s,t,0,[t.props,n]);if(Ft(),_i(),K(i)){if(i.then(_i,_i),e)return i.then((n=>{Ti(t,n,e)})).catch((e=>{je(e,t,0)}));t.asyncDep=i}else Ti(t,i,e)}else Si(t,e)}(t,e):void 0;Ei=!1}(o),o.asyncDep){if(i&&i.registerDep(o,O),!t.el){const t=o.subTree=oi(Gs);g(null,t,e,n)}}else O(o,t,e,n,i,r,a)},R=(t,e,n)=>{const s=e.component=t.component;if(function(t,e,n){const{props:s,children:i,component:r}=t,{props:a,children:o,patchFlag:l}=e,h=r.emitsOptions;if(e.dirs||e.transition)return!0;if(!(n&&l>=0))return!(!i&&!o||o&&o.$stable)||s!==a&&(s?!a||En(s,a,h):!!a);if(1024&l)return!0;if(16&l)return s?En(s,a,h):!!a;if(8&l){const t=e.dynamicProps;for(let e=0;e<t.length;e++){const n=t[e];if(a[n]!==s[n]&&!pn(h,n))return!0}}return!1}(t,e,n)){if(s.asyncDep&&!s.asyncResolved)return void D(s,e,n);s.next=e,function(t){const e=Ke.indexOf(t);e>Ze&&Ke.splice(e,1)}(s.update),s.update()}else e.el=t.el,s.vnode=e},O=(t,e,n,s,i,r,a)=>{const o=()=>{if(t.isMounted){let e,{next:n,bu:s,u:o,parent:l,vnode:h}=t,u=n;Us(t,!1),n?(n.el=h.el,D(t,n,a)):n=h,s&&ut(s),(e=n.props&&n.props.onVnodeBeforeUpdate)&&pi(e,l,n,h),Us(t,!0);const d=_n(t),f=t.subTree;t.subTree=d,p(f,d,c(f.el),H(f),t,i,r),n.el=d.el,null===u&&function({vnode:t,parent:e},n){for(;e&&e.subTree===t;)(t=e.vnode).el=n,e=e.parent}(t,d.el),o&&Bs(o,i),(e=n.props&&n.props.onVnodeUpdated)&&Bs((()=>pi(e,l,n,h)),i)}else{let a;const{el:o,props:l}=e,{bm:h,m:c,parent:u}=t,d=Fn(e);if(Us(t,!1),h&&ut(h),!d&&(a=l&&l.onVnodeBeforeMount)&&pi(a,u,e),Us(t,!0),o&&Z){const n=()=>{t.subTree=_n(t),Z(o,t.subTree,t,i,null)};d?e.type.__asyncLoader().then((()=>!t.isUnmounted&&n())):n()}else{const a=t.subTree=_n(t);p(null,a,n,s,t,i,r),e.el=a.el}if(c&&Bs(c,i),!d&&(a=l&&l.onVnodeMounted)){const t=e;Bs((()=>pi(a,u,t)),i)}(256&e.shapeFlag||u&&Fn(u.vnode)&&256&u.vnode.shapeFlag)&&t.a&&Bs(t.a,i),t.isMounted=!0,e=n=s=null}},l=t.effect=new It(o,(()=>rn(h)),t.scope),h=t.update=()=>l.run();h.id=t.uid,Us(t,!0),h()},D=(t,e,n)=>{e.component=t;const s=t.vnode.props;t.vnode=e,t.next=null,function(t,e,n,s){const{props:i,attrs:r,vnode:{patchFlag:a}}=t,o=Re(i),[l]=t.propsOptions;let h=!1;if(!(s||a>0)||16&a){let s;_s(t,e,i,r)&&(h=!0);for(const r in o)e&&(X(e,r)||(s=ot(r))!==r&&X(e,s))||(l?!n||void 0===n[r]&&void 0===n[s]||(i[r]=bs(l,o,r,void 0,t,!0)):delete i[r]);if(r!==o)for(const t in r)e&&X(e,t)||(delete r[t],h=!0)}else if(8&a){const n=t.vnode.dynamicProps;for(let s=0;s<n.length;s++){let a=n[s];if(pn(t.emitsOptions,a))continue;const c=e[a];if(l)if(X(r,a))c!==r[a]&&(r[a]=c,h=!0);else{const e=rt(a);i[e]=bs(l,o,e,c,t,!1)}else c!==r[a]&&(r[a]=c,h=!0)}}h&&Lt(t,"set","$attrs")}(t,e.props,s,n),Fs(t,e.children,n),kt(),on(),Ft()},L=(t,e,n,s,i,r,a,o,l=!1)=>{const c=t&&t.children,u=t?t.shapeFlag:0,d=e.children,{patchFlag:f,shapeFlag:p}=e;if(f>0){if(128&f)return void B(c,d,n,s,i,r,a,o,l);if(256&f)return void N(c,d,n,s,i,r,a,o,l)}8&p?(16&u&&G(c,i,r),d!==c&&h(n,d)):16&u?16&p?B(c,d,n,s,i,r,a,o,l):G(c,i,r,!0):(8&u&&h(n,""),16&p&&E(d,n,s,i,r,a,o,l))},N=(t,e,n,s,i,r,a,o,l)=>{e=e||k;const h=(t=t||k).length,c=e.length,u=Math.min(h,c);let d;for(d=0;d<u;d++){const s=e[d]=l?di(e[d]):ui(e[d]);p(t[d],s,n,null,i,r,a,o,l)}h>c?G(t,i,r,!0,!1,u):E(e,n,s,i,r,a,o,l,u)},B=(t,e,n,s,i,r,a,o,l)=>{let h=0;const c=e.length;let u=t.length-1,d=c-1;for(;h<=u&&h<=d;){const s=t[h],c=e[h]=l?di(e[h]):ui(e[h]);if(!ni(s,c))break;p(s,c,n,null,i,r,a,o,l),h++}for(;h<=u&&h<=d;){const s=t[u],h=e[d]=l?di(e[d]):ui(e[d]);if(!ni(s,h))break;p(s,h,n,null,i,r,a,o,l),u--,d--}if(h>u){if(h<=d){const t=d+1,u=t<c?e[t].el:s;for(;h<=d;)p(null,e[h]=l?di(e[h]):ui(e[h]),n,u,i,r,a,o,l),h++}}else if(h>d)for(;h<=u;)U(t[h],i,r,!0),h++;else{const f=h,m=h,g=new Map;for(h=m;h<=d;h++){const t=e[h]=l?di(e[h]):ui(e[h]);null!=t.key&&g.set(t.key,h)}let v,x=0;const y=d-m+1;let _=!1,b=0;const w=new Array(y);for(h=0;h<y;h++)w[h]=0;for(h=f;h<=u;h++){const s=t[h];if(x>=y){U(s,i,r,!0);continue}let c;if(null!=s.key)c=g.get(s.key);else for(v=m;v<=d;v++)if(0===w[v-m]&&ni(s,e[v])){c=v;break}void 0===c?U(s,i,r,!0):(w[c-m]=h+1,c>=b?b=c:_=!0,p(s,e[c],n,null,i,r,a,o,l),x++)}const E=_?function(t){const e=t.slice(),n=[0];let s,i,r,a,o;const l=t.length;for(s=0;s<l;s++){const l=t[s];if(0!==l){if(i=n[n.length-1],t[i]<l){e[s]=i,n.push(s);continue}for(r=0,a=n.length-1;r<a;)o=r+a>>1,t[n[o]]<l?r=o+1:a=o;l<t[n[r]]&&(r>0&&(e[s]=n[r-1]),n[r]=s)}}r=n.length,a=n[r-1];for(;r-- >0;)n[r]=a,a=e[a];return n}(w):k;for(v=E.length-1,h=y-1;h>=0;h--){const t=m+h,u=e[t],d=t+1<c?e[t+1].el:s;0===w[h]?p(null,u,n,d,i,r,a,o,l):_&&(v<0||h!==E[v]?V(u,n,d,2):v--)}}},V=(t,e,s,i,r=null)=>{const{el:a,type:o,transition:l,children:h,shapeFlag:c}=t;if(6&c)return void V(t.component.subTree,e,s,i);if(128&c)return void t.suspense.move(e,s,i);if(64&c)return void o.move(t,e,s,$);if(o===Ws){n(a,e,s);for(let t=0;t<h.length;t++)V(h[t],e,s,i);return void n(t.anchor,e,s)}if(o===Hs)return void x(t,e,s);if(2!==i&&1&c&&l)if(0===i)l.beforeEnter(a),n(a,e,s),Bs((()=>l.enter(a)),r);else{const{leave:t,delayLeave:i,afterLeave:r}=l,o=()=>n(a,e,s),h=()=>{t(a,(()=>{o(),r&&r()}))};i?i(a,o,h):h()}else n(a,e,s)},U=(t,e,n,s=!1,i=!1)=>{const{type:r,props:a,ref:o,children:l,dynamicChildren:h,shapeFlag:c,patchFlag:u,dirs:d}=t;if(null!=o&&Ns(o,null,n,t,!0),256&c)return void e.ctx.deactivate(t);const f=1&c&&d,p=!Fn(t);let m;if(p&&(m=a&&a.onVnodeBeforeUnmount)&&pi(m,e,t),6&c)z(t.component,n,s);else{if(128&c)return void t.suspense.unmount(n,s);f&&Qn(t,null,e,"beforeUnmount"),64&c?t.type.remove(t,e,n,i,$,s):h&&(r!==Ws||u>0&&64&u)?G(h,e,n,!1,!0):(r===Ws&&384&u||!i&&16&c)&&G(l,e,n),s&&Y(t)}(p&&(m=a&&a.onVnodeUnmounted)||f)&&Bs((()=>{m&&pi(m,e,t),f&&Qn(t,null,e,"unmounted")}),n)},Y=t=>{const{type:e,el:n,anchor:i,transition:r}=t;if(e===Ws)return void W(n,i);if(e===Hs)return void y(t);const a=()=>{s(n),r&&!r.persisted&&r.afterLeave&&r.afterLeave()};if(1&t.shapeFlag&&r&&!r.persisted){const{leave:e,delayLeave:s}=r,i=()=>e(n,a);s?s(t.el,a,i):i()}else a()},W=(t,e)=>{let n;for(;t!==e;)n=u(t),s(t),t=n;s(e)},z=(t,e,n)=>{const{bum:s,scope:i,update:r,subTree:a,um:o}=t;s&&ut(s),i.stop(),r&&(r.active=!1,U(a,t,e,n)),o&&Bs(o,e),Bs((()=>{t.isUnmounted=!0}),e),e&&e.pendingBranch&&!e.isUnmounted&&t.asyncDep&&!t.asyncResolved&&t.suspenseId===e.pendingId&&(e.deps--,0===e.deps&&e.resolve())},G=(t,e,n,s=!1,i=!1,r=0)=>{for(let a=r;a<t.length;a++)U(t[a],e,n,s,i)},H=t=>6&t.shapeFlag?H(t.component.subTree):128&t.shapeFlag?t.suspense.next():u(t.anchor||t.el),j=(t,e,n)=>{null==t?e._vnode&&U(e._vnode,null,null,!0):p(e._vnode||null,t,e,null,null,null,n),on(),ln(),e._vnode=t},$={p,um:U,m:V,r:Y,mt:M,mc:E,pc:L,pbc:S,n:H,o:t};let q,Z;e&&([q,Z]=e($));return{render:j,hydrate:q,createApp:Ls(j,q)}}(t)}function Us({effect:t,update:e},n){t.allowRecurse=e.allowRecurse=n}function Xs(t,e,n=!1){const s=t.children,i=e.children;if(Y(s)&&Y(i))for(let r=0;r<s.length;r++){const t=s[r];let e=i[r];1&e.shapeFlag&&!e.dynamicChildren&&((e.patchFlag<=0||32===e.patchFlag)&&(e=i[r]=di(i[r]),e.el=t.el),n||Xs(t,e)),e.type===zs&&(e.el=t.el)}}const Ys=t=>t.__isTeleport,Ws=Symbol(void 0),zs=Symbol(void 0),Gs=Symbol(void 0),Hs=Symbol(void 0),js=[];let $s=null;function qs(t=!1){js.push($s=t?null:[])}let Ks=1;function Zs(t){Ks+=t}function Qs(t){return t.dynamicChildren=Ks>0?$s||k:null,js.pop(),$s=js[js.length-1]||null,Ks>0&&$s&&$s.push(t),t}function Js(t,e,n,s,i,r){return Qs(ai(t,e,n,s,i,r,!0))}function ti(t,e,n,s,i){return Qs(oi(t,e,n,s,i,!0))}function ei(t){return!!t&&!0===t.__v_isVNode}function ni(t,e){return t.type===e.type&&t.key===e.key}const si="__vInternal",ii=({key:t})=>null!=t?t:null,ri=({ref:t,ref_key:e,ref_for:n})=>null!=t?j(t)||Le(t)||H(t)?{i:mn,r:t,k:e,f:!!n}:t:null;function ai(t,e=null,n=null,s=0,i=null,r=(t===Ws?0:1),a=!1,o=!1){const l={__v_isVNode:!0,__v_skip:!0,type:t,props:e,key:e&&ii(e),ref:e&&ri(e),scopeId:gn,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:r,patchFlag:s,dynamicProps:i,dynamicChildren:null,appContext:null,ctx:mn};return o?(fi(l,n),128&r&&t.normalize(l)):n&&(l.shapeFlag|=j(n)?8:16),Ks>0&&!a&&$s&&(l.patchFlag>0||6&r)&&32!==l.patchFlag&&$s.push(l),l}const oi=function(t,e=null,n=null,s=0,i=null,r=!1){t&&t!==es||(t=Gs);if(ei(t)){const s=li(t,e,!0);return n&&fi(s,n),Ks>0&&!r&&$s&&(6&s.shapeFlag?$s[$s.indexOf(t)]=s:$s.push(s)),s.patchFlag|=-2,s}a=t,H(a)&&"__vccOpts"in a&&(t=t.__vccOpts);var a;if(e){e=function(t){return t?Me(t)||si in t?B({},t):t:null}(e);let{class:t,style:n}=e;t&&!j(t)&&(e.class=T(t)),q(n)&&(Me(n)&&!Y(n)&&(n=B({},n)),e.style=y(n))}const o=j(t)?1:Tn(t)?128:Ys(t)?64:q(t)?4:H(t)?2:0;return ai(t,e,n,s,i,o,r,!0)};function li(t,e,n=!1){const{props:s,ref:i,patchFlag:r,children:a}=t,o=e?function(...t){const e={};for(let n=0;n<t.length;n++){const s=t[n];for(const t in s)if("class"===t)e.class!==s.class&&(e.class=T([e.class,s.class]));else if("style"===t)e.style=y([e.style,s.style]);else if(L(t)){const n=e[t],i=s[t];!i||n===i||Y(n)&&n.includes(i)||(e[t]=n?[].concat(n,i):i)}else""!==t&&(e[t]=s[t])}return e}(s||{},e):s;return{__v_isVNode:!0,__v_skip:!0,type:t.type,props:o,key:o&&ii(o),ref:e&&e.ref?n&&i?Y(i)?i.concat(ri(e)):[i,ri(e)]:ri(e):i,scopeId:t.scopeId,slotScopeIds:t.slotScopeIds,children:a,target:t.target,targetAnchor:t.targetAnchor,staticCount:t.staticCount,shapeFlag:t.shapeFlag,patchFlag:e&&t.type!==Ws?-1===r?16:16|r:r,dynamicProps:t.dynamicProps,dynamicChildren:t.dynamicChildren,appContext:t.appContext,dirs:t.dirs,transition:t.transition,component:t.component,suspense:t.suspense,ssContent:t.ssContent&&li(t.ssContent),ssFallback:t.ssFallback&&li(t.ssFallback),el:t.el,anchor:t.anchor,ctx:t.ctx,ce:t.ce}}function hi(t=" ",e=0){return oi(zs,null,t,e)}function ci(t="",e=!1){return e?(qs(),ti(Gs,null,t)):oi(Gs,null,t)}function ui(t){return null==t||"boolean"==typeof t?oi(Gs):Y(t)?oi(Ws,null,t.slice()):"object"==typeof t?di(t):oi(zs,null,String(t))}function di(t){return null===t.el&&-1!==t.patchFlag||t.memo?t:li(t)}function fi(t,e){let n=0;const{shapeFlag:s}=t;if(null==e)e=null;else if(Y(e))n=16;else if("object"==typeof e){if(65&s){const n=e.default;return void(n&&(n._c&&(n._d=!1),fi(t,n()),n._c&&(n._d=!0)))}{n=32;const s=e._;s||si in e?3===s&&mn&&(1===mn.slots._?e._=1:(e._=2,t.patchFlag|=1024)):e._ctx=mn}}else H(e)?(e={default:e,_ctx:mn},n=32):(e=String(e),64&s?(n=16,e=[hi(e)]):n=8);t.children=e,t.shapeFlag|=n}function pi(t,e,n,s=null){He(t,e,7,[n,s])}const mi=Os();let gi=0;let vi=null;const xi=()=>vi||mn,yi=t=>{vi=t,t.scope.on()},_i=()=>{vi&&vi.scope.off(),vi=null};function bi(t){return 4&t.vnode.shapeFlag}let wi,Ei=!1;function Ti(t,e,n){H(e)?t.type.__ssrInlineRender?t.ssrRender=e:t.render=e:q(e)&&(t.setupState=Ye(e)),Si(t,n)}function Si(t,e,n){const s=t.type;if(!t.render){if(!e&&wi&&!s.render){const e=s.template||ds(t).template;if(e){const{isCustomElement:n,compilerOptions:i}=t.appContext.config,{delimiters:r,compilerOptions:a}=s,o=B(B({isCustomElement:n,delimiters:r},i),a);s.render=wi(e,o)}}t.render=s.render||F}yi(t),kt(),hs(t),Ft(),_i()}function Ai(t){if(t.exposed)return t.exposeProxy||(t.exposeProxy=new Proxy(Ye(Pe(t.exposed)),{get:(e,n)=>n in e?e[n]:n in rs?rs[n](t):void 0,has:(t,e)=>e in t||e in rs}))}const Ci=(t,e)=>function(t,e,n=!1){let s,i;const r=H(t);return r?(s=t,i=F):(s=t.get,i=t.set),new ze(s,i,r||!i,n)}(t,0,Ei);function Ii(t,e,n){const s=arguments.length;return 2===s?q(e)&&!Y(e)?ei(e)?oi(t,null,[e]):oi(t,e):oi(t,null,e):(s>3?n=Array.prototype.slice.call(arguments,2):3===s&&ei(n)&&(n=[n]),oi(t,e,n))}const Mi=Symbol(""),Ri=()=>Sn(Mi),Pi="3.2.47",ki="undefined"!=typeof document?document:null,Fi=ki&&ki.createElement("template"),Oi={insert:(t,e,n)=>{e.insertBefore(t,n||null)},remove:t=>{const e=t.parentNode;e&&e.removeChild(t)},createElement:(t,e,n,s)=>{const i=e?ki.createElementNS("http://www.w3.org/2000/svg",t):ki.createElement(t,n?{is:n}:void 0);return"select"===t&&s&&null!=s.multiple&&i.setAttribute("multiple",s.multiple),i},createText:t=>ki.createTextNode(t),createComment:t=>ki.createComment(t),setText:(t,e)=>{t.nodeValue=e},setElementText:(t,e)=>{t.textContent=e},parentNode:t=>t.parentNode,nextSibling:t=>t.nextSibling,querySelector:t=>ki.querySelector(t),setScopeId(t,e){t.setAttribute(e,"")},insertStaticContent(t,e,n,s,i,r){const a=n?n.previousSibling:e.lastChild;if(i&&(i===r||i.nextSibling))for(;e.insertBefore(i.cloneNode(!0),n),i!==r&&(i=i.nextSibling););else{Fi.innerHTML=s?`<svg>${t}</svg>`:t;const i=Fi.content;if(s){const t=i.firstChild;for(;t.firstChild;)i.appendChild(t.firstChild);i.removeChild(t)}e.insertBefore(i,n)}return[a?a.nextSibling:e.firstChild,n?n.previousSibling:e.lastChild]}};const Di=/\s*!important$/;function Li(t,e,n){if(Y(n))n.forEach((n=>Li(t,e,n)));else if(null==n&&(n=""),e.startsWith("--"))t.setProperty(e,n);else{const s=function(t,e){const n=Bi[e];if(n)return n;let s=rt(e);if("filter"!==s&&s in t)return Bi[e]=s;s=lt(s);for(let i=0;i<Ni.length;i++){const n=Ni[i]+s;if(n in t)return Bi[e]=n}return e}(t,e);Di.test(n)?t.setProperty(ot(s),n.replace(Di,""),"important"):t[s]=n}}const Ni=["Webkit","Moz","ms"],Bi={};const Vi="http://www.w3.org/1999/xlink";function Ui(t,e,n,s){t.addEventListener(e,n,s)}function Xi(t,e,n,s,i=null){const r=t._vei||(t._vei={}),a=r[e];if(s&&a)a.value=s;else{const[n,o]=function(t){let e;if(Yi.test(t)){let n;for(e={};n=t.match(Yi);)t=t.slice(0,t.length-n[0].length),e[n[0].toLowerCase()]=!0}const n=":"===t[2]?t.slice(3):ot(t.slice(2));return[n,e]}(e);if(s){const a=r[e]=function(t,e){const n=t=>{if(t._vts){if(t._vts<=n.attached)return}else t._vts=Date.now();He(function(t,e){if(Y(e)){const n=t.stopImmediatePropagation;return t.stopImmediatePropagation=()=>{n.call(t),t._stopped=!0},e.map((t=>e=>!e._stopped&&t&&t(e)))}return e}(t,n.value),e,5,[t])};return n.value=t,n.attached=Gi(),n}(s,i);Ui(t,n,a,o)}else a&&(!function(t,e,n,s){t.removeEventListener(e,n,s)}(t,n,a,o),r[e]=void 0)}}const Yi=/(?:Once|Passive|Capture)$/;let Wi=0;const zi=Promise.resolve(),Gi=()=>Wi||(zi.then((()=>Wi=0)),Wi=Date.now());const Hi=/^on[a-z]/;const ji=t=>{const e=t.props["onUpdate:modelValue"]||!1;return Y(e)?t=>ut(e,t):e};function $i(t){t.target.composing=!0}function qi(t){const e=t.target;e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}const Ki={created(t,{modifiers:{lazy:e,trim:n,number:s}},i){t._assign=ji(i);const r=s||i.props&&"number"===i.props.type;Ui(t,e?"change":"input",(e=>{if(e.target.composing)return;let s=t.value;n&&(s=s.trim()),r&&(s=ft(s)),t._assign(s)})),n&&Ui(t,"change",(()=>{t.value=t.value.trim()})),e||(Ui(t,"compositionstart",$i),Ui(t,"compositionend",qi),Ui(t,"change",qi))},mounted(t,{value:e}){t.value=null==e?"":e},beforeUpdate(t,{value:e,modifiers:{lazy:n,trim:s,number:i}},r){if(t._assign=ji(r),t.composing)return;if(document.activeElement===t&&"range"!==t.type){if(n)return;if(s&&t.value.trim()===e)return;if((i||"number"===t.type)&&ft(t.value)===e)return}const a=null==e?"":e;t.value!==a&&(t.value=a)}},Zi={deep:!0,created(t,e,n){t._assign=ji(n),Ui(t,"change",(()=>{const e=t._modelValue,n=nr(t),s=t.checked,i=t._assign;if(Y(e)){const t=I(e,n),r=-1!==t;if(s&&!r)i(e.concat(n));else if(!s&&r){const n=[...e];n.splice(t,1),i(n)}}else if(z(e)){const t=new Set(e);s?t.add(n):t.delete(n),i(t)}else i(sr(t,s))}))},mounted:Qi,beforeUpdate(t,e,n){t._assign=ji(n),Qi(t,e,n)}};function Qi(t,{value:e,oldValue:n},s){t._modelValue=e,Y(e)?t.checked=I(e,s.props.value)>-1:z(e)?t.checked=e.has(s.props.value):e!==n&&(t.checked=C(e,sr(t,!0)))}const Ji={created(t,{value:e},n){t.checked=C(e,n.props.value),t._assign=ji(n),Ui(t,"change",(()=>{t._assign(nr(t))}))},beforeUpdate(t,{value:e,oldValue:n},s){t._assign=ji(s),e!==n&&(t.checked=C(e,s.props.value))}},tr={deep:!0,created(t,{value:e,modifiers:{number:n}},s){const i=z(e);Ui(t,"change",(()=>{const e=Array.prototype.filter.call(t.options,(t=>t.selected)).map((t=>n?ft(nr(t)):nr(t)));t._assign(t.multiple?i?new Set(e):e:e[0])})),t._assign=ji(s)},mounted(t,{value:e}){er(t,e)},beforeUpdate(t,e,n){t._assign=ji(n)},updated(t,{value:e}){er(t,e)}};function er(t,e){const n=t.multiple;if(!n||Y(e)||z(e)){for(let s=0,i=t.options.length;s<i;s++){const i=t.options[s],r=nr(i);if(n)Y(e)?i.selected=I(e,r)>-1:i.selected=e.has(r);else if(C(nr(i),e))return void(t.selectedIndex!==s&&(t.selectedIndex=s))}n||-1===t.selectedIndex||(t.selectedIndex=-1)}}function nr(t){return"_value"in t?t._value:t.value}function sr(t,e){const n=e?"_trueValue":"_falseValue";return n in t?t[n]:e}const ir={beforeMount(t,{value:e},{transition:n}){t._vod="none"===t.style.display?"":t.style.display,n&&e?n.beforeEnter(t):rr(t,e)},mounted(t,{value:e},{transition:n}){n&&e&&n.enter(t)},updated(t,{value:e,oldValue:n},{transition:s}){!e!=!n&&(s?e?(s.beforeEnter(t),rr(t,!0),s.enter(t)):s.leave(t,(()=>{rr(t,!1)})):rr(t,e))},beforeUnmount(t,{value:e}){rr(t,e)}};function rr(t,e){t.style.display=e?t._vod:"none"}const ar=B({patchProp:(t,e,n,s,i=!1,r,a,o,l)=>{"class"===e?function(t,e,n){const s=t._vtc;s&&(e=(e?[e,...s]:[...s]).join(" ")),null==e?t.removeAttribute("class"):n?t.setAttribute("class",e):t.className=e}(t,s,i):"style"===e?function(t,e,n){const s=t.style,i=j(n);if(n&&!i){if(e&&!j(e))for(const t in e)null==n[t]&&Li(s,t,"");for(const t in n)Li(s,t,n[t])}else{const r=s.display;i?e!==n&&(s.cssText=n):e&&t.removeAttribute("style"),"_vod"in t&&(s.display=r)}}(t,n,s):L(e)?N(e)||Xi(t,e,0,s,a):("."===e[0]?(e=e.slice(1),1):"^"===e[0]?(e=e.slice(1),0):function(t,e,n,s){if(s)return"innerHTML"===e||"textContent"===e||!!(e in t&&Hi.test(e)&&H(n));if("spellcheck"===e||"draggable"===e||"translate"===e)return!1;if("form"===e)return!1;if("list"===e&&"INPUT"===t.tagName)return!1;if("type"===e&&"TEXTAREA"===t.tagName)return!1;if(Hi.test(e)&&j(n))return!1;return e in t}(t,e,s,i))?function(t,e,n,s,i,r,a){if("innerHTML"===e||"textContent"===e)return s&&a(s,i,r),void(t[e]=null==n?"":n);if("value"===e&&"PROGRESS"!==t.tagName&&!t.tagName.includes("-")){t._value=n;const s=null==n?"":n;return t.value===s&&"OPTION"!==t.tagName||(t.value=s),void(null==n&&t.removeAttribute(e))}let o=!1;if(""===n||null==n){const s=typeof t[e];"boolean"===s?n=A(n):null==n&&"string"===s?(n="",o=!0):"number"===s&&(n=0,o=!0)}try{t[e]=n}catch(_m){}o&&t.removeAttribute(e)}(t,e,s,r,a,o,l):("true-value"===e?t._trueValue=s:"false-value"===e&&(t._falseValue=s),function(t,e,n,s,i){if(s&&e.startsWith("xlink:"))null==n?t.removeAttributeNS(Vi,e.slice(6,e.length)):t.setAttributeNS(Vi,e,n);else{const s=S(e);null==n||s&&!A(n)?t.removeAttribute(e):t.setAttribute(e,s?"":n)}}(t,e,s,i))}},Oi);let or;const lr=""+new URL("../assets/logo_star-8f0bdd72.png",import.meta.url).href,hr=""+new URL("../assets/logo_title-6d370861.png",import.meta.url).href,cr=""+new URL("../assets/bottom_right-1aaad10c.png",import.meta.url).href,ur=Ne(),dr=Ne([]);function fr(t,e){null!==t?(ur.value=t,void 0!==e?Array.isArray(e)?dr.value=e:dr.value=[e]:dr.value.length=0):ur.value=void 0}const pr=t=>(xn("data-v-c7428b11"),t=t(),yn(),t),mr={id:"screen"},gr=pr((()=>ai("img",{src:lr,alt:"Logo",id:"logo"},null,-1))),vr=pr((()=>ai("img",{src:"data:image/png;base64,/9j/4AAQSkZJRgABAQEAYABgAAD/2wBDAAMCAgMCAgMDAwMEAwMEBQgFBQQEBQoHBwYIDAoMDAsKCwsNDhIQDQ4RDgsLEBYQERMUFRUVDA8XGBYUGBIUFRT/2wBDAQMEBAUEBQkFBQkUDQsNFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBT/wAARCACUAKwDASIAAhEBAxEB/8QAHwAAAQUBAQEBAQEAAAAAAAAAAAECAwQFBgcICQoL/8QAtRAAAgEDAwIEAwUFBAQAAAF9AQIDAAQRBRIhMUEGE1FhByJxFDKBkaEII0KxwRVS0fAkM2JyggkKFhcYGRolJicoKSo0NTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uHi4+Tl5ufo6erx8vP09fb3+Pn6/8QAHwEAAwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoL/8QAtREAAgECBAQDBAcFBAQAAQJ3AAECAxEEBSExBhJBUQdhcRMiMoEIFEKRobHBCSMzUvAVYnLRChYkNOEl8RcYGRomJygpKjU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6goOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4uPk5ebn6Onq8vP09fb3+Pn6/9oADAMBAAIRAxEAPwD8qqKKKACiiigAooooAKKK+if2d/gCmsS23ifxTb/8S5SJLPT5R/x8HtI4/uei/wAXfj73mZjmNDLKDxFd6dF1b7IyqVY0o80jy/Q/gd498SaWuo6d4W1C4snTzElKBN6+qhiCw9MZzXH6lpl5o1/PY39rNZXkDbJbe4Qo6N6FTyK/UGHVAqgA4A4AFfOf7avh6wvvC+j+IxGqanBdiyaRQAZInR2AJ77SnHpuavz/ACfjCvjsfHC4ikoxm7Jq912v3/A46WL9pLla3PkGiitGwt4rdRdXYzGPuRd3P+FfqMpcqud0pKCuXtH022sbcanqYzAvMNv3lbtn2/z9c/WtaudcvDPcNwOEjH3UX0FQ6hqE2pXBllPsqjoo9BVasYU/e9pP4vyMKdJ83tamsvy8l+rCiivV/hP8LF1Roda1qL/QQd1vauP9d6Mw/u+3f6dc8Xi6WDpOrVf/AAfJDxGIp4aDqVGXvgz8HRq7Qa7r0ONPBD21nIP9f6Mw/ueg/i+nX0Txd441LxPqzeD/AAe4W7xtvtTX/V2cfQgEfxduOnQc9MnxR4x1DxHqh8LeFXxdYxeagv3LROhAI/i+nToOenI+LvG1h8N9Ek8KeE3/ANMbi/1IH593cA/3v/Qeg56fBSp4jMcSqtaN5v4Yv4Yr+aX6LeT8rI+ei6uKqKc1q9l0S7v+tS9418e6d8LdBk8HeDZP9ObjUdVB/eb+jAN/f7f7PQc9PDCSxJJyTQSWJJ5NFfc4LBQwcGk7ylrKT3b/AK2XQ+jo0VSVt2933CiiivQNwooooAKKKKACiivUvhX8NUvpIdY1mL/RVO6C1cf630Zh/d9B3+nXjxWKp4Ok6tT/AIc5cTiaeFp+0qP/AIJt/BH4NpqkkGv+IIf9BUh7WykH+u9Hcf3PQd/p1+n4dUC4AOB6VwMOqAYAOAKtNrkdrC800qxQxgs7ucBQBySa/Gs0q18zre0q/Jdv6/E+JrY6eJnzS+SO8k16Gyt5Li4nWGCJS7ySMFVVAySSe1fIvx8+M5+JupQWGnhk0OwdmiZshriQjHmEdgBkAdeST1wKnxc+MNx40kbTNOkeHRI257NcsP4m/wBn0H4ntjzCvsuH+HY4OSxmIXv9F2/4P5eu31GBwsoJVKu/bsPhKq25+cdqWe4e4fc5z6D0qOivvra3PXtrcKKK73wD4FF80epalH/ow+aKBh/rPc/7P8/p158RiIYeDnM5cViqeEpupUf/AAS58Nfh2uoNFqurx/6IPmhtmH+t/wBpv9n27/Tr2niHxVfa9qB8OeG2C3GMXV8PuWydCAf73/6hz0ydb8RXmtXx0LQmxP0ubwfdt16EA+v+evSlJef2Yg8KeExm7f8A4/NQJ+52YlvX+XQc18jUVTFVfbVt+ie0V/NL/Lr6HyLqVMTU9tX33Se0V/NL9O/oN8UeMLLwDo7+GvDD/wCltxe6gD8+7uAf73/oPQc9PJySTk8mu38U69puk6GfDOiIk8JdZL3UXUF7iRegU9lB9P8AEniK+jy+iqdNy5XeTvd7y8328l0R9RgYKNLms7vq935vt5Logooor1D0QooooAKKKKACiius8JeF1uGS9vl/dDmOFv4vc+386xrVo0Y88jnr14YeDnM0PAfglbpo9R1KP9wPmigYff8A9ph6e3f6dfWI9QK9DgVzUd574FTHUFiRndwiKMlmOAB618Pi5VMXPmn8l2PzvG1KuMqc8/kux039sLbxtJLII0QbmZjgADvXj3xE+JM/ihmsLN2i0tDz2MxHc+3oPxPtQ8ZeNJNcY2lszJYKeexlPqfb0H+Ryle1l2VxotVqq97ou3/B/I+kyrKvYWrV/i6Lt/wfyCiiivpD6gKKK63wj4UF0yXt8n7gcxxN/H7n2/n9OuNatGjDnkc9evDDwc5ljwT4MF4yX+oJ/o45ihb/AJae59v5/Tr0usa9dareHRtGbE3S4uh92Be4B9f89elLVNaudSuzpOktiXpPcD7sK9wD6/5+mfe6lHotv/Yehn/SG/4+bvuD359f5fWvnZKpiKiqVFr0XRLu/wCtT5WSq4qqqtVXl0XSK7v+tfQu3F6ulRjw54c5uW/4+r3P3fUk+v8ALoOa5/Vteg0bT30fR3yr8Xd4PvTHuAf7v+fXNC81SPT7RtP09uG/19x3kPoPb/P1xK9ShhV8U9euvV93+i6HsYfBR+Keq313b7v9F09Qooor1D2gooooAKKKKACiir2n2qswklGV7Ke9TKSirsiUlFXZf0HRVkZbm5X92OUjP8Xufauxju65xLzpzU63wVdxOAOprxa0ZVpXkfPYiM68uaR0P25Y1LMwVVGSSeBXGeJPFEmrMbeBitop59ZD6n29qp6vrT337qMlYB/499ay66cNg1TfPNanZhMDGm/aTWvTyClVS7BVBZicADqaRVLMABkngAV9N/BH4R2HgazHjHxf5cNzAnnwW9x920Uc+Y/+36D+H/e6RmWZUsto+0nrJ7RW7fY9CtWjQjeXyK/gz9lOwHw41HxB431W40G7+ztPBEhULaqFJBmDAkknHyAgjpnJwPmyvWPjj8dr74oXxsLN5LXw5bvmODo1ww/5aP8A0Xt9a4XQNDEzLc3K/uuqRn+L3PtXBlX16lSnicyn703dR6RXZfr/AJ3M1UlSpupW+4seGfDYuCt3dr+56pGf4/c+38629Q1a41G5Om6acSdJpx92Jf8AH/P0p3mpT31wbCwOJOkk3aMf41R1LVodDtDp2nH96f8AXXHfPfn1/lXS4zrTUpLXoui83/Wp5DjUxFRSkry6Lol3f9alnUtXh0G1OlaUf3x/19z3z359f5Vzcl55MBggOA335O7Vb8LeF7/xfqy2FiEVtpkmuJm2RQRjlpJG/hUDqfw5JAqbxkmgW+qJa+HWuLmzt4hFJfXHBu5QTulVP4EOQFU5OACeSa7Kfs6dT2K1lu/+D+i/yZ69LDwpe7u935vz/QwqKKK9A7AooooAKKKKACiiigBVIDZIzVlbr3qrRScU9yXFS3NBLz3qC6vGmGwHCfzqtRUKCTuSqcU7hQAWIAGSaBk8Dk16j4D8I2/h+Ia1rG1Joxvjjk6Qj+83+16en16c+KxMcLDmlq+i7nLi8XTwdPnnq3surZ0nwq+Htn4Ttx4l8R+XHPCvmxQzfdtx/fb/AG/Qdvr0474sfFy78fXX2O2Z7fRIWykPQzMP43/oO31rM8ffEO58WzfZoWaLS42ysfQyH+839B2rndPsgxEko+XsvrXkYXAydX69jdanRdIry8zjw9Gd/rWK+J7Lt/wSfR9LEhWecfu+qof4vc+1aVzey3k32OzOG/jk7IKqS3Ul1J9ntzg/xSdlFRXV8mnQG1tD8/8AHJ3z/jXpOMqkrvfp5GsoyqTu9+i6LzZYvtSi0i2NjYn95/y0m75/x/lVDQdBu/EeoraWoUHBeSaVtscKD7zu3ZQO9Q6Xpk+r3Ygh2g43PI5wkajqzHsBWrq2uQ2unto2kFlsSQbi4Iw9446E+iD+FfxPNaO9P93S1k93283+i/4LOiKVN+zhrJ7v9X+iL3iDxNa2Okt4c8Osy6UWDXl6y7ZdRkHRm9Iwfup+J56cjRRW1GjGjHlj13fVvu/68lodcYqKsgooorcoKKKKACiiigAooooAKKKKACiium0HS4rBftl3gOo3KrdE9z71jVqKnG7MK1ZUY3e5q+E/DsOkx/2nqW1ZEG9EfpH7n3/l9ax/FnjCbxBL5MRaOxQ/Kndz/eP+FVNe8Qy6s/loSlsp4X+8fU1jrxXJRw7lP29bWXTyOGhhXKp9ZxGsui7E9vEPvv07CrLTPcN5cfHq3pVNWaQ4BxUrziGPy4+D3auySuzulFt+ZYmu1s4jBb8N/E/eqtlZS6hcCKPGerMxwqjuSewpkEDXEgRfqWPAA9TVm4vFjtza22RDnMj9DKff29BSty+7HcVnH3YbvqWL7UoobU6fYEi2yDLMRhp2Hc+ijsPxPNZVFFXGKgrI0hBU1ZBRRRVmgUUUUAFFFFABRRRQAUUUUAFFFKrbTmgDQ0+FLf8AfS43DkA9vemajqj3p2AlYh0Hr7mqjzM4wTxTKyUPe5pbmKprm55bhRRRWpsO3lVwOKRV3HFJRQIlebbH5UfCfxHu3/1qioopWsCVgooopjCiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA//Z",alt:"top_left-log",id:"top-left"},null,-1))),xr={id:"loadGame"},yr=pr((()=>ai("img",{src:hr,alt:"Logo Title"},null,-1))),_r=["value"],br=pr((()=>ai("br",null,null,-1))),wr=pr((()=>ai("img",{src:cr,alt:"bottom_right-logo",id:"bottom-right"},null,-1))),Er=(t,e)=>{const n=t.__vccOpts||t;for(const[s,i]of e)n[s]=i;return n},Tr=Er(kn({__name:"loading",props:{progressNum:null},setup(t){const e=t,n=Ne();var s;return Cn((()=>e.progressNum),(t=>{void 0!==n.value&&(n.value.innerText=(100*t).toFixed()+"%")})),s=null!==API.params.get("debug"),API.showErrorMessage=fr,s&&(window.onerror=(t,e,n,s,i)=>{var r,a;"string"==typeof t?API.showErrorMessage(t,null==(r=null==i?void 0:i.stack)?void 0:r.split("\n")):API.showErrorMessage(t.type,null==(a=null==i?void 0:i.stack)?void 0:a.split("\n"))},window.onunhandledrejection=t=>{var e;if(!(t.reason instanceof Error&&""!=t.reason.message))throw new Error(t.type);API.showErrorMessage(t.reason.message,null==(e=t.reason.stack)?void 0:e.split("\n"))}),(e,s)=>(qs(),Js("div",mr,[gr,vr,ai("div",xr,[yr,ai("div",{id:"loader",class:T({"has-error":Ue(ur)})},[ai("div",{class:"status",ref_key:"statusDiv",ref:n},"Downloading...",512),ai("div",null,[ai("progress",{class:"progress-bar",id:"progress",value:t.progressNum,max:"1"},null,8,_r)])],2)]),ai("div",{class:T(["error-panel",{"has-error":Ue(ur)}])},[ai("p",null,M(Ue(ur)),1),ai("p",null,[(qs(!0),Js(Ws,null,ss(Ue(dr),(t=>(qs(),Js("span",null,[hi(M(t),1),br])))),256))])],2),wr]))}}),[["__scopeId","data-v-c7428b11"]]);var Sr=(t=>(t[t.WEBGL_LEGACY=0]="WEBGL_LEGACY",t[t.WEBGL=1]="WEBGL",t[t.WEBGL2=2]="WEBGL2",t))(Sr||{}),Ar=(t=>(t[t.UNKNOWN=0]="UNKNOWN",t[t.WEBGL=1]="WEBGL",t[t.CANVAS=2]="CANVAS",t))(Ar||{}),Cr=(t=>(t[t.COLOR=16384]="COLOR",t[t.DEPTH=256]="DEPTH",t[t.STENCIL=1024]="STENCIL",t))(Cr||{}),Ir=(t=>(t[t.NORMAL=0]="NORMAL",t[t.ADD=1]="ADD",t[t.MULTIPLY=2]="MULTIPLY",t[t.SCREEN=3]="SCREEN",t[t.OVERLAY=4]="OVERLAY",t[t.DARKEN=5]="DARKEN",t[t.LIGHTEN=6]="LIGHTEN",t[t.COLOR_DODGE=7]="COLOR_DODGE",t[t.COLOR_BURN=8]="COLOR_BURN",t[t.HARD_LIGHT=9]="HARD_LIGHT",t[t.SOFT_LIGHT=10]="SOFT_LIGHT",t[t.DIFFERENCE=11]="DIFFERENCE",t[t.EXCLUSION=12]="EXCLUSION",t[t.HUE=13]="HUE",t[t.SATURATION=14]="SATURATION",t[t.COLOR=15]="COLOR",t[t.LUMINOSITY=16]="LUMINOSITY",t[t.NORMAL_NPM=17]="NORMAL_NPM",t[t.ADD_NPM=18]="ADD_NPM",t[t.SCREEN_NPM=19]="SCREEN_NPM",t[t.NONE=20]="NONE",t[t.SRC_OVER=0]="SRC_OVER",t[t.SRC_IN=21]="SRC_IN",t[t.SRC_OUT=22]="SRC_OUT",t[t.SRC_ATOP=23]="SRC_ATOP",t[t.DST_OVER=24]="DST_OVER",t[t.DST_IN=25]="DST_IN",t[t.DST_OUT=26]="DST_OUT",t[t.DST_ATOP=27]="DST_ATOP",t[t.ERASE=26]="ERASE",t[t.SUBTRACT=28]="SUBTRACT",t[t.XOR=29]="XOR",t))(Ir||{}),Mr=(t=>(t[t.POINTS=0]="POINTS",t[t.LINES=1]="LINES",t[t.LINE_LOOP=2]="LINE_LOOP",t[t.LINE_STRIP=3]="LINE_STRIP",t[t.TRIANGLES=4]="TRIANGLES",t[t.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",t[t.TRIANGLE_FAN=6]="TRIANGLE_FAN",t))(Mr||{}),Rr=(t=>(t[t.RGBA=6408]="RGBA",t[t.RGB=6407]="RGB",t[t.RG=33319]="RG",t[t.RED=6403]="RED",t[t.RGBA_INTEGER=36249]="RGBA_INTEGER",t[t.RGB_INTEGER=36248]="RGB_INTEGER",t[t.RG_INTEGER=33320]="RG_INTEGER",t[t.RED_INTEGER=36244]="RED_INTEGER",t[t.ALPHA=6406]="ALPHA",t[t.LUMINANCE=6409]="LUMINANCE",t[t.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",t[t.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",t[t.DEPTH_STENCIL=34041]="DEPTH_STENCIL",t))(Rr||{}),Pr=(t=>(t[t.TEXTURE_2D=3553]="TEXTURE_2D",t[t.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",t[t.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",t[t.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",t[t.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",t[t.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",t[t.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",t))(Pr||{}),kr=(t=>(t[t.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",t[t.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",t[t.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",t[t.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",t[t.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",t[t.UNSIGNED_INT=5125]="UNSIGNED_INT",t[t.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",t[t.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",t[t.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",t[t.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",t[t.BYTE=5120]="BYTE",t[t.SHORT=5122]="SHORT",t[t.INT=5124]="INT",t[t.FLOAT=5126]="FLOAT",t[t.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",t[t.HALF_FLOAT=36193]="HALF_FLOAT",t))(kr||{}),Fr=(t=>(t[t.FLOAT=0]="FLOAT",t[t.INT=1]="INT",t[t.UINT=2]="UINT",t))(Fr||{}),Or=(t=>(t[t.NEAREST=0]="NEAREST",t[t.LINEAR=1]="LINEAR",t))(Or||{}),Dr=(t=>(t[t.CLAMP=33071]="CLAMP",t[t.REPEAT=10497]="REPEAT",t[t.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",t))(Dr||{}),Lr=(t=>(t[t.OFF=0]="OFF",t[t.POW2=1]="POW2",t[t.ON=2]="ON",t[t.ON_MANUAL=3]="ON_MANUAL",t))(Lr||{}),Nr=(t=>(t[t.NPM=0]="NPM",t[t.UNPACK=1]="UNPACK",t[t.PMA=2]="PMA",t[t.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",t[t.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",t[t.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA",t))(Nr||{}),Br=(t=>(t[t.NO=0]="NO",t[t.YES=1]="YES",t[t.AUTO=2]="AUTO",t[t.BLEND=0]="BLEND",t[t.CLEAR=1]="CLEAR",t[t.BLIT=2]="BLIT",t))(Br||{}),Vr=(t=>(t[t.AUTO=0]="AUTO",t[t.MANUAL=1]="MANUAL",t))(Vr||{}),Ur=(t=>(t.LOW="lowp",t.MEDIUM="mediump",t.HIGH="highp",t))(Ur||{}),Xr=(t=>(t[t.NONE=0]="NONE",t[t.SCISSOR=1]="SCISSOR",t[t.STENCIL=2]="STENCIL",t[t.SPRITE=3]="SPRITE",t[t.COLOR=4]="COLOR",t))(Xr||{}),Yr=(t=>(t[t.NONE=0]="NONE",t[t.LOW=2]="LOW",t[t.MEDIUM=4]="MEDIUM",t[t.HIGH=8]="HIGH",t))(Yr||{}),Wr=(t=>(t[t.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",t[t.ARRAY_BUFFER=34962]="ARRAY_BUFFER",t[t.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",t))(Wr||{});const zr={ADAPTER:{createCanvas:(t,e)=>{const n=document.createElement("canvas");return n.width=t,n.height=e,n},getCanvasRenderingContext2D:()=>CanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>{var t;return null!=(t=document.baseURI)?t:window.location.href},getFontFaceSet:()=>document.fonts,fetch:(t,e)=>fetch(t,e),parseXML:t=>(new DOMParser).parseFromString(t,"text/xml")},RESOLUTION:1,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1};var Gr=/iPhone/i,Hr=/iPod/i,jr=/iPad/i,$r=/\biOS-universal(?:.+)Mac\b/i,qr=/\bAndroid(?:.+)Mobile\b/i,Kr=/Android/i,Zr=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,Qr=/Silk/i,Jr=/Windows Phone/i,ta=/\bWindows(?:.+)ARM\b/i,ea=/BlackBerry/i,na=/BB10/i,sa=/Opera Mini/i,ia=/\b(CriOS|Chrome)(?:.+)Mobile/i,ra=/Mobile(?:.+)Firefox\b/i,aa=function(t){return void 0!==t&&"MacIntel"===t.platform&&"number"==typeof t.maxTouchPoints&&t.maxTouchPoints>1&&"undefined"==typeof MSStream};function oa(t){var e={userAgent:"",platform:"",maxTouchPoints:0};t||"undefined"==typeof navigator?"string"==typeof t?e.userAgent=t:t&&t.userAgent&&(e={userAgent:t.userAgent,platform:t.platform,maxTouchPoints:t.maxTouchPoints||0}):e={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0};var n=e.userAgent,s=n.split("[FBAN");void 0!==s[1]&&(n=s[0]),void 0!==(s=n.split("Twitter"))[1]&&(n=s[0]);var i=function(t){return function(e){return e.test(t)}}(n),r={apple:{phone:i(Gr)&&!i(Jr),ipod:i(Hr),tablet:!i(Gr)&&(i(jr)||aa(e))&&!i(Jr),universal:i($r),device:(i(Gr)||i(Hr)||i(jr)||i($r)||aa(e))&&!i(Jr)},amazon:{phone:i(Zr),tablet:!i(Zr)&&i(Qr),device:i(Zr)||i(Qr)},android:{phone:!i(Jr)&&i(Zr)||!i(Jr)&&i(qr),tablet:!i(Jr)&&!i(Zr)&&!i(qr)&&(i(Qr)||i(Kr)),device:!i(Jr)&&(i(Zr)||i(Qr)||i(qr)||i(Kr))||i(/\bokhttp\b/i)},windows:{phone:i(Jr),tablet:i(ta),device:i(Jr)||i(ta)},other:{blackberry:i(ea),blackberry10:i(na),opera:i(sa),firefox:i(ra),chrome:i(ia),device:i(ea)||i(na)||i(sa)||i(ra)||i(ia)},any:!1,phone:!1,tablet:!1};return r.any=r.apple.device||r.android.device||r.windows.device||r.other.device,r.phone=r.apple.phone||r.android.phone||r.windows.phone,r.tablet=r.apple.tablet||r.android.tablet||r.windows.tablet,r}const la=(null!=(t=oa.default)?t:oa)(globalThis.navigator);zr.RETINA_PREFIX=/@([0-9\.]+)x/,zr.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!1;var ha="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function ca(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var ua={};!function(t){var e=Object.prototype.hasOwnProperty,n="~";function s(){}function i(t,e,n){this.fn=t,this.context=e,this.once=n||!1}function r(t,e,s,r,a){if("function"!=typeof s)throw new TypeError("The listener must be a function");var o=new i(s,r||t,a),l=n?n+e:e;return t._events[l]?t._events[l].fn?t._events[l]=[t._events[l],o]:t._events[l].push(o):(t._events[l]=o,t._eventsCount++),t}function a(t,e){0==--t._eventsCount?t._events=new s:delete t._events[e]}function o(){this._events=new s,this._eventsCount=0}Object.create&&(s.prototype=Object.create(null),(new s).__proto__||(n=!1)),o.prototype.eventNames=function(){var t,s,i=[];if(0===this._eventsCount)return i;for(s in t=this._events)e.call(t,s)&&i.push(n?s.slice(1):s);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(t)):i},o.prototype.listeners=function(t){var e=n?n+t:t,s=this._events[e];if(!s)return[];if(s.fn)return[s.fn];for(var i=0,r=s.length,a=new Array(r);i<r;i++)a[i]=s[i].fn;return a},o.prototype.listenerCount=function(t){var e=n?n+t:t,s=this._events[e];return s?s.fn?1:s.length:0},o.prototype.emit=function(t,e,s,i,r,a){var o=n?n+t:t;if(!this._events[o])return!1;var l,h,c=this._events[o],u=arguments.length;if(c.fn){switch(c.once&&this.removeListener(t,c.fn,void 0,!0),u){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,e),!0;case 3:return c.fn.call(c.context,e,s),!0;case 4:return c.fn.call(c.context,e,s,i),!0;case 5:return c.fn.call(c.context,e,s,i,r),!0;case 6:return c.fn.call(c.context,e,s,i,r,a),!0}for(h=1,l=new Array(u-1);h<u;h++)l[h-1]=arguments[h];c.fn.apply(c.context,l)}else{var d,f=c.length;for(h=0;h<f;h++)switch(c[h].once&&this.removeListener(t,c[h].fn,void 0,!0),u){case 1:c[h].fn.call(c[h].context);break;case 2:c[h].fn.call(c[h].context,e);break;case 3:c[h].fn.call(c[h].context,e,s);break;case 4:c[h].fn.call(c[h].context,e,s,i);break;default:if(!l)for(d=1,l=new Array(u-1);d<u;d++)l[d-1]=arguments[d];c[h].fn.apply(c[h].context,l)}}return!0},o.prototype.on=function(t,e,n){return r(this,t,e,n,!1)},o.prototype.once=function(t,e,n){return r(this,t,e,n,!0)},o.prototype.removeListener=function(t,e,s,i){var r=n?n+t:t;if(!this._events[r])return this;if(!e)return a(this,r),this;var o=this._events[r];if(o.fn)o.fn!==e||i&&!o.once||s&&o.context!==s||a(this,r);else{for(var l=0,h=[],c=o.length;l<c;l++)(o[l].fn!==e||i&&!o[l].once||s&&o[l].context!==s)&&h.push(o[l]);h.length?this._events[r]=1===h.length?h[0]:h:a(this,r)}return this},o.prototype.removeAllListeners=function(t){var e;return t?(e=n?n+t:t,this._events[e]&&a(this,e)):(this._events=new s,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=n,o.EventEmitter=o,t.exports=o}({get exports(){return ua},set exports(t){ua=t}});var da={};function fa(t,e,n){n=n||2;var s,i,r,a,o,l,h,c=e&&e.length,u=c?e[0]*n:t.length,d=pa(t,0,u,n,!0),f=[];if(!d||d.next===d.prev)return f;if(c&&(d=function(t,e,n,s){var i,r,a,o=[];for(i=0,r=e.length;i<r;i++)(a=pa(t,e[i]*s,i<r-1?e[i+1]*s:t.length,s,!1))===a.next&&(a.steiner=!0),o.push(Sa(a));for(o.sort(ba),i=0;i<o.length;i++)n=wa(o[i],n);return n}(t,e,d,n)),t.length>80*n){s=r=t[0],i=a=t[1];for(var p=n;p<u;p+=n)(o=t[p])<s&&(s=o),(l=t[p+1])<i&&(i=l),o>r&&(r=o),l>a&&(a=l);h=0!==(h=Math.max(r-s,a-i))?32767/h:0}return ga(d,f,n,s,i,h,0),f}function pa(t,e,n,s,i){var r,a;if(i===Ba(t,e,n,s)>0)for(r=e;r<n;r+=s)a=Da(r,t[r],t[r+1],a);else for(r=n-s;r>=e;r-=s)a=Da(r,t[r],t[r+1],a);return a&&Ma(a,a.next)&&(La(a),a=a.next),a}function ma(t,e){if(!t)return t;e||(e=t);var n,s=t;do{if(n=!1,s.steiner||!Ma(s,s.next)&&0!==Ia(s.prev,s,s.next))s=s.next;else{if(La(s),(s=e=s.prev)===s.next)break;n=!0}}while(n||s!==e);return e}function ga(t,e,n,s,i,r,a){if(t){!a&&r&&function(t,e,n,s){var i=t;do{0===i.z&&(i.z=Ta(i.x,i.y,e,n,s)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,function(t){var e,n,s,i,r,a,o,l,h=1;do{for(n=t,t=null,r=null,a=0;n;){for(a++,s=n,o=0,e=0;e<h&&(o++,s=s.nextZ);e++);for(l=h;o>0||l>0&&s;)0!==o&&(0===l||!s||n.z<=s.z)?(i=n,n=n.nextZ,o--):(i=s,s=s.nextZ,l--),r?r.nextZ=i:t=i,i.prevZ=r,r=i;n=s}r.nextZ=null,h*=2}while(a>1)}(i)}(t,s,i,r);for(var o,l,h=t;t.prev!==t.next;)if(o=t.prev,l=t.next,r?xa(t,s,i,r):va(t))e.push(o.i/n|0),e.push(t.i/n|0),e.push(l.i/n|0),La(t),t=l.next,h=l.next;else if((t=l)===h){a?1===a?ga(t=ya(ma(t),e,n),e,n,s,i,r,2):2===a&&_a(t,e,n,s,i,r):ga(ma(t),e,n,s,i,r,1);break}}}function va(t){var e=t.prev,n=t,s=t.next;if(Ia(e,n,s)>=0)return!1;for(var i=e.x,r=n.x,a=s.x,o=e.y,l=n.y,h=s.y,c=i<r?i<a?i:a:r<a?r:a,u=o<l?o<h?o:h:l<h?l:h,d=i>r?i>a?i:a:r>a?r:a,f=o>l?o>h?o:h:l>h?l:h,p=s.next;p!==e;){if(p.x>=c&&p.x<=d&&p.y>=u&&p.y<=f&&Aa(i,o,r,l,a,h,p.x,p.y)&&Ia(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function xa(t,e,n,s){var i=t.prev,r=t,a=t.next;if(Ia(i,r,a)>=0)return!1;for(var o=i.x,l=r.x,h=a.x,c=i.y,u=r.y,d=a.y,f=o<l?o<h?o:h:l<h?l:h,p=c<u?c<d?c:d:u<d?u:d,m=o>l?o>h?o:h:l>h?l:h,g=c>u?c>d?c:d:u>d?u:d,v=Ta(f,p,e,n,s),x=Ta(m,g,e,n,s),y=t.prevZ,_=t.nextZ;y&&y.z>=v&&_&&_.z<=x;){if(y.x>=f&&y.x<=m&&y.y>=p&&y.y<=g&&y!==i&&y!==a&&Aa(o,c,l,u,h,d,y.x,y.y)&&Ia(y.prev,y,y.next)>=0)return!1;if(y=y.prevZ,_.x>=f&&_.x<=m&&_.y>=p&&_.y<=g&&_!==i&&_!==a&&Aa(o,c,l,u,h,d,_.x,_.y)&&Ia(_.prev,_,_.next)>=0)return!1;_=_.nextZ}for(;y&&y.z>=v;){if(y.x>=f&&y.x<=m&&y.y>=p&&y.y<=g&&y!==i&&y!==a&&Aa(o,c,l,u,h,d,y.x,y.y)&&Ia(y.prev,y,y.next)>=0)return!1;y=y.prevZ}for(;_&&_.z<=x;){if(_.x>=f&&_.x<=m&&_.y>=p&&_.y<=g&&_!==i&&_!==a&&Aa(o,c,l,u,h,d,_.x,_.y)&&Ia(_.prev,_,_.next)>=0)return!1;_=_.nextZ}return!0}function ya(t,e,n){var s=t;do{var i=s.prev,r=s.next.next;!Ma(i,r)&&Ra(i,s,s.next,r)&&Fa(i,r)&&Fa(r,i)&&(e.push(i.i/n|0),e.push(s.i/n|0),e.push(r.i/n|0),La(s),La(s.next),s=t=r),s=s.next}while(s!==t);return ma(s)}function _a(t,e,n,s,i,r){var a=t;do{for(var o=a.next.next;o!==a.prev;){if(a.i!==o.i&&Ca(a,o)){var l=Oa(a,o);return a=ma(a,a.next),l=ma(l,l.next),ga(a,e,n,s,i,r,0),void ga(l,e,n,s,i,r,0)}o=o.next}a=a.next}while(a!==t)}function ba(t,e){return t.x-e.x}function wa(t,e){var n=function(t,e){var n,s=e,i=t.x,r=t.y,a=-1/0;do{if(r<=s.y&&r>=s.next.y&&s.next.y!==s.y){var o=s.x+(r-s.y)*(s.next.x-s.x)/(s.next.y-s.y);if(o<=i&&o>a&&(a=o,n=s.x<s.next.x?s:s.next,o===i))return n}s=s.next}while(s!==e);if(!n)return null;var l,h=n,c=n.x,u=n.y,d=1/0;s=n;do{i>=s.x&&s.x>=c&&i!==s.x&&Aa(r<u?i:a,r,c,u,r<u?a:i,r,s.x,s.y)&&(l=Math.abs(r-s.y)/(i-s.x),Fa(s,t)&&(l<d||l===d&&(s.x>n.x||s.x===n.x&&Ea(n,s)))&&(n=s,d=l)),s=s.next}while(s!==h);return n}(t,e);if(!n)return e;var s=Oa(n,t);return ma(s,s.next),ma(n,n.next)}function Ea(t,e){return Ia(t.prev,t,e.prev)<0&&Ia(e.next,t,t.next)<0}function Ta(t,e,n,s,i){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-n)*i|0)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-s)*i|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function Sa(t){var e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function Aa(t,e,n,s,i,r,a,o){return(i-a)*(e-o)>=(t-a)*(r-o)&&(t-a)*(s-o)>=(n-a)*(e-o)&&(n-a)*(r-o)>=(i-a)*(s-o)}function Ca(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&Ra(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&(Fa(t,e)&&Fa(e,t)&&function(t,e){var n=t,s=!1,i=(t.x+e.x)/2,r=(t.y+e.y)/2;do{n.y>r!=n.next.y>r&&n.next.y!==n.y&&i<(n.next.x-n.x)*(r-n.y)/(n.next.y-n.y)+n.x&&(s=!s),n=n.next}while(n!==t);return s}(t,e)&&(Ia(t.prev,t,e.prev)||Ia(t,e.prev,e))||Ma(t,e)&&Ia(t.prev,t,t.next)>0&&Ia(e.prev,e,e.next)>0)}function Ia(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function Ma(t,e){return t.x===e.x&&t.y===e.y}function Ra(t,e,n,s){var i=ka(Ia(t,e,n)),r=ka(Ia(t,e,s)),a=ka(Ia(n,s,t)),o=ka(Ia(n,s,e));return i!==r&&a!==o||(!(0!==i||!Pa(t,n,e))||(!(0!==r||!Pa(t,s,e))||(!(0!==a||!Pa(n,t,s))||!(0!==o||!Pa(n,e,s)))))}function Pa(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function ka(t){return t>0?1:t<0?-1:0}function Fa(t,e){return Ia(t.prev,t,t.next)<0?Ia(t,e,t.next)>=0&&Ia(t,t.prev,e)>=0:Ia(t,e,t.prev)<0||Ia(t,t.next,e)<0}function Oa(t,e){var n=new Na(t.i,t.x,t.y),s=new Na(e.i,e.x,e.y),i=t.next,r=e.prev;return t.next=e,e.prev=t,n.next=i,i.prev=n,s.next=n,n.prev=s,r.next=s,s.prev=r,s}function Da(t,e,n,s){var i=new Na(t,e,n);return s?(i.next=s.next,i.prev=s,s.next.prev=i,s.next=i):(i.prev=i,i.next=i),i}function La(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Na(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Ba(t,e,n,s){for(var i=0,r=e,a=n-s;r<n;r+=s)i+=(t[a]-t[r])*(t[r+1]+t[a+1]),a=r;return i}({get exports(){return da},set exports(t){da=t}}).exports=fa,da.default=fa,fa.deviation=function(t,e,n,s){var i=e&&e.length,r=i?e[0]*n:t.length,a=Math.abs(Ba(t,0,r,n));if(i)for(var o=0,l=e.length;o<l;o++){var h=e[o]*n,c=o<l-1?e[o+1]*n:t.length;a-=Math.abs(Ba(t,h,c,n))}var u=0;for(o=0;o<s.length;o+=3){var d=s[o]*n,f=s[o+1]*n,p=s[o+2]*n;u+=Math.abs((t[d]-t[p])*(t[f+1]-t[d+1])-(t[d]-t[f])*(t[p+1]-t[d+1]))}return 0===a&&0===u?0:Math.abs((u-a)/a)},fa.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},s=0,i=0;i<t.length;i++){for(var r=0;r<t[i].length;r++)for(var a=0;a<e;a++)n.vertices.push(t[i][r][a]);i>0&&(s+=t[i-1].length,n.holes.push(s))}return n};var Va,Ua,Xa={};Va={get exports(){return Xa},set exports(t){Xa=t}},Ua=Xa,function(t){var e=Ua&&!Ua.nodeType&&Ua,n=Va&&!Va.nodeType&&Va,s="object"==typeof ha&&ha;s.global!==s&&s.window!==s&&s.self!==s||(t=s);var i,r,a=2147483647,o=36,l=1,h=26,c=38,u=700,d=72,f=128,p="-",m=/^xn--/,g=/[^\x20-\x7E]/,v=/[\x2E\u3002\uFF0E\uFF61]/g,x={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},y=o-l,_=Math.floor,b=String.fromCharCode;function w(t){throw RangeError(x[t])}function E(t,e){for(var n=t.length,s=[];n--;)s[n]=e(t[n]);return s}function T(t,e){var n=t.split("@"),s="";return n.length>1&&(s=n[0]+"@",t=n[1]),s+E((t=t.replace(v,".")).split("."),e).join(".")}function S(t){for(var e,n,s=[],i=0,r=t.length;i<r;)(e=t.charCodeAt(i++))>=55296&&e<=56319&&i<r?56320==(64512&(n=t.charCodeAt(i++)))?s.push(((1023&e)<<10)+(1023&n)+65536):(s.push(e),i--):s.push(e);return s}function A(t){return E(t,(function(t){var e="";return t>65535&&(e+=b((t-=65536)>>>10&1023|55296),t=56320|1023&t),e+=b(t)})).join("")}function C(t,e){return t+22+75*(t<26)-((0!=e)<<5)}function I(t,e,n){var s=0;for(t=n?_(t/u):t>>1,t+=_(t/e);t>y*h>>1;s+=o)t=_(t/y);return _(s+(y+1)*t/(t+c))}function M(t){var e,n,s,i,r,c,u,m,g,v,x,y=[],b=t.length,E=0,T=f,S=d;for((n=t.lastIndexOf(p))<0&&(n=0),s=0;s<n;++s)t.charCodeAt(s)>=128&&w("not-basic"),y.push(t.charCodeAt(s));for(i=n>0?n+1:0;i<b;){for(r=E,c=1,u=o;i>=b&&w("invalid-input"),((m=(x=t.charCodeAt(i++))-48<10?x-22:x-65<26?x-65:x-97<26?x-97:o)>=o||m>_((a-E)/c))&&w("overflow"),E+=m*c,!(m<(g=u<=S?l:u>=S+h?h:u-S));u+=o)c>_(a/(v=o-g))&&w("overflow"),c*=v;S=I(E-r,e=y.length+1,0==r),_(E/e)>a-T&&w("overflow"),T+=_(E/e),E%=e,y.splice(E++,0,T)}return A(y)}function R(t){var e,n,s,i,r,c,u,m,g,v,x,y,E,T,A,M=[];for(y=(t=S(t)).length,e=f,n=0,r=d,c=0;c<y;++c)(x=t[c])<128&&M.push(b(x));for(s=i=M.length,i&&M.push(p);s<y;){for(u=a,c=0;c<y;++c)(x=t[c])>=e&&x<u&&(u=x);for(u-e>_((a-n)/(E=s+1))&&w("overflow"),n+=(u-e)*E,e=u,c=0;c<y;++c)if((x=t[c])<e&&++n>a&&w("overflow"),x==e){for(m=n,g=o;!(m<(v=g<=r?l:g>=r+h?h:g-r));g+=o)A=m-v,T=o-v,M.push(b(C(v+A%T,0))),m=_(A/T);M.push(b(C(m,0))),r=I(n,E,s==i),n=0,++s}++n,++e}return M.join("")}if(i={version:"1.3.2",ucs2:{decode:S,encode:A},decode:M,encode:R,toASCII:function(t){return T(t,(function(t){return g.test(t)?"xn--"+R(t):t}))},toUnicode:function(t){return T(t,(function(t){return m.test(t)?M(t.slice(4).toLowerCase()):t}))}},e&&n)if(Va.exports==e)n.exports=i;else for(r in i)i.hasOwnProperty(r)&&(e[r]=i[r]);else t.punycode=i}(ha);var Ya={};function Wa(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var za=function(t){switch(typeof t){case"string":return t;case"boolean":return t?"true":"false";case"number":return isFinite(t)?t:"";default:return""}};Ya.decode=Ya.parse=function(t,e,n,s){e=e||"&",n=n||"=";var i={};if("string"!=typeof t||0===t.length)return i;var r=/\+/g;t=t.split(e);var a=1e3;s&&"number"==typeof s.maxKeys&&(a=s.maxKeys);var o=t.length;a>0&&o>a&&(o=a);for(var l=0;l<o;++l){var h,c,u,d,f=t[l].replace(r,"%20"),p=f.indexOf(n);p>=0?(h=f.substr(0,p),c=f.substr(p+1)):(h=f,c=""),u=decodeURIComponent(h),d=decodeURIComponent(c),Wa(i,u)?Array.isArray(i[u])?i[u].push(d):i[u]=[i[u],d]:i[u]=d}return i},Ya.encode=Ya.stringify=function(t,e,n,s){return e=e||"&",n=n||"=",null===t&&(t=void 0),"object"==typeof t?Object.keys(t).map((function(s){var i=encodeURIComponent(za(s))+n;return Array.isArray(t[s])?t[s].map((function(t){return i+encodeURIComponent(za(t))})).join(e):i+encodeURIComponent(za(t[s]))})).join(e):s?encodeURIComponent(za(s))+n+encodeURIComponent(za(t)):""};var Ga=Xa,Ha={isString:function(t){return"string"==typeof t},isObject:function(t){return"object"==typeof t&&null!==t},isNull:function(t){return null===t},isNullOrUndefined:function(t){return null==t}},ja=co,$a=function(t,e){return co(t,!1,!0).resolve(e)},qa=function(t){Ha.isString(t)&&(t=co(t));return t instanceof Ka?t.format():Ka.prototype.format.call(t)};function Ka(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var Za=/^([a-z0-9.+-]+:)/i,Qa=/:[0-9]*$/,Ja=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,to=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),eo=["'"].concat(to),no=["%","/","?",";","#"].concat(eo),so=["/","?","#"],io=/^[+a-z0-9A-Z_-]{0,63}$/,ro=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,ao={javascript:!0,"javascript:":!0},oo={javascript:!0,"javascript:":!0},lo={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},ho=Ya;function co(t,e,n){if(t&&Ha.isObject(t)&&t instanceof Ka)return t;var s=new Ka;return s.parse(t,e,n),s}Ka.prototype.parse=function(t,e,n){if(!Ha.isString(t))throw new TypeError("Parameter 'url' must be a string, not "+typeof t);var s=t.indexOf("?"),i=-1!==s&&s<t.indexOf("#")?"?":"#",r=t.split(i);r[0]=r[0].replace(/\\/g,"/");var a=t=r.join(i);if(a=a.trim(),!n&&1===t.split("#").length){var o=Ja.exec(a);if(o)return this.path=a,this.href=a,this.pathname=o[1],o[2]?(this.search=o[2],this.query=e?ho.parse(this.search.substr(1)):this.search.substr(1)):e&&(this.search="",this.query={}),this}var l=Za.exec(a);if(l){var h=(l=l[0]).toLowerCase();this.protocol=h,a=a.substr(l.length)}if(n||l||a.match(/^\/\/[^@\/]+@[^@\/]+/)){var c="//"===a.substr(0,2);!c||l&&oo[l]||(a=a.substr(2),this.slashes=!0)}if(!oo[l]&&(c||l&&!lo[l])){for(var u,d,f=-1,p=0;p<so.length;p++){-1!==(m=a.indexOf(so[p]))&&(-1===f||m<f)&&(f=m)}-1!==(d=-1===f?a.lastIndexOf("@"):a.lastIndexOf("@",f))&&(u=a.slice(0,d),a=a.slice(d+1),this.auth=decodeURIComponent(u)),f=-1;for(p=0;p<no.length;p++){var m;-1!==(m=a.indexOf(no[p]))&&(-1===f||m<f)&&(f=m)}-1===f&&(f=a.length),this.host=a.slice(0,f),a=a.slice(f),this.parseHost(),this.hostname=this.hostname||"";var g="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!g)for(var v=this.hostname.split(/\./),x=(p=0,v.length);p<x;p++){var y=v[p];if(y&&!y.match(io)){for(var _="",b=0,w=y.length;b<w;b++)y.charCodeAt(b)>127?_+="x":_+=y[b];if(!_.match(io)){var E=v.slice(0,p),T=v.slice(p+1),S=y.match(ro);S&&(E.push(S[1]),T.unshift(S[2])),T.length&&(a="/"+T.join(".")+a),this.hostname=E.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),g||(this.hostname=Ga.toASCII(this.hostname));var A=this.port?":"+this.port:"",C=this.hostname||"";this.host=C+A,this.href+=this.host,g&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==a[0]&&(a="/"+a))}if(!ao[h])for(p=0,x=eo.length;p<x;p++){var I=eo[p];if(-1!==a.indexOf(I)){var M=encodeURIComponent(I);M===I&&(M=escape(I)),a=a.split(I).join(M)}}var R=a.indexOf("#");-1!==R&&(this.hash=a.substr(R),a=a.slice(0,R));var P=a.indexOf("?");if(-1!==P?(this.search=a.substr(P),this.query=a.substr(P+1),e&&(this.query=ho.parse(this.query)),a=a.slice(0,P)):e&&(this.search="",this.query={}),a&&(this.pathname=a),lo[h]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){A=this.pathname||"";var k=this.search||"";this.path=A+k}return this.href=this.format(),this},Ka.prototype.format=function(){var t=this.auth||"";t&&(t=(t=encodeURIComponent(t)).replace(/%3A/i,":"),t+="@");var e=this.protocol||"",n=this.pathname||"",s=this.hash||"",i=!1,r="";this.host?i=t+this.host:this.hostname&&(i=t+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(i+=":"+this.port)),this.query&&Ha.isObject(this.query)&&Object.keys(this.query).length&&(r=ho.stringify(this.query));var a=this.search||r&&"?"+r||"";return e&&":"!==e.substr(-1)&&(e+=":"),this.slashes||(!e||lo[e])&&!1!==i?(i="//"+(i||""),n&&"/"!==n.charAt(0)&&(n="/"+n)):i||(i=""),s&&"#"!==s.charAt(0)&&(s="#"+s),a&&"?"!==a.charAt(0)&&(a="?"+a),e+i+(n=n.replace(/[?#]/g,(function(t){return encodeURIComponent(t)})))+(a=a.replace("#","%23"))+s},Ka.prototype.resolve=function(t){return this.resolveObject(co(t,!1,!0)).format()},Ka.prototype.resolveObject=function(t){if(Ha.isString(t)){var e=new Ka;e.parse(t,!1,!0),t=e}for(var n=new Ka,s=Object.keys(this),i=0;i<s.length;i++){var r=s[i];n[r]=this[r]}if(n.hash=t.hash,""===t.href)return n.href=n.format(),n;if(t.slashes&&!t.protocol){for(var a=Object.keys(t),o=0;o<a.length;o++){var l=a[o];"protocol"!==l&&(n[l]=t[l])}return lo[n.protocol]&&n.hostname&&!n.pathname&&(n.path=n.pathname="/"),n.href=n.format(),n}if(t.protocol&&t.protocol!==n.protocol){if(!lo[t.protocol]){for(var h=Object.keys(t),c=0;c<h.length;c++){var u=h[c];n[u]=t[u]}return n.href=n.format(),n}if(n.protocol=t.protocol,t.host||oo[t.protocol])n.pathname=t.pathname;else{for(var d=(t.pathname||"").split("/");d.length&&!(t.host=d.shift()););t.host||(t.host=""),t.hostname||(t.hostname=""),""!==d[0]&&d.unshift(""),d.length<2&&d.unshift(""),n.pathname=d.join("/")}if(n.search=t.search,n.query=t.query,n.host=t.host||"",n.auth=t.auth,n.hostname=t.hostname||t.host,n.port=t.port,n.pathname||n.search){var f=n.pathname||"",p=n.search||"";n.path=f+p}return n.slashes=n.slashes||t.slashes,n.href=n.format(),n}var m=n.pathname&&"/"===n.pathname.charAt(0),g=t.host||t.pathname&&"/"===t.pathname.charAt(0),v=g||m||n.host&&t.pathname,x=v,y=n.pathname&&n.pathname.split("/")||[],_=(d=t.pathname&&t.pathname.split("/")||[],n.protocol&&!lo[n.protocol]);if(_&&(n.hostname="",n.port=null,n.host&&(""===y[0]?y[0]=n.host:y.unshift(n.host)),n.host="",t.protocol&&(t.hostname=null,t.port=null,t.host&&(""===d[0]?d[0]=t.host:d.unshift(t.host)),t.host=null),v=v&&(""===d[0]||""===y[0])),g)n.host=t.host||""===t.host?t.host:n.host,n.hostname=t.hostname||""===t.hostname?t.hostname:n.hostname,n.search=t.search,n.query=t.query,y=d;else if(d.length)y||(y=[]),y.pop(),y=y.concat(d),n.search=t.search,n.query=t.query;else if(!Ha.isNullOrUndefined(t.search)){if(_)n.hostname=n.host=y.shift(),(S=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@"))&&(n.auth=S.shift(),n.host=n.hostname=S.shift());return n.search=t.search,n.query=t.query,Ha.isNull(n.pathname)&&Ha.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.href=n.format(),n}if(!y.length)return n.pathname=null,n.search?n.path="/"+n.search:n.path=null,n.href=n.format(),n;for(var b=y.slice(-1)[0],w=(n.host||t.host||y.length>1)&&("."===b||".."===b)||""===b,E=0,T=y.length;T>=0;T--)"."===(b=y[T])?y.splice(T,1):".."===b?(y.splice(T,1),E++):E&&(y.splice(T,1),E--);if(!v&&!x)for(;E--;E)y.unshift("..");!v||""===y[0]||y[0]&&"/"===y[0].charAt(0)||y.unshift(""),w&&"/"!==y.join("/").substr(-1)&&y.push("");var S,A=""===y[0]||y[0]&&"/"===y[0].charAt(0);_&&(n.hostname=n.host=A?"":y.length?y.shift():"",(S=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@"))&&(n.auth=S.shift(),n.host=n.hostname=S.shift()));return(v=v||n.host&&y.length)&&!A&&y.unshift(""),y.length?n.pathname=y.join("/"):(n.pathname=null,n.path=null),Ha.isNull(n.pathname)&&Ha.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.auth=t.auth||n.auth,n.slashes=n.slashes||t.slashes,n.href=n.format(),n},Ka.prototype.parseHost=function(){var t=this.host,e=Qa.exec(t);e&&(":"!==(e=e[0])&&(this.port=e.substr(1)),t=t.substr(0,t.length-e.length)),t&&(this.hostname=t)};const uo={parse:ja,format:qa,resolve:$a};function fo(t){if("string"!=typeof t)throw new TypeError(`Path must be a string. Received ${JSON.stringify(t)}`)}function po(t){return t.split("?")[0].split("#")[0]}const mo={toPosix(t){return e="\\",n="/",t.replace(new RegExp(e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"g"),n);var e,n},isUrl(t){return/^https?:/.test(this.toPosix(t))},isDataUrl:t=>/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(t),hasProtocol(t){return/^[^/:]+:\//.test(this.toPosix(t))},getProtocol(t){fo(t),t=this.toPosix(t);let e="";const n=/^file:\/\/\//.exec(t),s=/^[^/:]+:\/\//.exec(t),i=/^[^/:]+:\//.exec(t);if(n||s||i){const r=(null==n?void 0:n[0])||(null==s?void 0:s[0])||(null==i?void 0:i[0]);e=r,t=t.slice(r.length)}return e},toAbsolute(t,e,n){if(this.isDataUrl(t))return t;const s=po(this.toPosix(null!=e?e:zr.ADAPTER.getBaseUrl())),i=po(this.toPosix(null!=n?n:this.rootname(s)));if(fo(t),(t=this.toPosix(t)).startsWith("/"))return mo.join(i,t.slice(1));return this.isAbsolute(t)?t:this.join(s,t)},normalize(t){if(fo(t=this.toPosix(t)),0===t.length)return".";let e="";const n=t.startsWith("/");this.hasProtocol(t)&&(e=this.rootname(t),t=t.slice(e.length));const s=t.endsWith("/");return(t=function(t,e){let n="",s=0,i=-1,r=0,a=-1;for(let o=0;o<=t.length;++o){if(o<t.length)a=t.charCodeAt(o);else{if(47===a)break;a=47}if(47===a){if(i===o-1||1===r);else if(i!==o-1&&2===r){if(n.length<2||2!==s||46!==n.charCodeAt(n.length-1)||46!==n.charCodeAt(n.length-2))if(n.length>2){const t=n.lastIndexOf("/");if(t!==n.length-1){-1===t?(n="",s=0):(n=n.slice(0,t),s=n.length-1-n.lastIndexOf("/")),i=o,r=0;continue}}else if(2===n.length||1===n.length){n="",s=0,i=o,r=0;continue}e&&(n.length>0?n+="/..":n="..",s=2)}else n.length>0?n+=`/${t.slice(i+1,o)}`:n=t.slice(i+1,o),s=o-i-1;i=o,r=0}else 46===a&&-1!==r?++r:r=-1}return n}(t,!1)).length>0&&s&&(t+="/"),n?`/${t}`:e+t},isAbsolute(t){return fo(t),t=this.toPosix(t),!!this.hasProtocol(t)||t.startsWith("/")},join(...t){var e;if(0===t.length)return".";let n;for(let s=0;s<t.length;++s){const i=t[s];if(fo(i),i.length>0)if(void 0===n)n=i;else{const r=null!=(e=t[s-1])?e:"";this.extname(r)?n+=`/../${i}`:n+=`/${i}`}}return void 0===n?".":this.normalize(n)},dirname(t){if(fo(t),0===t.length)return".";let e=(t=this.toPosix(t)).charCodeAt(0);const n=47===e;let s=-1,i=!0;const r=this.getProtocol(t),a=t;for(let o=(t=t.slice(r.length)).length-1;o>=1;--o)if(e=t.charCodeAt(o),47===e){if(!i){s=o;break}}else i=!1;return-1===s?n?"/":this.isUrl(a)?r+t:r:n&&1===s?"//":r+t.slice(0,s)},rootname(t){fo(t);let e="";if(e=(t=this.toPosix(t)).startsWith("/")?"/":this.getProtocol(t),this.isUrl(t)){const n=t.indexOf("/",e.length);e=-1!==n?t.slice(0,n):t,e.endsWith("/")||(e+="/")}return e},basename(t,e){fo(t),e&&fo(e),t=po(this.toPosix(t));let n,s=0,i=-1,r=!0;if(void 0!==e&&e.length>0&&e.length<=t.length){if(e.length===t.length&&e===t)return"";let a=e.length-1,o=-1;for(n=t.length-1;n>=0;--n){const l=t.charCodeAt(n);if(47===l){if(!r){s=n+1;break}}else-1===o&&(r=!1,o=n+1),a>=0&&(l===e.charCodeAt(a)?-1==--a&&(i=n):(a=-1,i=o))}return s===i?i=o:-1===i&&(i=t.length),t.slice(s,i)}for(n=t.length-1;n>=0;--n)if(47===t.charCodeAt(n)){if(!r){s=n+1;break}}else-1===i&&(r=!1,i=n+1);return-1===i?"":t.slice(s,i)},extname(t){fo(t);let e=-1,n=0,s=-1,i=!0,r=0;for(let a=(t=po(this.toPosix(t))).length-1;a>=0;--a){const o=t.charCodeAt(a);if(47!==o)-1===s&&(i=!1,s=a+1),46===o?-1===e?e=a:1!==r&&(r=1):-1!==e&&(r=-1);else if(!i){n=a+1;break}}return-1===e||-1===s||0===r||1===r&&e===s-1&&e===n+1?"":t.slice(e,s)},parse(t){fo(t);const e={root:"",dir:"",base:"",ext:"",name:""};if(0===t.length)return e;let n=(t=po(this.toPosix(t))).charCodeAt(0);const s=this.isAbsolute(t);let i;e.root=this.rootname(t),i=s||this.hasProtocol(t)?1:0;let r=-1,a=0,o=-1,l=!0,h=t.length-1,c=0;for(;h>=i;--h)if(n=t.charCodeAt(h),47!==n)-1===o&&(l=!1,o=h+1),46===n?-1===r?r=h:1!==c&&(c=1):-1!==r&&(c=-1);else if(!l){a=h+1;break}return-1===r||-1===o||0===c||1===c&&r===o-1&&r===a+1?-1!==o&&(e.base=e.name=0===a&&s?t.slice(1,o):t.slice(a,o)):(0===a&&s?(e.name=t.slice(1,r),e.base=t.slice(1,o)):(e.name=t.slice(a,r),e.base=t.slice(a,o)),e.ext=t.slice(r,o)),e.dir=this.dirname(t),e},sep:"/",delimiter:":"},go={};function vo(t,e,n=3){if(go[e])return;let s=(new Error).stack;void 0===s?console.warn("PixiJS Deprecation Warning: ",`${e}\nDeprecated since v${t}`):(s=s.split("\n").splice(n).join("\n"),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",`${e}\nDeprecated since v${t}`),console.warn(s),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",`${e}\nDeprecated since v${t}`),console.warn(s))),go[e]=!0}let xo;var yo,_o={grad:.9,turn:360,rad:360/(2*Math.PI)},bo=function(t){return"string"==typeof t?t.length>0:"number"==typeof t},wo=function(t,e,n){return void 0===e&&(e=0),void 0===n&&(n=Math.pow(10,e)),Math.round(n*t)/n+0},Eo=function(t,e,n){return void 0===e&&(e=0),void 0===n&&(n=1),t>n?n:t>e?t:e},To=function(t){return(t=isFinite(t)?t%360:0)>0?t:t+360},So=function(t){return{r:Eo(t.r,0,255),g:Eo(t.g,0,255),b:Eo(t.b,0,255),a:Eo(t.a)}},Ao=function(t){return{r:wo(t.r),g:wo(t.g),b:wo(t.b),a:wo(t.a,3)}},Co=/^#([0-9a-f]{3,8})$/i,Io=function(t){var e=t.toString(16);return e.length<2?"0"+e:e},Mo=function(t){var e=t.r,n=t.g,s=t.b,i=t.a,r=Math.max(e,n,s),a=r-Math.min(e,n,s),o=a?r===e?(n-s)/a:r===n?2+(s-e)/a:4+(e-n)/a:0;return{h:60*(o<0?o+6:o),s:r?a/r*100:0,v:r/255*100,a:i}},Ro=function(t){var e=t.h,n=t.s,s=t.v,i=t.a;e=e/360*6,n/=100,s/=100;var r=Math.floor(e),a=s*(1-n),o=s*(1-(e-r)*n),l=s*(1-(1-e+r)*n),h=r%6;return{r:255*[s,o,a,a,l,s][h],g:255*[l,s,s,o,a,a][h],b:255*[a,a,l,s,s,o][h],a:i}},Po=function(t){return{h:To(t.h),s:Eo(t.s,0,100),l:Eo(t.l,0,100),a:Eo(t.a)}},ko=function(t){return{h:wo(t.h),s:wo(t.s),l:wo(t.l),a:wo(t.a,3)}},Fo=function(t){return Ro((n=(e=t).s,{h:e.h,s:(n*=((s=e.l)<50?s:100-s)/100)>0?2*n/(s+n)*100:0,v:s+n,a:e.a}));var e,n,s},Oo=function(t){return{h:(e=Mo(t)).h,s:(i=(200-(n=e.s))*(s=e.v)/100)>0&&i<200?n*s/100/(i<=100?i:200-i)*100:0,l:i/2,a:e.a};var e,n,s,i},Do=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Lo=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,No=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Bo=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Vo={string:[[function(t){var e=Co.exec(t);return e?(t=e[1]).length<=4?{r:parseInt(t[0]+t[0],16),g:parseInt(t[1]+t[1],16),b:parseInt(t[2]+t[2],16),a:4===t.length?wo(parseInt(t[3]+t[3],16)/255,2):1}:6===t.length||8===t.length?{r:parseInt(t.substr(0,2),16),g:parseInt(t.substr(2,2),16),b:parseInt(t.substr(4,2),16),a:8===t.length?wo(parseInt(t.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(t){var e=No.exec(t)||Bo.exec(t);return e?e[2]!==e[4]||e[4]!==e[6]?null:So({r:Number(e[1])/(e[2]?100/255:1),g:Number(e[3])/(e[4]?100/255:1),b:Number(e[5])/(e[6]?100/255:1),a:void 0===e[7]?1:Number(e[7])/(e[8]?100:1)}):null},"rgb"],[function(t){var e=Do.exec(t)||Lo.exec(t);if(!e)return null;var n,s,i=Po({h:(n=e[1],s=e[2],void 0===s&&(s="deg"),Number(n)*(_o[s]||1)),s:Number(e[3]),l:Number(e[4]),a:void 0===e[5]?1:Number(e[5])/(e[6]?100:1)});return Fo(i)},"hsl"]],object:[[function(t){var e=t.r,n=t.g,s=t.b,i=t.a,r=void 0===i?1:i;return bo(e)&&bo(n)&&bo(s)?So({r:Number(e),g:Number(n),b:Number(s),a:Number(r)}):null},"rgb"],[function(t){var e=t.h,n=t.s,s=t.l,i=t.a,r=void 0===i?1:i;if(!bo(e)||!bo(n)||!bo(s))return null;var a=Po({h:Number(e),s:Number(n),l:Number(s),a:Number(r)});return Fo(a)},"hsl"],[function(t){var e=t.h,n=t.s,s=t.v,i=t.a,r=void 0===i?1:i;if(!bo(e)||!bo(n)||!bo(s))return null;var a,o=(a={h:Number(e),s:Number(n),v:Number(s),a:Number(r)},{h:To(a.h),s:Eo(a.s,0,100),v:Eo(a.v,0,100),a:Eo(a.a)});return Ro(o)},"hsv"]]},Uo=function(t,e){for(var n=0;n<e.length;n++){var s=e[n][0](t);if(s)return[s,e[n][1]]}return[null,void 0]},Xo=function(t){return"string"==typeof t?Uo(t.trim(),Vo.string):"object"==typeof t&&null!==t?Uo(t,Vo.object):[null,void 0]},Yo=function(t,e){var n=Oo(t);return{h:n.h,s:Eo(n.s+100*e,0,100),l:n.l,a:n.a}},Wo=function(t){return(299*t.r+587*t.g+114*t.b)/1e3/255},zo=function(t,e){var n=Oo(t);return{h:n.h,s:n.s,l:Eo(n.l+100*e,0,100),a:n.a}},Go=function(){function t(t){this.parsed=Xo(t)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return t.prototype.isValid=function(){return null!==this.parsed},t.prototype.brightness=function(){return wo(Wo(this.rgba),2)},t.prototype.isDark=function(){return Wo(this.rgba)<.5},t.prototype.isLight=function(){return Wo(this.rgba)>=.5},t.prototype.toHex=function(){return e=(t=Ao(this.rgba)).r,n=t.g,s=t.b,r=(i=t.a)<1?Io(wo(255*i)):"","#"+Io(e)+Io(n)+Io(s)+r;var t,e,n,s,i,r},t.prototype.toRgb=function(){return Ao(this.rgba)},t.prototype.toRgbString=function(){return e=(t=Ao(this.rgba)).r,n=t.g,s=t.b,(i=t.a)<1?"rgba("+e+", "+n+", "+s+", "+i+")":"rgb("+e+", "+n+", "+s+")";var t,e,n,s,i},t.prototype.toHsl=function(){return ko(Oo(this.rgba))},t.prototype.toHslString=function(){return e=(t=ko(Oo(this.rgba))).h,n=t.s,s=t.l,(i=t.a)<1?"hsla("+e+", "+n+"%, "+s+"%, "+i+")":"hsl("+e+", "+n+"%, "+s+"%)";var t,e,n,s,i},t.prototype.toHsv=function(){return t=Mo(this.rgba),{h:wo(t.h),s:wo(t.s),v:wo(t.v),a:wo(t.a,3)};var t},t.prototype.invert=function(){return Ho({r:255-(t=this.rgba).r,g:255-t.g,b:255-t.b,a:t.a});var t},t.prototype.saturate=function(t){return void 0===t&&(t=.1),Ho(Yo(this.rgba,t))},t.prototype.desaturate=function(t){return void 0===t&&(t=.1),Ho(Yo(this.rgba,-t))},t.prototype.grayscale=function(){return Ho(Yo(this.rgba,-1))},t.prototype.lighten=function(t){return void 0===t&&(t=.1),Ho(zo(this.rgba,t))},t.prototype.darken=function(t){return void 0===t&&(t=.1),Ho(zo(this.rgba,-t))},t.prototype.rotate=function(t){return void 0===t&&(t=15),this.hue(this.hue()+t)},t.prototype.alpha=function(t){return"number"==typeof t?Ho({r:(e=this.rgba).r,g:e.g,b:e.b,a:t}):wo(this.rgba.a,3);var e},t.prototype.hue=function(t){var e=Oo(this.rgba);return"number"==typeof t?Ho({h:t,s:e.s,l:e.l,a:e.a}):wo(e.h)},t.prototype.isEqual=function(t){return this.toHex()===Ho(t).toHex()},t}(),Ho=function(t){return t instanceof Go?t:new Go(t)},jo=[];yo=[function(t,e){var n={white:"#ffffff",bisque:"#ffe4c4",blue:"#0000ff",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",antiquewhite:"#faebd7",aqua:"#00ffff",azure:"#f0ffff",whitesmoke:"#f5f5f5",papayawhip:"#ffefd5",plum:"#dda0dd",blanchedalmond:"#ffebcd",black:"#000000",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",cornsilk:"#fff8dc",cornflowerblue:"#6495ed",burlywood:"#deb887",aquamarine:"#7fffd4",beige:"#f5f5dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkkhaki:"#bdb76b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",peachpuff:"#ffdab9",darkmagenta:"#8b008b",darkred:"#8b0000",darkorchid:"#9932cc",darkorange:"#ff8c00",darkslateblue:"#483d8b",gray:"#808080",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",deeppink:"#ff1493",deepskyblue:"#00bfff",wheat:"#f5deb3",firebrick:"#b22222",floralwhite:"#fffaf0",ghostwhite:"#f8f8ff",darkviolet:"#9400d3",magenta:"#ff00ff",green:"#008000",dodgerblue:"#1e90ff",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",blueviolet:"#8a2be2",forestgreen:"#228b22",lawngreen:"#7cfc00",indianred:"#cd5c5c",indigo:"#4b0082",fuchsia:"#ff00ff",brown:"#a52a2a",maroon:"#800000",mediumblue:"#0000cd",lightcoral:"#f08080",darkturquoise:"#00ced1",lightcyan:"#e0ffff",ivory:"#fffff0",lightyellow:"#ffffe0",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",linen:"#faf0e6",mediumaquamarine:"#66cdaa",lemonchiffon:"#fffacd",lime:"#00ff00",khaki:"#f0e68c",mediumseagreen:"#3cb371",limegreen:"#32cd32",mediumspringgreen:"#00fa9a",lightskyblue:"#87cefa",lightblue:"#add8e6",midnightblue:"#191970",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",mintcream:"#f5fffa",lightslategray:"#778899",lightslategrey:"#778899",navajowhite:"#ffdead",navy:"#000080",mediumvioletred:"#c71585",powderblue:"#b0e0e6",palegoldenrod:"#eee8aa",oldlace:"#fdf5e6",paleturquoise:"#afeeee",mediumturquoise:"#48d1cc",mediumorchid:"#ba55d3",rebeccapurple:"#663399",lightsteelblue:"#b0c4de",mediumslateblue:"#7b68ee",thistle:"#d8bfd8",tan:"#d2b48c",orchid:"#da70d6",mediumpurple:"#9370db",purple:"#800080",pink:"#ffc0cb",skyblue:"#87ceeb",springgreen:"#00ff7f",palegreen:"#98fb98",red:"#ff0000",yellow:"#ffff00",slateblue:"#6a5acd",lavenderblush:"#fff0f5",peru:"#cd853f",palevioletred:"#db7093",violet:"#ee82ee",teal:"#008080",slategray:"#708090",slategrey:"#708090",aliceblue:"#f0f8ff",darkseagreen:"#8fbc8f",darkolivegreen:"#556b2f",greenyellow:"#adff2f",seagreen:"#2e8b57",seashell:"#fff5ee",tomato:"#ff6347",silver:"#c0c0c0",sienna:"#a0522d",lavender:"#e6e6fa",lightgreen:"#90ee90",orange:"#ffa500",orangered:"#ff4500",steelblue:"#4682b4",royalblue:"#4169e1",turquoise:"#40e0d0",yellowgreen:"#9acd32",salmon:"#fa8072",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",darksalmon:"#e9967a",lightgoldenrodyellow:"#fafad2",snow:"#fffafa",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",dimgray:"#696969",dimgrey:"#696969",olivedrab:"#6b8e23",olive:"#808000"},s={};for(var i in n)s[n[i]]=i;var r={};t.prototype.toName=function(e){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return"transparent";var i,a,o=s[this.toHex()];if(o)return o;if(null==e?void 0:e.closest){var l=this.toRgb(),h=1/0,c="black";if(!r.length)for(var u in n)r[u]=new t(n[u]).toRgb();for(var d in n){var f=(i=l,a=r[d],Math.pow(i.r-a.r,2)+Math.pow(i.g-a.g,2)+Math.pow(i.b-a.b,2));f<h&&(h=f,c=d)}return c}},e.string.push([function(e){var s=e.toLowerCase(),i="transparent"===s?"#0000":n[s];return i?new t(i).toRgb():null},"name"])}],yo.forEach((function(t){jo.indexOf(t)<0&&(t(Go,Vo),jo.push(t))}));const $o=class{constructor(t=16777215){this._value=null,this._components=new Float32Array(4),this._components.fill(1),this._int=16777215,this.value=t}get red(){return this._components[0]}get green(){return this._components[1]}get blue(){return this._components[2]}get alpha(){return this._components[3]}setValue(t){return this.value=t,this}set value(t){if(t instanceof $o)this._value=this.cloneSource(t._value),this._int=t._int,this._components.set(t._components);else{if(null===t)throw new Error("Cannot set PIXI.Color#value to null");null!==this._value&&this.isSourceEqual(this._value,t)||(this.normalize(t),this._value=this.cloneSource(t))}}get value(){return this._value}cloneSource(t){return"string"==typeof t||"number"==typeof t||t instanceof Number||null===t?t:Array.isArray(t)||ArrayBuffer.isView(t)?t.slice(0):"object"==typeof t&&null!==t?u({},t):t}isSourceEqual(t,e){const n=typeof t;if(n!==typeof e)return!1;if("number"===n||"string"===n||t instanceof Number)return t===e;if(Array.isArray(t)&&Array.isArray(e)||ArrayBuffer.isView(t)&&ArrayBuffer.isView(e))return t.length===e.length&&t.every(((t,n)=>t===e[n]));if(null!==t&&null!==e){const n=Object.keys(t),s=Object.keys(e);return n.length===s.length&&n.every((n=>t[n]===e[n]))}return t===e}toRgba(){const[t,e,n,s]=this._components;return{r:t,g:e,b:n,a:s}}toRgb(){const[t,e,n]=this._components;return{r:t,g:e,b:n}}toRgbaString(){const[t,e,n]=this.toUint8RgbArray();return`rgba(${t},${e},${n},${this.alpha})`}toUint8RgbArray(t){const[e,n,s]=this._components;return(t=null!=t?t:[])[0]=Math.round(255*e),t[1]=Math.round(255*n),t[2]=Math.round(255*s),t}toRgbArray(t){t=null!=t?t:[];const[e,n,s]=this._components;return t[0]=e,t[1]=n,t[2]=s,t}toNumber(){return this._int}toLittleEndianNumber(){const t=this._int;return(t>>16)+(65280&t)+((255&t)<<16)}multiply(t){const[e,n,s,i]=$o.temp.setValue(t)._components;return this._components[0]*=e,this._components[1]*=n,this._components[2]*=s,this._components[3]*=i,this.refreshInt(),this._value=null,this}premultiply(t,e=!0){return e&&(this._components[0]*=t,this._components[1]*=t,this._components[2]*=t),this._components[3]=t,this.refreshInt(),this._value=null,this}toPremultiplied(t,e=!0){if(1===t)return(255<<24)+this._int;if(0===t)return e?0:this._int;let n=this._int>>16&255,s=this._int>>8&255,i=255&this._int;return e&&(n=n*t+.5|0,s=s*t+.5|0,i=i*t+.5|0),(255*t<<24)+(n<<16)+(s<<8)+i}toHex(){const t=this._int.toString(16);return`#${"000000".substring(0,6-t.length)+t}`}toHexa(){const t=Math.round(255*this._components[3]).toString(16);return this.toHex()+"00".substring(0,2-t.length)+t}setAlpha(t){return this._components[3]=this._clamp(t),this}round(t){const[e,n,s]=this._components;return this._components[0]=Math.round(e*t)/t,this._components[1]=Math.round(n*t)/t,this._components[2]=Math.round(s*t)/t,this.refreshInt(),this._value=null,this}toArray(t){t=null!=t?t:[];const[e,n,s,i]=this._components;return t[0]=e,t[1]=n,t[2]=s,t[3]=i,t}normalize(t){let e,n,s,i;if(("number"==typeof t||t instanceof Number)&&t>=0&&t<=16777215){e=(t>>16&255)/255,n=(t>>8&255)/255,s=(255&t)/255,i=1}else if((Array.isArray(t)||t instanceof Float32Array)&&t.length>=3&&t.length<=4)t=this._clamp(t),[e,n,s,i=1]=t;else if((t instanceof Uint8Array||t instanceof Uint8ClampedArray)&&t.length>=3&&t.length<=4)t=this._clamp(t,0,255),[e,n,s,i=255]=t,e/=255,n/=255,s/=255,i/=255;else if("string"==typeof t||"object"==typeof t){if("string"==typeof t){const e=$o.HEX_PATTERN.exec(t);e&&(t=`#${e[2]}`)}const r=Ho(t);r.isValid()&&(({r:e,g:n,b:s,a:i}=r.rgba),e/=255,n/=255,s/=255)}if(void 0===e)throw new Error(`Unable to convert color ${t}`);this._components[0]=e,this._components[1]=n,this._components[2]=s,this._components[3]=i,this.refreshInt()}refreshInt(){this._clamp(this._components);const[t,e,n]=this._components;this._int=(255*t<<16)+(255*e<<8)+(255*n|0)}_clamp(t,e=0,n=1){return"number"==typeof t?Math.min(Math.max(t,e),n):(t.forEach(((s,i)=>{t[i]=Math.min(Math.max(s,e),n)})),t)}};let qo=$o;function Ko(t,e=[]){return vo("7.2.0","utils.hex2rgb is deprecated, use Color#toRgbArray instead"),qo.shared.setValue(t).toRgbArray(e)}function Zo(t){return vo("7.2.0","utils.rgb2hex is deprecated, use Color#toNumber instead"),qo.shared.setValue(t).toNumber()}qo.shared=new $o,qo.temp=new $o,qo.HEX_PATTERN=/^(#|0x)?(([a-f0-9]{3}){1,2}([a-f0-9]{2})?)$/i;const Qo=function(){const t=[],e=[];for(let s=0;s<32;s++)t[s]=s,e[s]=s;t[Ir.NORMAL_NPM]=Ir.NORMAL,t[Ir.ADD_NPM]=Ir.ADD,t[Ir.SCREEN_NPM]=Ir.SCREEN,e[Ir.NORMAL]=Ir.NORMAL_NPM,e[Ir.ADD]=Ir.ADD_NPM,e[Ir.SCREEN]=Ir.SCREEN_NPM;const n=[];return n.push(e),n.push(t),n}();function Jo(t,e){return Qo[e?1:0][t]}function tl(t){if(4===t.BYTES_PER_ELEMENT)return t instanceof Float32Array?"Float32Array":t instanceof Uint32Array?"Uint32Array":"Int32Array";if(2===t.BYTES_PER_ELEMENT){if(t instanceof Uint16Array)return"Uint16Array"}else if(1===t.BYTES_PER_ELEMENT&&t instanceof Uint8Array)return"Uint8Array";return null}function el(t){return t+=0===t?1:0,--t,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,(t|=t>>>16)+1}function nl(t){return!(t&t-1||!t)}function sl(t){let e=(t>65535?1:0)<<4,n=((t>>>=e)>255?1:0)<<3;return e|=n,n=((t>>>=n)>15?1:0)<<2,e|=n,n=((t>>>=n)>3?1:0)<<1,e|=n,e|(t>>>=n)>>1}function il(t,e,n){const s=t.length;let i;if(e>=s||0===n)return;const r=s-(n=e+n>s?s-e:n);for(i=e;i<r;++i)t[i]=t[i+n];t.length=r}function rl(t){return 0===t?0:t<0?-1:1}let al=0;function ol(){return++al}const ll=class{constructor(t,e,n,s){this.left=t,this.top=e,this.right=n,this.bottom=s}get width(){return this.right-this.left}get height(){return this.bottom-this.top}isEmpty(){return this.left===this.right||this.top===this.bottom}};let hl=ll;hl.EMPTY=new ll(0,0,0,0);const cl={},ul=Object.create(null),dl=Object.create(null);class fl{constructor(t,e,n){this._canvas=zr.ADAPTER.createCanvas(),this._context=this._canvas.getContext("2d"),this.resolution=n||zr.RESOLUTION,this.resize(t,e)}clear(){this._checkDestroyed(),this._context.setTransform(1,0,0,1,0,0),this._context.clearRect(0,0,this._canvas.width,this._canvas.height)}resize(t,e){this._checkDestroyed(),this._canvas.width=Math.round(t*this.resolution),this._canvas.height=Math.round(e*this.resolution)}destroy(){this._context=null,this._canvas=null}get width(){return this._checkDestroyed(),this._canvas.width}set width(t){this._checkDestroyed(),this._canvas.width=Math.round(t)}get height(){return this._checkDestroyed(),this._canvas.height}set height(t){this._checkDestroyed(),this._canvas.height=Math.round(t)}get canvas(){return this._checkDestroyed(),this._canvas}get context(){return this._checkDestroyed(),this._context}_checkDestroyed(){if(null===this._canvas)throw new TypeError("The CanvasRenderTarget has already been destroyed")}}function pl(t,e,n){for(let s=0,i=4*n*e;s<e;++s,i+=4)if(0!==t[i+3])return!1;return!0}function ml(t,e,n,s,i){const r=4*e;for(let a=s,o=s*r+4*n;a<=i;++a,o+=r)if(0!==t[o+3])return!1;return!0}function gl(t){const e=function(t){const{width:e,height:n}=t,s=t.getContext("2d",{willReadFrequently:!0});if(null===s)throw new TypeError("Failed to get canvas 2D context");const i=s.getImageData(0,0,e,n).data;let r=0,a=0,o=e-1,l=n-1;for(;a<n&&pl(i,e,a);)++a;if(a===n)return hl.EMPTY;for(;pl(i,e,l);)--l;for(;ml(i,e,r,a,l);)++r;for(;ml(i,e,o,a,l);)--o;return++o,++l,new hl(r,a,o,l)}(t),{width:n,height:s}=e;let i=null;if(!e.isEmpty()){const r=t.getContext("2d");if(null===r)throw new TypeError("Failed to get canvas 2D context");i=r.getImageData(e.left,e.top,n,s)}return{width:n,height:s,data:i}}let vl;function xl(t,e=1){var n;const s=null==(n=zr.RETINA_PREFIX)?void 0:n.exec(t);return s?parseFloat(s[1]):e}var yl=(t=>(t.Renderer="renderer",t.Application="application",t.RendererSystem="renderer-webgl-system",t.RendererPlugin="renderer-webgl-plugin",t.CanvasRendererSystem="renderer-canvas-system",t.CanvasRendererPlugin="renderer-canvas-plugin",t.Asset="asset",t.LoadParser="load-parser",t.ResolveParser="resolve-parser",t.CacheParser="cache-parser",t.DetectionParser="detection-parser",t))(yl||{});const _l=t=>{if("function"==typeof t||"object"==typeof t&&t.extension){if(!t.extension)throw new Error("Extension class must have an extension object");const e="object"!=typeof t.extension?{type:t.extension}:t.extension;t=d(u({},e),{ref:t})}if("object"!=typeof t)throw new Error("Invalid extension type");return"string"==typeof(t=u({},t)).type&&(t.type=[t.type]),t},bl=(t,e)=>{var n;return null!=(n=_l(t).priority)?n:e},wl={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...t){return t.map(_l).forEach((t=>{t.type.forEach((e=>{var n,s;return null==(s=(n=this._removeHandlers)[e])?void 0:s.call(n,t)}))})),this},add(...t){return t.map(_l).forEach((t=>{t.type.forEach((e=>{const n=this._addHandlers,s=this._queue;n[e]?n[e](t):(s[e]=s[e]||[],s[e].push(t))}))})),this},handle(t,e,n){const s=this._addHandlers,i=this._removeHandlers;if(s[t]||i[t])throw new Error(`Extension type ${t} already has a handler`);s[t]=e,i[t]=n;const r=this._queue;return r[t]&&(r[t].forEach((t=>e(t))),delete r[t]),this},handleByMap(t,e){return this.handle(t,(t=>{e[t.name]=t.ref}),(t=>{delete e[t.name]}))},handleByList(t,e,n=-1){return this.handle(t,(t=>{e.includes(t.ref)||(e.push(t.ref),e.sort(((t,e)=>bl(e,n)-bl(t,n))))}),(t=>{const n=e.indexOf(t.ref);-1!==n&&e.splice(n,1)}))}};class El{constructor(t){"number"==typeof t?this.rawBinaryData=new ArrayBuffer(t):t instanceof Uint8Array?this.rawBinaryData=t.buffer:this.rawBinaryData=t,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}get int8View(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View}get uint8View(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View}get int16View(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View}get uint16View(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View}get int32View(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View}view(t){return this[`${t}View`]}destroy(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null}static sizeOf(t){switch(t){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(`${t} isn't a valid view type`)}}}const Tl=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join("\n");function Sl(t){let e="";for(let n=0;n<t;++n)n>0&&(e+="\nelse "),n<t-1&&(e+=`if(test == ${n}.0){}`);return e}class Al{constructor(){this.data=0,this.blendMode=Ir.NORMAL,this.polygonOffset=0,this.blend=!0,this.depthMask=!0}get blend(){return!!(1&this.data)}set blend(t){!!(1&this.data)!==t&&(this.data^=1)}get offsets(){return!!(2&this.data)}set offsets(t){!!(2&this.data)!==t&&(this.data^=2)}get culling(){return!!(4&this.data)}set culling(t){!!(4&this.data)!==t&&(this.data^=4)}get depthTest(){return!!(8&this.data)}set depthTest(t){!!(8&this.data)!==t&&(this.data^=8)}get depthMask(){return!!(32&this.data)}set depthMask(t){!!(32&this.data)!==t&&(this.data^=32)}get clockwiseFrontFace(){return!!(16&this.data)}set clockwiseFrontFace(t){!!(16&this.data)!==t&&(this.data^=16)}get blendMode(){return this._blendMode}set blendMode(t){this.blend=t!==Ir.NONE,this._blendMode=t}get polygonOffset(){return this._polygonOffset}set polygonOffset(t){this.offsets=!!t,this._polygonOffset=t}toString(){return`[@pixi/core:State blendMode=${this.blendMode} clockwiseFrontFace=${this.clockwiseFrontFace} culling=${this.culling} depthMask=${this.depthMask} polygonOffset=${this.polygonOffset}]`}static for2d(){const t=new Al;return t.depthTest=!1,t.blend=!0,t}}const Cl=[];function Il(t,e){if(!t)return null;let n="";if("string"==typeof t){const e=/\.(\w{3,4})(?:$|\?|#)/i.exec(t);e&&(n=e[1].toLowerCase())}for(let s=Cl.length-1;s>=0;--s){const i=Cl[s];if(i.test&&i.test(t,n))return new i(t,e)}throw new Error("Unrecognized source type to auto-detect Resource")}class Ml{constructor(t){this.items=[],this._name=t,this._aliasCount=0}emit(t,e,n,s,i,r,a,o){if(arguments.length>8)throw new Error("max arguments reached");const{name:l,items:h}=this;this._aliasCount++;for(let c=0,u=h.length;c<u;c++)h[c][l](t,e,n,s,i,r,a,o);return h===this.items&&this._aliasCount--,this}ensureNonAliasedItems(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))}add(t){return t[this._name]&&(this.ensureNonAliasedItems(),this.remove(t),this.items.push(t)),this}remove(t){const e=this.items.indexOf(t);return-1!==e&&(this.ensureNonAliasedItems(),this.items.splice(e,1)),this}contains(t){return this.items.includes(t)}removeAll(){return this.ensureNonAliasedItems(),this.items.length=0,this}destroy(){this.removeAll(),this.items=null,this._name=null}get empty(){return 0===this.items.length}get name(){return this._name}}Object.defineProperties(Ml.prototype,{dispatch:{value:Ml.prototype.emit},run:{value:Ml.prototype.emit}});class Rl{constructor(t=0,e=0){this._width=t,this._height=e,this.destroyed=!1,this.internal=!1,this.onResize=new Ml("setRealSize"),this.onUpdate=new Ml("update"),this.onError=new Ml("onError")}bind(t){this.onResize.add(t),this.onUpdate.add(t),this.onError.add(t),(this._width||this._height)&&this.onResize.emit(this._width,this._height)}unbind(t){this.onResize.remove(t),this.onUpdate.remove(t),this.onError.remove(t)}resize(t,e){t===this._width&&e===this._height||(this._width=t,this._height=e,this.onResize.emit(t,e))}get valid(){return!!this._width&&!!this._height}update(){this.destroyed||this.onUpdate.emit()}load(){return Promise.resolve(this)}get width(){return this._width}get height(){return this._height}style(t,e,n){return!1}dispose(){}destroy(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)}static test(t,e){return!1}}class Pl extends Rl{constructor(t,e){const{width:n,height:s}=e||{};if(!n||!s)throw new Error("BufferResource width or height invalid");super(n,s),this.data=t}upload(t,e,n){const s=t.gl;s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===Nr.UNPACK);const i=e.realWidth,r=e.realHeight;return n.width===i&&n.height===r?s.texSubImage2D(e.target,0,0,0,i,r,e.format,n.type,this.data):(n.width=i,n.height=r,s.texImage2D(e.target,0,n.internalFormat,i,r,0,e.format,n.type,this.data)),!0}dispose(){this.data=null}static test(t){return t instanceof Float32Array||t instanceof Uint8Array||t instanceof Uint32Array}}const kl={scaleMode:Or.NEAREST,format:Rr.RGBA,alphaMode:Nr.NPM},Fl=class extends ua{constructor(t=null,e=null){super(),e=Object.assign({},Fl.defaultOptions,e);const{alphaMode:n,mipmap:s,anisotropicLevel:i,scaleMode:r,width:a,height:o,wrapMode:l,format:h,type:c,target:u,resolution:d,resourceOptions:f}=e;!t||t instanceof Rl||((t=Il(t,f)).internal=!0),this.resolution=d||zr.RESOLUTION,this.width=Math.round((a||0)*this.resolution)/this.resolution,this.height=Math.round((o||0)*this.resolution)/this.resolution,this._mipmap=s,this.anisotropicLevel=i,this._wrapMode=l,this._scaleMode=r,this.format=h,this.type=c,this.target=u,this.alphaMode=n,this.uid=ol(),this.touched=0,this.isPowerOfTwo=!1,this._refreshPOT(),this._glTextures={},this.dirtyId=0,this.dirtyStyleId=0,this.cacheId=null,this.valid=a>0&&o>0,this.textureCacheIds=[],this.destroyed=!1,this.resource=null,this._batchEnabled=0,this._batchLocation=0,this.parentTextureArray=null,this.setResource(t)}get realWidth(){return Math.round(this.width*this.resolution)}get realHeight(){return Math.round(this.height*this.resolution)}get mipmap(){return this._mipmap}set mipmap(t){this._mipmap!==t&&(this._mipmap=t,this.dirtyStyleId++)}get scaleMode(){return this._scaleMode}set scaleMode(t){this._scaleMode!==t&&(this._scaleMode=t,this.dirtyStyleId++)}get wrapMode(){return this._wrapMode}set wrapMode(t){this._wrapMode!==t&&(this._wrapMode=t,this.dirtyStyleId++)}setStyle(t,e){let n;return void 0!==t&&t!==this.scaleMode&&(this.scaleMode=t,n=!0),void 0!==e&&e!==this.mipmap&&(this.mipmap=e,n=!0),n&&this.dirtyStyleId++,this}setSize(t,e,n){return n=n||this.resolution,this.setRealSize(t*n,e*n,n)}setRealSize(t,e,n){return this.resolution=n||this.resolution,this.width=Math.round(t)/this.resolution,this.height=Math.round(e)/this.resolution,this._refreshPOT(),this.update(),this}_refreshPOT(){this.isPowerOfTwo=nl(this.realWidth)&&nl(this.realHeight)}setResolution(t){const e=this.resolution;return e===t||(this.resolution=t,this.valid&&(this.width=Math.round(this.width*e)/t,this.height=Math.round(this.height*e)/t,this.emit("update",this)),this._refreshPOT()),this}setResource(t){if(this.resource===t)return this;if(this.resource)throw new Error("Resource can be set only once");return t.bind(this),this.resource=t,this}update(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))}onError(t){this.emit("error",this,t)}destroy(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete dl[this.cacheId],delete ul[this.cacheId],this.cacheId=null),this.dispose(),Fl.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0}dispose(){this.emit("dispose",this)}castToBaseTexture(){return this}static from(t,e,n=zr.STRICT_TEXTURE_CACHE){const s="string"==typeof t;let i=null;if(s)i=t;else{if(!t._pixiId){const n=(null==e?void 0:e.pixiIdPrefix)||"pixiid";t._pixiId=`${n}_${ol()}`}i=t._pixiId}let r=dl[i];if(s&&n&&!r)throw new Error(`The cacheId "${i}" does not exist in BaseTextureCache.`);return r||(r=new Fl(t,e),r.cacheId=i,Fl.addToCache(r,i)),r}static fromBuffer(t,e,n,s){t=t||new Float32Array(e*n*4);const i=new Pl(t,{width:e,height:n}),r=t instanceof Float32Array?kr.FLOAT:kr.UNSIGNED_BYTE;return new Fl(i,Object.assign({},kl,{type:r},s))}static addToCache(t,e){e&&(t.textureCacheIds.includes(e)||t.textureCacheIds.push(e),dl[e]&&dl[e]!==t&&console.warn(`BaseTexture added to the cache with an id [${e}] that already had an entry`),dl[e]=t)}static removeFromCache(t){if("string"==typeof t){const e=dl[t];if(e){const n=e.textureCacheIds.indexOf(t);return n>-1&&e.textureCacheIds.splice(n,1),delete dl[t],e}}else if(null==t?void 0:t.textureCacheIds){for(let e=0;e<t.textureCacheIds.length;++e)delete dl[t.textureCacheIds[e]];return t.textureCacheIds.length=0,t}return null}};let Ol=Fl;Ol.defaultOptions={mipmap:Lr.POW2,anisotropicLevel:0,scaleMode:Or.LINEAR,wrapMode:Dr.CLAMP,alphaMode:Nr.UNPACK,target:Pr.TEXTURE_2D,format:Rr.RGBA,type:kr.UNSIGNED_BYTE},Ol._globalBatch=0;class Dl{constructor(){this.texArray=null,this.blend=0,this.type=Mr.TRIANGLES,this.start=0,this.size=0,this.data=null}}let Ll=0;class Nl{constructor(t,e=!0,n=!1){this.data=t||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=n,this.static=e,this.id=Ll++,this.disposeRunner=new Ml("disposeBuffer")}update(t){t instanceof Array&&(t=new Float32Array(t)),this.data=t||this.data,this._updateID++}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.data=null}set index(t){this.type=t?Wr.ELEMENT_ARRAY_BUFFER:Wr.ARRAY_BUFFER}get index(){return this.type===Wr.ELEMENT_ARRAY_BUFFER}static from(t){return t instanceof Array&&(t=new Float32Array(t)),new Nl(t)}}class Bl{constructor(t,e=0,n=!1,s=kr.FLOAT,i,r,a,o=1){this.buffer=t,this.size=e,this.normalized=n,this.type=s,this.stride=i,this.start=r,this.instance=a,this.divisor=o}destroy(){this.buffer=null}static from(t,e,n,s,i){return new Bl(t,e,n,s,i)}}const Vl={Float32Array,Uint32Array,Int32Array,Uint8Array};const Ul={5126:4,5123:2,5121:1};let Xl=0;const Yl={Float32Array,Uint32Array,Int32Array,Uint8Array,Uint16Array};class Wl{constructor(t=[],e={}){this.buffers=t,this.indexBuffer=null,this.attributes=e,this.glVertexArrayObjects={},this.id=Xl++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new Ml("disposeGeometry"),this.refCount=0}addAttribute(t,e,n=0,s=!1,i,r,a,o=!1){if(!e)throw new Error("You must pass a buffer when creating an attribute");e instanceof Nl||(e instanceof Array&&(e=new Float32Array(e)),e=new Nl(e));const l=t.split("|");if(l.length>1){for(let t=0;t<l.length;t++)this.addAttribute(l[t],e,n,s,i);return this}let h=this.buffers.indexOf(e);return-1===h&&(this.buffers.push(e),h=this.buffers.length-1),this.attributes[t]=new Bl(h,n,s,i,r,a,o),this.instanced=this.instanced||o,this}getAttribute(t){return this.attributes[t]}getBuffer(t){return this.buffers[this.getAttribute(t).buffer]}addIndex(t){return t instanceof Nl||(t instanceof Array&&(t=new Uint16Array(t)),t=new Nl(t)),t.type=Wr.ELEMENT_ARRAY_BUFFER,this.indexBuffer=t,this.buffers.includes(t)||this.buffers.push(t),this}getIndex(){return this.indexBuffer}interleave(){if(1===this.buffers.length||2===this.buffers.length&&this.indexBuffer)return this;const t=[],e=[],n=new Nl;let s;for(s in this.attributes){const n=this.attributes[s],i=this.buffers[n.buffer];t.push(i.data),e.push(n.size*Ul[n.type]/4),n.buffer=0}for(n.data=function(t,e){let n=0,s=0;const i={};for(let l=0;l<t.length;l++)s+=e[l],n+=t[l].length;const r=new ArrayBuffer(4*n);let a=null,o=0;for(let l=0;l<t.length;l++){const n=e[l],h=t[l],c=tl(h);i[c]||(i[c]=new Vl[c](r)),a=i[c];for(let t=0;t<h.length;t++)a[(t/n|0)*s+o+t%n]=h[t];o+=n}return new Float32Array(r)}(t,e),s=0;s<this.buffers.length;s++)this.buffers[s]!==this.indexBuffer&&this.buffers[s].destroy();return this.buffers=[n],this.indexBuffer&&this.buffers.push(this.indexBuffer),this}getSize(){for(const t in this.attributes){const e=this.attributes[t];return this.buffers[e.buffer].data.length/(e.stride/4||e.size)}return 0}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null}clone(){const t=new Wl;for(let e=0;e<this.buffers.length;e++)t.buffers[e]=new Nl(this.buffers[e].data.slice(0));for(const e in this.attributes){const n=this.attributes[e];t.attributes[e]=new Bl(n.buffer,n.size,n.normalized,n.type,n.stride,n.start,n.instance)}return this.indexBuffer&&(t.indexBuffer=t.buffers[this.buffers.indexOf(this.indexBuffer)],t.indexBuffer.type=Wr.ELEMENT_ARRAY_BUFFER),t}static merge(t){const e=new Wl,n=[],s=[],i=[];let r;for(let a=0;a<t.length;a++){r=t[a];for(let t=0;t<r.buffers.length;t++)s[t]=s[t]||0,s[t]+=r.buffers[t].data.length,i[t]=0}for(let a=0;a<r.buffers.length;a++)n[a]=new(Yl[tl(r.buffers[a].data)])(s[a]),e.buffers[a]=new Nl(n[a]);for(let a=0;a<t.length;a++){r=t[a];for(let t=0;t<r.buffers.length;t++)n[t].set(r.buffers[t].data,i[t]),i[t]+=r.buffers[t].data.length}if(e.attributes=r.attributes,r.indexBuffer){e.indexBuffer=e.buffers[r.buffers.indexOf(r.indexBuffer)],e.indexBuffer.type=Wr.ELEMENT_ARRAY_BUFFER;let n=0,s=0,i=0,a=0;for(let t=0;t<r.buffers.length;t++)if(r.buffers[t]!==r.indexBuffer){a=t;break}for(const t in r.attributes){const e=r.attributes[t];(0|e.buffer)===a&&(s+=e.size*Ul[e.type]/4)}for(let r=0;r<t.length;r++){const o=t[r].indexBuffer.data;for(let t=0;t<o.length;t++)e.indexBuffer.data[t+i]+=n;n+=t[r].buffers[a].data.length/s,i+=o.length}}return e}}class zl extends Wl{constructor(t=!1){super(),this._buffer=new Nl(null,t,!1),this._indexBuffer=new Nl(null,t,!0),this.addAttribute("aVertexPosition",this._buffer,2,!1,kr.FLOAT).addAttribute("aTextureCoord",this._buffer,2,!1,kr.FLOAT).addAttribute("aColor",this._buffer,4,!0,kr.UNSIGNED_BYTE).addAttribute("aTextureId",this._buffer,1,!0,kr.FLOAT).addIndex(this._indexBuffer)}}const Gl=2*Math.PI,Hl=180/Math.PI,jl=Math.PI/180;var $l=(t=>(t[t.POLY=0]="POLY",t[t.RECT=1]="RECT",t[t.CIRC=2]="CIRC",t[t.ELIP=3]="ELIP",t[t.RREC=4]="RREC",t))($l||{});class ql{constructor(t=0,e=0){this.x=0,this.y=0,this.x=t,this.y=e}clone(){return new ql(this.x,this.y)}copyFrom(t){return this.set(t.x,t.y),this}copyTo(t){return t.set(this.x,this.y),t}equals(t){return t.x===this.x&&t.y===this.y}set(t=0,e=t){return this.x=t,this.y=e,this}toString(){return`[@pixi/math:Point x=${this.x} y=${this.y}]`}}const Kl=[new ql,new ql,new ql,new ql];let Zl=class t{constructor(t=0,e=0,n=0,s=0){this.x=Number(t),this.y=Number(e),this.width=Number(n),this.height=Number(s),this.type=$l.RECT}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}static get EMPTY(){return new t(0,0,0,0)}clone(){return new t(this.x,this.y,this.width,this.height)}copyFrom(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this}copyTo(t){return t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t}contains(t,e){return!(this.width<=0||this.height<=0)&&(t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height)}intersects(t,e){if(!e){const e=this.x<t.x?t.x:this.x;if((this.right>t.right?t.right:this.right)<=e)return!1;const n=this.y<t.y?t.y:this.y;return(this.bottom>t.bottom?t.bottom:this.bottom)>n}const n=this.left,s=this.right,i=this.top,r=this.bottom;if(s<=n||r<=i)return!1;const a=Kl[0].set(t.left,t.top),o=Kl[1].set(t.left,t.bottom),l=Kl[2].set(t.right,t.top),h=Kl[3].set(t.right,t.bottom);if(l.x<=a.x||o.y<=a.y)return!1;const c=Math.sign(e.a*e.d-e.b*e.c);if(0===c)return!1;if(e.apply(a,a),e.apply(o,o),e.apply(l,l),e.apply(h,h),Math.max(a.x,o.x,l.x,h.x)<=n||Math.min(a.x,o.x,l.x,h.x)>=s||Math.max(a.y,o.y,l.y,h.y)<=i||Math.min(a.y,o.y,l.y,h.y)>=r)return!1;const u=c*(o.y-a.y),d=c*(a.x-o.x),f=u*n+d*i,p=u*s+d*i,m=u*n+d*r,g=u*s+d*r;if(Math.max(f,p,m,g)<=u*a.x+d*a.y||Math.min(f,p,m,g)>=u*h.x+d*h.y)return!1;const v=c*(a.y-l.y),x=c*(l.x-a.x),y=v*n+x*i,_=v*s+x*i,b=v*n+x*r,w=v*s+x*r;return!(Math.max(y,_,b,w)<=v*a.x+x*a.y||Math.min(y,_,b,w)>=v*h.x+x*h.y)}pad(t=0,e=t){return this.x-=t,this.y-=e,this.width+=2*t,this.height+=2*e,this}fit(t){const e=Math.max(this.x,t.x),n=Math.min(this.x+this.width,t.x+t.width),s=Math.max(this.y,t.y),i=Math.min(this.y+this.height,t.y+t.height);return this.x=e,this.width=Math.max(n-e,0),this.y=s,this.height=Math.max(i-s,0),this}ceil(t=1,e=.001){const n=Math.ceil((this.x+this.width-e)*t)/t,s=Math.ceil((this.y+this.height-e)*t)/t;return this.x=Math.floor((this.x+e)*t)/t,this.y=Math.floor((this.y+e)*t)/t,this.width=n-this.x,this.height=s-this.y,this}enlarge(t){const e=Math.min(this.x,t.x),n=Math.max(this.x+this.width,t.x+t.width),s=Math.min(this.y,t.y),i=Math.max(this.y+this.height,t.y+t.height);return this.x=e,this.width=n-e,this.y=s,this.height=i-s,this}toString(){return`[@pixi/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`}};class Ql{constructor(t=0,e=0,n=0){this.x=t,this.y=e,this.radius=n,this.type=$l.CIRC}clone(){return new Ql(this.x,this.y,this.radius)}contains(t,e){if(this.radius<=0)return!1;const n=this.radius*this.radius;let s=this.x-t,i=this.y-e;return s*=s,i*=i,s+i<=n}getBounds(){return new Zl(this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius)}toString(){return`[@pixi/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`}}class Jl{constructor(t=0,e=0,n=0,s=0){this.x=t,this.y=e,this.width=n,this.height=s,this.type=$l.ELIP}clone(){return new Jl(this.x,this.y,this.width,this.height)}contains(t,e){if(this.width<=0||this.height<=0)return!1;let n=(t-this.x)/this.width,s=(e-this.y)/this.height;return n*=n,s*=s,n+s<=1}getBounds(){return new Zl(this.x-this.width,this.y-this.height,this.width,this.height)}toString(){return`[@pixi/math:Ellipse x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`}}class th{constructor(...t){let e=Array.isArray(t[0])?t[0]:t;if("number"!=typeof e[0]){const t=[];for(let n=0,s=e.length;n<s;n++)t.push(e[n].x,e[n].y);e=t}this.points=e,this.type=$l.POLY,this.closeStroke=!0}clone(){const t=this.points.slice(),e=new th(t);return e.closeStroke=this.closeStroke,e}contains(t,e){let n=!1;const s=this.points.length/2;for(let i=0,r=s-1;i<s;r=i++){const s=this.points[2*i],a=this.points[2*i+1],o=this.points[2*r],l=this.points[2*r+1];a>e!=l>e&&t<(e-a)/(l-a)*(o-s)+s&&(n=!n)}return n}toString(){return`[@pixi/math:PolygoncloseStroke=${this.closeStroke}points=${this.points.reduce(((t,e)=>`${t}, ${e}`),"")}]`}}class eh{constructor(t=0,e=0,n=0,s=0,i=20){this.x=t,this.y=e,this.width=n,this.height=s,this.radius=i,this.type=$l.RREC}clone(){return new eh(this.x,this.y,this.width,this.height,this.radius)}contains(t,e){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){const n=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(e>=this.y+n&&e<=this.y+this.height-n||t>=this.x+n&&t<=this.x+this.width-n)return!0;let s=t-(this.x+n),i=e-(this.y+n);const r=n*n;if(s*s+i*i<=r)return!0;if(s=t-(this.x+this.width-n),s*s+i*i<=r)return!0;if(i=e-(this.y+this.height-n),s*s+i*i<=r)return!0;if(s=t-(this.x+n),s*s+i*i<=r)return!0}return!1}toString(){return`[@pixi/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`}}class nh{constructor(t=1,e=0,n=0,s=1,i=0,r=0){this.array=null,this.a=t,this.b=e,this.c=n,this.d=s,this.tx=i,this.ty=r}fromArray(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]}set(t,e,n,s,i,r){return this.a=t,this.b=e,this.c=n,this.d=s,this.tx=i,this.ty=r,this}toArray(t,e){this.array||(this.array=new Float32Array(9));const n=e||this.array;return t?(n[0]=this.a,n[1]=this.b,n[2]=0,n[3]=this.c,n[4]=this.d,n[5]=0,n[6]=this.tx,n[7]=this.ty,n[8]=1):(n[0]=this.a,n[1]=this.c,n[2]=this.tx,n[3]=this.b,n[4]=this.d,n[5]=this.ty,n[6]=0,n[7]=0,n[8]=1),n}apply(t,e){e=e||new ql;const n=t.x,s=t.y;return e.x=this.a*n+this.c*s+this.tx,e.y=this.b*n+this.d*s+this.ty,e}applyInverse(t,e){e=e||new ql;const n=1/(this.a*this.d+this.c*-this.b),s=t.x,i=t.y;return e.x=this.d*n*s+-this.c*n*i+(this.ty*this.c-this.tx*this.d)*n,e.y=this.a*n*i+-this.b*n*s+(-this.ty*this.a+this.tx*this.b)*n,e}translate(t,e){return this.tx+=t,this.ty+=e,this}scale(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this}rotate(t){const e=Math.cos(t),n=Math.sin(t),s=this.a,i=this.c,r=this.tx;return this.a=s*e-this.b*n,this.b=s*n+this.b*e,this.c=i*e-this.d*n,this.d=i*n+this.d*e,this.tx=r*e-this.ty*n,this.ty=r*n+this.ty*e,this}append(t){const e=this.a,n=this.b,s=this.c,i=this.d;return this.a=t.a*e+t.b*s,this.b=t.a*n+t.b*i,this.c=t.c*e+t.d*s,this.d=t.c*n+t.d*i,this.tx=t.tx*e+t.ty*s+this.tx,this.ty=t.tx*n+t.ty*i+this.ty,this}setTransform(t,e,n,s,i,r,a,o,l){return this.a=Math.cos(a+l)*i,this.b=Math.sin(a+l)*i,this.c=-Math.sin(a-o)*r,this.d=Math.cos(a-o)*r,this.tx=t-(n*this.a+s*this.c),this.ty=e-(n*this.b+s*this.d),this}prepend(t){const e=this.tx;if(1!==t.a||0!==t.b||0!==t.c||1!==t.d){const e=this.a,n=this.c;this.a=e*t.a+this.b*t.c,this.b=e*t.b+this.b*t.d,this.c=n*t.a+this.d*t.c,this.d=n*t.b+this.d*t.d}return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this}decompose(t){const e=this.a,n=this.b,s=this.c,i=this.d,r=t.pivot,a=-Math.atan2(-s,i),o=Math.atan2(n,e),l=Math.abs(a+o);return l<1e-5||Math.abs(Gl-l)<1e-5?(t.rotation=o,t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=a,t.skew.y=o),t.scale.x=Math.sqrt(e*e+n*n),t.scale.y=Math.sqrt(s*s+i*i),t.position.x=this.tx+(r.x*e+r.y*s),t.position.y=this.ty+(r.x*n+r.y*i),t}invert(){const t=this.a,e=this.b,n=this.c,s=this.d,i=this.tx,r=t*s-e*n;return this.a=s/r,this.b=-e/r,this.c=-n/r,this.d=t/r,this.tx=(n*this.ty-s*i)/r,this.ty=-(t*this.ty-e*i)/r,this}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){const t=new nh;return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyTo(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyFrom(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this}toString(){return`[@pixi/math:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`}static get IDENTITY(){return new nh}static get TEMP_MATRIX(){return new nh}}const sh=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],ih=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],rh=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],ah=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],oh=[],lh=[],hh=Math.sign;!function(){for(let t=0;t<16;t++){const e=[];oh.push(e);for(let n=0;n<16;n++){const s=hh(sh[t]*sh[n]+rh[t]*ih[n]),i=hh(ih[t]*sh[n]+ah[t]*ih[n]),r=hh(sh[t]*rh[n]+rh[t]*ah[n]),a=hh(ih[t]*rh[n]+ah[t]*ah[n]);for(let t=0;t<16;t++)if(sh[t]===s&&ih[t]===i&&rh[t]===r&&ah[t]===a){e.push(t);break}}}for(let t=0;t<16;t++){const e=new nh;e.set(sh[t],ih[t],rh[t],ah[t],0,0),lh.push(e)}}();const ch={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:t=>sh[t],uY:t=>ih[t],vX:t=>rh[t],vY:t=>ah[t],inv:t=>8&t?15&t:7&-t,add:(t,e)=>oh[t][e],sub:(t,e)=>oh[t][ch.inv(e)],rotate180:t=>4^t,isVertical:t=>2==(3&t),byDirection:(t,e)=>2*Math.abs(t)<=Math.abs(e)?e>=0?ch.S:ch.N:2*Math.abs(e)<=Math.abs(t)?t>0?ch.E:ch.W:e>0?t>0?ch.SE:ch.SW:t>0?ch.NE:ch.NW,matrixAppendRotationInv:(t,e,n=0,s=0)=>{const i=lh[ch.inv(e)];i.tx=n,i.ty=s,t.append(i)}};class uh{constructor(t,e,n=0,s=0){this._x=n,this._y=s,this.cb=t,this.scope=e}clone(t=this.cb,e=this.scope){return new uh(t,e,this._x,this._y)}set(t=0,e=t){return this._x===t&&this._y===e||(this._x=t,this._y=e,this.cb.call(this.scope)),this}copyFrom(t){return this._x===t.x&&this._y===t.y||(this._x=t.x,this._y=t.y,this.cb.call(this.scope)),this}copyTo(t){return t.set(this._x,this._y),t}equals(t){return t.x===this._x&&t.y===this._y}toString(){return`[@pixi/math:ObservablePoint x=0 y=0 scope=${this.scope}]`}get x(){return this._x}set x(t){this._x!==t&&(this._x=t,this.cb.call(this.scope))}get y(){return this._y}set y(t){this._y!==t&&(this._y=t,this.cb.call(this.scope))}}const dh=class{constructor(){this.worldTransform=new nh,this.localTransform=new nh,this.position=new uh(this.onChange,this,0,0),this.scale=new uh(this.onChange,this,1,1),this.pivot=new uh(this.onChange,this,0,0),this.skew=new uh(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}onChange(){this._localID++}updateSkew(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++}toString(){return`[@pixi/math:Transform position=(${this.position.x}, ${this.position.y}) rotation=${this.rotation} scale=(${this.scale.x}, ${this.scale.y}) skew=(${this.skew.x}, ${this.skew.y}) ]`}updateLocalTransform(){const t=this.localTransform;this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1)}updateTransform(t){const e=this.localTransform;if(this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(this.pivot.x*e.b+this.pivot.y*e.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==t._worldID){const n=t.worldTransform,s=this.worldTransform;s.a=e.a*n.a+e.b*n.c,s.b=e.a*n.b+e.b*n.d,s.c=e.c*n.a+e.d*n.c,s.d=e.c*n.b+e.d*n.d,s.tx=e.tx*n.a+e.ty*n.c+n.tx,s.ty=e.tx*n.b+e.ty*n.d+n.ty,this._parentID=t._worldID,this._worldID++}}setFromMatrix(t){t.decompose(this),this._localID++}get rotation(){return this._rotation}set rotation(t){this._rotation!==t&&(this._rotation=t,this.updateSkew())}};let fh=dh;fh.IDENTITY=new dh;function ph(t,e,n){const s=t.createShader(e);return t.shaderSource(s,n),t.compileShader(s),s}function mh(t){const e=new Array(t);for(let n=0;n<e.length;n++)e[n]=!1;return e}function gh(t,e){switch(t){case"float":case"int":case"uint":case"sampler2D":case"sampler2DArray":return 0;case"vec2":return new Float32Array(2*e);case"vec3":return new Float32Array(3*e);case"vec4":return new Float32Array(4*e);case"ivec2":return new Int32Array(2*e);case"ivec3":return new Int32Array(3*e);case"ivec4":return new Int32Array(4*e);case"uvec2":return new Uint32Array(2*e);case"uvec3":return new Uint32Array(3*e);case"uvec4":return new Uint32Array(4*e);case"bool":return!1;case"bvec2":return mh(2*e);case"bvec3":return mh(3*e);case"bvec4":return mh(4*e);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}const vh=[{test:t=>"float"===t.type&&1===t.size&&!t.isArray,code:t=>`\n            if(uv["${t}"] !== ud["${t}"].value)\n            {\n                ud["${t}"].value = uv["${t}"]\n                gl.uniform1f(ud["${t}"].location, uv["${t}"])\n            }\n            `},{test:(t,e)=>!("sampler2D"!==t.type&&"samplerCube"!==t.type&&"sampler2DArray"!==t.type||1!==t.size||t.isArray||null!=e&&void 0===e.castToBaseTexture),code:t=>`t = syncData.textureCount++;\n\n            renderer.texture.bind(uv["${t}"], t);\n\n            if(ud["${t}"].value !== t)\n            {\n                ud["${t}"].value = t;\n                gl.uniform1i(ud["${t}"].location, t);\n; // eslint-disable-line max-len\n            }`},{test:(t,e)=>"mat3"===t.type&&1===t.size&&!t.isArray&&void 0!==e.a,code:t=>`\n            gl.uniformMatrix3fv(ud["${t}"].location, false, uv["${t}"].toArray(true));\n            `,codeUbo:t=>`\n                var ${t}_matrix = uv.${t}.toArray(true);\n\n                data[offset] = ${t}_matrix[0];\n                data[offset+1] = ${t}_matrix[1];\n                data[offset+2] = ${t}_matrix[2];\n        \n                data[offset + 4] = ${t}_matrix[3];\n                data[offset + 5] = ${t}_matrix[4];\n                data[offset + 6] = ${t}_matrix[5];\n        \n                data[offset + 8] = ${t}_matrix[6];\n                data[offset + 9] = ${t}_matrix[7];\n                data[offset + 10] = ${t}_matrix[8];\n            `},{test:(t,e)=>"vec2"===t.type&&1===t.size&&!t.isArray&&void 0!==e.x,code:t=>`\n                cv = ud["${t}"].value;\n                v = uv["${t}"];\n\n                if(cv[0] !== v.x || cv[1] !== v.y)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    gl.uniform2f(ud["${t}"].location, v.x, v.y);\n                }`,codeUbo:t=>`\n                v = uv.${t};\n\n                data[offset] = v.x;\n                data[offset+1] = v.y;\n            `},{test:t=>"vec2"===t.type&&1===t.size&&!t.isArray,code:t=>`\n                cv = ud["${t}"].value;\n                v = uv["${t}"];\n\n                if(cv[0] !== v[0] || cv[1] !== v[1])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    gl.uniform2f(ud["${t}"].location, v[0], v[1]);\n                }\n            `},{test:(t,e)=>"vec4"===t.type&&1===t.size&&!t.isArray&&void 0!==e.width,code:t=>`\n                cv = ud["${t}"].value;\n                v = uv["${t}"];\n\n                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    cv[2] = v.width;\n                    cv[3] = v.height;\n                    gl.uniform4f(ud["${t}"].location, v.x, v.y, v.width, v.height)\n                }`,codeUbo:t=>`\n                    v = uv.${t};\n\n                    data[offset] = v.x;\n                    data[offset+1] = v.y;\n                    data[offset+2] = v.width;\n                    data[offset+3] = v.height;\n                `},{test:(t,e)=>"vec4"===t.type&&1===t.size&&!t.isArray&&void 0!==e.red,code:t=>`\n                cv = ud["${t}"].value;\n                v = uv["${t}"];\n\n                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.alpha)\n                {\n                    cv[0] = v.red;\n                    cv[1] = v.green;\n                    cv[2] = v.blue;\n                    cv[3] = v.alpha;\n                    gl.uniform4f(ud["${t}"].location, v.red, v.green, v.blue, v.alpha)\n                }`,codeUbo:t=>`\n                    v = uv.${t};\n\n                    data[offset] = v.red;\n                    data[offset+1] = v.green;\n                    data[offset+2] = v.blue;\n                    data[offset+3] = v.alpha;\n                `},{test:(t,e)=>"vec3"===t.type&&1===t.size&&!t.isArray&&void 0!==e.red,code:t=>`\n                cv = ud["${t}"].value;\n                v = uv["${t}"];\n\n                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.a)\n                {\n                    cv[0] = v.red;\n                    cv[1] = v.green;\n                    cv[2] = v.blue;\n    \n                    gl.uniform3f(ud["${t}"].location, v.red, v.green, v.blue)\n                }`,codeUbo:t=>`\n                    v = uv.${t};\n\n                    data[offset] = v.red;\n                    data[offset+1] = v.green;\n                    data[offset+2] = v.blue;\n                `},{test:t=>"vec4"===t.type&&1===t.size&&!t.isArray,code:t=>`\n                cv = ud["${t}"].value;\n                v = uv["${t}"];\n\n                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    cv[2] = v[2];\n                    cv[3] = v[3];\n\n                    gl.uniform4f(ud["${t}"].location, v[0], v[1], v[2], v[3])\n                }`}],xh={float:"\n    if (cv !== v)\n    {\n        cu.value = v;\n        gl.uniform1f(location, v);\n    }",vec2:"\n    if (cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n\n        gl.uniform2f(location, v[0], v[1])\n    }",vec3:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3f(location, v[0], v[1], v[2])\n    }",vec4:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n        cv[3] = v[3];\n\n        gl.uniform4f(location, v[0], v[1], v[2], v[3]);\n    }",int:"\n    if (cv !== v)\n    {\n        cu.value = v;\n\n        gl.uniform1i(location, v);\n    }",ivec2:"\n    if (cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n\n        gl.uniform2i(location, v[0], v[1]);\n    }",ivec3:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3i(location, v[0], v[1], v[2]);\n    }",ivec4:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n        cv[3] = v[3];\n\n        gl.uniform4i(location, v[0], v[1], v[2], v[3]);\n    }",uint:"\n    if (cv !== v)\n    {\n        cu.value = v;\n\n        gl.uniform1ui(location, v);\n    }",uvec2:"\n    if (cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n\n        gl.uniform2ui(location, v[0], v[1]);\n    }",uvec3:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3ui(location, v[0], v[1], v[2]);\n    }",uvec4:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n        cv[3] = v[3];\n\n        gl.uniform4ui(location, v[0], v[1], v[2], v[3]);\n    }",bool:"\n    if (cv !== v)\n    {\n        cu.value = v;\n        gl.uniform1i(location, v);\n    }",bvec2:"\n    if (cv[0] != v[0] || cv[1] != v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n\n        gl.uniform2i(location, v[0], v[1]);\n    }",bvec3:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3i(location, v[0], v[1], v[2]);\n    }",bvec4:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n        cv[3] = v[3];\n\n        gl.uniform4i(location, v[0], v[1], v[2], v[3]);\n    }",mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:"\n    if (cv !== v)\n    {\n        cu.value = v;\n\n        gl.uniform1i(location, v);\n    }",samplerCube:"\n    if (cv !== v)\n    {\n        cu.value = v;\n\n        gl.uniform1i(location, v);\n    }",sampler2DArray:"\n    if (cv !== v)\n    {\n        cu.value = v;\n\n        gl.uniform1i(location, v);\n    }"},yh={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",uint:"gl.uniform1uiv(location, v)",uvec2:"gl.uniform2uiv(location, v)",uvec3:"gl.uniform3uiv(location, v)",uvec4:"gl.uniform4uiv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};const _h={};let bh,wh=_h;function Eh(){if(!bh){bh=Ur.MEDIUM;const t=function(){if(wh===_h||(null==wh?void 0:wh.isContextLost())){const t=zr.ADAPTER.createCanvas();let e;zr.PREFER_ENV>=Sr.WEBGL2&&(e=t.getContext("webgl2",{})),e||(e=t.getContext("webgl",{})||t.getContext("experimental-webgl",{}),e?e.getExtension("WEBGL_draw_buffers"):e=null),wh=e}return wh}();if(t&&t.getShaderPrecisionFormat){const e=t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT);bh=e.precision?Ur.HIGH:Ur.MEDIUM}}return bh}function Th(t,e){const n=t.getShaderSource(e).split("\n").map(((t,e)=>`${e}: ${t}`)),s=t.getShaderInfoLog(e),i=s.split("\n"),r={},a=i.map((t=>parseFloat(t.replace(/^ERROR\: 0\:([\d]+)\:.*$/,"$1")))).filter((t=>!(!t||r[t])&&(r[t]=!0,!0))),o=[""];a.forEach((t=>{n[t-1]=`%c${n[t-1]}%c`,o.push("background: #FF0000; color:#FFFFFF; font-size: 10px","font-size: 10px")}));const l=n.join("\n");o[0]=l,console.error(s),console.groupCollapsed("click to view full shader code"),console.warn(...o),console.groupEnd()}const Sh={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,uint:1,uvec2:2,uvec3:3,uvec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function Ah(t){return Sh[t]}let Ch=null;const Ih={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",UNSIGNED_INT:"uint",UNSIGNED_INT_VEC2:"uvec2",UNSIGNED_INT_VEC3:"uvec3",UNSIGNED_INT_VEC4:"uvec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"};function Mh(t,e){if(!Ch){const e=Object.keys(Ih);Ch={};for(let n=0;n<e.length;++n){const s=e[n];Ch[t[s]]=Ih[s]}}return Ch[e]}function Rh(t,e,n){if("precision"!==t.substring(0,9)){let s=e;return e===Ur.HIGH&&n!==Ur.HIGH&&(s=Ur.MEDIUM),`precision ${s} float;\n${t}`}return n!==Ur.HIGH&&"precision highp"===t.substring(0,15)?t.replace("precision highp","precision mediump"):t}let Ph;let kh=0;const Fh={},Oh=class{constructor(t,e,n="pixi-shader",s={}){this.extra={},this.id=kh++,this.vertexSrc=t||Oh.defaultVertexSrc,this.fragmentSrc=e||Oh.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),this.extra=s,"#version"!==this.vertexSrc.substring(0,8)&&(n=n.replace(/\s+/g,"-"),Fh[n]?(Fh[n]++,n+=`-${Fh[n]}`):Fh[n]=1,this.vertexSrc=`#define SHADER_NAME ${n}\n${this.vertexSrc}`,this.fragmentSrc=`#define SHADER_NAME ${n}\n${this.fragmentSrc}`,this.vertexSrc=Rh(this.vertexSrc,Oh.defaultVertexPrecision,Ur.HIGH),this.fragmentSrc=Rh(this.fragmentSrc,Oh.defaultFragmentPrecision,Eh())),this.glPrograms={},this.syncUniforms=null}static get defaultVertexSrc(){return"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void){\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vTextureCoord = aTextureCoord;\n}\n"}static get defaultFragmentSrc(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor *= texture2D(uSampler, vTextureCoord);\n}"}static from(t,e,n){const s=t+e;let i=cl[s];return i||(cl[s]=i=new Oh(t,e,n)),i}};let Dh=Oh;Dh.defaultVertexPrecision=Ur.HIGH,Dh.defaultFragmentPrecision=la.apple.device?Ur.HIGH:Ur.MEDIUM;let Lh=0;class Nh{constructor(t,e,n){this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=Lh++,this.static=!!e,this.ubo=!!n,t instanceof Nl?(this.buffer=t,this.buffer.type=Wr.UNIFORM_BUFFER,this.autoManage=!1,this.ubo=!0):(this.uniforms=t,this.ubo&&(this.buffer=new Nl(new Float32Array(1)),this.buffer.type=Wr.UNIFORM_BUFFER,this.autoManage=!0))}update(){this.dirtyId++,!this.autoManage&&this.buffer&&this.buffer.update()}add(t,e,n){if(this.ubo)throw new Error("[UniformGroup] uniform groups in ubo mode cannot be modified, or have uniform groups nested in them");this.uniforms[t]=new Nh(e,n)}static from(t,e,n){return new Nh(t,e,n)}static uboFrom(t,e){return new Nh(t,null==e||e,!0)}}class Bh{constructor(t,e){this.uniformBindCount=0,this.program=t,this.uniformGroup=e?e instanceof Nh?e:new Nh(e):new Nh({}),this.disposeRunner=new Ml("disposeShader")}checkUniformExists(t,e){if(e.uniforms[t])return!0;for(const n in e.uniforms){const s=e.uniforms[n];if(s.group&&this.checkUniformExists(t,s))return!0}return!1}destroy(){this.uniformGroup=null,this.disposeRunner.emit(this),this.disposeRunner.destroy()}get uniforms(){return this.uniformGroup.uniforms}static from(t,e,n){const s=Dh.from(t,e);return new Bh(s,n)}}class Vh{constructor(t,e){if(this.vertexSrc=t,this.fragTemplate=e,this.programCache={},this.defaultGroupCache={},!e.includes("%count%"))throw new Error('Fragment template must contain "%count%".');if(!e.includes("%forloop%"))throw new Error('Fragment template must contain "%forloop%".')}generateShader(t){if(!this.programCache[t]){const e=new Int32Array(t);for(let s=0;s<t;s++)e[s]=s;this.defaultGroupCache[t]=Nh.from({uSamplers:e},!0);let n=this.fragTemplate;n=n.replace(/%count%/gi,`${t}`),n=n.replace(/%forloop%/gi,this.generateSampleSrc(t)),this.programCache[t]=new Dh(this.vertexSrc,n)}const e={tint:new Float32Array([1,1,1,1]),translationMatrix:new nh,default:this.defaultGroupCache[t]};return new Bh(this.programCache[t],e)}generateSampleSrc(t){let e="";e+="\n",e+="\n";for(let n=0;n<t;n++)n>0&&(e+="\nelse "),n<t-1&&(e+=`if(vTextureId < ${n}.5)`),e+="\n{",e+=`\n\tcolor = texture2D(uSamplers[${n}], vTextureCoord);`,e+="\n}";return e+="\n",e+="\n",e}}class Uh{constructor(){this.elements=[],this.ids=[],this.count=0}clear(){for(let t=0;t<this.count;t++)this.elements[t]=null;this.count=0}}class Xh{constructor(t){this.renderer=t}flush(){}destroy(){this.renderer=null}start(){}stop(){this.flush()}render(t){}}const Yh=class extends Xh{constructor(t){super(t),this.setShaderGenerator(),this.geometryClass=zl,this.vertexSize=6,this.state=Al.for2d(),this.size=4*Yh.defaultBatchSize,this._vertexCount=0,this._indexCount=0,this._bufferedElements=[],this._bufferedTextures=[],this._bufferSize=0,this._shader=null,this._packedGeometries=[],this._packedGeometryPoolSize=2,this._flushId=0,this._aBuffers={},this._iBuffers={},this.maxTextures=1,this.renderer.on("prerender",this.onPrerender,this),t.runners.contextChange.add(this),this._dcIndex=0,this._aIndex=0,this._iIndex=0,this._attributeBuffer=null,this._indexBuffer=null,this._tempBoundTextures=[]}static get defaultMaxTextures(){var t;return this._defaultMaxTextures=null!=(t=this._defaultMaxTextures)?t:function(t){let e=!0;const n=zr.ADAPTER.getNavigator();if(la.tablet||la.phone){if(la.apple.device){const t=n.userAgent.match(/OS (\d+)_(\d+)?/);t&&parseInt(t[1],10)<11&&(e=!1)}if(la.android.device){const t=n.userAgent.match(/Android\s([0-9.]*)/);t&&parseInt(t[1],10)<7&&(e=!1)}}return e?t:4}(32),this._defaultMaxTextures}static set defaultMaxTextures(t){this._defaultMaxTextures=t}static get canUploadSameBuffer(){var t;return this._canUploadSameBuffer=null!=(t=this._canUploadSameBuffer)?t:!la.apple.device,this._canUploadSameBuffer}static set canUploadSameBuffer(t){this._canUploadSameBuffer=t}get MAX_TEXTURES(){return vo("7.1.0","BatchRenderer#MAX_TEXTURES renamed to BatchRenderer#maxTextures"),this.maxTextures}static get defaultVertexSrc(){return"precision highp float;\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\nattribute float aTextureId;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform vec4 tint;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\n\nvoid main(void){\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vTextureId = aTextureId;\n    vColor = aColor * tint;\n}\n"}static get defaultFragmentTemplate(){return"varying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\nuniform sampler2D uSamplers[%count%];\n\nvoid main(void){\n    vec4 color;\n    %forloop%\n    gl_FragColor = color * vColor;\n}\n"}setShaderGenerator({vertex:t=Yh.defaultVertexSrc,fragment:e=Yh.defaultFragmentTemplate}={}){this.shaderGenerator=new Vh(t,e)}contextChange(){const t=this.renderer.gl;zr.PREFER_ENV===Sr.WEBGL_LEGACY?this.maxTextures=1:(this.maxTextures=Math.min(t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),Yh.defaultMaxTextures),this.maxTextures=function(t,e){if(0===t)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");const n=e.createShader(e.FRAGMENT_SHADER);for(;;){const s=Tl.replace(/%forloop%/gi,Sl(t));if(e.shaderSource(n,s),e.compileShader(n),e.getShaderParameter(n,e.COMPILE_STATUS))break;t=t/2|0}return t}(this.maxTextures,t)),this._shader=this.shaderGenerator.generateShader(this.maxTextures);for(let e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]=new this.geometryClass;this.initFlushBuffers()}initFlushBuffers(){const{_drawCallPool:t,_textureArrayPool:e}=Yh,n=this.size/4,s=Math.floor(n/this.maxTextures)+1;for(;t.length<n;)t.push(new Dl);for(;e.length<s;)e.push(new Uh);for(let i=0;i<this.maxTextures;i++)this._tempBoundTextures[i]=null}onPrerender(){this._flushId=0}render(t){t._texture.valid&&(this._vertexCount+t.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=t.vertexData.length/2,this._indexCount+=t.indices.length,this._bufferedTextures[this._bufferSize]=t._texture.baseTexture,this._bufferedElements[this._bufferSize++]=t)}buildTexturesAndDrawCalls(){const{_bufferedTextures:t,maxTextures:e}=this,n=Yh._textureArrayPool,s=this.renderer.batch,i=this._tempBoundTextures,r=this.renderer.textureGC.count;let a=++Ol._globalBatch,o=0,l=n[0],h=0;s.copyBoundTextures(i,e);for(let c=0;c<this._bufferSize;++c){const u=t[c];t[c]=null,u._batchEnabled!==a&&(l.count>=e&&(s.boundArray(l,i,a,e),this.buildDrawCalls(l,h,c),h=c,l=n[++o],++a),u._batchEnabled=a,u.touched=r,l.elements[l.count++]=u)}l.count>0&&(s.boundArray(l,i,a,e),this.buildDrawCalls(l,h,this._bufferSize),++o,++a);for(let c=0;c<i.length;c++)i[c]=null;Ol._globalBatch=a}buildDrawCalls(t,e,n){const{_bufferedElements:s,_attributeBuffer:i,_indexBuffer:r,vertexSize:a}=this,o=Yh._drawCallPool;let l=this._dcIndex,h=this._aIndex,c=this._iIndex,u=o[l];u.start=this._iIndex,u.texArray=t;for(let d=e;d<n;++d){const n=s[d],f=n._texture.baseTexture,p=Qo[f.alphaMode?1:0][n.blendMode];s[d]=null,e<d&&u.blend!==p&&(u.size=c-u.start,e=d,u=o[++l],u.texArray=t,u.start=c),this.packInterleavedGeometry(n,i,r,h,c),h+=n.vertexData.length/2*a,c+=n.indices.length,u.blend=p}e<n&&(u.size=c-u.start,++l),this._dcIndex=l,this._aIndex=h,this._iIndex=c}bindAndClearTexArray(t){const e=this.renderer.texture;for(let n=0;n<t.count;n++)e.bind(t.elements[n],t.ids[n]),t.elements[n]=null;t.count=0}updateGeometry(){const{_packedGeometries:t,_attributeBuffer:e,_indexBuffer:n}=this;Yh.canUploadSameBuffer?(t[this._flushId]._buffer.update(e.rawBinaryData),t[this._flushId]._indexBuffer.update(n),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,t[this._flushId]=new this.geometryClass),t[this._flushId]._buffer.update(e.rawBinaryData),t[this._flushId]._indexBuffer.update(n),this.renderer.geometry.bind(t[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)}drawBatches(){const t=this._dcIndex,{gl:e,state:n}=this.renderer,s=Yh._drawCallPool;let i=null;for(let r=0;r<t;r++){const{texArray:t,type:a,size:o,start:l,blend:h}=s[r];i!==t&&(i=t,this.bindAndClearTexArray(t)),this.state.blendMode=h,n.set(this.state),e.drawElements(a,o,e.UNSIGNED_SHORT,2*l)}}flush(){0!==this._vertexCount&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)}start(){this.renderer.state.set(this.state),this.renderer.texture.ensureSamplerType(this.maxTextures),this.renderer.shader.bind(this._shader),Yh.canUploadSameBuffer&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])}stop(){this.flush()}destroy(){for(let t=0;t<this._packedGeometryPoolSize;t++)this._packedGeometries[t]&&this._packedGeometries[t].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),super.destroy()}getAttributeBuffer(t){const e=el(Math.ceil(t/8)),n=sl(e),s=8*e;this._aBuffers.length<=n&&(this._iBuffers.length=n+1);let i=this._aBuffers[s];return i||(this._aBuffers[s]=i=new El(s*this.vertexSize*4)),i}getIndexBuffer(t){const e=el(Math.ceil(t/12)),n=sl(e),s=12*e;this._iBuffers.length<=n&&(this._iBuffers.length=n+1);let i=this._iBuffers[n];return i||(this._iBuffers[n]=i=new Uint16Array(s)),i}packInterleavedGeometry(t,e,n,s,i){const{uint32View:r,float32View:a}=e,o=s/this.vertexSize,l=t.uvs,h=t.indices,c=t.vertexData,u=t._texture.baseTexture._batchLocation,d=Math.min(t.worldAlpha,1),f=qo.shared.setValue(t._tintRGB).toPremultiplied(d,t._texture.baseTexture.alphaMode>0);for(let p=0;p<c.length;p+=2)a[s++]=c[p],a[s++]=c[p+1],a[s++]=l[p],a[s++]=l[p+1],r[s++]=f,a[s++]=u;for(let p=0;p<h.length;p++)n[i++]=o+h[p]}};let Wh=Yh;Wh.defaultBatchSize=4096,Wh.extension={name:"batch",type:yl.RendererPlugin},Wh._drawCallPool=[],Wh._textureArrayPool=[],wl.add(Wh);const zh=class extends Bh{constructor(t,e,n){super(Dh.from(t||zh.defaultVertexSrc,e||zh.defaultFragmentSrc),n),this.padding=0,this.resolution=zh.defaultResolution,this.multisample=zh.defaultMultisample,this.enabled=!0,this.autoFit=!0,this.state=new Al}apply(t,e,n,s,i){t.applyFilter(this,e,n,s)}get blendMode(){return this.state.blendMode}set blendMode(t){this.state.blendMode=t}get resolution(){return this._resolution}set resolution(t){this._resolution=t}static get defaultVertexSrc(){return"attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n"}static get defaultFragmentSrc(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor = texture2D(uSampler, vTextureCoord);\n}\n"}};let Gh=zh;Gh.defaultResolution=1,Gh.defaultMultisample=Yr.NONE;class Hh{constructor(){this.clearBeforeRender=!0,this._backgroundColor=new qo(0),this.alpha=1}init(t){this.clearBeforeRender=t.clearBeforeRender;const{backgroundColor:e,background:n,backgroundAlpha:s}=t,i=null!=n?n:e;void 0!==i&&(this.color=i),this.alpha=s}get color(){return this._backgroundColor.value}set color(t){this._backgroundColor.setValue(t)}get alpha(){return this._backgroundColor.alpha}set alpha(t){this._backgroundColor.setAlpha(t)}get backgroundColor(){return this._backgroundColor}destroy(){}}Hh.defaultOptions={backgroundAlpha:1,backgroundColor:0,clearBeforeRender:!0},Hh.extension={type:[yl.RendererSystem,yl.CanvasRendererSystem],name:"background"},wl.add(Hh);class jh{constructor(t){this.renderer=t,this.emptyRenderer=new Xh(t),this.currentRenderer=this.emptyRenderer}setObjectRenderer(t){this.currentRenderer!==t&&(this.currentRenderer.stop(),this.currentRenderer=t,this.currentRenderer.start())}flush(){this.setObjectRenderer(this.emptyRenderer)}reset(){this.setObjectRenderer(this.emptyRenderer)}copyBoundTextures(t,e){const{boundTextures:n}=this.renderer.texture;for(let s=e-1;s>=0;--s)t[s]=n[s]||null,t[s]&&(t[s]._batchLocation=s)}boundArray(t,e,n,s){const{elements:i,ids:r,count:a}=t;let o=0;for(let l=0;l<a;l++){const t=i[l],a=t._batchLocation;if(a>=0&&a<s&&e[a]===t)r[l]=a;else for(;o<s;){const s=e[o];if(!s||s._batchEnabled!==n||s._batchLocation!==o){r[l]=o,t._batchLocation=o,e[o]=t;break}o++}}}destroy(){this.renderer=null}}jh.extension={type:yl.RendererSystem,name:"batch"},wl.add(jh);let $h=0;class qh{constructor(t){this.renderer=t,this.webGLVersion=1,this.extensions={},this.supports={uint32Indices:!1},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this)}get isLost(){return!this.gl||this.gl.isContextLost()}contextChange(t){this.gl=t,this.renderer.gl=t,this.renderer.CONTEXT_UID=$h++}init(t){if(t.context)this.initFromContext(t.context);else{const e=this.renderer.background.alpha<1,n=t.premultipliedAlpha;this.preserveDrawingBuffer=t.preserveDrawingBuffer,this.useContextAlpha=t.useContextAlpha,this.powerPreference=t.powerPreference,this.initFromOptions({alpha:e,premultipliedAlpha:n,antialias:t.antialias,stencil:!0,preserveDrawingBuffer:t.preserveDrawingBuffer,powerPreference:t.powerPreference})}}initFromContext(t){this.gl=t,this.validateContext(t),this.renderer.gl=t,this.renderer.CONTEXT_UID=$h++,this.renderer.runners.contextChange.emit(t);const e=this.renderer.view;void 0!==e.addEventListener&&(e.addEventListener("webglcontextlost",this.handleContextLost,!1),e.addEventListener("webglcontextrestored",this.handleContextRestored,!1))}initFromOptions(t){const e=this.createContext(this.renderer.view,t);this.initFromContext(e)}createContext(t,e){let n;if(zr.PREFER_ENV>=Sr.WEBGL2&&(n=t.getContext("webgl2",e)),n)this.webGLVersion=2;else if(this.webGLVersion=1,n=t.getContext("webgl",e)||t.getContext("experimental-webgl",e),!n)throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=n,this.getExtensions(),this.gl}getExtensions(){const{gl:t}=this,e={loseContext:t.getExtension("WEBGL_lose_context"),anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),s3tc:t.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:t.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:t.getExtension("WEBGL_compressed_texture_etc"),etc1:t.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:t.getExtension("WEBGL_compressed_texture_atc"),astc:t.getExtension("WEBGL_compressed_texture_astc")};1===this.webGLVersion?Object.assign(this.extensions,e,{drawBuffers:t.getExtension("WEBGL_draw_buffers"),depthTexture:t.getExtension("WEBGL_depth_texture"),vertexArrayObject:t.getExtension("OES_vertex_array_object")||t.getExtension("MOZ_OES_vertex_array_object")||t.getExtension("WEBKIT_OES_vertex_array_object"),uint32ElementIndex:t.getExtension("OES_element_index_uint"),floatTexture:t.getExtension("OES_texture_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),textureHalfFloat:t.getExtension("OES_texture_half_float"),textureHalfFloatLinear:t.getExtension("OES_texture_half_float_linear")}):2===this.webGLVersion&&Object.assign(this.extensions,e,{colorBufferFloat:t.getExtension("EXT_color_buffer_float")})}handleContextLost(t){t.preventDefault(),setTimeout((()=>{this.gl.isContextLost()&&this.extensions.loseContext&&this.extensions.loseContext.restoreContext()}),0)}handleContextRestored(){this.renderer.runners.contextChange.emit(this.gl)}destroy(){const t=this.renderer.view;this.renderer=null,void 0!==t.removeEventListener&&(t.removeEventListener("webglcontextlost",this.handleContextLost),t.removeEventListener("webglcontextrestored",this.handleContextRestored)),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()}postrender(){this.renderer.objectRenderer.renderingToScreen&&this.gl.flush()}validateContext(t){const e=t.getContextAttributes(),n="WebGL2RenderingContext"in globalThis&&t instanceof globalThis.WebGL2RenderingContext;n&&(this.webGLVersion=2),e&&!e.stencil&&console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly");const s=n||!!t.getExtension("OES_element_index_uint");this.supports.uint32Indices=s,s||console.warn("Provided WebGL context does not support 32 index buffer, complex graphics may not render correctly")}}qh.defaultOptions={context:null,antialias:!1,premultipliedAlpha:!0,preserveDrawingBuffer:!1,powerPreference:"default"},qh.extension={type:yl.RendererSystem,name:"context"},wl.add(qh);class Kh extends Pl{upload(t,e,n){const s=t.gl;s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===Nr.UNPACK);const i=e.realWidth,r=e.realHeight;return n.width===i&&n.height===r?s.texSubImage2D(e.target,0,0,0,i,r,e.format,n.type,this.data):(n.width=i,n.height=r,s.texImage2D(e.target,0,n.internalFormat,i,r,0,e.format,n.type,this.data)),!0}}class Zh{constructor(t,e){this.width=Math.round(t||100),this.height=Math.round(e||100),this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new Ml("disposeFramebuffer"),this.multisample=Yr.NONE}get colorTexture(){return this.colorTextures[0]}addColorTexture(t=0,e){return this.colorTextures[t]=e||new Ol(null,{scaleMode:Or.NEAREST,resolution:1,mipmap:Lr.OFF,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this}addDepthTexture(t){return this.depthTexture=t||new Ol(new Kh(null,{width:this.width,height:this.height}),{scaleMode:Or.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:Lr.OFF,format:Rr.DEPTH_COMPONENT,type:kr.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this}enableDepth(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this}enableStencil(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this}resize(t,e){if(t=Math.round(t),e=Math.round(e),t!==this.width||e!==this.height){this.width=t,this.height=e,this.dirtyId++,this.dirtySize++;for(let n=0;n<this.colorTextures.length;n++){const s=this.colorTextures[n],i=s.resolution;s.setSize(t/i,e/i)}if(this.depthTexture){const n=this.depthTexture.resolution;this.depthTexture.setSize(t/n,e/n)}}}dispose(){this.disposeRunner.emit(this,!1)}destroyDepthTexture(){this.depthTexture&&(this.depthTexture.destroy(),this.depthTexture=null,++this.dirtyId,++this.dirtyFormat)}}class Qh extends Ol{constructor(t={}){if("number"==typeof t){t={width:arguments[0],height:arguments[1],scaleMode:arguments[2],resolution:arguments[3]}}t.width=t.width||100,t.height=t.height||100,null!=t.multisample||(t.multisample=Yr.NONE),super(null,t),this.mipmap=Lr.OFF,this.valid=!0,this._clear=new qo([0,0,0,0]),this.framebuffer=new Zh(this.realWidth,this.realHeight).addColorTexture(0,this),this.framebuffer.multisample=t.multisample,this.maskStack=[],this.filterStack=[{}]}set clearColor(t){this._clear.setValue(t)}get clearColor(){return this._clear.value}get clear(){return this._clear}resize(t,e){this.framebuffer.resize(t*this.resolution,e*this.resolution),this.setRealSize(this.framebuffer.width,this.framebuffer.height)}dispose(){this.framebuffer.dispose(),super.dispose()}destroy(){super.destroy(),this.framebuffer.destroyDepthTexture(),this.framebuffer=null}}class Jh extends Rl{constructor(t){const e=t;super(e.naturalWidth||e.videoWidth||e.width,e.naturalHeight||e.videoHeight||e.height),this.source=t,this.noSubImage=!1}static crossOrigin(t,e,n){void 0!==n||e.startsWith("data:")?!1!==n&&(t.crossOrigin="string"==typeof n?n:"anonymous"):t.crossOrigin=function(t,e=globalThis.location){if(t.startsWith("data:"))return"";e=e||globalThis.location,vl||(vl=document.createElement("a")),vl.href=t;const n=uo.parse(vl.href),s=!n.port&&""===e.port||n.port===e.port;return n.hostname===e.hostname&&s&&n.protocol===e.protocol?"":"anonymous"}(e)}upload(t,e,n,s){const i=t.gl,r=e.realWidth,a=e.realHeight;if(s=s||this.source,"undefined"!=typeof HTMLImageElement&&s instanceof HTMLImageElement){if(!s.complete||0===s.naturalWidth)return!1}else if("undefined"!=typeof HTMLVideoElement&&s instanceof HTMLVideoElement&&s.readyState<=1&&0===s.buffered.length)return!1;return i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===Nr.UNPACK),this.noSubImage||e.target!==i.TEXTURE_2D||n.width!==r||n.height!==a?(n.width=r,n.height=a,i.texImage2D(e.target,0,n.internalFormat,e.format,n.type,s)):i.texSubImage2D(i.TEXTURE_2D,0,0,0,e.format,n.type,s),!0}update(){if(this.destroyed)return;const t=this.source,e=t.naturalWidth||t.videoWidth||t.width,n=t.naturalHeight||t.videoHeight||t.height;this.resize(e,n),super.update()}dispose(){this.source=null}}class tc extends Jh{constructor(t,e){var n;if(e=e||{},"string"==typeof t){const n=new Image;Jh.crossOrigin(n,t,e.crossorigin),n.src=t,t=n}super(t),!t.complete&&this._width&&this._height&&(this._width=0,this._height=0),this.url=t.src,this._process=null,this.preserveBitmap=!1,this.createBitmap=(null!=(n=e.createBitmap)?n:zr.CREATE_IMAGE_BITMAP)&&!!globalThis.createImageBitmap,this.alphaMode="number"==typeof e.alphaMode?e.alphaMode:null,this.bitmap=null,this._load=null,!1!==e.autoLoad&&this.load()}load(t){return this._load||(void 0!==t&&(this.createBitmap=t),this._load=new Promise(((t,e)=>{const n=this.source;this.url=n.src;const s=()=>{this.destroyed||(n.onload=null,n.onerror=null,this.resize(n.width,n.height),this._load=null,this.createBitmap?t(this.process()):t(this))};n.complete&&n.src?s():(n.onload=s,n.onerror=t=>{e(t),this.onError.emit(t)})}))),this._load}process(){const t=this.source;if(null!==this._process)return this._process;if(null!==this.bitmap||!globalThis.createImageBitmap)return Promise.resolve(this);const e=globalThis.createImageBitmap,n=!t.crossOrigin||"anonymous"===t.crossOrigin;return this._process=fetch(t.src,{mode:n?"cors":"no-cors"}).then((t=>t.blob())).then((n=>e(n,0,0,t.width,t.height,{premultiplyAlpha:null===this.alphaMode||this.alphaMode===Nr.UNPACK?"premultiply":"none"}))).then((t=>this.destroyed?Promise.reject():(this.bitmap=t,this.update(),this._process=null,Promise.resolve(this)))),this._process}upload(t,e,n){if("number"==typeof this.alphaMode&&(e.alphaMode=this.alphaMode),!this.createBitmap)return super.upload(t,e,n);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(super.upload(t,e,n,this.bitmap),!this.preserveBitmap){let t=!0;const s=e._glTextures;for(const i in s){const r=s[i];if(r!==n&&r.dirtyId!==e.dirtyId){t=!1;break}}t&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0}dispose(){this.source.onload=null,this.source.onerror=null,super.dispose(),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null}static test(t){return"undefined"!=typeof HTMLImageElement&&("string"==typeof t||t instanceof HTMLImageElement)}}class ec{constructor(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}set(t,e,n){const s=e.width,i=e.height;if(n){const e=t.width/2/s,r=t.height/2/i,a=t.x/s+e,o=t.y/i+r;n=ch.add(n,ch.NW),this.x0=a+e*ch.uX(n),this.y0=o+r*ch.uY(n),n=ch.add(n,2),this.x1=a+e*ch.uX(n),this.y1=o+r*ch.uY(n),n=ch.add(n,2),this.x2=a+e*ch.uX(n),this.y2=o+r*ch.uY(n),n=ch.add(n,2),this.x3=a+e*ch.uX(n),this.y3=o+r*ch.uY(n)}else this.x0=t.x/s,this.y0=t.y/i,this.x1=(t.x+t.width)/s,this.y1=t.y/i,this.x2=(t.x+t.width)/s,this.y2=(t.y+t.height)/i,this.x3=t.x/s,this.y3=(t.y+t.height)/i;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3}toString(){return`[@pixi/core:TextureUvs x0=${this.x0} y0=${this.y0} x1=${this.x1} y1=${this.y1} x2=${this.x2} y2=${this.y2} x3=${this.x3} y3=${this.y3}]`}}const nc=new ec;function sc(t){t.destroy=function(){},t.on=function(){},t.once=function(){},t.emit=function(){}}class ic extends ua{constructor(t,e,n,s,i,r,a){if(super(),this.noFrame=!1,e||(this.noFrame=!0,e=new Zl(0,0,1,1)),t instanceof ic&&(t=t.baseTexture),this.baseTexture=t,this._frame=e,this.trim=s,this.valid=!1,this._uvs=nc,this.uvMatrix=null,this.orig=n||e,this._rotate=Number(i||0),!0===i)this._rotate=2;else if(this._rotate%2!=0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");this.defaultAnchor=r?new ql(r.x,r.y):new ql(0,0),this.defaultBorders=a,this._updateID=0,this.textureCacheIds=[],t.valid?this.noFrame?t.valid&&this.onBaseTextureUpdated(t):this.frame=e:t.once("loaded",this.onBaseTextureUpdated,this),this.noFrame&&t.on("update",this.onBaseTextureUpdated,this)}update(){this.baseTexture.resource&&this.baseTexture.resource.update()}onBaseTextureUpdated(t){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=t.width,this._frame.height=t.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)}destroy(t){if(this.baseTexture){if(t){const{resource:t}=this.baseTexture;(null==t?void 0:t.url)&&ul[t.url]&&ic.removeFromCache(t.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,ic.removeFromCache(this),this.textureCacheIds=null}clone(){var t;const e=this._frame.clone(),n=this._frame===this.orig?e:this.orig.clone(),s=new ic(this.baseTexture,!this.noFrame&&e,n,null==(t=this.trim)?void 0:t.clone(),this.rotate,this.defaultAnchor,this.defaultBorders);return this.noFrame&&(s._frame=e),s}updateUvs(){this._uvs===nc&&(this._uvs=new ec),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++}static from(t,e={},n=zr.STRICT_TEXTURE_CACHE){const s="string"==typeof t;let i=null;if(s)i=t;else if(t instanceof Ol){if(!t.cacheId){const n=(null==e?void 0:e.pixiIdPrefix)||"pixiid";t.cacheId=`${n}-${ol()}`,Ol.addToCache(t,t.cacheId)}i=t.cacheId}else{if(!t._pixiId){const n=(null==e?void 0:e.pixiIdPrefix)||"pixiid";t._pixiId=`${n}_${ol()}`}i=t._pixiId}let r=ul[i];if(s&&n&&!r)throw new Error(`The cacheId "${i}" does not exist in TextureCache.`);return r||t instanceof Ol?!r&&t instanceof Ol&&(r=new ic(t),ic.addToCache(r,i)):(e.resolution||(e.resolution=xl(t)),r=new ic(new Ol(t,e)),r.baseTexture.cacheId=i,Ol.addToCache(r.baseTexture,i),ic.addToCache(r,i)),r}static fromURL(t,e){const n=Object.assign({autoLoad:!1},null==e?void 0:e.resourceOptions),s=ic.from(t,Object.assign({resourceOptions:n},e),!1),i=s.baseTexture.resource;return s.baseTexture.valid?Promise.resolve(s):i.load().then((()=>Promise.resolve(s)))}static fromBuffer(t,e,n,s){return new ic(Ol.fromBuffer(t,e,n,s))}static fromLoader(t,e,n,s){const i=new Ol(t,Object.assign({scaleMode:Ol.defaultOptions.scaleMode,resolution:xl(e)},s)),{resource:r}=i;r instanceof tc&&(r.url=e);const a=new ic(i);return n||(n=e),Ol.addToCache(a.baseTexture,n),ic.addToCache(a,n),n!==e&&(Ol.addToCache(a.baseTexture,e),ic.addToCache(a,e)),a.baseTexture.valid?Promise.resolve(a):new Promise((t=>{a.baseTexture.once("loaded",(()=>t(a)))}))}static addToCache(t,e){e&&(t.textureCacheIds.includes(e)||t.textureCacheIds.push(e),ul[e]&&ul[e]!==t&&console.warn(`Texture added to the cache with an id [${e}] that already had an entry`),ul[e]=t)}static removeFromCache(t){if("string"==typeof t){const e=ul[t];if(e){const n=e.textureCacheIds.indexOf(t);return n>-1&&e.textureCacheIds.splice(n,1),delete ul[t],e}}else if(null==t?void 0:t.textureCacheIds){for(let e=0;e<t.textureCacheIds.length;++e)ul[t.textureCacheIds[e]]===t&&delete ul[t.textureCacheIds[e]];return t.textureCacheIds.length=0,t}return null}get resolution(){return this.baseTexture.resolution}get frame(){return this._frame}set frame(t){this._frame=t,this.noFrame=!1;const{x:e,y:n,width:s,height:i}=t,r=e+s>this.baseTexture.width,a=n+i>this.baseTexture.height;if(r||a){const t=r&&a?"and":"or",o=`X: ${e} + ${s} = ${e+s} > ${this.baseTexture.width}`,l=`Y: ${n} + ${i} = ${n+i} > ${this.baseTexture.height}`;throw new Error(`Texture Error: frame does not fit inside the base Texture dimensions: ${o} ${t} ${l}`)}this.valid=s&&i&&this.baseTexture.valid,this.trim||this.rotate||(this.orig=t),this.valid&&this.updateUvs()}get rotate(){return this._rotate}set rotate(t){this._rotate=t,this.valid&&this.updateUvs()}get width(){return this.orig.width}get height(){return this.orig.height}castToBaseTexture(){return this.baseTexture}static get EMPTY(){return ic._EMPTY||(ic._EMPTY=new ic(new Ol),sc(ic._EMPTY),sc(ic._EMPTY.baseTexture)),ic._EMPTY}static get WHITE(){if(!ic._WHITE){const t=zr.ADAPTER.createCanvas(16,16),e=t.getContext("2d");t.width=16,t.height=16,e.fillStyle="white",e.fillRect(0,0,16,16),ic._WHITE=new ic(Ol.from(t)),sc(ic._WHITE),sc(ic._WHITE.baseTexture)}return ic._WHITE}}class rc extends ic{constructor(t,e){super(t,e),this.valid=!0,this.filterFrame=null,this.filterPoolKey=null,this.updateUvs()}get framebuffer(){return this.baseTexture.framebuffer}get multisample(){return this.framebuffer.multisample}set multisample(t){this.framebuffer.multisample=t}resize(t,e,n=!0){const s=this.baseTexture.resolution,i=Math.round(t*s)/s,r=Math.round(e*s)/s;this.valid=i>0&&r>0,this._frame.width=this.orig.width=i,this._frame.height=this.orig.height=r,n&&this.baseTexture.resize(i,r),this.updateUvs()}setResolution(t){const{baseTexture:e}=this;e.resolution!==t&&(e.setResolution(t),this.resize(e.width,e.height,!1))}static create(t){return new rc(new Qh(t))}}class ac{constructor(t){this.texturePool={},this.textureOptions=t||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}createTexture(t,e,n=Yr.NONE){const s=new Qh(Object.assign({width:t,height:e,resolution:1,multisample:n},this.textureOptions));return new rc(s)}getOptimalTexture(t,e,n=1,s=Yr.NONE){let i;t=Math.ceil(t*n-1e-6),e=Math.ceil(e*n-1e-6),this.enableFullScreen&&t===this._pixelsWidth&&e===this._pixelsHeight?i=s>1?-s:-1:(i=((65535&(t=el(t)))<<16|65535&(e=el(e)))>>>0,s>1&&(i+=4294967296*s)),this.texturePool[i]||(this.texturePool[i]=[]);let r=this.texturePool[i].pop();return r||(r=this.createTexture(t,e,s)),r.filterPoolKey=i,r.setResolution(n),r}getFilterTexture(t,e,n){const s=this.getOptimalTexture(t.width,t.height,e||t.resolution,n||Yr.NONE);return s.filterFrame=t.filterFrame,s}returnTexture(t){const e=t.filterPoolKey;t.filterFrame=null,this.texturePool[e].push(t)}returnFilterTexture(t){this.returnTexture(t)}clear(t){if(t=!1!==t)for(const e in this.texturePool){const t=this.texturePool[e];if(t)for(let e=0;e<t.length;e++)t[e].destroy(!0)}this.texturePool={}}setScreenSize(t){if(t.width!==this._pixelsWidth||t.height!==this._pixelsHeight){this.enableFullScreen=t.width>0&&t.height>0;for(const t in this.texturePool){if(!(Number(t)<0))continue;const e=this.texturePool[t];if(e)for(let t=0;t<e.length;t++)e[t].destroy(!0);this.texturePool[t]=[]}this._pixelsWidth=t.width,this._pixelsHeight=t.height}}}ac.SCREEN_KEY=-1;class oc extends Wl{constructor(){super(),this.addAttribute("aVertexPosition",new Float32Array([0,0,1,0,1,1,0,1])).addIndex([0,1,3,2])}}class lc extends Wl{constructor(){super(),this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.vertexBuffer=new Nl(this.vertices),this.uvBuffer=new Nl(this.uvs),this.addAttribute("aVertexPosition",this.vertexBuffer).addAttribute("aTextureCoord",this.uvBuffer).addIndex([0,1,2,0,2,3])}map(t,e){let n=0,s=0;return this.uvs[0]=n,this.uvs[1]=s,this.uvs[2]=n+e.width/t.width,this.uvs[3]=s,this.uvs[4]=n+e.width/t.width,this.uvs[5]=s+e.height/t.height,this.uvs[6]=n,this.uvs[7]=s+e.height/t.height,n=e.x,s=e.y,this.vertices[0]=n,this.vertices[1]=s,this.vertices[2]=n+e.width,this.vertices[3]=s,this.vertices[4]=n+e.width,this.vertices[5]=s+e.height,this.vertices[6]=n,this.vertices[7]=s+e.height,this.invalidate(),this}invalidate(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this}}class hc{constructor(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.multisample=Yr.NONE,this.sourceFrame=new Zl,this.destinationFrame=new Zl,this.bindingSourceFrame=new Zl,this.bindingDestinationFrame=new Zl,this.filters=[],this.transform=null}clear(){this.target=null,this.filters=null,this.renderTexture=null}}const cc=[new ql,new ql,new ql,new ql],uc=new nh;class dc{constructor(t){this.renderer=t,this.defaultFilterStack=[{}],this.texturePool=new ac,this.statePool=[],this.quad=new oc,this.quadUv=new lc,this.tempRect=new Zl,this.activeState={},this.globalUniforms=new Nh({outputFrame:new Zl,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this.forceClear=!1,this.useMaxPadding=!1}init(){this.texturePool.setScreenSize(this.renderer.view)}push(t,e){var n,s;const i=this.renderer,r=this.defaultFilterStack,a=this.statePool.pop()||new hc,o=this.renderer.renderTexture;let l=e[0].resolution,h=e[0].multisample,c=e[0].padding,u=e[0].autoFit,d=null==(n=e[0].legacy)||n;for(let m=1;m<e.length;m++){const t=e[m];l=Math.min(l,t.resolution),h=Math.min(h,t.multisample),c=this.useMaxPadding?Math.max(c,t.padding):c+t.padding,u=u&&t.autoFit,d=d||null==(s=t.legacy)||s}1===r.length&&(this.defaultFilterStack[0].renderTexture=o.current),r.push(a),a.resolution=l,a.multisample=h,a.legacy=d,a.target=t,a.sourceFrame.copyFrom(t.filterArea||t.getBounds(!0)),a.sourceFrame.pad(c);const f=this.tempRect.copyFrom(o.sourceFrame);i.projection.transform&&this.transformAABB(uc.copyFrom(i.projection.transform).invert(),f),u?(a.sourceFrame.fit(f),(a.sourceFrame.width<=0||a.sourceFrame.height<=0)&&(a.sourceFrame.width=0,a.sourceFrame.height=0)):a.sourceFrame.intersects(f)||(a.sourceFrame.width=0,a.sourceFrame.height=0),this.roundFrame(a.sourceFrame,o.current?o.current.resolution:i.resolution,o.sourceFrame,o.destinationFrame,i.projection.transform),a.renderTexture=this.getOptimalFilterTexture(a.sourceFrame.width,a.sourceFrame.height,l,h),a.filters=e,a.destinationFrame.width=a.renderTexture.width,a.destinationFrame.height=a.renderTexture.height;const p=this.tempRect;p.x=0,p.y=0,p.width=a.sourceFrame.width,p.height=a.sourceFrame.height,a.renderTexture.filterFrame=a.sourceFrame,a.bindingSourceFrame.copyFrom(o.sourceFrame),a.bindingDestinationFrame.copyFrom(o.destinationFrame),a.transform=i.projection.transform,i.projection.transform=null,o.bind(a.renderTexture,a.sourceFrame,p),i.framebuffer.clear(0,0,0,0)}pop(){const t=this.defaultFilterStack,e=t.pop(),n=e.filters;this.activeState=e;const s=this.globalUniforms.uniforms;s.outputFrame=e.sourceFrame,s.resolution=e.resolution;const i=s.inputSize,r=s.inputPixel,a=s.inputClamp;if(i[0]=e.destinationFrame.width,i[1]=e.destinationFrame.height,i[2]=1/i[0],i[3]=1/i[1],r[0]=Math.round(i[0]*e.resolution),r[1]=Math.round(i[1]*e.resolution),r[2]=1/r[0],r[3]=1/r[1],a[0]=.5*r[2],a[1]=.5*r[3],a[2]=e.sourceFrame.width*i[2]-.5*r[2],a[3]=e.sourceFrame.height*i[3]-.5*r[3],e.legacy){const t=s.filterArea;t[0]=e.destinationFrame.width,t[1]=e.destinationFrame.height,t[2]=e.sourceFrame.x,t[3]=e.sourceFrame.y,s.filterClamp=s.inputClamp}this.globalUniforms.update();const o=t[t.length-1];if(this.renderer.framebuffer.blit(),1===n.length)n[0].apply(this,e.renderTexture,o.renderTexture,Br.BLEND,e),this.returnFilterTexture(e.renderTexture);else{let t=e.renderTexture,s=this.getOptimalFilterTexture(t.width,t.height,e.resolution);s.filterFrame=t.filterFrame;let i=0;for(i=0;i<n.length-1;++i){1===i&&e.multisample>1&&(s=this.getOptimalFilterTexture(t.width,t.height,e.resolution),s.filterFrame=t.filterFrame),n[i].apply(this,t,s,Br.CLEAR,e);const r=t;t=s,s=r}n[i].apply(this,t,o.renderTexture,Br.BLEND,e),i>1&&e.multisample>1&&this.returnFilterTexture(e.renderTexture),this.returnFilterTexture(t),this.returnFilterTexture(s)}e.clear(),this.statePool.push(e)}bindAndClear(t,e=Br.CLEAR){const{renderTexture:n,state:s}=this.renderer;if(t===this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?this.renderer.projection.transform=this.activeState.transform:this.renderer.projection.transform=null,null==t?void 0:t.filterFrame){const e=this.tempRect;e.x=0,e.y=0,e.width=t.filterFrame.width,e.height=t.filterFrame.height,n.bind(t,t.filterFrame,e)}else t!==this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?n.bind(t):this.renderer.renderTexture.bind(t,this.activeState.bindingSourceFrame,this.activeState.bindingDestinationFrame);const i=1&s.stateId||this.forceClear;(e===Br.CLEAR||e===Br.BLIT&&i)&&this.renderer.framebuffer.clear(0,0,0,0)}applyFilter(t,e,n,s){const i=this.renderer;i.state.set(t.state),this.bindAndClear(n,s),t.uniforms.uSampler=e,t.uniforms.filterGlobals=this.globalUniforms,i.shader.bind(t),t.legacy=!!t.program.attributeData.aTextureCoord,t.legacy?(this.quadUv.map(e._frame,e.filterFrame),i.geometry.bind(this.quadUv),i.geometry.draw(Mr.TRIANGLES)):(i.geometry.bind(this.quad),i.geometry.draw(Mr.TRIANGLE_STRIP))}calculateSpriteMatrix(t,e){const{sourceFrame:n,destinationFrame:s}=this.activeState,{orig:i}=e._texture,r=t.set(s.width,0,0,s.height,n.x,n.y),a=e.worldTransform.copyTo(nh.TEMP_MATRIX);return a.invert(),r.prepend(a),r.scale(1/i.width,1/i.height),r.translate(e.anchor.x,e.anchor.y),r}destroy(){this.renderer=null,this.texturePool.clear(!1)}getOptimalFilterTexture(t,e,n=1,s=Yr.NONE){return this.texturePool.getOptimalTexture(t,e,n,s)}getFilterTexture(t,e,n){if("number"==typeof t){const n=t;t=e,e=n}t=t||this.activeState.renderTexture;const s=this.texturePool.getOptimalTexture(t.width,t.height,e||t.resolution,n||Yr.NONE);return s.filterFrame=t.filterFrame,s}returnFilterTexture(t){this.texturePool.returnTexture(t)}emptyPool(){this.texturePool.clear(!0)}resize(){this.texturePool.setScreenSize(this.renderer.view)}transformAABB(t,e){const n=cc[0],s=cc[1],i=cc[2],r=cc[3];n.set(e.left,e.top),s.set(e.left,e.bottom),i.set(e.right,e.top),r.set(e.right,e.bottom),t.apply(n,n),t.apply(s,s),t.apply(i,i),t.apply(r,r);const a=Math.min(n.x,s.x,i.x,r.x),o=Math.min(n.y,s.y,i.y,r.y),l=Math.max(n.x,s.x,i.x,r.x),h=Math.max(n.y,s.y,i.y,r.y);e.x=a,e.y=o,e.width=l-a,e.height=h-o}roundFrame(t,e,n,s,i){if(!(t.width<=0||t.height<=0||n.width<=0||n.height<=0)){if(i){const{a:t,b:e,c:n,d:s}=i;if((Math.abs(e)>1e-4||Math.abs(n)>1e-4)&&(Math.abs(t)>1e-4||Math.abs(s)>1e-4))return}(i=i?uc.copyFrom(i):uc.identity()).translate(-n.x,-n.y).scale(s.width/n.width,s.height/n.height).translate(s.x,s.y),this.transformAABB(i,t),t.ceil(e),this.transformAABB(i.invert(),t)}}}dc.extension={type:yl.RendererSystem,name:"filter"},wl.add(dc);class fc{constructor(t){this.framebuffer=t,this.stencil=null,this.dirtyId=-1,this.dirtyFormat=-1,this.dirtySize=-1,this.multisample=Yr.NONE,this.msaaBuffer=null,this.blitFramebuffer=null,this.mipLevel=0}}const pc=new Zl;class mc{constructor(t){this.renderer=t,this.managedFramebuffers=[],this.unknownFramebuffer=new Zh(10,10),this.msaaSamples=null}contextChange(){this.disposeAll(!0);const t=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new Zl,this.hasMRT=!0,this.writeDepthTexture=!0,1===this.renderer.context.webGLVersion){let e=this.renderer.context.extensions.drawBuffers,n=this.renderer.context.extensions.depthTexture;zr.PREFER_ENV===Sr.WEBGL_LEGACY&&(e=null,n=null),e?t.drawBuffers=t=>e.drawBuffersWEBGL(t):(this.hasMRT=!1,t.drawBuffers=()=>{}),n||(this.writeDepthTexture=!1)}else this.msaaSamples=t.getInternalformatParameter(t.RENDERBUFFER,t.RGBA8,t.SAMPLES)}bind(t,e,n=0){const{gl:s}=this;if(t){const i=t.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(t);this.current!==t&&(this.current=t,s.bindFramebuffer(s.FRAMEBUFFER,i.framebuffer)),i.mipLevel!==n&&(t.dirtyId++,t.dirtyFormat++,i.mipLevel=n),i.dirtyId!==t.dirtyId&&(i.dirtyId=t.dirtyId,i.dirtyFormat!==t.dirtyFormat?(i.dirtyFormat=t.dirtyFormat,i.dirtySize=t.dirtySize,this.updateFramebuffer(t,n)):i.dirtySize!==t.dirtySize&&(i.dirtySize=t.dirtySize,this.resizeFramebuffer(t)));for(let e=0;e<t.colorTextures.length;e++){const n=t.colorTextures[e];this.renderer.texture.unbind(n.parentTextureArray||n)}if(t.depthTexture&&this.renderer.texture.unbind(t.depthTexture),e){const t=e.width>>n,s=e.height>>n,i=t/e.width;this.setViewport(e.x*i,e.y*i,t,s)}else{const e=t.width>>n,s=t.height>>n;this.setViewport(0,0,e,s)}}else this.current&&(this.current=null,s.bindFramebuffer(s.FRAMEBUFFER,null)),e?this.setViewport(e.x,e.y,e.width,e.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)}setViewport(t,e,n,s){const i=this.viewport;t=Math.round(t),e=Math.round(e),n=Math.round(n),s=Math.round(s),i.width===n&&i.height===s&&i.x===t&&i.y===e||(i.x=t,i.y=e,i.width=n,i.height=s,this.gl.viewport(t,e,n,s))}get size(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}}clear(t,e,n,s,i=Cr.COLOR|Cr.DEPTH){const{gl:r}=this;r.clearColor(t,e,n,s),r.clear(i)}initFramebuffer(t){const{gl:e}=this,n=new fc(e.createFramebuffer());return n.multisample=this.detectSamples(t.multisample),t.glFramebuffers[this.CONTEXT_UID]=n,this.managedFramebuffers.push(t),t.disposeRunner.add(this),n}resizeFramebuffer(t){const{gl:e}=this,n=t.glFramebuffers[this.CONTEXT_UID];n.stencil&&(e.bindRenderbuffer(e.RENDERBUFFER,n.stencil),n.msaaBuffer?e.renderbufferStorageMultisample(e.RENDERBUFFER,n.multisample,e.DEPTH24_STENCIL8,t.width,t.height):e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.width,t.height));const s=t.colorTextures;let i=s.length;e.drawBuffers||(i=Math.min(i,1));for(let r=0;r<i;r++){const i=s[r],a=i.parentTextureArray||i;this.renderer.texture.bind(a,0),0===r&&n.msaaBuffer&&(e.bindRenderbuffer(e.RENDERBUFFER,n.msaaBuffer),e.renderbufferStorageMultisample(e.RENDERBUFFER,n.multisample,a._glTextures[this.CONTEXT_UID].internalFormat,t.width,t.height))}t.depthTexture&&this.writeDepthTexture&&this.renderer.texture.bind(t.depthTexture,0)}updateFramebuffer(t,e){const{gl:n}=this,s=t.glFramebuffers[this.CONTEXT_UID],i=t.colorTextures;let r=i.length;n.drawBuffers||(r=Math.min(r,1)),s.multisample>1&&this.canMultisampleFramebuffer(t)?s.msaaBuffer=s.msaaBuffer||n.createRenderbuffer():s.msaaBuffer&&(n.deleteRenderbuffer(s.msaaBuffer),s.msaaBuffer=null,s.blitFramebuffer&&(s.blitFramebuffer.dispose(),s.blitFramebuffer=null));const a=[];for(let o=0;o<r;o++){const r=i[o],l=r.parentTextureArray||r;this.renderer.texture.bind(l,0),0===o&&s.msaaBuffer?(n.bindRenderbuffer(n.RENDERBUFFER,s.msaaBuffer),n.renderbufferStorageMultisample(n.RENDERBUFFER,s.multisample,l._glTextures[this.CONTEXT_UID].internalFormat,t.width,t.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.RENDERBUFFER,s.msaaBuffer)):(n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+o,r.target,l._glTextures[this.CONTEXT_UID].texture,e),a.push(n.COLOR_ATTACHMENT0+o))}if(a.length>1&&n.drawBuffers(a),t.depthTexture){if(this.writeDepthTexture){const s=t.depthTexture;this.renderer.texture.bind(s,0),n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,s._glTextures[this.CONTEXT_UID].texture,e)}}!t.stencil&&!t.depth||t.depthTexture&&this.writeDepthTexture?s.stencil&&(n.deleteRenderbuffer(s.stencil),s.stencil=null):(s.stencil=s.stencil||n.createRenderbuffer(),n.bindRenderbuffer(n.RENDERBUFFER,s.stencil),s.msaaBuffer?n.renderbufferStorageMultisample(n.RENDERBUFFER,s.multisample,n.DEPTH24_STENCIL8,t.width,t.height):n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,t.width,t.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,s.stencil))}canMultisampleFramebuffer(t){return 1!==this.renderer.context.webGLVersion&&t.colorTextures.length<=1&&!t.depthTexture}detectSamples(t){const{msaaSamples:e}=this;let n=Yr.NONE;if(t<=1||null===e)return n;for(let s=0;s<e.length;s++)if(e[s]<=t){n=e[s];break}return 1===n&&(n=Yr.NONE),n}blit(t,e,n){const{current:s,renderer:i,gl:r,CONTEXT_UID:a}=this;if(2!==i.context.webGLVersion)return;if(!s)return;const o=s.glFramebuffers[a];if(!o)return;if(!t){if(!o.msaaBuffer)return;const e=s.colorTextures[0];if(!e)return;o.blitFramebuffer||(o.blitFramebuffer=new Zh(s.width,s.height),o.blitFramebuffer.addColorTexture(0,e)),(t=o.blitFramebuffer).colorTextures[0]!==e&&(t.colorTextures[0]=e,t.dirtyId++,t.dirtyFormat++),t.width===s.width&&t.height===s.height||(t.width=s.width,t.height=s.height,t.dirtyId++,t.dirtySize++)}e||((e=pc).width=s.width,e.height=s.height),n||(n=e);const l=e.width===n.width&&e.height===n.height;this.bind(t),r.bindFramebuffer(r.READ_FRAMEBUFFER,o.framebuffer),r.blitFramebuffer(e.left,e.top,e.right,e.bottom,n.left,n.top,n.right,n.bottom,r.COLOR_BUFFER_BIT,l?r.NEAREST:r.LINEAR),r.bindFramebuffer(r.READ_FRAMEBUFFER,t.glFramebuffers[this.CONTEXT_UID].framebuffer)}disposeFramebuffer(t,e){const n=t.glFramebuffers[this.CONTEXT_UID],s=this.gl;if(!n)return;delete t.glFramebuffers[this.CONTEXT_UID];const i=this.managedFramebuffers.indexOf(t);i>=0&&this.managedFramebuffers.splice(i,1),t.disposeRunner.remove(this),e||(s.deleteFramebuffer(n.framebuffer),n.msaaBuffer&&s.deleteRenderbuffer(n.msaaBuffer),n.stencil&&s.deleteRenderbuffer(n.stencil)),n.blitFramebuffer&&this.disposeFramebuffer(n.blitFramebuffer,e)}disposeAll(t){const e=this.managedFramebuffers;this.managedFramebuffers=[];for(let n=0;n<e.length;n++)this.disposeFramebuffer(e[n],t)}forceStencil(){const t=this.current;if(!t)return;const e=t.glFramebuffers[this.CONTEXT_UID];if(!e||e.stencil)return;t.stencil=!0;const n=t.width,s=t.height,i=this.gl,r=i.createRenderbuffer();i.bindRenderbuffer(i.RENDERBUFFER,r),e.msaaBuffer?i.renderbufferStorageMultisample(i.RENDERBUFFER,e.multisample,i.DEPTH24_STENCIL8,n,s):i.renderbufferStorage(i.RENDERBUFFER,i.DEPTH_STENCIL,n,s),e.stencil=r,i.framebufferRenderbuffer(i.FRAMEBUFFER,i.DEPTH_STENCIL_ATTACHMENT,i.RENDERBUFFER,r)}reset(){this.current=this.unknownFramebuffer,this.viewport=new Zl}destroy(){this.renderer=null}}mc.extension={type:yl.RendererSystem,name:"framebuffer"},wl.add(mc);const gc={5126:4,5123:2,5121:1};class vc{constructor(t){this.renderer=t,this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.managedGeometries={}}contextChange(){this.disposeAll(!0);const t=this.gl=this.renderer.gl,e=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,2!==e.webGLVersion){let e=this.renderer.context.extensions.vertexArrayObject;zr.PREFER_ENV===Sr.WEBGL_LEGACY&&(e=null),e?(t.createVertexArray=()=>e.createVertexArrayOES(),t.bindVertexArray=t=>e.bindVertexArrayOES(t),t.deleteVertexArray=t=>e.deleteVertexArrayOES(t)):(this.hasVao=!1,t.createVertexArray=()=>null,t.bindVertexArray=()=>null,t.deleteVertexArray=()=>null)}if(2!==e.webGLVersion){const e=t.getExtension("ANGLE_instanced_arrays");e?(t.vertexAttribDivisor=(t,n)=>e.vertexAttribDivisorANGLE(t,n),t.drawElementsInstanced=(t,n,s,i,r)=>e.drawElementsInstancedANGLE(t,n,s,i,r),t.drawArraysInstanced=(t,n,s,i)=>e.drawArraysInstancedANGLE(t,n,s,i)):this.hasInstance=!1}this.canUseUInt32ElementIndex=2===e.webGLVersion||!!e.extensions.uint32ElementIndex}bind(t,e){e=e||this.renderer.shader.shader;const{gl:n}=this;let s=t.glVertexArrayObjects[this.CONTEXT_UID],i=!1;s||(this.managedGeometries[t.id]=t,t.disposeRunner.add(this),t.glVertexArrayObjects[this.CONTEXT_UID]=s={},i=!0);const r=s[e.program.id]||this.initGeometryVao(t,e,i);this._activeGeometry=t,this._activeVao!==r&&(this._activeVao=r,this.hasVao?n.bindVertexArray(r):this.activateVao(t,e.program)),this.updateBuffers()}reset(){this.unbind()}updateBuffers(){const t=this._activeGeometry,e=this.renderer.buffer;for(let n=0;n<t.buffers.length;n++){const s=t.buffers[n];e.update(s)}}checkCompatibility(t,e){const n=t.attributes,s=e.attributeData;for(const i in s)if(!n[i])throw new Error(`shader and geometry incompatible, geometry missing the "${i}" attribute`)}getSignature(t,e){const n=t.attributes,s=e.attributeData,i=["g",t.id];for(const r in n)s[r]&&i.push(r,s[r].location);return i.join("-")}initGeometryVao(t,e,n=!0){const s=this.gl,i=this.CONTEXT_UID,r=this.renderer.buffer,a=e.program;a.glPrograms[i]||this.renderer.shader.generateProgram(e),this.checkCompatibility(t,a);const o=this.getSignature(t,a),l=t.glVertexArrayObjects[this.CONTEXT_UID];let h=l[o];if(h)return l[a.id]=h,h;const c=t.buffers,u=t.attributes,d={},f={};for(const p in c)d[p]=0,f[p]=0;for(const p in u)!u[p].size&&a.attributeData[p]?u[p].size=a.attributeData[p].size:u[p].size||console.warn(`PIXI Geometry attribute '${p}' size cannot be determined (likely the bound shader does not have the attribute)`),d[u[p].buffer]+=u[p].size*gc[u[p].type];for(const p in u){const t=u[p],e=t.size;void 0===t.stride&&(d[t.buffer]===e*gc[t.type]?t.stride=0:t.stride=d[t.buffer]),void 0===t.start&&(t.start=f[t.buffer],f[t.buffer]+=e*gc[t.type])}h=s.createVertexArray(),s.bindVertexArray(h);for(let p=0;p<c.length;p++){const t=c[p];r.bind(t),n&&t._glBuffers[i].refCount++}return this.activateVao(t,a),l[a.id]=h,l[o]=h,s.bindVertexArray(null),r.unbind(Wr.ARRAY_BUFFER),h}disposeGeometry(t,e){var n;if(!this.managedGeometries[t.id])return;delete this.managedGeometries[t.id];const s=t.glVertexArrayObjects[this.CONTEXT_UID],i=this.gl,r=t.buffers,a=null==(n=this.renderer)?void 0:n.buffer;if(t.disposeRunner.remove(this),s){if(a)for(let t=0;t<r.length;t++){const n=r[t]._glBuffers[this.CONTEXT_UID];n&&(n.refCount--,0!==n.refCount||e||a.dispose(r[t],e))}if(!e)for(const t in s)if("g"===t[0]){const e=s[t];this._activeVao===e&&this.unbind(),i.deleteVertexArray(e)}delete t.glVertexArrayObjects[this.CONTEXT_UID]}}disposeAll(t){const e=Object.keys(this.managedGeometries);for(let n=0;n<e.length;n++)this.disposeGeometry(this.managedGeometries[e[n]],t)}activateVao(t,e){const n=this.gl,s=this.CONTEXT_UID,i=this.renderer.buffer,r=t.buffers,a=t.attributes;t.indexBuffer&&i.bind(t.indexBuffer);let o=null;for(const l in a){const t=a[l],h=r[t.buffer],c=h._glBuffers[s];if(e.attributeData[l]){o!==c&&(i.bind(h),o=c);const s=e.attributeData[l].location;if(n.enableVertexAttribArray(s),n.vertexAttribPointer(s,t.size,t.type||n.FLOAT,t.normalized,t.stride,t.start),t.instance){if(!this.hasInstance)throw new Error("geometry error, GPU Instancing is not supported on this device");n.vertexAttribDivisor(s,t.divisor)}}}}draw(t,e,n,s){const{gl:i}=this,r=this._activeGeometry;if(r.indexBuffer){const a=r.indexBuffer.data.BYTES_PER_ELEMENT,o=2===a?i.UNSIGNED_SHORT:i.UNSIGNED_INT;2===a||4===a&&this.canUseUInt32ElementIndex?r.instanced?i.drawElementsInstanced(t,e||r.indexBuffer.data.length,o,(n||0)*a,s||1):i.drawElements(t,e||r.indexBuffer.data.length,o,(n||0)*a):console.warn("unsupported index buffer type: uint32")}else r.instanced?i.drawArraysInstanced(t,n,e||r.getSize(),s||1):i.drawArrays(t,n,e||r.getSize());return this}unbind(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null}destroy(){this.renderer=null}}vc.extension={type:yl.RendererSystem,name:"geometry"},wl.add(vc);const xc=new nh;class yc{constructor(t,e){this._texture=t,this.mapCoord=new nh,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=void 0===e?.5:e,this.isSimple=!1}get texture(){return this._texture}set texture(t){this._texture=t,this._textureID=-1}multiplyUvs(t,e){void 0===e&&(e=t);const n=this.mapCoord;for(let s=0;s<t.length;s+=2){const i=t[s],r=t[s+1];e[s]=i*n.a+r*n.c+n.tx,e[s+1]=i*n.b+r*n.d+n.ty}return e}update(t){const e=this._texture;if(!e||!e.valid)return!1;if(!t&&this._textureID===e._updateID)return!1;this._textureID=e._updateID,this._updateID++;const n=e._uvs;this.mapCoord.set(n.x1-n.x0,n.y1-n.y0,n.x3-n.x0,n.y3-n.y0,n.x0,n.y0);const s=e.orig,i=e.trim;i&&(xc.set(s.width/i.width,0,0,s.height/i.height,-i.x/i.width,-i.y/i.height),this.mapCoord.append(xc));const r=e.baseTexture,a=this.uClampFrame,o=this.clampMargin/r.resolution,l=this.clampOffset;return a[0]=(e._frame.x+o+l)/r.width,a[1]=(e._frame.y+o+l)/r.height,a[2]=(e._frame.x+e._frame.width-o+l)/r.width,a[3]=(e._frame.y+e._frame.height-o+l)/r.height,this.uClampOffset[0]=l/r.realWidth,this.uClampOffset[1]=l/r.realHeight,this.isSimple=e._frame.width===r.width&&e._frame.height===r.height&&0===e.rotate,!0}}class _c extends Gh{constructor(t,e,n){let s=null;"string"!=typeof t&&void 0===e&&void 0===n&&(s=t,t=void 0,e=void 0,n=void 0),super(t||"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 otherMatrix;\n\nvarying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n}\n",e||"varying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform sampler2D mask;\nuniform float alpha;\nuniform float npmAlpha;\nuniform vec4 maskClamp;\n\nvoid main(void)\n{\n    float clip = step(3.5,\n        step(maskClamp.x, vMaskCoord.x) +\n        step(maskClamp.y, vMaskCoord.y) +\n        step(vMaskCoord.x, maskClamp.z) +\n        step(vMaskCoord.y, maskClamp.w));\n\n    vec4 original = texture2D(uSampler, vTextureCoord);\n    vec4 masky = texture2D(mask, vMaskCoord);\n    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);\n\n    original *= (alphaMul * masky.r * alpha * clip);\n\n    gl_FragColor = original;\n}\n",n),this.maskSprite=s,this.maskMatrix=new nh}get maskSprite(){return this._maskSprite}set maskSprite(t){this._maskSprite=t,this._maskSprite&&(this._maskSprite.renderable=!1)}apply(t,e,n,s){const i=this._maskSprite,r=i._texture;r.valid&&(r.uvMatrix||(r.uvMatrix=new yc(r,0)),r.uvMatrix.update(),this.uniforms.npmAlpha=r.baseTexture.alphaMode?0:1,this.uniforms.mask=r,this.uniforms.otherMatrix=t.calculateSpriteMatrix(this.maskMatrix,i).prepend(r.uvMatrix.mapCoord),this.uniforms.alpha=i.worldAlpha,this.uniforms.maskClamp=r.uvMatrix.uClampFrame,t.applyFilter(this,e,n,s))}}class bc{constructor(t=null){this.type=Xr.NONE,this.autoDetect=!0,this.maskObject=t||null,this.pooled=!1,this.isMaskData=!0,this.resolution=null,this.multisample=Gh.defaultMultisample,this.enabled=!0,this.colorMask=15,this._filters=null,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._scissorRectLocal=null,this._colorMask=15,this._target=null}get filter(){return this._filters?this._filters[0]:null}set filter(t){t?this._filters?this._filters[0]=t:this._filters=[t]:this._filters=null}reset(){this.pooled&&(this.maskObject=null,this.type=Xr.NONE,this.autoDetect=!0),this._target=null,this._scissorRectLocal=null}copyCountersOrReset(t){t?(this._stencilCounter=t._stencilCounter,this._scissorCounter=t._scissorCounter,this._scissorRect=t._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)}}class wc{constructor(t){this.renderer=t,this.enableScissor=!0,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],this.alphaMaskIndex=0}setMaskStack(t){this.maskStack=t,this.renderer.scissor.setMaskStack(t),this.renderer.stencil.setMaskStack(t)}push(t,e){let n=e;if(!n.isMaskData){const t=this.maskDataPool.pop()||new bc;t.pooled=!0,t.maskObject=e,n=t}const s=0!==this.maskStack.length?this.maskStack[this.maskStack.length-1]:null;if(n.copyCountersOrReset(s),n._colorMask=s?s._colorMask:15,n.autoDetect&&this.detect(n),n._target=t,n.type!==Xr.SPRITE&&this.maskStack.push(n),n.enabled)switch(n.type){case Xr.SCISSOR:this.renderer.scissor.push(n);break;case Xr.STENCIL:this.renderer.stencil.push(n);break;case Xr.SPRITE:n.copyCountersOrReset(null),this.pushSpriteMask(n);break;case Xr.COLOR:this.pushColorMask(n)}n.type===Xr.SPRITE&&this.maskStack.push(n)}pop(t){const e=this.maskStack.pop();if(e&&e._target===t){if(e.enabled)switch(e.type){case Xr.SCISSOR:this.renderer.scissor.pop(e);break;case Xr.STENCIL:this.renderer.stencil.pop(e.maskObject);break;case Xr.SPRITE:this.popSpriteMask(e);break;case Xr.COLOR:this.popColorMask(e)}if(e.reset(),e.pooled&&this.maskDataPool.push(e),0!==this.maskStack.length){const t=this.maskStack[this.maskStack.length-1];t.type===Xr.SPRITE&&t._filters&&(t._filters[0].maskSprite=t.maskObject)}}}detect(t){const e=t.maskObject;e?e.isSprite?t.type=Xr.SPRITE:this.enableScissor&&this.renderer.scissor.testScissor(t)?t.type=Xr.SCISSOR:t.type=Xr.STENCIL:t.type=Xr.COLOR}pushSpriteMask(t){var e,n;const{maskObject:s}=t,i=t._target;let r=t._filters;r||(r=this.alphaMaskPool[this.alphaMaskIndex],r||(r=this.alphaMaskPool[this.alphaMaskIndex]=[new _c]));const a=this.renderer,o=a.renderTexture;let l,h;if(o.current){const n=o.current;l=t.resolution||n.resolution,h=null!=(e=t.multisample)?e:n.multisample}else l=t.resolution||a.resolution,h=null!=(n=t.multisample)?n:a.multisample;r[0].resolution=l,r[0].multisample=h,r[0].maskSprite=s;const c=i.filterArea;i.filterArea=s.getBounds(!0),a.filter.push(i,r),i.filterArea=c,t._filters||this.alphaMaskIndex++}popSpriteMask(t){this.renderer.filter.pop(),t._filters?t._filters[0].maskSprite=null:(this.alphaMaskIndex--,this.alphaMaskPool[this.alphaMaskIndex][0].maskSprite=null)}pushColorMask(t){const e=t._colorMask,n=t._colorMask=e&t.colorMask;n!==e&&this.renderer.gl.colorMask(0!=(1&n),0!=(2&n),0!=(4&n),0!=(8&n))}popColorMask(t){const e=t._colorMask,n=this.maskStack.length>0?this.maskStack[this.maskStack.length-1]._colorMask:15;n!==e&&this.renderer.gl.colorMask(0!=(1&n),0!=(2&n),0!=(4&n),0!=(8&n))}destroy(){this.renderer=null}}wc.extension={type:yl.RendererSystem,name:"mask"},wl.add(wc);class Ec{constructor(t){this.renderer=t,this.maskStack=[],this.glConst=0}getStackLength(){return this.maskStack.length}setMaskStack(t){const{gl:e}=this.renderer,n=this.getStackLength();this.maskStack=t;const s=this.getStackLength();s!==n&&(0===s?e.disable(this.glConst):(e.enable(this.glConst),this._useCurrent()))}_useCurrent(){}destroy(){this.renderer=null,this.maskStack=null}}const Tc=new nh,Sc=[],Ac=class extends Ec{constructor(t){super(t),this.glConst=zr.ADAPTER.getWebGLRenderingContext().SCISSOR_TEST}getStackLength(){const t=this.maskStack[this.maskStack.length-1];return t?t._scissorCounter:0}calcScissorRect(t){var e;if(t._scissorRectLocal)return;const n=t._scissorRect,{maskObject:s}=t,{renderer:i}=this,r=i.renderTexture,a=s.getBounds(!0,null!=(e=Sc.pop())?e:new Zl);this.roundFrameToPixels(a,r.current?r.current.resolution:i.resolution,r.sourceFrame,r.destinationFrame,i.projection.transform),n&&a.fit(n),t._scissorRectLocal=a}static isMatrixRotated(t){if(!t)return!1;const{a:e,b:n,c:s,d:i}=t;return(Math.abs(n)>1e-4||Math.abs(s)>1e-4)&&(Math.abs(e)>1e-4||Math.abs(i)>1e-4)}testScissor(t){const{maskObject:e}=t;if(!e.isFastRect||!e.isFastRect())return!1;if(Ac.isMatrixRotated(e.worldTransform))return!1;if(Ac.isMatrixRotated(this.renderer.projection.transform))return!1;this.calcScissorRect(t);const n=t._scissorRectLocal;return n.width>0&&n.height>0}roundFrameToPixels(t,e,n,s,i){Ac.isMatrixRotated(i)||((i=i?Tc.copyFrom(i):Tc.identity()).translate(-n.x,-n.y).scale(s.width/n.width,s.height/n.height).translate(s.x,s.y),this.renderer.filter.transformAABB(i,t),t.fit(s),t.x=Math.round(t.x*e),t.y=Math.round(t.y*e),t.width=Math.round(t.width*e),t.height=Math.round(t.height*e))}push(t){t._scissorRectLocal||this.calcScissorRect(t);const{gl:e}=this.renderer;t._scissorRect||e.enable(e.SCISSOR_TEST),t._scissorCounter++,t._scissorRect=t._scissorRectLocal,this._useCurrent()}pop(t){const{gl:e}=this.renderer;t&&Sc.push(t._scissorRectLocal),this.getStackLength()>0?this._useCurrent():e.disable(e.SCISSOR_TEST)}_useCurrent(){const t=this.maskStack[this.maskStack.length-1]._scissorRect;let e;e=this.renderer.renderTexture.current?t.y:this.renderer.height-t.height-t.y,this.renderer.gl.scissor(t.x,e,t.width,t.height)}};let Cc=Ac;Cc.extension={type:yl.RendererSystem,name:"scissor"},wl.add(Cc);class Ic extends Ec{constructor(t){super(t),this.glConst=zr.ADAPTER.getWebGLRenderingContext().STENCIL_TEST}getStackLength(){const t=this.maskStack[this.maskStack.length-1];return t?t._stencilCounter:0}push(t){const e=t.maskObject,{gl:n}=this.renderer,s=t._stencilCounter;0===s&&(this.renderer.framebuffer.forceStencil(),n.clearStencil(0),n.clear(n.STENCIL_BUFFER_BIT),n.enable(n.STENCIL_TEST)),t._stencilCounter++;const i=t._colorMask;0!==i&&(t._colorMask=0,n.colorMask(!1,!1,!1,!1)),n.stencilFunc(n.EQUAL,s,4294967295),n.stencilOp(n.KEEP,n.KEEP,n.INCR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,0!==i&&(t._colorMask=i,n.colorMask(0!=(1&i),0!=(2&i),0!=(4&i),0!=(8&i))),this._useCurrent()}pop(t){const e=this.renderer.gl;if(0===this.getStackLength())e.disable(e.STENCIL_TEST);else{const n=0!==this.maskStack.length?this.maskStack[this.maskStack.length-1]:null,s=n?n._colorMask:15;0!==s&&(n._colorMask=0,e.colorMask(!1,!1,!1,!1)),e.stencilOp(e.KEEP,e.KEEP,e.DECR),t.renderable=!0,t.render(this.renderer),this.renderer.batch.flush(),t.renderable=!1,0!==s&&(n._colorMask=s,e.colorMask(0!=(1&s),0!=(2&s),0!=(4&s),0!=(8&s))),this._useCurrent()}}_useCurrent(){const t=this.renderer.gl;t.stencilFunc(t.EQUAL,this.getStackLength(),4294967295),t.stencilOp(t.KEEP,t.KEEP,t.KEEP)}}Ic.extension={type:yl.RendererSystem,name:"stencil"},wl.add(Ic);class Mc{constructor(t){this.renderer=t,this.plugins={},Object.defineProperties(this.plugins,{extract:{enumerable:!1,get:()=>(vo("7.0.0","renderer.plugins.extract has moved to renderer.extract"),t.extract)},prepare:{enumerable:!1,get:()=>(vo("7.0.0","renderer.plugins.prepare has moved to renderer.prepare"),t.prepare)},interaction:{enumerable:!1,get:()=>(vo("7.0.0","renderer.plugins.interaction has been deprecated, use renderer.events"),t.events)}})}init(){const t=this.rendererPlugins;for(const e in t)this.plugins[e]=new t[e](this.renderer)}destroy(){for(const t in this.plugins)this.plugins[t].destroy(),this.plugins[t]=null}}Mc.extension={type:[yl.RendererSystem,yl.CanvasRendererSystem],name:"_plugin"},wl.add(Mc);class Rc{constructor(t){this.renderer=t,this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new nh,this.transform=null}update(t,e,n,s){this.destinationFrame=t||this.destinationFrame||this.defaultFrame,this.sourceFrame=e||this.sourceFrame||t,this.calculateProjection(this.destinationFrame,this.sourceFrame,n,s),this.transform&&this.projectionMatrix.append(this.transform);const i=this.renderer;i.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,i.globalUniforms.update(),i.shader.shader&&i.shader.syncUniformGroup(i.shader.shader.uniforms.globals)}calculateProjection(t,e,n,s){const i=this.projectionMatrix,r=s?-1:1;i.identity(),i.a=1/e.width*2,i.d=r*(1/e.height*2),i.tx=-1-e.x*i.a,i.ty=-r-e.y*i.d}setTransform(t){}destroy(){this.renderer=null}}Rc.extension={type:yl.RendererSystem,name:"projection"},wl.add(Rc);const Pc=new fh;class kc{constructor(t){this.renderer=t,this._tempMatrix=new nh}generateTexture(t,e){const n=e||{},{region:s}=n,i=f(n,["region"]),r=s||t.getLocalBounds(null,!0);0===r.width&&(r.width=1),0===r.height&&(r.height=1);const a=rc.create(u({width:r.width,height:r.height},i));this._tempMatrix.tx=-r.x,this._tempMatrix.ty=-r.y;const o=t.transform;return t.transform=Pc,this.renderer.render(t,{renderTexture:a,transform:this._tempMatrix,skipUpdateTransform:!!t.parent,blit:!0}),t.transform=o,a}destroy(){}}kc.extension={type:[yl.RendererSystem,yl.CanvasRendererSystem],name:"textureGenerator"},wl.add(kc);const Fc=new Zl,Oc=new Zl;class Dc{constructor(t){this.renderer=t,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new Zl,this.destinationFrame=new Zl,this.viewportFrame=new Zl}contextChange(){var t;const e=null==(t=this.renderer)?void 0:t.gl.getContextAttributes();this._rendererPremultipliedAlpha=!!(e&&e.alpha&&e.premultipliedAlpha)}bind(t=null,e,n){const s=this.renderer;let i,r,a;this.current=t,t?(i=t.baseTexture,a=i.resolution,e||(Fc.width=t.frame.width,Fc.height=t.frame.height,e=Fc),n||(Oc.x=t.frame.x,Oc.y=t.frame.y,Oc.width=e.width,Oc.height=e.height,n=Oc),r=i.framebuffer):(a=s.resolution,e||(Fc.width=s._view.screen.width,Fc.height=s._view.screen.height,e=Fc),n||((n=Fc).width=e.width,n.height=e.height));const o=this.viewportFrame;o.x=n.x*a,o.y=n.y*a,o.width=n.width*a,o.height=n.height*a,t||(o.y=s.view.height-(o.y+o.height)),o.ceil(),this.renderer.framebuffer.bind(r,o),this.renderer.projection.update(n,e,a,!r),t?this.renderer.mask.setMaskStack(i.maskStack):this.renderer.mask.setMaskStack(this.defaultMaskStack),this.sourceFrame.copyFrom(e),this.destinationFrame.copyFrom(n)}clear(t,e){const n=this.current?this.current.baseTexture.clear:this.renderer.background.backgroundColor,s=qo.shared.setValue(t||n);(this.current&&this.current.baseTexture.alphaMode>0||!this.current&&this._rendererPremultipliedAlpha)&&s.premultiply(s.alpha);const i=this.destinationFrame,r=this.current?this.current.baseTexture:this.renderer._view.screen,a=i.width!==r.width||i.height!==r.height;if(a){let{x:t,y:e,width:n,height:s}=this.viewportFrame;t=Math.round(t),e=Math.round(e),n=Math.round(n),s=Math.round(s),this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST),this.renderer.gl.scissor(t,e,n,s)}this.renderer.framebuffer.clear(s.red,s.green,s.blue,s.alpha,e),a&&this.renderer.scissor.pop()}resize(){this.bind(null)}reset(){this.bind(null)}destroy(){this.renderer=null}}Dc.extension={type:yl.RendererSystem,name:"renderTexture"},wl.add(Dc);class Lc{constructor(t,e){this.program=t,this.uniformData=e,this.uniformGroups={},this.uniformDirtyGroups={},this.uniformBufferBindings={}}destroy(){this.uniformData=null,this.uniformGroups=null,this.uniformDirtyGroups=null,this.uniformBufferBindings=null,this.program=null}}function Nc(t,e){var n;const s=ph(t,t.VERTEX_SHADER,e.vertexSrc),i=ph(t,t.FRAGMENT_SHADER,e.fragmentSrc),r=t.createProgram();t.attachShader(r,s),t.attachShader(r,i);const a=null==(n=e.extra)?void 0:n.transformFeedbackVaryings;if(a&&("function"!=typeof t.transformFeedbackVaryings?console.warn("TransformFeedback is not supported but TransformFeedbackVaryings are given."):t.transformFeedbackVaryings(r,a.names,"separate"===a.bufferMode?t.SEPARATE_ATTRIBS:t.INTERLEAVED_ATTRIBS)),t.linkProgram(r),t.getProgramParameter(r,t.LINK_STATUS)||function(t,e,n,s){t.getProgramParameter(e,t.LINK_STATUS)||(t.getShaderParameter(n,t.COMPILE_STATUS)||Th(t,n),t.getShaderParameter(s,t.COMPILE_STATUS)||Th(t,s),console.error("PixiJS Error: Could not initialize shader."),""!==t.getProgramInfoLog(e)&&console.warn("PixiJS Warning: gl.getProgramInfoLog()",t.getProgramInfoLog(e)))}(t,r,s,i),e.attributeData=function(t,e){const n={},s=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES);for(let i=0;i<s;i++){const s=e.getActiveAttrib(t,i);if(s.name.startsWith("gl_"))continue;const r=Mh(e,s.type),a={type:r,name:s.name,size:Ah(r),location:e.getAttribLocation(t,s.name)};n[s.name]=a}return n}(r,t),e.uniformData=function(t,e){const n={},s=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let i=0;i<s;i++){const s=e.getActiveUniform(t,i),r=s.name.replace(/\[.*?\]$/,""),a=!!s.name.match(/\[.*?\]$/),o=Mh(e,s.type);n[r]={name:r,index:i,type:o,size:s.size,isArray:a,value:gh(o,s.size)}}return n}(r,t),!/^[ \t]*#[ \t]*version[ \t]+300[ \t]+es[ \t]*$/m.test(e.vertexSrc)){const n=Object.keys(e.attributeData);n.sort(((t,e)=>t>e?1:-1));for(let s=0;s<n.length;s++)e.attributeData[n[s]].location=s,t.bindAttribLocation(r,s,n[s]);t.linkProgram(r)}t.deleteShader(s),t.deleteShader(i);const o={};for(const l in e.uniformData){const n=e.uniformData[l];o[l]={location:t.getUniformLocation(r,l),value:gh(n.type,n.size)}}return new Lc(r,o)}function Bc(t,e,n,s,i){n.buffer.update(i)}const Vc={float:"\n        data[offset] = v;\n    ",vec2:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n    ",vec3:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n        data[offset+2] = v[2];\n\n    ",vec4:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n        data[offset+2] = v[2];\n        data[offset+3] = v[3];\n    ",mat2:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n\n        data[offset+4] = v[2];\n        data[offset+5] = v[3];\n    ",mat3:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n        data[offset+2] = v[2];\n\n        data[offset + 4] = v[3];\n        data[offset + 5] = v[4];\n        data[offset + 6] = v[5];\n\n        data[offset + 8] = v[6];\n        data[offset + 9] = v[7];\n        data[offset + 10] = v[8];\n    ",mat4:"\n        for(var i = 0; i < 16; i++)\n        {\n            data[offset + i] = v[i];\n        }\n    "},Uc={float:4,vec2:8,vec3:12,vec4:16,int:4,ivec2:8,ivec3:12,ivec4:16,uint:4,uvec2:8,uvec3:12,uvec4:16,bool:4,bvec2:8,bvec3:12,bvec4:16,mat2:32,mat3:48,mat4:64};function Xc(t,e){if(!t.autoManage)return{size:0,syncFunc:Bc};const n=function(t,e){const n=[];for(const s in t)e[s]&&n.push(e[s]);return n.sort(((t,e)=>t.index-e.index)),n}(t.uniforms,e),{uboElements:s,size:i}=function(t){const e=t.map((t=>({data:t,offset:0,dataLen:0,dirty:0})));let n=0,s=0,i=0;for(let r=0;r<e.length;r++){const t=e[r];if(n=Uc[t.data.type],t.data.size>1&&(n=Math.max(n,16)*t.data.size),t.dataLen=n,s%n!=0&&s<16){const t=s%n%16;s+=t,i+=t}s+n>16?(i=16*Math.ceil(i/16),t.offset=i,i+=n,s=n):(t.offset=i,s+=n,i+=n)}return i=16*Math.ceil(i/16),{uboElements:e,size:i}}(n),r=["\n    var v = null;\n    var v2 = null;\n    var cv = null;\n    var t = 0;\n    var gl = renderer.gl\n    var index = 0;\n    var data = buffer.data;\n    "];for(let a=0;a<s.length;a++){const e=s[a],n=t.uniforms[e.data.name],i=e.data.name;let o=!1;for(let t=0;t<vh.length;t++){const s=vh[t];if(s.codeUbo&&s.test(e.data,n)){r.push(`offset = ${e.offset/4};`,vh[t].codeUbo(e.data.name,n)),o=!0;break}}if(!o)if(e.data.size>1){const t=Ah(e.data.type),n=Math.max(Uc[e.data.type]/16,1),s=t/n,a=(4-s%4)%4;r.push(`\n                cv = ud.${i}.value;\n                v = uv.${i};\n                offset = ${e.offset/4};\n\n                t = 0;\n\n                for(var i=0; i < ${e.data.size*n}; i++)\n                {\n                    for(var j = 0; j < ${s}; j++)\n                    {\n                        data[offset++] = v[t++];\n                    }\n                    offset += ${a};\n                }\n\n                `)}else{const t=Vc[e.data.type];r.push(`\n                cv = ud.${i}.value;\n                v = uv.${i};\n                offset = ${e.offset/4};\n                ${t};\n                `)}}return r.push("\n       renderer.buffer.update(buffer);\n    "),{size:i,syncFunc:new Function("ud","uv","renderer","syncData","buffer",r.join("\n"))}}let Yc=0;const Wc={textureCount:0,uboCount:0};class zc{constructor(t){this.destroyed=!1,this.renderer=t,this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this._uboCache={},this.id=Yc++}systemCheck(){if(!function(){if("boolean"==typeof Ph)return Ph;try{const t=new Function("param1","param2","param3","return param1[param2] === param3;");Ph=!0===t({a:"b"},"a","b")}catch(_m){Ph=!1}return Ph}())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")}contextChange(t){this.gl=t,this.reset()}bind(t,e){t.disposeRunner.add(this),t.uniforms.globals=this.renderer.globalUniforms;const n=t.program,s=n.glPrograms[this.renderer.CONTEXT_UID]||this.generateProgram(t);return this.shader=t,this.program!==n&&(this.program=n,this.gl.useProgram(s.program)),e||(Wc.textureCount=0,Wc.uboCount=0,this.syncUniformGroup(t.uniformGroup,Wc)),s}setUniforms(t){const e=this.shader.program,n=e.glPrograms[this.renderer.CONTEXT_UID];e.syncUniforms(n.uniformData,t,this.renderer)}syncUniformGroup(t,e){const n=this.getGlProgram();t.static&&t.dirtyId===n.uniformDirtyGroups[t.id]||(n.uniformDirtyGroups[t.id]=t.dirtyId,this.syncUniforms(t,n,e))}syncUniforms(t,e,n){(t.syncUniforms[this.shader.program.id]||this.createSyncGroups(t))(e.uniformData,t.uniforms,this.renderer,n)}createSyncGroups(t){const e=this.getSignature(t,this.shader.program.uniformData,"u");return this.cache[e]||(this.cache[e]=function(t,e){var n;const s=["\n        var v = null;\n        var cv = null;\n        var cu = null;\n        var t = 0;\n        var gl = renderer.gl;\n    "];for(const i in t.uniforms){const r=e[i];if(!r){(null==(n=t.uniforms[i])?void 0:n.group)&&(t.uniforms[i].ubo?s.push(`\n                        renderer.shader.syncUniformBufferGroup(uv.${i}, '${i}');\n                    `):s.push(`\n                        renderer.shader.syncUniformGroup(uv.${i}, syncData);\n                    `));continue}const a=t.uniforms[i];let o=!1;for(let t=0;t<vh.length;t++)if(vh[t].test(r,a)){s.push(vh[t].code(i,a)),o=!0;break}if(!o){const t=(1!==r.size||r.isArray?yh:xh)[r.type].replace("location",`ud["${i}"].location`);s.push(`\n            cu = ud["${i}"];\n            cv = cu.value;\n            v = uv["${i}"];\n            ${t};`)}}return new Function("ud","uv","renderer","syncData",s.join("\n"))}(t,this.shader.program.uniformData)),t.syncUniforms[this.shader.program.id]=this.cache[e],t.syncUniforms[this.shader.program.id]}syncUniformBufferGroup(t,e){const n=this.getGlProgram();if(!t.static||0!==t.dirtyId||!n.uniformGroups[t.id]){t.dirtyId=0;const s=n.uniformGroups[t.id]||this.createSyncBufferGroup(t,n,e);t.buffer.update(),s(n.uniformData,t.uniforms,this.renderer,Wc,t.buffer)}this.renderer.buffer.bindBufferBase(t.buffer,n.uniformBufferBindings[e])}createSyncBufferGroup(t,e,n){const{gl:s}=this.renderer;this.renderer.buffer.bind(t.buffer);const i=this.gl.getUniformBlockIndex(e.program,n);e.uniformBufferBindings[n]=this.shader.uniformBindCount,s.uniformBlockBinding(e.program,i,this.shader.uniformBindCount),this.shader.uniformBindCount++;const r=this.getSignature(t,this.shader.program.uniformData,"ubo");let a=this._uboCache[r];if(a||(a=this._uboCache[r]=Xc(t,this.shader.program.uniformData)),t.autoManage){const e=new Float32Array(a.size/4);t.buffer.update(e)}return e.uniformGroups[t.id]=a.syncFunc,e.uniformGroups[t.id]}getSignature(t,e,n){const s=t.uniforms,i=[`${n}-`];for(const r in s)i.push(r),e[r]&&i.push(e[r].type);return i.join("-")}getGlProgram(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null}generateProgram(t){const e=this.gl,n=t.program,s=Nc(e,n);return n.glPrograms[this.renderer.CONTEXT_UID]=s,s}reset(){this.program=null,this.shader=null}disposeShader(t){this.shader===t&&(this.shader=null)}destroy(){this.renderer=null,this.destroyed=!0}}zc.extension={type:yl.RendererSystem,name:"shader"},wl.add(zc);class Gc{constructor(t){this.renderer=t}run(t){const{renderer:e}=this;e.runners.init.emit(e.options),t.hello&&console.log(`PixiJS 7.2.4 - ${e.rendererLogId} - https://pixijs.com`),e.resize(e.screen.width,e.screen.height)}destroy(){}}Gc.defaultOptions={hello:!1},Gc.extension={type:[yl.RendererSystem,yl.CanvasRendererSystem],name:"startup"},wl.add(Gc);const Hc=class{constructor(){this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=Ir.NONE,this._blendEq=!1,this.map=[],this.map[0]=this.setBlend,this.map[1]=this.setOffset,this.map[2]=this.setCullFace,this.map[3]=this.setDepthTest,this.map[4]=this.setFrontFace,this.map[5]=this.setDepthMask,this.checks=[],this.defaultState=new Al,this.defaultState.blend=!0}contextChange(t){this.gl=t,this.blendModes=function(t,e=[]){return e[Ir.NORMAL]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Ir.ADD]=[t.ONE,t.ONE],e[Ir.MULTIPLY]=[t.DST_COLOR,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Ir.SCREEN]=[t.ONE,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Ir.OVERLAY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Ir.DARKEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Ir.LIGHTEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Ir.COLOR_DODGE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Ir.COLOR_BURN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Ir.HARD_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Ir.SOFT_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Ir.DIFFERENCE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Ir.EXCLUSION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Ir.HUE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Ir.SATURATION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Ir.COLOR]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Ir.LUMINOSITY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Ir.NONE]=[0,0],e[Ir.NORMAL_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Ir.ADD_NPM]=[t.SRC_ALPHA,t.ONE,t.ONE,t.ONE],e[Ir.SCREEN_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Ir.SRC_IN]=[t.DST_ALPHA,t.ZERO],e[Ir.SRC_OUT]=[t.ONE_MINUS_DST_ALPHA,t.ZERO],e[Ir.SRC_ATOP]=[t.DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[Ir.DST_OVER]=[t.ONE_MINUS_DST_ALPHA,t.ONE],e[Ir.DST_IN]=[t.ZERO,t.SRC_ALPHA],e[Ir.DST_OUT]=[t.ZERO,t.ONE_MINUS_SRC_ALPHA],e[Ir.DST_ATOP]=[t.ONE_MINUS_DST_ALPHA,t.SRC_ALPHA],e[Ir.XOR]=[t.ONE_MINUS_DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[Ir.SUBTRACT]=[t.ONE,t.ONE,t.ONE,t.ONE,t.FUNC_REVERSE_SUBTRACT,t.FUNC_ADD],e}(t),this.set(this.defaultState),this.reset()}set(t){if(t=t||this.defaultState,this.stateId!==t.data){let e=this.stateId^t.data,n=0;for(;e;)1&e&&this.map[n].call(this,!!(t.data&1<<n)),e>>=1,n++;this.stateId=t.data}for(let e=0;e<this.checks.length;e++)this.checks[e](this,t)}forceState(t){t=t||this.defaultState;for(let e=0;e<this.map.length;e++)this.map[e].call(this,!!(t.data&1<<e));for(let e=0;e<this.checks.length;e++)this.checks[e](this,t);this.stateId=t.data}setBlend(t){this.updateCheck(Hc.checkBlendMode,t),this.gl[t?"enable":"disable"](this.gl.BLEND)}setOffset(t){this.updateCheck(Hc.checkPolygonOffset,t),this.gl[t?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)}setDepthTest(t){this.gl[t?"enable":"disable"](this.gl.DEPTH_TEST)}setDepthMask(t){this.gl.depthMask(t)}setCullFace(t){this.gl[t?"enable":"disable"](this.gl.CULL_FACE)}setFrontFace(t){this.gl.frontFace(this.gl[t?"CW":"CCW"])}setBlendMode(t){if(t===this.blendMode)return;this.blendMode=t;const e=this.blendModes[t],n=this.gl;2===e.length?n.blendFunc(e[0],e[1]):n.blendFuncSeparate(e[0],e[1],e[2],e[3]),6===e.length?(this._blendEq=!0,n.blendEquationSeparate(e[4],e[5])):this._blendEq&&(this._blendEq=!1,n.blendEquationSeparate(n.FUNC_ADD,n.FUNC_ADD))}setPolygonOffset(t,e){this.gl.polygonOffset(t,e)}reset(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)}updateCheck(t,e){const n=this.checks.indexOf(t);e&&-1===n?this.checks.push(t):e||-1===n||this.checks.splice(n,1)}static checkBlendMode(t,e){t.setBlendMode(e.blendMode)}static checkPolygonOffset(t,e){t.setPolygonOffset(1,e.polygonOffset)}destroy(){this.gl=null}};let jc=Hc;jc.extension={type:yl.RendererSystem,name:"state"},wl.add(jc);class $c extends ua{constructor(){super(...arguments),this.runners={},this._systemsHash={}}setup(t){var e;this.addRunners(...t.runners);const n=(null!=(e=t.priority)?e:[]).filter((e=>t.systems[e])),s=[...n,...Object.keys(t.systems).filter((t=>!n.includes(t)))];for(const i of s)this.addSystem(t.systems[i],i)}addRunners(...t){t.forEach((t=>{this.runners[t]=new Ml(t)}))}addSystem(t,e){const n=new t(this);if(this[e])throw new Error(`Whoops! The name "${e}" is already in use`);this[e]=n,this._systemsHash[e]=n;for(const s in this.runners)this.runners[s].add(n);return this}emitWithCustomOptions(t,e){const n=Object.keys(this._systemsHash);t.items.forEach((s=>{const i=n.find((t=>this._systemsHash[t]===s));s[t.name](e[i])}))}destroy(){Object.values(this.runners).forEach((t=>{t.destroy()})),this._systemsHash={}}}const qc=class{constructor(t){this.renderer=t,this.count=0,this.checkCount=0,this.maxIdle=qc.defaultMaxIdle,this.checkCountMax=qc.defaultCheckCountMax,this.mode=qc.defaultMode}postrender(){this.renderer.objectRenderer.renderingToScreen&&(this.count++,this.mode!==Vr.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))}run(){const t=this.renderer.texture,e=t.managedTextures;let n=!1;for(let s=0;s<e.length;s++){const i=e[s];!i.framebuffer&&this.count-i.touched>this.maxIdle&&(t.destroyTexture(i,!0),e[s]=null,n=!0)}if(n){let t=0;for(let n=0;n<e.length;n++)null!==e[n]&&(e[t++]=e[n]);e.length=t}}unload(t){const e=this.renderer.texture,n=t._texture;n&&!n.framebuffer&&e.destroyTexture(n);for(let s=t.children.length-1;s>=0;s--)this.unload(t.children[s])}destroy(){this.renderer=null}};let Kc=qc;Kc.defaultMode=Vr.AUTO,Kc.defaultMaxIdle=3600,Kc.defaultCheckCountMax=600,Kc.extension={type:yl.RendererSystem,name:"textureGC"},wl.add(Kc);class Zc{constructor(t){this.texture=t,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=kr.UNSIGNED_BYTE,this.internalFormat=Rr.RGBA,this.samplerType=0}}class Qc{constructor(t){this.renderer=t,this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new Ol,this.hasIntegerTextures=!1}contextChange(){const t=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion,this.internalFormats=function(t){let e;return e="WebGL2RenderingContext"in globalThis&&t instanceof globalThis.WebGL2RenderingContext?{[kr.UNSIGNED_BYTE]:{[Rr.RGBA]:t.RGBA8,[Rr.RGB]:t.RGB8,[Rr.RG]:t.RG8,[Rr.RED]:t.R8,[Rr.RGBA_INTEGER]:t.RGBA8UI,[Rr.RGB_INTEGER]:t.RGB8UI,[Rr.RG_INTEGER]:t.RG8UI,[Rr.RED_INTEGER]:t.R8UI,[Rr.ALPHA]:t.ALPHA,[Rr.LUMINANCE]:t.LUMINANCE,[Rr.LUMINANCE_ALPHA]:t.LUMINANCE_ALPHA},[kr.BYTE]:{[Rr.RGBA]:t.RGBA8_SNORM,[Rr.RGB]:t.RGB8_SNORM,[Rr.RG]:t.RG8_SNORM,[Rr.RED]:t.R8_SNORM,[Rr.RGBA_INTEGER]:t.RGBA8I,[Rr.RGB_INTEGER]:t.RGB8I,[Rr.RG_INTEGER]:t.RG8I,[Rr.RED_INTEGER]:t.R8I},[kr.UNSIGNED_SHORT]:{[Rr.RGBA_INTEGER]:t.RGBA16UI,[Rr.RGB_INTEGER]:t.RGB16UI,[Rr.RG_INTEGER]:t.RG16UI,[Rr.RED_INTEGER]:t.R16UI,[Rr.DEPTH_COMPONENT]:t.DEPTH_COMPONENT16},[kr.SHORT]:{[Rr.RGBA_INTEGER]:t.RGBA16I,[Rr.RGB_INTEGER]:t.RGB16I,[Rr.RG_INTEGER]:t.RG16I,[Rr.RED_INTEGER]:t.R16I},[kr.UNSIGNED_INT]:{[Rr.RGBA_INTEGER]:t.RGBA32UI,[Rr.RGB_INTEGER]:t.RGB32UI,[Rr.RG_INTEGER]:t.RG32UI,[Rr.RED_INTEGER]:t.R32UI,[Rr.DEPTH_COMPONENT]:t.DEPTH_COMPONENT24},[kr.INT]:{[Rr.RGBA_INTEGER]:t.RGBA32I,[Rr.RGB_INTEGER]:t.RGB32I,[Rr.RG_INTEGER]:t.RG32I,[Rr.RED_INTEGER]:t.R32I},[kr.FLOAT]:{[Rr.RGBA]:t.RGBA32F,[Rr.RGB]:t.RGB32F,[Rr.RG]:t.RG32F,[Rr.RED]:t.R32F,[Rr.DEPTH_COMPONENT]:t.DEPTH_COMPONENT32F},[kr.HALF_FLOAT]:{[Rr.RGBA]:t.RGBA16F,[Rr.RGB]:t.RGB16F,[Rr.RG]:t.RG16F,[Rr.RED]:t.R16F},[kr.UNSIGNED_SHORT_5_6_5]:{[Rr.RGB]:t.RGB565},[kr.UNSIGNED_SHORT_4_4_4_4]:{[Rr.RGBA]:t.RGBA4},[kr.UNSIGNED_SHORT_5_5_5_1]:{[Rr.RGBA]:t.RGB5_A1},[kr.UNSIGNED_INT_2_10_10_10_REV]:{[Rr.RGBA]:t.RGB10_A2,[Rr.RGBA_INTEGER]:t.RGB10_A2UI},[kr.UNSIGNED_INT_10F_11F_11F_REV]:{[Rr.RGB]:t.R11F_G11F_B10F},[kr.UNSIGNED_INT_5_9_9_9_REV]:{[Rr.RGB]:t.RGB9_E5},[kr.UNSIGNED_INT_24_8]:{[Rr.DEPTH_STENCIL]:t.DEPTH24_STENCIL8},[kr.FLOAT_32_UNSIGNED_INT_24_8_REV]:{[Rr.DEPTH_STENCIL]:t.DEPTH32F_STENCIL8}}:{[kr.UNSIGNED_BYTE]:{[Rr.RGBA]:t.RGBA,[Rr.RGB]:t.RGB,[Rr.ALPHA]:t.ALPHA,[Rr.LUMINANCE]:t.LUMINANCE,[Rr.LUMINANCE_ALPHA]:t.LUMINANCE_ALPHA},[kr.UNSIGNED_SHORT_5_6_5]:{[Rr.RGB]:t.RGB},[kr.UNSIGNED_SHORT_4_4_4_4]:{[Rr.RGBA]:t.RGBA},[kr.UNSIGNED_SHORT_5_5_5_1]:{[Rr.RGBA]:t.RGBA}},e}(t);const e=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=e;for(let s=0;s<e;s++)this.boundTextures[s]=null;this.emptyTextures={};const n=new Zc(t.createTexture());t.bindTexture(t.TEXTURE_2D,n.texture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[t.TEXTURE_2D]=n,this.emptyTextures[t.TEXTURE_CUBE_MAP]=new Zc(t.createTexture()),t.bindTexture(t.TEXTURE_CUBE_MAP,this.emptyTextures[t.TEXTURE_CUBE_MAP].texture);for(let s=0;s<6;s++)t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+s,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,null);t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MIN_FILTER,t.LINEAR);for(let s=0;s<this.boundTextures.length;s++)this.bind(null,s)}bind(t,e=0){const{gl:n}=this;if((null==(t=null==t?void 0:t.castToBaseTexture())?void 0:t.valid)&&!t.parentTextureArray){t.touched=this.renderer.textureGC.count;const s=t._glTextures[this.CONTEXT_UID]||this.initTexture(t);this.boundTextures[e]!==t&&(this.currentLocation!==e&&(this.currentLocation=e,n.activeTexture(n.TEXTURE0+e)),n.bindTexture(t.target,s.texture)),s.dirtyId!==t.dirtyId?(this.currentLocation!==e&&(this.currentLocation=e,n.activeTexture(n.TEXTURE0+e)),this.updateTexture(t)):s.dirtyStyleId!==t.dirtyStyleId&&this.updateTextureStyle(t),this.boundTextures[e]=t}else this.currentLocation!==e&&(this.currentLocation=e,n.activeTexture(n.TEXTURE0+e)),n.bindTexture(n.TEXTURE_2D,this.emptyTextures[n.TEXTURE_2D].texture),this.boundTextures[e]=null}reset(){this._unknownBoundTextures=!0,this.hasIntegerTextures=!1,this.currentLocation=-1;for(let t=0;t<this.boundTextures.length;t++)this.boundTextures[t]=this.unknownTexture}unbind(t){const{gl:e,boundTextures:n}=this;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(let t=0;t<n.length;t++)n[t]===this.unknownTexture&&this.bind(null,t)}for(let s=0;s<n.length;s++)n[s]===t&&(this.currentLocation!==s&&(e.activeTexture(e.TEXTURE0+s),this.currentLocation=s),e.bindTexture(t.target,this.emptyTextures[t.target].texture),n[s]=null)}ensureSamplerType(t){const{boundTextures:e,hasIntegerTextures:n,CONTEXT_UID:s}=this;if(n)for(let i=t-1;i>=0;--i){const t=e[i];if(t){t._glTextures[s].samplerType!==Fr.FLOAT&&this.renderer.texture.unbind(t)}}}initTexture(t){const e=new Zc(this.gl.createTexture());return e.dirtyId=-1,t._glTextures[this.CONTEXT_UID]=e,this.managedTextures.push(t),t.on("dispose",this.destroyTexture,this),e}initTextureType(t,e){var n,s;e.internalFormat=null!=(s=null==(n=this.internalFormats[t.type])?void 0:n[t.format])?s:t.format,2===this.webGLVersion&&t.type===kr.HALF_FLOAT?e.type=this.gl.HALF_FLOAT:e.type=t.type}updateTexture(t){var e;const n=t._glTextures[this.CONTEXT_UID];if(!n)return;const s=this.renderer;if(this.initTextureType(t,n),null==(e=t.resource)?void 0:e.upload(s,t,n))n.samplerType!==Fr.FLOAT&&(this.hasIntegerTextures=!0);else{const e=t.realWidth,i=t.realHeight,r=s.gl;(n.width!==e||n.height!==i||n.dirtyId<0)&&(n.width=e,n.height=i,r.texImage2D(t.target,0,n.internalFormat,e,i,0,t.format,n.type,null))}t.dirtyStyleId!==n.dirtyStyleId&&this.updateTextureStyle(t),n.dirtyId=t.dirtyId}destroyTexture(t,e){const{gl:n}=this;if((t=t.castToBaseTexture())._glTextures[this.CONTEXT_UID]&&(this.unbind(t),n.deleteTexture(t._glTextures[this.CONTEXT_UID].texture),t.off("dispose",this.destroyTexture,this),delete t._glTextures[this.CONTEXT_UID],!e)){const e=this.managedTextures.indexOf(t);-1!==e&&il(this.managedTextures,e,1)}}updateTextureStyle(t){var e;const n=t._glTextures[this.CONTEXT_UID];n&&(t.mipmap!==Lr.POW2&&2===this.webGLVersion||t.isPowerOfTwo?n.mipmap=t.mipmap>=1:n.mipmap=!1,2===this.webGLVersion||t.isPowerOfTwo?n.wrapMode=t.wrapMode:n.wrapMode=Dr.CLAMP,(null==(e=t.resource)?void 0:e.style(this.renderer,t,n))||this.setStyle(t,n),n.dirtyStyleId=t.dirtyStyleId)}setStyle(t,e){const n=this.gl;if(e.mipmap&&t.mipmap!==Lr.ON_MANUAL&&n.generateMipmap(t.target),n.texParameteri(t.target,n.TEXTURE_WRAP_S,e.wrapMode),n.texParameteri(t.target,n.TEXTURE_WRAP_T,e.wrapMode),e.mipmap){n.texParameteri(t.target,n.TEXTURE_MIN_FILTER,t.scaleMode===Or.LINEAR?n.LINEAR_MIPMAP_LINEAR:n.NEAREST_MIPMAP_NEAREST);const e=this.renderer.context.extensions.anisotropicFiltering;if(e&&t.anisotropicLevel>0&&t.scaleMode===Or.LINEAR){const s=Math.min(t.anisotropicLevel,n.getParameter(e.MAX_TEXTURE_MAX_ANISOTROPY_EXT));n.texParameterf(t.target,e.TEXTURE_MAX_ANISOTROPY_EXT,s)}}else n.texParameteri(t.target,n.TEXTURE_MIN_FILTER,t.scaleMode===Or.LINEAR?n.LINEAR:n.NEAREST);n.texParameteri(t.target,n.TEXTURE_MAG_FILTER,t.scaleMode===Or.LINEAR?n.LINEAR:n.NEAREST)}destroy(){this.renderer=null}}Qc.extension={type:yl.RendererSystem,name:"texture"},wl.add(Qc);class Jc{constructor(t){this.renderer=t}contextChange(){this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(t){const{gl:e,CONTEXT_UID:n}=this,s=t._glTransformFeedbacks[n]||this.createGLTransformFeedback(t);e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,s)}unbind(){const{gl:t}=this;t.bindTransformFeedback(t.TRANSFORM_FEEDBACK,null)}beginTransformFeedback(t,e){const{gl:n,renderer:s}=this;e&&s.shader.bind(e),n.beginTransformFeedback(t)}endTransformFeedback(){const{gl:t}=this;t.endTransformFeedback()}createGLTransformFeedback(t){const{gl:e,renderer:n,CONTEXT_UID:s}=this,i=e.createTransformFeedback();t._glTransformFeedbacks[s]=i,e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,i);for(let r=0;r<t.buffers.length;r++){const i=t.buffers[r];i&&(n.buffer.update(i),i._glBuffers[s].refCount++,e.bindBufferBase(e.TRANSFORM_FEEDBACK_BUFFER,r,i._glBuffers[s].buffer||null))}return e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,null),t.disposeRunner.add(this),i}disposeTransformFeedback(t,e){const n=t._glTransformFeedbacks[this.CONTEXT_UID],s=this.gl;t.disposeRunner.remove(this);const i=this.renderer.buffer;if(i)for(let r=0;r<t.buffers.length;r++){const n=t.buffers[r];if(!n)continue;const s=n._glBuffers[this.CONTEXT_UID];s&&(s.refCount--,0!==s.refCount||e||i.dispose(n,e))}n&&(e||s.deleteTransformFeedback(n),delete t._glTransformFeedbacks[this.CONTEXT_UID])}destroy(){this.renderer=null}}Jc.extension={type:yl.RendererSystem,name:"transformFeedback"},wl.add(Jc);class tu{constructor(t){this.renderer=t}init(t){this.screen=new Zl(0,0,t.width,t.height),this.element=t.view||zr.ADAPTER.createCanvas(),this.resolution=t.resolution||zr.RESOLUTION,this.autoDensity=!!t.autoDensity}resizeView(t,e){this.element.width=Math.round(t*this.resolution),this.element.height=Math.round(e*this.resolution);const n=this.element.width/this.resolution,s=this.element.height/this.resolution;this.screen.width=n,this.screen.height=s,this.autoDensity&&(this.element.style.width=`${n}px`,this.element.style.height=`${s}px`),this.renderer.emit("resize",n,s),this.renderer.runners.resize.emit(this.screen.width,this.screen.height)}destroy(t){var e;t&&(null==(e=this.element.parentNode)||e.removeChild(this.element)),this.renderer=null,this.element=null,this.screen=null}}tu.defaultOptions={width:800,height:600,resolution:zr.RESOLUTION,autoDensity:!1},tu.extension={type:[yl.RendererSystem,yl.CanvasRendererSystem],name:"_view"},wl.add(tu),zr.PREFER_ENV=Sr.WEBGL2,zr.STRICT_TEXTURE_CACHE=!1,zr.RENDER_OPTIONS=u(u(u(u({},qh.defaultOptions),Hh.defaultOptions),tu.defaultOptions),Gc.defaultOptions),Object.defineProperties(zr,{WRAP_MODE:{get:()=>Ol.defaultOptions.wrapMode,set(t){vo("7.1.0","settings.WRAP_MODE is deprecated, use BaseTexture.defaultOptions.wrapMode"),Ol.defaultOptions.wrapMode=t}},SCALE_MODE:{get:()=>Ol.defaultOptions.scaleMode,set(t){vo("7.1.0","settings.SCALE_MODE is deprecated, use BaseTexture.defaultOptions.scaleMode"),Ol.defaultOptions.scaleMode=t}},MIPMAP_TEXTURES:{get:()=>Ol.defaultOptions.mipmap,set(t){vo("7.1.0","settings.MIPMAP_TEXTURES is deprecated, use BaseTexture.defaultOptions.mipmap"),Ol.defaultOptions.mipmap=t}},ANISOTROPIC_LEVEL:{get:()=>Ol.defaultOptions.anisotropicLevel,set(t){vo("7.1.0","settings.ANISOTROPIC_LEVEL is deprecated, use BaseTexture.defaultOptions.anisotropicLevel"),Ol.defaultOptions.anisotropicLevel=t}},FILTER_RESOLUTION:{get:()=>(vo("7.1.0","settings.FILTER_RESOLUTION is deprecated, use Filter.defaultResolution"),Gh.defaultResolution),set(t){Gh.defaultResolution=t}},FILTER_MULTISAMPLE:{get:()=>(vo("7.1.0","settings.FILTER_MULTISAMPLE is deprecated, use Filter.defaultMultisample"),Gh.defaultMultisample),set(t){Gh.defaultMultisample=t}},SPRITE_MAX_TEXTURES:{get:()=>Wh.defaultMaxTextures,set(t){vo("7.1.0","settings.SPRITE_MAX_TEXTURES is deprecated, use BatchRenderer.defaultMaxTextures"),Wh.defaultMaxTextures=t}},SPRITE_BATCH_SIZE:{get:()=>Wh.defaultBatchSize,set(t){vo("7.1.0","settings.SPRITE_BATCH_SIZE is deprecated, use BatchRenderer.defaultBatchSize"),Wh.defaultBatchSize=t}},CAN_UPLOAD_SAME_BUFFER:{get:()=>Wh.canUploadSameBuffer,set(t){vo("7.1.0","settings.CAN_UPLOAD_SAME_BUFFER is deprecated, use BatchRenderer.canUploadSameBuffer"),Wh.canUploadSameBuffer=t}},GC_MODE:{get:()=>Kc.defaultMode,set(t){vo("7.1.0","settings.GC_MODE is deprecated, use TextureGCSystem.defaultMode"),Kc.defaultMode=t}},GC_MAX_IDLE:{get:()=>Kc.defaultMaxIdle,set(t){vo("7.1.0","settings.GC_MAX_IDLE is deprecated, use TextureGCSystem.defaultMaxIdle"),Kc.defaultMaxIdle=t}},GC_MAX_CHECK_COUNT:{get:()=>Kc.defaultCheckCountMax,set(t){vo("7.1.0","settings.GC_MAX_CHECK_COUNT is deprecated, use TextureGCSystem.defaultCheckCountMax"),Kc.defaultCheckCountMax=t}},PRECISION_VERTEX:{get:()=>Dh.defaultVertexPrecision,set(t){vo("7.1.0","settings.PRECISION_VERTEX is deprecated, use Program.defaultVertexPrecision"),Dh.defaultVertexPrecision=t}},PRECISION_FRAGMENT:{get:()=>Dh.defaultFragmentPrecision,set(t){vo("7.1.0","settings.PRECISION_FRAGMENT is deprecated, use Program.defaultFragmentPrecision"),Dh.defaultFragmentPrecision=t}}});var eu=(t=>(t[t.INTERACTION=50]="INTERACTION",t[t.HIGH=25]="HIGH",t[t.NORMAL=0]="NORMAL",t[t.LOW=-25]="LOW",t[t.UTILITY=-50]="UTILITY",t))(eu||{});class nu{constructor(t,e=null,n=0,s=!1){this.next=null,this.previous=null,this._destroyed=!1,this.fn=t,this.context=e,this.priority=n,this.once=s}match(t,e=null){return this.fn===t&&this.context===e}emit(t){this.fn&&(this.context?this.fn.call(this.context,t):this.fn(t));const e=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),e}connect(t){this.previous=t,t.next&&(t.next.previous=this),this.next=t.next,t.next=this}destroy(t=!1){this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);const e=this.next;return this.next=t?null:e,this.previous=null,e}}const su=class{constructor(){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new nu(null,null,1/0),this.deltaMS=1/su.targetFPMS,this.elapsedMS=1/su.targetFPMS,this._tick=t=>{this._requestId=null,this.started&&(this.update(t),this.started&&null===this._requestId&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}_requestIfNeeded(){null===this._requestId&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){null!==this._requestId&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}add(t,e,n=eu.NORMAL){return this._addListener(new nu(t,e,n))}addOnce(t,e,n=eu.NORMAL){return this._addListener(new nu(t,e,n,!0))}_addListener(t){let e=this._head.next,n=this._head;if(e){for(;e;){if(t.priority>e.priority){t.connect(n);break}n=e,e=e.next}t.previous||t.connect(n)}else t.connect(n);return this._startIfPossible(),this}remove(t,e){let n=this._head.next;for(;n;)n=n.match(t,e)?n.destroy():n.next;return this._head.next||this._cancelIfNeeded(),this}get count(){if(!this._head)return 0;let t=0,e=this._head;for(;e=e.next;)t++;return t}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let t=this._head.next;for(;t;)t=t.destroy(!0);this._head.destroy(),this._head=null}}update(t=performance.now()){let e;if(t>this.lastTime){if(e=this.elapsedMS=t-this.lastTime,e>this._maxElapsedMS&&(e=this._maxElapsedMS),e*=this.speed,this._minElapsedMS){const e=t-this._lastFrame|0;if(e<this._minElapsedMS)return;this._lastFrame=t-e%this._minElapsedMS}this.deltaMS=e,this.deltaTime=this.deltaMS*su.targetFPMS;const n=this._head;let s=n.next;for(;s;)s=s.emit(this.deltaTime);n.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=t}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this._maxElapsedMS}set minFPS(t){const e=Math.min(this.maxFPS,t),n=Math.min(Math.max(0,e)/1e3,su.targetFPMS);this._maxElapsedMS=1/n}get maxFPS(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0}set maxFPS(t){if(0===t)this._minElapsedMS=0;else{const e=Math.max(this.minFPS,t);this._minElapsedMS=1/(e/1e3)}}static get shared(){if(!su._shared){const t=su._shared=new su;t.autoStart=!0,t._protected=!0}return su._shared}static get system(){if(!su._system){const t=su._system=new su;t.autoStart=!0,t._protected=!0}return su._system}};let iu=su;iu.targetFPMS=.06,Object.defineProperties(zr,{TARGET_FPMS:{get:()=>iu.targetFPMS,set(t){vo("7.1.0","settings.TARGET_FPMS is deprecated, use Ticker.targetFPMS"),iu.targetFPMS=t}}});class ru{static init(t){t=Object.assign({autoStart:!0,sharedTicker:!1},t),Object.defineProperty(this,"ticker",{set(t){this._ticker&&this._ticker.remove(this.render,this),this._ticker=t,t&&t.add(this.render,this,eu.LOW)},get(){return this._ticker}}),this.stop=()=>{this._ticker.stop()},this.start=()=>{this._ticker.start()},this._ticker=null,this.ticker=t.sharedTicker?iu.shared:new iu,t.autoStart&&this.start()}static destroy(){if(this._ticker){const t=this._ticker;this.ticker=null,t.destroy()}}}ru.extension=yl.Application,wl.add(ru);const au=[];wl.handleByList(yl.Renderer,au);const ou="attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n";class lu{constructor(t){this.renderer=t}contextChange(t){let e;if(1===this.renderer.context.webGLVersion){const n=t.getParameter(t.FRAMEBUFFER_BINDING);t.bindFramebuffer(t.FRAMEBUFFER,null),e=t.getParameter(t.SAMPLES),t.bindFramebuffer(t.FRAMEBUFFER,n)}else{const n=t.getParameter(t.DRAW_FRAMEBUFFER_BINDING);t.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),e=t.getParameter(t.SAMPLES),t.bindFramebuffer(t.DRAW_FRAMEBUFFER,n)}e>=Yr.HIGH?this.multisample=Yr.HIGH:e>=Yr.MEDIUM?this.multisample=Yr.MEDIUM:e>=Yr.LOW?this.multisample=Yr.LOW:this.multisample=Yr.NONE}destroy(){}}lu.extension={type:yl.RendererSystem,name:"_multisample"},wl.add(lu);class hu{constructor(t){this.buffer=t||null,this.updateID=-1,this.byteLength=-1,this.refCount=0}}class cu{constructor(t){this.renderer=t,this.managedBuffers={},this.boundBufferBases={}}destroy(){this.renderer=null}contextChange(){this.disposeAll(!0),this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(t){const{gl:e,CONTEXT_UID:n}=this,s=t._glBuffers[n]||this.createGLBuffer(t);e.bindBuffer(t.type,s.buffer)}unbind(t){const{gl:e}=this;e.bindBuffer(t,null)}bindBufferBase(t,e){const{gl:n,CONTEXT_UID:s}=this;if(this.boundBufferBases[e]!==t){const i=t._glBuffers[s]||this.createGLBuffer(t);this.boundBufferBases[e]=t,n.bindBufferBase(n.UNIFORM_BUFFER,e,i.buffer)}}bindBufferRange(t,e,n){const{gl:s,CONTEXT_UID:i}=this;n=n||0;const r=t._glBuffers[i]||this.createGLBuffer(t);s.bindBufferRange(s.UNIFORM_BUFFER,e||0,r.buffer,256*n,256)}update(t){const{gl:e,CONTEXT_UID:n}=this,s=t._glBuffers[n]||this.createGLBuffer(t);if(t._updateID!==s.updateID)if(s.updateID=t._updateID,e.bindBuffer(t.type,s.buffer),s.byteLength>=t.data.byteLength)e.bufferSubData(t.type,0,t.data);else{const n=t.static?e.STATIC_DRAW:e.DYNAMIC_DRAW;s.byteLength=t.data.byteLength,e.bufferData(t.type,t.data,n)}}dispose(t,e){if(!this.managedBuffers[t.id])return;delete this.managedBuffers[t.id];const n=t._glBuffers[this.CONTEXT_UID],s=this.gl;t.disposeRunner.remove(this),n&&(e||s.deleteBuffer(n.buffer),delete t._glBuffers[this.CONTEXT_UID])}disposeAll(t){const e=Object.keys(this.managedBuffers);for(let n=0;n<e.length;n++)this.dispose(this.managedBuffers[e[n]],t)}createGLBuffer(t){const{CONTEXT_UID:e,gl:n}=this;return t._glBuffers[e]=new hu(n.createBuffer()),this.managedBuffers[t.id]=t,t.disposeRunner.add(this),t._glBuffers[e]}}cu.extension={type:yl.RendererSystem,name:"buffer"},wl.add(cu);class uu{constructor(t){this.renderer=t}render(t,e){const n=this.renderer;let s,i,r,a;if(e&&(s=e.renderTexture,i=e.clear,r=e.transform,a=e.skipUpdateTransform),this.renderingToScreen=!s,n.runners.prerender.emit(),n.emit("prerender"),n.projection.transform=r,!n.context.isLost){if(s||(this.lastObjectRendered=t),!a){const e=t.enableTempParent();t.updateTransform(),t.disableTempParent(e)}n.renderTexture.bind(s),n.batch.currentRenderer.start(),(null!=i?i:n.background.clearBeforeRender)&&n.renderTexture.clear(),t.render(n),n.batch.currentRenderer.flush(),s&&(e.blit&&n.framebuffer.blit(),s.baseTexture.update()),n.runners.postrender.emit(),n.projection.transform=null,n.emit("postrender")}}destroy(){this.renderer=null,this.lastObjectRendered=null}}uu.extension={type:yl.RendererSystem,name:"objectRenderer"},wl.add(uu);const du=class extends $c{constructor(t){super(),this.type=Ar.WEBGL,t=Object.assign({},zr.RENDER_OPTIONS,t),this.gl=null,this.CONTEXT_UID=0,this.globalUniforms=new Nh({projectionMatrix:new nh},!0);const e={runners:["init","destroy","contextChange","resolutionChange","reset","update","postrender","prerender","resize"],systems:du.__systems,priority:["_view","textureGenerator","background","_plugin","startup","context","state","texture","buffer","geometry","framebuffer","transformFeedback","mask","scissor","stencil","projection","textureGC","filter","renderTexture","batch","objectRenderer","_multisample"]};this.setup(e),"useContextAlpha"in t&&(vo("7.0.0","options.useContextAlpha is deprecated, use options.premultipliedAlpha and options.backgroundAlpha instead"),t.premultipliedAlpha=t.useContextAlpha&&"notMultiplied"!==t.useContextAlpha,t.backgroundAlpha=!1===t.useContextAlpha?1:t.backgroundAlpha),this._plugin.rendererPlugins=du.__plugins,this.options=t,this.startup.run(this.options)}static test(t){return!(null==t?void 0:t.forceCanvas)&&(void 0===xo&&(xo=function(){var t;const e={stencil:!0,failIfMajorPerformanceCaveat:zr.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!zr.ADAPTER.getWebGLRenderingContext())return!1;const n=zr.ADAPTER.createCanvas();let s=n.getContext("webgl",e)||n.getContext("experimental-webgl",e);const i=!!(null==(t=null==s?void 0:s.getContextAttributes())?void 0:t.stencil);if(s){const t=s.getExtension("WEBGL_lose_context");t&&t.loseContext()}return s=null,i}catch(_m){return!1}}()),xo)}render(t,e){this.objectRenderer.render(t,e)}resize(t,e){this._view.resizeView(t,e)}reset(){return this.runners.reset.emit(),this}clear(){this.renderTexture.bind(),this.renderTexture.clear()}destroy(t=!1){this.runners.destroy.items.reverse(),this.emitWithCustomOptions(this.runners.destroy,{_view:t}),super.destroy()}get plugins(){return this._plugin.plugins}get multisample(){return this._multisample.multisample}get width(){return this._view.element.width}get height(){return this._view.element.height}get resolution(){return this._view.resolution}set resolution(t){this._view.resolution=t,this.runners.resolutionChange.emit(t)}get autoDensity(){return this._view.autoDensity}get view(){return this._view.element}get screen(){return this._view.screen}get lastObjectRendered(){return this.objectRenderer.lastObjectRendered}get renderingToScreen(){return this.objectRenderer.renderingToScreen}get rendererLogId(){return`WebGL ${this.context.webGLVersion}`}get clearBeforeRender(){return vo("7.0.0","renderer.clearBeforeRender has been deprecated, please use renderer.background.clearBeforeRender instead."),this.background.clearBeforeRender}get useContextAlpha(){return vo("7.0.0","renderer.useContextAlpha has been deprecated, please use renderer.context.premultipliedAlpha instead."),this.context.useContextAlpha}get preserveDrawingBuffer(){return vo("7.0.0","renderer.preserveDrawingBuffer has been deprecated, we cannot truly know this unless pixi created the context"),this.context.preserveDrawingBuffer}get backgroundColor(){return vo("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color}set backgroundColor(t){vo("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color=t}get backgroundAlpha(){return vo("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha}set backgroundAlpha(t){vo("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha=t}get powerPreference(){return vo("7.0.0","renderer.powerPreference has been deprecated, we can only know this if pixi creates the context"),this.context.powerPreference}generateTexture(t,e){return this.textureGenerator.generateTexture(t,e)}};let fu=du;fu.extension={type:yl.Renderer,priority:1},fu.__plugins={},fu.__systems={},wl.handleByMap(yl.RendererPlugin,fu.__plugins),wl.handleByMap(yl.RendererSystem,fu.__systems),wl.add(fu);class pu extends Rl{constructor(t,e){const{width:n,height:s}=e||{};super(n,s),this.items=[],this.itemDirtyIds=[];for(let i=0;i<t;i++){const t=new Ol;this.items.push(t),this.itemDirtyIds.push(-2)}this.length=t,this._load=null,this.baseTexture=null}initFromArray(t,e){for(let n=0;n<this.length;n++)t[n]&&(t[n].castToBaseTexture?this.addBaseTextureAt(t[n].castToBaseTexture(),n):t[n]instanceof Rl?this.addResourceAt(t[n],n):this.addResourceAt(Il(t[n],e),n))}dispose(){for(let t=0,e=this.length;t<e;t++)this.items[t].destroy();this.items=null,this.itemDirtyIds=null,this._load=null}addResourceAt(t,e){if(!this.items[e])throw new Error(`Index ${e} is out of bounds`);return t.valid&&!this.valid&&this.resize(t.width,t.height),this.items[e].setResource(t),this}bind(t){if(null!==this.baseTexture)throw new Error("Only one base texture per TextureArray is allowed");super.bind(t);for(let e=0;e<this.length;e++)this.items[e].parentTextureArray=t,this.items[e].on("update",t.update,t)}unbind(t){super.unbind(t);for(let e=0;e<this.length;e++)this.items[e].parentTextureArray=null,this.items[e].off("update",t.update,t)}load(){if(this._load)return this._load;const t=this.items.map((t=>t.resource)).filter((t=>t)).map((t=>t.load()));return this._load=Promise.all(t).then((()=>{const{realWidth:t,realHeight:e}=this.items[0];return this.resize(t,e),Promise.resolve(this)})),this._load}}const mu=class extends pu{constructor(t,e){const{width:n,height:s,autoLoad:i,linkBaseTexture:r}=e||{};if(t&&t.length!==mu.SIDES)throw new Error(`Invalid length. Got ${t.length}, expected 6`);super(6,{width:n,height:s});for(let a=0;a<mu.SIDES;a++)this.items[a].target=Pr.TEXTURE_CUBE_MAP_POSITIVE_X+a;this.linkBaseTexture=!1!==r,t&&this.initFromArray(t,e),!1!==i&&this.load()}bind(t){super.bind(t),t.target=Pr.TEXTURE_CUBE_MAP}addBaseTextureAt(t,e,n){if(void 0===n&&(n=this.linkBaseTexture),!this.items[e])throw new Error(`Index ${e} is out of bounds`);if(!this.linkBaseTexture||t.parentTextureArray||Object.keys(t._glTextures).length>0){if(!t.resource)throw new Error("CubeResource does not support copying of renderTexture.");this.addResourceAt(t.resource,e)}else t.target=Pr.TEXTURE_CUBE_MAP_POSITIVE_X+e,t.parentTextureArray=this.baseTexture,this.items[e]=t;return t.valid&&!this.valid&&this.resize(t.realWidth,t.realHeight),this.items[e]=t,this}upload(t,e,n){const s=this.itemDirtyIds;for(let i=0;i<mu.SIDES;i++){const r=this.items[i];(s[i]<r.dirtyId||n.dirtyId<e.dirtyId)&&(r.valid&&r.resource?(r.resource.upload(t,r,n),s[i]=r.dirtyId):s[i]<-1&&(t.gl.texImage2D(r.target,0,n.internalFormat,e.realWidth,e.realHeight,0,e.format,n.type,null),s[i]=-1))}return!0}static test(t){return Array.isArray(t)&&t.length===mu.SIDES}};let gu=mu;gu.SIDES=6;class vu extends Jh{constructor(t,e){var n;let s,i;e=e||{},"string"==typeof t?(s=vu.EMPTY,i=t):(s=t,i=null),super(s),this.url=i,this.crossOrigin=null==(n=e.crossOrigin)||n,this.alphaMode="number"==typeof e.alphaMode?e.alphaMode:null,this._load=null,!1!==e.autoLoad&&this.load()}load(){return this._load||(this._load=new Promise(((t,e)=>m(this,null,(function*(){if(null!==this.url)try{const e=yield zr.ADAPTER.fetch(this.url,{mode:this.crossOrigin?"cors":"no-cors"});if(this.destroyed)return;const n=yield e.blob();if(this.destroyed)return;const s=yield createImageBitmap(n,{premultiplyAlpha:null===this.alphaMode||this.alphaMode===Nr.UNPACK?"premultiply":"none"});if(this.destroyed)return;this.source=s,this.update(),t(this)}catch(_m){if(this.destroyed)return;e(_m),this.onError.emit(_m)}else t(this)}))))),this._load}upload(t,e,n){return this.source instanceof ImageBitmap?("number"==typeof this.alphaMode&&(e.alphaMode=this.alphaMode),super.upload(t,e,n)):(this.load(),!1)}dispose(){this.source instanceof ImageBitmap&&this.source.close(),super.dispose(),this._load=null}static test(t){return!!globalThis.createImageBitmap&&"undefined"!=typeof ImageBitmap&&("string"==typeof t||t instanceof ImageBitmap)}static get EMPTY(){var t;return vu._EMPTY=null!=(t=vu._EMPTY)?t:zr.ADAPTER.createCanvas(0,0),vu._EMPTY}}const xu=class extends Jh{constructor(t,e){e=e||{},super(zr.ADAPTER.createCanvas()),this._width=0,this._height=0,this.svg=t,this.scale=e.scale||1,this._overrideWidth=e.width,this._overrideHeight=e.height,this._resolve=null,this._crossorigin=e.crossorigin,this._load=null,!1!==e.autoLoad&&this.load()}load(){return this._load||(this._load=new Promise((t=>{if(this._resolve=()=>{this.resize(this.source.width,this.source.height),t(this)},xu.SVG_XML.test(this.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");this.svg=`data:image/svg+xml;base64,${btoa(unescape(encodeURIComponent(this.svg)))}`}this._loadSvg()}))),this._load}_loadSvg(){const t=new Image;Jh.crossOrigin(t,this.svg,this._crossorigin),t.src=this.svg,t.onerror=e=>{this._resolve&&(t.onerror=null,this.onError.emit(e))},t.onload=()=>{if(!this._resolve)return;const e=t.width,n=t.height;if(!e||!n)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");let s=e*this.scale,i=n*this.scale;(this._overrideWidth||this._overrideHeight)&&(s=this._overrideWidth||this._overrideHeight/n*e,i=this._overrideHeight||this._overrideWidth/e*n),s=Math.round(s),i=Math.round(i);const r=this.source;r.width=s,r.height=i,r._pixiId=`canvas_${ol()}`,r.getContext("2d").drawImage(t,0,0,e,n,0,0,s,i),this._resolve(),this._resolve=null}}static getSize(t){const e=xu.SVG_SIZE.exec(t),n={};return e&&(n[e[1]]=Math.round(parseFloat(e[3])),n[e[5]]=Math.round(parseFloat(e[7]))),n}dispose(){super.dispose(),this._resolve=null,this._crossorigin=null}static test(t,e){return"svg"===e||"string"==typeof t&&t.startsWith("data:image/svg+xml")||"string"==typeof t&&xu.SVG_XML.test(t)}};let yu=xu;yu.SVG_XML=/^(<\?xml[^?]+\?>)?\s*(<!--[^(-->)]*-->)?\s*\<svg/m,yu.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i;const _u=class extends Jh{constructor(t,e){if(e=e||{},!(t instanceof HTMLVideoElement)){const n=document.createElement("video");n.setAttribute("preload","auto"),n.setAttribute("webkit-playsinline",""),n.setAttribute("playsinline",""),"string"==typeof t&&(t=[t]);const s=t[0].src||t[0];Jh.crossOrigin(n,s,e.crossorigin);for(let e=0;e<t.length;++e){const s=document.createElement("source");let{src:i,mime:r}=t[e];i=i||t[e];const a=i.split("?").shift().toLowerCase(),o=a.slice(a.lastIndexOf(".")+1);r=r||_u.MIME_TYPES[o]||`video/${o}`,s.src=i,s.type=r,n.appendChild(s)}t=n}super(t),this.noSubImage=!0,this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=e.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=!1!==e.autoPlay,this._load=null,this._resolve=null,this._onCanPlay=this._onCanPlay.bind(this),this._onError=this._onError.bind(this),!1!==e.autoLoad&&this.load()}update(t=0){if(!this.destroyed){const t=iu.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-t),(!this._updateFPS||this._msToNextUpdate<=0)&&(super.update(),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}}load(){if(this._load)return this._load;const t=this.source;return(t.readyState===t.HAVE_ENOUGH_DATA||t.readyState===t.HAVE_FUTURE_DATA)&&t.width&&t.height&&(t.complete=!0),t.addEventListener("play",this._onPlayStart.bind(this)),t.addEventListener("pause",this._onPlayStop.bind(this)),this._isSourceReady()?this._onCanPlay():(t.addEventListener("canplay",this._onCanPlay),t.addEventListener("canplaythrough",this._onCanPlay),t.addEventListener("error",this._onError,!0)),this._load=new Promise((e=>{this.valid?e(this):(this._resolve=e,t.load())})),this._load}_onError(t){this.source.removeEventListener("error",this._onError,!0),this.onError.emit(t)}_isSourcePlaying(){const t=this.source;return!t.paused&&!t.ended&&this._isSourceReady()}_isSourceReady(){return this.source.readyState>2}_onPlayStart(){this.valid||this._onCanPlay(),this.autoUpdate&&!this._isConnectedToTicker&&(iu.shared.add(this.update,this),this._isConnectedToTicker=!0)}_onPlayStop(){this._isConnectedToTicker&&(iu.shared.remove(this.update,this),this._isConnectedToTicker=!1)}_onCanPlay(){const t=this.source;t.removeEventListener("canplay",this._onCanPlay),t.removeEventListener("canplaythrough",this._onCanPlay);const e=this.valid;this.resize(t.videoWidth,t.videoHeight),!e&&this._resolve&&(this._resolve(this),this._resolve=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&t.play()}dispose(){this._isConnectedToTicker&&(iu.shared.remove(this.update,this),this._isConnectedToTicker=!1);const t=this.source;t&&(t.removeEventListener("error",this._onError,!0),t.pause(),t.src="",t.load()),super.dispose()}get autoUpdate(){return this._autoUpdate}set autoUpdate(t){t!==this._autoUpdate&&(this._autoUpdate=t,!this._autoUpdate&&this._isConnectedToTicker?(iu.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._isSourcePlaying()&&(iu.shared.add(this.update,this),this._isConnectedToTicker=!0))}get updateFPS(){return this._updateFPS}set updateFPS(t){t!==this._updateFPS&&(this._updateFPS=t)}static test(t,e){return globalThis.HTMLVideoElement&&t instanceof HTMLVideoElement||_u.TYPES.includes(e)}};let bu=_u;bu.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"],bu.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"},Cl.push(vu,tc,class extends Jh{constructor(t){super(t)}static test(t){const{OffscreenCanvas:e}=globalThis;return!!(e&&t instanceof e)||globalThis.HTMLCanvasElement&&t instanceof HTMLCanvasElement}},bu,yu,Pl,gu,class extends pu{constructor(t,e){const{width:n,height:s}=e||{};let i,r;Array.isArray(t)?(i=t,r=t.length):r=t,super(r,{width:n,height:s}),i&&this.initFromArray(i,e)}addBaseTextureAt(t,e){if(!t.resource)throw new Error("ArrayResource does not support RenderTexture");return this.addResourceAt(t.resource,e),this}bind(t){super.bind(t),t.target=Pr.TEXTURE_2D_ARRAY}upload(t,e,n){const{length:s,itemDirtyIds:i,items:r}=this,{gl:a}=t;n.dirtyId<0&&a.texImage3D(a.TEXTURE_2D_ARRAY,0,n.internalFormat,this._width,this._height,s,0,e.format,n.type,null);for(let o=0;o<s;o++){const t=r[o];i[o]<t.dirtyId&&(i[o]=t.dirtyId,t.valid&&a.texSubImage3D(a.TEXTURE_2D_ARRAY,0,0,0,o,t.resource.width,t.resource.height,1,e.format,n.type,t.resource.source))}return!0}});class wu{constructor(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null,this.updateID=-1}isEmpty(){return this.minX>this.maxX||this.minY>this.maxY}clear(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0}getRectangle(t){return this.minX>this.maxX||this.minY>this.maxY?Zl.EMPTY:((t=t||new Zl(0,0,1,1)).x=this.minX,t.y=this.minY,t.width=this.maxX-this.minX,t.height=this.maxY-this.minY,t)}addPoint(t){this.minX=Math.min(this.minX,t.x),this.maxX=Math.max(this.maxX,t.x),this.minY=Math.min(this.minY,t.y),this.maxY=Math.max(this.maxY,t.y)}addPointMatrix(t,e){const{a:n,b:s,c:i,d:r,tx:a,ty:o}=t,l=n*e.x+i*e.y+a,h=s*e.x+r*e.y+o;this.minX=Math.min(this.minX,l),this.maxX=Math.max(this.maxX,l),this.minY=Math.min(this.minY,h),this.maxY=Math.max(this.maxY,h)}addQuad(t){let e=this.minX,n=this.minY,s=this.maxX,i=this.maxY,r=t[0],a=t[1];e=r<e?r:e,n=a<n?a:n,s=r>s?r:s,i=a>i?a:i,r=t[2],a=t[3],e=r<e?r:e,n=a<n?a:n,s=r>s?r:s,i=a>i?a:i,r=t[4],a=t[5],e=r<e?r:e,n=a<n?a:n,s=r>s?r:s,i=a>i?a:i,r=t[6],a=t[7],e=r<e?r:e,n=a<n?a:n,s=r>s?r:s,i=a>i?a:i,this.minX=e,this.minY=n,this.maxX=s,this.maxY=i}addFrame(t,e,n,s,i){this.addFrameMatrix(t.worldTransform,e,n,s,i)}addFrameMatrix(t,e,n,s,i){const r=t.a,a=t.b,o=t.c,l=t.d,h=t.tx,c=t.ty;let u=this.minX,d=this.minY,f=this.maxX,p=this.maxY,m=r*e+o*n+h,g=a*e+l*n+c;u=m<u?m:u,d=g<d?g:d,f=m>f?m:f,p=g>p?g:p,m=r*s+o*n+h,g=a*s+l*n+c,u=m<u?m:u,d=g<d?g:d,f=m>f?m:f,p=g>p?g:p,m=r*e+o*i+h,g=a*e+l*i+c,u=m<u?m:u,d=g<d?g:d,f=m>f?m:f,p=g>p?g:p,m=r*s+o*i+h,g=a*s+l*i+c,u=m<u?m:u,d=g<d?g:d,f=m>f?m:f,p=g>p?g:p,this.minX=u,this.minY=d,this.maxX=f,this.maxY=p}addVertexData(t,e,n){let s=this.minX,i=this.minY,r=this.maxX,a=this.maxY;for(let o=e;o<n;o+=2){const e=t[o],n=t[o+1];s=e<s?e:s,i=n<i?n:i,r=e>r?e:r,a=n>a?n:a}this.minX=s,this.minY=i,this.maxX=r,this.maxY=a}addVertices(t,e,n,s){this.addVerticesMatrix(t.worldTransform,e,n,s)}addVerticesMatrix(t,e,n,s,i=0,r=i){const a=t.a,o=t.b,l=t.c,h=t.d,c=t.tx,u=t.ty;let d=this.minX,f=this.minY,p=this.maxX,m=this.maxY;for(let g=n;g<s;g+=2){const t=e[g],n=e[g+1],s=a*t+l*n+c,v=h*n+o*t+u;d=Math.min(d,s-i),p=Math.max(p,s+i),f=Math.min(f,v-r),m=Math.max(m,v+r)}this.minX=d,this.minY=f,this.maxX=p,this.maxY=m}addBounds(t){const e=this.minX,n=this.minY,s=this.maxX,i=this.maxY;this.minX=t.minX<e?t.minX:e,this.minY=t.minY<n?t.minY:n,this.maxX=t.maxX>s?t.maxX:s,this.maxY=t.maxY>i?t.maxY:i}addBoundsMask(t,e){const n=t.minX>e.minX?t.minX:e.minX,s=t.minY>e.minY?t.minY:e.minY,i=t.maxX<e.maxX?t.maxX:e.maxX,r=t.maxY<e.maxY?t.maxY:e.maxY;if(n<=i&&s<=r){const t=this.minX,e=this.minY,a=this.maxX,o=this.maxY;this.minX=n<t?n:t,this.minY=s<e?s:e,this.maxX=i>a?i:a,this.maxY=r>o?r:o}}addBoundsMatrix(t,e){this.addFrameMatrix(e,t.minX,t.minY,t.maxX,t.maxY)}addBoundsArea(t,e){const n=t.minX>e.x?t.minX:e.x,s=t.minY>e.y?t.minY:e.y,i=t.maxX<e.x+e.width?t.maxX:e.x+e.width,r=t.maxY<e.y+e.height?t.maxY:e.y+e.height;if(n<=i&&s<=r){const t=this.minX,e=this.minY,a=this.maxX,o=this.maxY;this.minX=n<t?n:t,this.minY=s<e?s:e,this.maxX=i>a?i:a,this.maxY=r>o?r:o}}pad(t=0,e=t){this.isEmpty()||(this.minX-=t,this.maxX+=t,this.minY-=e,this.maxY+=e)}addFramePad(t,e,n,s,i,r){t-=i,e-=r,n+=i,s+=r,this.minX=this.minX<t?this.minX:t,this.maxX=this.maxX>n?this.maxX:n,this.minY=this.minY<e?this.minY:e,this.maxY=this.maxY>s?this.maxY:s}}class Eu extends ua{constructor(){super(),this.tempDisplayObjectParent=null,this.transform=new fh,this.alpha=1,this.visible=!0,this.renderable=!0,this.cullable=!1,this.cullArea=null,this.parent=null,this.worldAlpha=1,this._lastSortedIndex=0,this._zIndex=0,this.filterArea=null,this.filters=null,this._enabledFilters=null,this._bounds=new wu,this._localBounds=null,this._boundsID=0,this._boundsRect=null,this._localBoundsRect=null,this._mask=null,this._maskRefCount=0,this._destroyed=!1,this.isSprite=!1,this.isMask=!1}static mixin(t){const e=Object.keys(t);for(let n=0;n<e.length;++n){const s=e[n];Object.defineProperty(Eu.prototype,s,Object.getOwnPropertyDescriptor(t,s))}}get destroyed(){return this._destroyed}_recursivePostUpdateTransform(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)}updateTransform(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha}getBounds(t,e){return t||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._bounds.updateID!==this._boundsID&&(this.calculateBounds(),this._bounds.updateID=this._boundsID),e||(this._boundsRect||(this._boundsRect=new Zl),e=this._boundsRect),this._bounds.getRectangle(e)}getLocalBounds(t){t||(this._localBoundsRect||(this._localBoundsRect=new Zl),t=this._localBoundsRect),this._localBounds||(this._localBounds=new wu);const e=this.transform,n=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform;const s=this._bounds,i=this._boundsID;this._bounds=this._localBounds;const r=this.getBounds(!1,t);return this.parent=n,this.transform=e,this._bounds=s,this._bounds.updateID+=this._boundsID-i,r}toGlobal(t,e,n=!1){return n||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(t,e)}toLocal(t,e,n,s){return e&&(t=e.toGlobal(t,n,s)),s||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(t,n)}setParent(t){if(!t||!t.addChild)throw new Error("setParent: Argument must be a Container");return t.addChild(this),t}removeFromParent(){var t;null==(t=this.parent)||t.removeChild(this)}setTransform(t=0,e=0,n=1,s=1,i=0,r=0,a=0,o=0,l=0){return this.position.x=t,this.position.y=e,this.scale.x=n||1,this.scale.y=s||1,this.rotation=i,this.skew.x=r,this.skew.y=a,this.pivot.x=o,this.pivot.y=l,this}destroy(t){this.removeFromParent(),this._destroyed=!0,this.transform=null,this.parent=null,this._bounds=null,this.mask=null,this.cullArea=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.eventMode="auto",this.interactiveChildren=!1,this.emit("destroyed"),this.removeAllListeners()}get _tempDisplayObjectParent(){return null===this.tempDisplayObjectParent&&(this.tempDisplayObjectParent=new Tu),this.tempDisplayObjectParent}enableTempParent(){const t=this.parent;return this.parent=this._tempDisplayObjectParent,t}disableTempParent(t){this.parent=t}get x(){return this.position.x}set x(t){this.transform.position.x=t}get y(){return this.position.y}set y(t){this.transform.position.y=t}get worldTransform(){return this.transform.worldTransform}get localTransform(){return this.transform.localTransform}get position(){return this.transform.position}set position(t){this.transform.position.copyFrom(t)}get scale(){return this.transform.scale}set scale(t){this.transform.scale.copyFrom(t)}get pivot(){return this.transform.pivot}set pivot(t){this.transform.pivot.copyFrom(t)}get skew(){return this.transform.skew}set skew(t){this.transform.skew.copyFrom(t)}get rotation(){return this.transform.rotation}set rotation(t){this.transform.rotation=t}get angle(){return this.transform.rotation*Hl}set angle(t){this.transform.rotation=t*jl}get zIndex(){return this._zIndex}set zIndex(t){this._zIndex=t,this.parent&&(this.parent.sortDirty=!0)}get worldVisible(){let t=this;do{if(!t.visible)return!1;t=t.parent}while(t);return!0}get mask(){return this._mask}set mask(t){if(this._mask!==t){if(this._mask){const t=this._mask.isMaskData?this._mask.maskObject:this._mask;t&&(t._maskRefCount--,0===t._maskRefCount&&(t.renderable=!0,t.isMask=!1))}if(this._mask=t,this._mask){const t=this._mask.isMaskData?this._mask.maskObject:this._mask;t&&(0===t._maskRefCount&&(t.renderable=!1,t.isMask=!0),t._maskRefCount++)}}}}class Tu extends Eu{constructor(){super(...arguments),this.sortDirty=null}}Eu.prototype.displayObjectUpdateTransform=Eu.prototype.updateTransform;const Su=new nh;function Au(t,e){return t.zIndex===e.zIndex?t._lastSortedIndex-e._lastSortedIndex:t.zIndex-e.zIndex}const Cu=class extends Eu{constructor(){super(),this.children=[],this.sortableChildren=Cu.defaultSortableChildren,this.sortDirty=!1}onChildrenChange(t){}addChild(...t){if(t.length>1)for(let e=0;e<t.length;e++)this.addChild(t[e]);else{const e=t[0];e.parent&&e.parent.removeChild(e),e.parent=this,this.sortDirty=!0,e.transform._parentID=-1,this.children.push(e),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",e,this,this.children.length-1),e.emit("added",this)}return t[0]}addChildAt(t,e){if(e<0||e>this.children.length)throw new Error(`${t}addChildAt: The index ${e} supplied is out of bounds ${this.children.length}`);return t.parent&&t.parent.removeChild(t),t.parent=this,this.sortDirty=!0,t.transform._parentID=-1,this.children.splice(e,0,t),this._boundsID++,this.onChildrenChange(e),t.emit("added",this),this.emit("childAdded",t,this,e),t}swapChildren(t,e){if(t===e)return;const n=this.getChildIndex(t),s=this.getChildIndex(e);this.children[n]=e,this.children[s]=t,this.onChildrenChange(n<s?n:s)}getChildIndex(t){const e=this.children.indexOf(t);if(-1===e)throw new Error("The supplied DisplayObject must be a child of the caller");return e}setChildIndex(t,e){if(e<0||e>=this.children.length)throw new Error(`The index ${e} supplied is out of bounds ${this.children.length}`);const n=this.getChildIndex(t);il(this.children,n,1),this.children.splice(e,0,t),this.onChildrenChange(e)}getChildAt(t){if(t<0||t>=this.children.length)throw new Error(`getChildAt: Index (${t}) does not exist.`);return this.children[t]}removeChild(...t){if(t.length>1)for(let e=0;e<t.length;e++)this.removeChild(t[e]);else{const e=t[0],n=this.children.indexOf(e);if(-1===n)return null;e.parent=null,e.transform._parentID=-1,il(this.children,n,1),this._boundsID++,this.onChildrenChange(n),e.emit("removed",this),this.emit("childRemoved",e,this,n)}return t[0]}removeChildAt(t){const e=this.getChildAt(t);return e.parent=null,e.transform._parentID=-1,il(this.children,t,1),this._boundsID++,this.onChildrenChange(t),e.emit("removed",this),this.emit("childRemoved",e,this,t),e}removeChildren(t=0,e=this.children.length){const n=t,s=e-n;let i;if(s>0&&s<=e){i=this.children.splice(n,s);for(let t=0;t<i.length;++t)i[t].parent=null,i[t].transform&&(i[t].transform._parentID=-1);this._boundsID++,this.onChildrenChange(t);for(let t=0;t<i.length;++t)i[t].emit("removed",this),this.emit("childRemoved",i[t],this,t);return i}if(0===s&&0===this.children.length)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")}sortChildren(){let t=!1;for(let e=0,n=this.children.length;e<n;++e){const n=this.children[e];n._lastSortedIndex=e,t||0===n.zIndex||(t=!0)}t&&this.children.length>1&&this.children.sort(Au),this.sortDirty=!1}updateTransform(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(let t=0,e=this.children.length;t<e;++t){const e=this.children[t];e.visible&&e.updateTransform()}}calculateBounds(){this._bounds.clear(),this._calculateBounds();for(let t=0;t<this.children.length;t++){const e=this.children[t];if(e.visible&&e.renderable)if(e.calculateBounds(),e._mask){const t=e._mask.isMaskData?e._mask.maskObject:e._mask;t?(t.calculateBounds(),this._bounds.addBoundsMask(e._bounds,t._bounds)):this._bounds.addBounds(e._bounds)}else e.filterArea?this._bounds.addBoundsArea(e._bounds,e.filterArea):this._bounds.addBounds(e._bounds)}this._bounds.updateID=this._boundsID}getLocalBounds(t,e=!1){const n=super.getLocalBounds(t);if(!e)for(let s=0,i=this.children.length;s<i;++s){const t=this.children[s];t.visible&&t.updateTransform()}return n}_calculateBounds(){}_renderWithCulling(t){const e=t.renderTexture.sourceFrame;if(!(e.width>0&&e.height>0))return;let n,s;this.cullArea?(n=this.cullArea,s=this.worldTransform):this._render!==Cu.prototype._render&&(n=this.getBounds(!0));const i=t.projection.transform;if(i&&(s?(s=Su.copyFrom(s),s.prepend(i)):s=i),n&&e.intersects(n,s))this._render(t);else if(this.cullArea)return;for(let r=0,a=this.children.length;r<a;++r){const e=this.children[r],n=e.cullable;e.cullable=n||!this.cullArea,e.render(t),e.cullable=n}}render(t){var e;if(this.visible&&!(this.worldAlpha<=0)&&this.renderable)if(this._mask||(null==(e=this.filters)?void 0:e.length))this.renderAdvanced(t);else if(this.cullable)this._renderWithCulling(t);else{this._render(t);for(let e=0,n=this.children.length;e<n;++e)this.children[e].render(t)}}renderAdvanced(t){var e,n,s;const i=this.filters,r=this._mask;if(i){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(let t=0;t<i.length;t++)i[t].enabled&&this._enabledFilters.push(i[t])}const a=i&&(null==(e=this._enabledFilters)?void 0:e.length)||r&&(!r.isMaskData||r.enabled&&(r.autoDetect||r.type!==Xr.NONE));if(a&&t.batch.flush(),i&&(null==(n=this._enabledFilters)?void 0:n.length)&&t.filter.push(this,this._enabledFilters),r&&t.mask.push(this,this._mask),this.cullable)this._renderWithCulling(t);else{this._render(t);for(let e=0,n=this.children.length;e<n;++e)this.children[e].render(t)}a&&t.batch.flush(),r&&t.mask.pop(this),i&&(null==(s=this._enabledFilters)?void 0:s.length)&&t.filter.pop()}_render(t){}destroy(t){super.destroy(),this.sortDirty=!1;const e="boolean"==typeof t?t:null==t?void 0:t.children,n=this.removeChildren(0,this.children.length);if(e)for(let s=0;s<n.length;++s)n[s].destroy(t)}get width(){return this.scale.x*this.getLocalBounds().width}set width(t){const e=this.getLocalBounds().width;this.scale.x=0!==e?t/e:1,this._width=t}get height(){return this.scale.y*this.getLocalBounds().height}set height(t){const e=this.getLocalBounds().height;this.scale.y=0!==e?t/e:1,this._height=t}};let Iu=Cu;Iu.defaultSortableChildren=!1,Iu.prototype.containerUpdateTransform=Iu.prototype.updateTransform,Object.defineProperties(zr,{SORTABLE_CHILDREN:{get:()=>Iu.defaultSortableChildren,set(t){vo("7.1.0","settings.SORTABLE_CHILDREN is deprecated, use Container.defaultSortableChildren"),Iu.defaultSortableChildren=t}}});const Mu=new ql,Ru=new Uint16Array([0,1,2,0,2,3]);class Pu extends Iu{constructor(t){super(),this._anchor=new uh(this._onAnchorUpdate,this,t?t.defaultAnchor.x:0,t?t.defaultAnchor.y:0),this._texture=null,this._width=0,this._height=0,this._tintColor=new qo(16777215),this._tintRGB=null,this.tint=16777215,this.blendMode=Ir.NORMAL,this._cachedTint=16777215,this.uvs=null,this.texture=t||ic.EMPTY,this.vertexData=new Float32Array(8),this.vertexTrimmedData=null,this._transformID=-1,this._textureID=-1,this._transformTrimmedID=-1,this._textureTrimmedID=-1,this.indices=Ru,this.pluginName="batch",this.isSprite=!0,this._roundPixels=zr.ROUND_PIXELS}_onTextureUpdate(){this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this._width&&(this.scale.x=rl(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=rl(this.scale.y)*this._height/this._texture.orig.height)}_onAnchorUpdate(){this._transformID=-1,this._transformTrimmedID=-1}calculateVertices(){const t=this._texture;if(this._transformID===this.transform._worldID&&this._textureID===t._updateID)return;this._textureID!==t._updateID&&(this.uvs=this._texture._uvs.uvsFloat32),this._transformID=this.transform._worldID,this._textureID=t._updateID;const e=this.transform.worldTransform,n=e.a,s=e.b,i=e.c,r=e.d,a=e.tx,o=e.ty,l=this.vertexData,h=t.trim,c=t.orig,u=this._anchor;let d=0,f=0,p=0,m=0;if(h?(f=h.x-u._x*c.width,d=f+h.width,m=h.y-u._y*c.height,p=m+h.height):(f=-u._x*c.width,d=f+c.width,m=-u._y*c.height,p=m+c.height),l[0]=n*f+i*m+a,l[1]=r*m+s*f+o,l[2]=n*d+i*m+a,l[3]=r*m+s*d+o,l[4]=n*d+i*p+a,l[5]=r*p+s*d+o,l[6]=n*f+i*p+a,l[7]=r*p+s*f+o,this._roundPixels){const t=zr.RESOLUTION;for(let e=0;e<l.length;++e)l[e]=Math.round(l[e]*t)/t}}calculateTrimmedVertices(){if(this.vertexTrimmedData){if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return}else this.vertexTrimmedData=new Float32Array(8);this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;const t=this._texture,e=this.vertexTrimmedData,n=t.orig,s=this._anchor,i=this.transform.worldTransform,r=i.a,a=i.b,o=i.c,l=i.d,h=i.tx,c=i.ty,u=-s._x*n.width,d=u+n.width,f=-s._y*n.height,p=f+n.height;e[0]=r*u+o*f+h,e[1]=l*f+a*u+c,e[2]=r*d+o*f+h,e[3]=l*f+a*d+c,e[4]=r*d+o*p+h,e[5]=l*p+a*d+c,e[6]=r*u+o*p+h,e[7]=l*p+a*u+c}_render(t){this.calculateVertices(),t.batch.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this)}_calculateBounds(){const t=this._texture.trim,e=this._texture.orig;!t||t.width===e.width&&t.height===e.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))}getLocalBounds(t){return 0===this.children.length?(this._localBounds||(this._localBounds=new wu),this._localBounds.minX=this._texture.orig.width*-this._anchor._x,this._localBounds.minY=this._texture.orig.height*-this._anchor._y,this._localBounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._localBounds.maxY=this._texture.orig.height*(1-this._anchor._y),t||(this._localBoundsRect||(this._localBoundsRect=new Zl),t=this._localBoundsRect),this._localBounds.getRectangle(t)):super.getLocalBounds.call(this,t)}containsPoint(t){this.worldTransform.applyInverse(t,Mu);const e=this._texture.orig.width,n=this._texture.orig.height,s=-e*this.anchor.x;let i=0;return Mu.x>=s&&Mu.x<s+e&&(i=-n*this.anchor.y,Mu.y>=i&&Mu.y<i+n)}destroy(t){super.destroy(t),this._texture.off("update",this._onTextureUpdate,this),this._anchor=null;if("boolean"==typeof t?t:null==t?void 0:t.texture){const e="boolean"==typeof t?t:null==t?void 0:t.baseTexture;this._texture.destroy(!!e)}this._texture=null}static from(t,e){const n=t instanceof ic?t:ic.from(t,e);return new Pu(n)}set roundPixels(t){this._roundPixels!==t&&(this._transformID=-1),this._roundPixels=t}get roundPixels(){return this._roundPixels}get width(){return Math.abs(this.scale.x)*this._texture.orig.width}set width(t){const e=rl(this.scale.x)||1;this.scale.x=e*t/this._texture.orig.width,this._width=t}get height(){return Math.abs(this.scale.y)*this._texture.orig.height}set height(t){const e=rl(this.scale.y)||1;this.scale.y=e*t/this._texture.orig.height,this._height=t}get anchor(){return this._anchor}set anchor(t){this._anchor.copyFrom(t)}get tint(){return this._tintColor.value}set tint(t){this._tintColor.setValue(t),this._tintRGB=this._tintColor.toLittleEndianNumber()}get tintValue(){return this._tintColor.toNumber()}get texture(){return this._texture}set texture(t){this._texture!==t&&(this._texture&&this._texture.off("update",this._onTextureUpdate,this),this._texture=t||ic.EMPTY,this._cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,t&&(t.baseTexture.valid?this._onTextureUpdate():t.once("update",this._onTextureUpdate,this)))}}const ku=new nh;Eu.prototype._cacheAsBitmap=!1,Eu.prototype._cacheData=null,Eu.prototype._cacheAsBitmapResolution=null,Eu.prototype._cacheAsBitmapMultisample=null;class Fu{constructor(){this.textureCacheId=null,this.originalRender=null,this.originalRenderCanvas=null,this.originalCalculateBounds=null,this.originalGetLocalBounds=null,this.originalUpdateTransform=null,this.originalDestroy=null,this.originalMask=null,this.originalFilterArea=null,this.originalContainsPoint=null,this.sprite=null}}Object.defineProperties(Eu.prototype,{cacheAsBitmapResolution:{get(){return this._cacheAsBitmapResolution},set(t){t!==this._cacheAsBitmapResolution&&(this._cacheAsBitmapResolution=t,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmapMultisample:{get(){return this._cacheAsBitmapMultisample},set(t){t!==this._cacheAsBitmapMultisample&&(this._cacheAsBitmapMultisample=t,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmap:{get(){return this._cacheAsBitmap},set(t){if(this._cacheAsBitmap===t)return;let e;this._cacheAsBitmap=t,t?(this._cacheData||(this._cacheData=new Fu),e=this._cacheData,e.originalRender=this.render,e.originalRenderCanvas=this.renderCanvas,e.originalUpdateTransform=this.updateTransform,e.originalCalculateBounds=this.calculateBounds,e.originalGetLocalBounds=this.getLocalBounds,e.originalDestroy=this.destroy,e.originalContainsPoint=this.containsPoint,e.originalMask=this._mask,e.originalFilterArea=this.filterArea,this.render=this._renderCached,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):(e=this._cacheData,e.sprite&&this._destroyCachedDisplayObject(),this.render=e.originalRender,this.renderCanvas=e.originalRenderCanvas,this.calculateBounds=e.originalCalculateBounds,this.getLocalBounds=e.originalGetLocalBounds,this.destroy=e.originalDestroy,this.updateTransform=e.originalUpdateTransform,this.containsPoint=e.originalContainsPoint,this._mask=e.originalMask,this.filterArea=e.originalFilterArea)}}}),Eu.prototype._renderCached=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObject(t),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._render(t))},Eu.prototype._initCachedDisplayObject=function(t){var e,n,s;if(null==(e=this._cacheData)?void 0:e.sprite)return;const i=this.alpha;this.alpha=1,t.batch.flush();const r=this.getLocalBounds(null,!0).clone();if(null==(n=this.filters)?void 0:n.length){const t=this.filters[0].padding;r.pad(t)}r.ceil(zr.RESOLUTION);const a=t.renderTexture.current,o=t.renderTexture.sourceFrame.clone(),l=t.renderTexture.destinationFrame.clone(),h=t.projection.transform,c=rc.create({width:r.width,height:r.height,resolution:this.cacheAsBitmapResolution||t.resolution,multisample:null!=(s=this.cacheAsBitmapMultisample)?s:t.multisample}),u=`cacheAsBitmap_${ol()}`;this._cacheData.textureCacheId=u,Ol.addToCache(c.baseTexture,u),ic.addToCache(c,u);const d=this.transform.localTransform.copyTo(ku).invert().translate(-r.x,-r.y);this.render=this._cacheData.originalRender,t.render(this,{renderTexture:c,clear:!0,transform:d,skipUpdateTransform:!1}),t.framebuffer.blit(),t.projection.transform=h,t.renderTexture.bind(a,o,l),this.render=this._renderCached,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=i;const f=new Pu(c);f.transform.worldTransform=this.transform.worldTransform,f.anchor.x=-r.x/r.width,f.anchor.y=-r.y/r.height,f.alpha=i,f._bounds=this._bounds,this._cacheData.sprite=f,this.transform._parentID=-1,this.parent?this.updateTransform():(this.enableTempParent(),this.updateTransform(),this.disableTempParent(null)),this.containsPoint=f.containsPoint.bind(f)},Eu.prototype._renderCachedCanvas=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObjectCanvas(t),this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._renderCanvas(t))},Eu.prototype._initCachedDisplayObjectCanvas=function(t){var e;if(null==(e=this._cacheData)?void 0:e.sprite)return;const n=this.getLocalBounds(null,!0),s=this.alpha;this.alpha=1;const i=t.canvasContext.activeContext,r=t._projTransform;n.ceil(zr.RESOLUTION);const a=rc.create({width:n.width,height:n.height}),o=`cacheAsBitmap_${ol()}`;this._cacheData.textureCacheId=o,Ol.addToCache(a.baseTexture,o),ic.addToCache(a,o);const l=ku;this.transform.localTransform.copyTo(l),l.invert(),l.tx-=n.x,l.ty-=n.y,this.renderCanvas=this._cacheData.originalRenderCanvas,t.render(this,{renderTexture:a,clear:!0,transform:l,skipUpdateTransform:!1}),t.canvasContext.activeContext=i,t._projTransform=r,this.renderCanvas=this._renderCachedCanvas,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=s;const h=new Pu(a);h.transform.worldTransform=this.transform.worldTransform,h.anchor.x=-n.x/n.width,h.anchor.y=-n.y/n.height,h.alpha=s,h._bounds=this._bounds,this._cacheData.sprite=h,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=t._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=h.containsPoint.bind(h)},Eu.prototype._calculateCachedBounds=function(){this._bounds.clear(),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite._calculateBounds(),this._bounds.updateID=this._boundsID},Eu.prototype._getCachedLocalBounds=function(){return this._cacheData.sprite.getLocalBounds(null)},Eu.prototype._destroyCachedDisplayObject=function(){this._cacheData.sprite._texture.destroy(!0),this._cacheData.sprite=null,Ol.removeFromCache(this._cacheData.textureCacheId),ic.removeFromCache(this._cacheData.textureCacheId),this._cacheData.textureCacheId=null},Eu.prototype._cacheAsBitmapDestroy=function(t){this.cacheAsBitmap=!1,this.destroy(t)},Eu.prototype.name=null,Iu.prototype.getChildByName=function(t,e){for(let n=0,s=this.children.length;n<s;n++)if(this.children[n].name===t)return this.children[n];if(e)for(let n=0,s=this.children.length;n<s;n++){const e=this.children[n];if(!e.getChildByName)continue;const s=e.getChildByName(t,!0);if(s)return s}return null},Eu.prototype.getGlobalPosition=function(t=new ql,e=!1){return this.parent?this.parent.toGlobal(this.position,t,e):(t.x=this.position.x,t.y=this.position.y),t};const Ou={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,.02784,.065602,.120999,.174697,.197448]},Du=["varying vec2 vBlurTexCoords[%size%];","uniform sampler2D uSampler;","void main(void)","{","    gl_FragColor = vec4(0.0);","    %blur%","}"].join("\n");const Lu="\n    attribute vec2 aVertexPosition;\n\n    uniform mat3 projectionMatrix;\n\n    uniform float strength;\n\n    varying vec2 vBlurTexCoords[%size%];\n\n    uniform vec4 inputSize;\n    uniform vec4 outputFrame;\n\n    vec4 filterVertexPosition( void )\n    {\n        vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n        return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n    }\n\n    vec2 filterTextureCoord( void )\n    {\n        return aVertexPosition * (outputFrame.zw * inputSize.zw);\n    }\n\n    void main(void)\n    {\n        gl_Position = filterVertexPosition();\n\n        vec2 textureCoord = filterTextureCoord();\n        %blur%\n    }";class Nu extends Gh{constructor(t,e=8,n=4,s=Gh.defaultResolution,i=5){const r=function(t,e){const n=Math.ceil(t/2);let s,i=Lu,r="";s=e?"vBlurTexCoords[%index%] =  textureCoord + vec2(%sampleIndex% * strength, 0.0);":"vBlurTexCoords[%index%] =  textureCoord + vec2(0.0, %sampleIndex% * strength);";for(let a=0;a<t;a++){let t=s.replace("%index%",a.toString());t=t.replace("%sampleIndex%",a-(n-1)+".0"),r+=t,r+="\n"}return i=i.replace("%blur%",r),i=i.replace("%size%",t.toString()),i}(i,t),a=function(t){const e=Ou[t],n=e.length;let s,i=Du,r="";for(let a=0;a<t;a++){let i="gl_FragColor += texture2D(uSampler, vBlurTexCoords[%index%]) * %value%;".replace("%index%",a.toString());s=a,a>=n&&(s=t-a-1),i=i.replace("%value%",e[s].toString()),r+=i,r+="\n"}return i=i.replace("%blur%",r),i=i.replace("%size%",t.toString()),i}(i);super(r,a),this.horizontal=t,this.resolution=s,this._quality=0,this.quality=n,this.blur=e}apply(t,e,n,s){if(n?this.horizontal?this.uniforms.strength=1/n.width*(n.width/e.width):this.uniforms.strength=1/n.height*(n.height/e.height):this.horizontal?this.uniforms.strength=1/t.renderer.width*(t.renderer.width/e.width):this.uniforms.strength=1/t.renderer.height*(t.renderer.height/e.height),this.uniforms.strength*=this.strength,this.uniforms.strength/=this.passes,1===this.passes)t.applyFilter(this,e,n,s);else{const i=t.getFilterTexture(),r=t.renderer;let a=e,o=i;this.state.blend=!1,t.applyFilter(this,a,o,Br.CLEAR);for(let e=1;e<this.passes-1;e++){t.bindAndClear(a,Br.BLIT),this.uniforms.uSampler=o;const e=o;o=a,a=e,r.shader.bind(this),r.geometry.draw(5)}this.state.blend=!0,t.applyFilter(this,o,n,s),t.returnFilterTexture(i)}}get blur(){return this.strength}set blur(t){this.padding=1+2*Math.abs(t),this.strength=t}get quality(){return this._quality}set quality(t){this._quality=t,this.passes=t}}class Bu extends Gh{constructor(){const t={m:new Float32Array([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]),uAlpha:1};super(ou,"varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform float m[20];\nuniform float uAlpha;\n\nvoid main(void)\n{\n    vec4 c = texture2D(uSampler, vTextureCoord);\n\n    if (uAlpha == 0.0) {\n        gl_FragColor = c;\n        return;\n    }\n\n    // Un-premultiply alpha before applying the color matrix. See issue #3539.\n    if (c.a > 0.0) {\n      c.rgb /= c.a;\n    }\n\n    vec4 result;\n\n    result.r = (m[0] * c.r);\n        result.r += (m[1] * c.g);\n        result.r += (m[2] * c.b);\n        result.r += (m[3] * c.a);\n        result.r += m[4];\n\n    result.g = (m[5] * c.r);\n        result.g += (m[6] * c.g);\n        result.g += (m[7] * c.b);\n        result.g += (m[8] * c.a);\n        result.g += m[9];\n\n    result.b = (m[10] * c.r);\n       result.b += (m[11] * c.g);\n       result.b += (m[12] * c.b);\n       result.b += (m[13] * c.a);\n       result.b += m[14];\n\n    result.a = (m[15] * c.r);\n       result.a += (m[16] * c.g);\n       result.a += (m[17] * c.b);\n       result.a += (m[18] * c.a);\n       result.a += m[19];\n\n    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);\n\n    // Premultiply alpha again.\n    rgb *= result.a;\n\n    gl_FragColor = vec4(rgb, result.a);\n}\n",t),this.alpha=1}_loadMatrix(t,e=!1){let n=t;e&&(this._multiply(n,this.uniforms.m,t),n=this._colorMatrix(n)),this.uniforms.m=n}_multiply(t,e,n){return t[0]=e[0]*n[0]+e[1]*n[5]+e[2]*n[10]+e[3]*n[15],t[1]=e[0]*n[1]+e[1]*n[6]+e[2]*n[11]+e[3]*n[16],t[2]=e[0]*n[2]+e[1]*n[7]+e[2]*n[12]+e[3]*n[17],t[3]=e[0]*n[3]+e[1]*n[8]+e[2]*n[13]+e[3]*n[18],t[4]=e[0]*n[4]+e[1]*n[9]+e[2]*n[14]+e[3]*n[19]+e[4],t[5]=e[5]*n[0]+e[6]*n[5]+e[7]*n[10]+e[8]*n[15],t[6]=e[5]*n[1]+e[6]*n[6]+e[7]*n[11]+e[8]*n[16],t[7]=e[5]*n[2]+e[6]*n[7]+e[7]*n[12]+e[8]*n[17],t[8]=e[5]*n[3]+e[6]*n[8]+e[7]*n[13]+e[8]*n[18],t[9]=e[5]*n[4]+e[6]*n[9]+e[7]*n[14]+e[8]*n[19]+e[9],t[10]=e[10]*n[0]+e[11]*n[5]+e[12]*n[10]+e[13]*n[15],t[11]=e[10]*n[1]+e[11]*n[6]+e[12]*n[11]+e[13]*n[16],t[12]=e[10]*n[2]+e[11]*n[7]+e[12]*n[12]+e[13]*n[17],t[13]=e[10]*n[3]+e[11]*n[8]+e[12]*n[13]+e[13]*n[18],t[14]=e[10]*n[4]+e[11]*n[9]+e[12]*n[14]+e[13]*n[19]+e[14],t[15]=e[15]*n[0]+e[16]*n[5]+e[17]*n[10]+e[18]*n[15],t[16]=e[15]*n[1]+e[16]*n[6]+e[17]*n[11]+e[18]*n[16],t[17]=e[15]*n[2]+e[16]*n[7]+e[17]*n[12]+e[18]*n[17],t[18]=e[15]*n[3]+e[16]*n[8]+e[17]*n[13]+e[18]*n[18],t[19]=e[15]*n[4]+e[16]*n[9]+e[17]*n[14]+e[18]*n[19]+e[19],t}_colorMatrix(t){const e=new Float32Array(t);return e[4]/=255,e[9]/=255,e[14]/=255,e[19]/=255,e}brightness(t,e){const n=[t,0,0,0,0,0,t,0,0,0,0,0,t,0,0,0,0,0,1,0];this._loadMatrix(n,e)}tint(t,e){const[n,s,i]=qo.shared.setValue(t).toArray(),r=[n,0,0,0,0,0,s,0,0,0,0,0,i,0,0,0,0,0,1,0];this._loadMatrix(r,e)}greyscale(t,e){const n=[t,t,t,0,0,t,t,t,0,0,t,t,t,0,0,0,0,0,1,0];this._loadMatrix(n,e)}blackAndWhite(t){this._loadMatrix([.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0],t)}hue(t,e){t=(t||0)/180*Math.PI;const n=Math.cos(t),s=Math.sin(t),i=1/3,r=(0,Math.sqrt)(i),a=[n+(1-n)*i,i*(1-n)-r*s,i*(1-n)+r*s,0,0,i*(1-n)+r*s,n+i*(1-n),i*(1-n)-r*s,0,0,i*(1-n)-r*s,i*(1-n)+r*s,n+i*(1-n),0,0,0,0,0,1,0];this._loadMatrix(a,e)}contrast(t,e){const n=(t||0)+1,s=-.5*(n-1),i=[n,0,0,0,s,0,n,0,0,s,0,0,n,0,s,0,0,0,1,0];this._loadMatrix(i,e)}saturate(t=0,e){const n=2*t/3+1,s=-.5*(n-1),i=[n,s,s,0,0,s,n,s,0,0,s,s,n,0,0,0,0,0,1,0];this._loadMatrix(i,e)}desaturate(){this.saturate(-1)}negative(t){this._loadMatrix([-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0],t)}sepia(t){this._loadMatrix([.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0],t)}technicolor(t){this._loadMatrix([1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0],t)}polaroid(t){this._loadMatrix([1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0],t)}toBGR(t){this._loadMatrix([0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0],t)}kodachrome(t){this._loadMatrix([1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0],t)}browni(t){this._loadMatrix([.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0],t)}vintage(t){this._loadMatrix([.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0],t)}colorTone(t,e,n,s,i){t=t||.2,e=e||.15,n=n||16770432,s=s||3375104;const r=qo.shared,[a,o,l]=r.setValue(n).toArray(),[h,c,u]=r.setValue(s).toArray(),d=[.3,.59,.11,0,0,a,o,l,t,0,h,c,u,e,0,a-h,o-c,l-u,0,0];this._loadMatrix(d,i)}night(t,e){const n=[-2*(t=t||.1),-t,0,0,0,-t,0,t,0,0,0,t,2*t,0,0,0,0,0,1,0];this._loadMatrix(n,e)}predator(t,e){const n=[11.224130630493164*t,-4.794486999511719*t,-2.8746118545532227*t,0*t,.40342438220977783*t,-3.6330697536468506*t,9.193157196044922*t,-2.951810836791992*t,0*t,-1.316135048866272*t,-3.2184197902679443*t,-4.2375030517578125*t,7.476448059082031*t,0*t,.8044459223747253*t,0,0,0,1,0];this._loadMatrix(n,e)}lsd(t){this._loadMatrix([2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0],t)}reset(){this._loadMatrix([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],!1)}get matrix(){return this.uniforms.m}set matrix(t){this.uniforms.m=t}get alpha(){return this.uniforms.uAlpha}set alpha(t){this.uniforms.uAlpha=t}}Bu.prototype.grayscale=Bu.prototype.greyscale;const Vu={AlphaFilter:class extends Gh{constructor(t=1){super("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform float uAlpha;\n\nvoid main(void)\n{\n   gl_FragColor = texture2D(uSampler, vTextureCoord) * uAlpha;\n}\n",{uAlpha:1}),this.alpha=t}get alpha(){return this.uniforms.uAlpha}set alpha(t){this.uniforms.uAlpha=t}},BlurFilter:class extends Gh{constructor(t=8,e=4,n=Gh.defaultResolution,s=5){super(),this._repeatEdgePixels=!1,this.blurXFilter=new Nu(!0,t,e,n,s),this.blurYFilter=new Nu(!1,t,e,n,s),this.resolution=n,this.quality=e,this.blur=t,this.repeatEdgePixels=!1}apply(t,e,n,s){const i=Math.abs(this.blurXFilter.strength),r=Math.abs(this.blurYFilter.strength);if(i&&r){const i=t.getFilterTexture();this.blurXFilter.apply(t,e,i,Br.CLEAR),this.blurYFilter.apply(t,i,n,s),t.returnFilterTexture(i)}else r?this.blurYFilter.apply(t,e,n,s):this.blurXFilter.apply(t,e,n,s)}updatePadding(){this._repeatEdgePixels?this.padding=0:this.padding=2*Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))}get blur(){return this.blurXFilter.blur}set blur(t){this.blurXFilter.blur=this.blurYFilter.blur=t,this.updatePadding()}get quality(){return this.blurXFilter.quality}set quality(t){this.blurXFilter.quality=this.blurYFilter.quality=t}get blurX(){return this.blurXFilter.blur}set blurX(t){this.blurXFilter.blur=t,this.updatePadding()}get blurY(){return this.blurYFilter.blur}set blurY(t){this.blurYFilter.blur=t,this.updatePadding()}get blendMode(){return this.blurYFilter.blendMode}set blendMode(t){this.blurYFilter.blendMode=t}get repeatEdgePixels(){return this._repeatEdgePixels}set repeatEdgePixels(t){this._repeatEdgePixels=t,this.updatePadding()}},BlurFilterPass:Nu,ColorMatrixFilter:Bu,DisplacementFilter:class extends Gh{constructor(t,e){const n=new nh;t.renderable=!1,super("attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\nuniform mat3 filterMatrix;\n\nvarying vec2 vTextureCoord;\nvarying vec2 vFilterCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n\tgl_Position = filterVertexPosition();\n\tvTextureCoord = filterTextureCoord();\n\tvFilterCoord = ( filterMatrix * vec3( vTextureCoord, 1.0)  ).xy;\n}\n","varying vec2 vFilterCoord;\nvarying vec2 vTextureCoord;\n\nuniform vec2 scale;\nuniform mat2 rotation;\nuniform sampler2D uSampler;\nuniform sampler2D mapSampler;\n\nuniform highp vec4 inputSize;\nuniform vec4 inputClamp;\n\nvoid main(void)\n{\n  vec4 map =  texture2D(mapSampler, vFilterCoord);\n\n  map -= 0.5;\n  map.xy = scale * inputSize.zw * (rotation * map.xy);\n\n  gl_FragColor = texture2D(uSampler, clamp(vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y), inputClamp.xy, inputClamp.zw));\n}\n",{mapSampler:t._texture,filterMatrix:n,scale:{x:1,y:1},rotation:new Float32Array([1,0,0,1])}),this.maskSprite=t,this.maskMatrix=n,null==e&&(e=20),this.scale=new ql(e,e)}apply(t,e,n,s){this.uniforms.filterMatrix=t.calculateSpriteMatrix(this.maskMatrix,this.maskSprite),this.uniforms.scale.x=this.scale.x,this.uniforms.scale.y=this.scale.y;const i=this.maskSprite.worldTransform,r=Math.sqrt(i.a*i.a+i.b*i.b),a=Math.sqrt(i.c*i.c+i.d*i.d);0!==r&&0!==a&&(this.uniforms.rotation[0]=i.a/r,this.uniforms.rotation[1]=i.b/r,this.uniforms.rotation[2]=i.c/a,this.uniforms.rotation[3]=i.d/a),t.applyFilter(this,e,n,s)}get map(){return this.uniforms.mapSampler}set map(t){this.uniforms.mapSampler=t}},FXAAFilter:class extends Gh{constructor(){super("\nattribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\nvarying vec2 vFragCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvoid texcoords(vec2 fragCoord, vec2 inverseVP,\n               out vec2 v_rgbNW, out vec2 v_rgbNE,\n               out vec2 v_rgbSW, out vec2 v_rgbSE,\n               out vec2 v_rgbM) {\n    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;\n    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;\n    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;\n    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;\n    v_rgbM = vec2(fragCoord * inverseVP);\n}\n\nvoid main(void) {\n\n   gl_Position = filterVertexPosition();\n\n   vFragCoord = aVertexPosition * outputFrame.zw;\n\n   texcoords(vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n}\n",'varying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\nvarying vec2 vFragCoord;\nuniform sampler2D uSampler;\nuniform highp vec4 inputSize;\n\n\n/**\n Basic FXAA implementation based on the code on geeks3d.com with the\n modification that the texture2DLod stuff was removed since it\'s\n unsupported by WebGL.\n\n --\n\n From:\n https://github.com/mitsuhiko/webgl-meincraft\n\n Copyright (c) 2011 by Armin Ronacher.\n\n Some rights reserved.\n\n Redistribution and use in source and binary forms, with or without\n modification, are permitted provided that the following conditions are\n met:\n\n * Redistributions of source code must retain the above copyright\n notice, this list of conditions and the following disclaimer.\n\n * Redistributions in binary form must reproduce the above\n copyright notice, this list of conditions and the following\n disclaimer in the documentation and/or other materials provided\n with the distribution.\n\n * The names of the contributors may not be used to endorse or\n promote products derived from this software without specific\n prior written permission.\n\n THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\n LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\n A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\n OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\n THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\n#ifndef FXAA_REDUCE_MIN\n#define FXAA_REDUCE_MIN   (1.0/ 128.0)\n#endif\n#ifndef FXAA_REDUCE_MUL\n#define FXAA_REDUCE_MUL   (1.0 / 8.0)\n#endif\n#ifndef FXAA_SPAN_MAX\n#define FXAA_SPAN_MAX     8.0\n#endif\n\n//optimized version for mobile, where dependent\n//texture reads can be a bottleneck\nvec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 inverseVP,\n          vec2 v_rgbNW, vec2 v_rgbNE,\n          vec2 v_rgbSW, vec2 v_rgbSE,\n          vec2 v_rgbM) {\n    vec4 color;\n    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;\n    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;\n    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;\n    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;\n    vec4 texColor = texture2D(tex, v_rgbM);\n    vec3 rgbM  = texColor.xyz;\n    vec3 luma = vec3(0.299, 0.587, 0.114);\n    float lumaNW = dot(rgbNW, luma);\n    float lumaNE = dot(rgbNE, luma);\n    float lumaSW = dot(rgbSW, luma);\n    float lumaSE = dot(rgbSE, luma);\n    float lumaM  = dot(rgbM,  luma);\n    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));\n    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));\n\n    mediump vec2 dir;\n    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));\n    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));\n\n    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *\n                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);\n\n    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);\n    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),\n              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),\n                  dir * rcpDirMin)) * inverseVP;\n\n    vec3 rgbA = 0.5 * (\n                       texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +\n                       texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);\n    vec3 rgbB = rgbA * 0.5 + 0.25 * (\n                                     texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +\n                                     texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);\n\n    float lumaB = dot(rgbB, luma);\n    if ((lumaB < lumaMin) || (lumaB > lumaMax))\n        color = vec4(rgbA, texColor.a);\n    else\n        color = vec4(rgbB, texColor.a);\n    return color;\n}\n\nvoid main() {\n\n      vec4 color;\n\n      color = fxaa(uSampler, vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n\n      gl_FragColor = color;\n}\n')}},NoiseFilter:class extends Gh{constructor(t=.5,e=Math.random()){super(ou,"precision highp float;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform float uNoise;\nuniform float uSeed;\nuniform sampler2D uSampler;\n\nfloat rand(vec2 co)\n{\n    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);\n}\n\nvoid main()\n{\n    vec4 color = texture2D(uSampler, vTextureCoord);\n    float randomValue = rand(gl_FragCoord.xy * uSeed);\n    float diff = (randomValue - 0.5) * uNoise;\n\n    // Un-premultiply alpha before applying the color matrix. See issue #3539.\n    if (color.a > 0.0) {\n        color.rgb /= color.a;\n    }\n\n    color.r += diff;\n    color.g += diff;\n    color.b += diff;\n\n    // Premultiply alpha again.\n    color.rgb *= color.a;\n\n    gl_FragColor = color;\n}\n",{uNoise:0,uSeed:0}),this.noise=t,this.seed=e}get noise(){return this.uniforms.uNoise}set noise(t){this.uniforms.uNoise=t}get seed(){return this.uniforms.uSeed}set seed(t){this.uniforms.uSeed=t}}};Object.entries(Vu).forEach((([t,e])=>{Object.defineProperty(Vu,t,{get:()=>(vo("7.1.0",`filters.${t} has moved to ${t}`),e)})}));const Uu=new class{constructor(){this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this.tickerAdded=!1,this._pauseUpdate=!0}init(t){this.removeTickerListener(),this.events=t,this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this.tickerAdded=!1,this._pauseUpdate=!0}get pauseUpdate(){return this._pauseUpdate}set pauseUpdate(t){this._pauseUpdate=t}addTickerListener(){!this.tickerAdded&&this.domElement&&(iu.system.add(this.tickerUpdate,this,eu.INTERACTION),this.tickerAdded=!0)}removeTickerListener(){this.tickerAdded&&(iu.system.remove(this.tickerUpdate,this),this.tickerAdded=!1)}pointerMoved(){this._didMove=!0}update(){if(!this.domElement||this._pauseUpdate)return;if(this._didMove)return void(this._didMove=!1);const t=this.events.rootPointerEvent;this.events.supportsTouchEvents&&"touch"===t.pointerType||globalThis.document.dispatchEvent(new PointerEvent("pointermove",{clientX:t.clientX,clientY:t.clientY}))}tickerUpdate(t){this._deltaTime+=t,this._deltaTime<this.interactionFrequency||(this._deltaTime=0,this.update())}};class Xu{constructor(t){this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.composed=!1,this.defaultPrevented=!1,this.eventPhase=Xu.prototype.NONE,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new ql,this.page=new ql,this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=t}get layerX(){return this.layer.x}get layerY(){return this.layer.y}get pageX(){return this.page.x}get pageY(){return this.page.y}get data(){return this}composedPath(){return!this.manager||this.path&&this.path[this.path.length-1]===this.target||(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path}initEvent(t,e,n){throw new Error("initEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}initUIEvent(t,e,n,s,i){throw new Error("initUIEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}preventDefault(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0}stopImmediatePropagation(){this.propagationImmediatelyStopped=!0}stopPropagation(){this.propagationStopped=!0}}class Yu extends Xu{constructor(){super(...arguments),this.client=new ql,this.movement=new ql,this.offset=new ql,this.global=new ql,this.screen=new ql}get clientX(){return this.client.x}get clientY(){return this.client.y}get x(){return this.clientX}get y(){return this.clientY}get movementX(){return this.movement.x}get movementY(){return this.movement.y}get offsetX(){return this.offset.x}get offsetY(){return this.offset.y}get globalX(){return this.global.x}get globalY(){return this.global.y}get screenX(){return this.screen.x}get screenY(){return this.screen.y}getLocalPosition(t,e,n){return t.worldTransform.applyInverse(n||this.global,e)}getModifierState(t){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(t)}initMouseEvent(t,e,n,s,i,r,a,o,l,h,c,u,d,f,p){throw new Error("Method not implemented.")}}class Wu extends Yu{constructor(){super(...arguments),this.width=0,this.height=0,this.isPrimary=!1}getCoalescedEvents(){return"pointermove"===this.type||"mousemove"===this.type||"touchmove"===this.type?[this]:[]}getPredictedEvents(){throw new Error("getPredictedEvents is not supported!")}}class zu extends Yu{constructor(){super(...arguments),this.DOM_DELTA_PIXEL=0,this.DOM_DELTA_LINE=1,this.DOM_DELTA_PAGE=2}}zu.DOM_DELTA_PIXEL=0,zu.DOM_DELTA_LINE=1,zu.DOM_DELTA_PAGE=2;const Gu=new ql,Hu=new ql;class ju{constructor(t){this.dispatch=new ua,this.moveOnAll=!1,this.enableGlobalMoveEvents=!0,this.mappingState={trackingData:{}},this.eventPool=new Map,this._allInteractiveElements=[],this._hitElements=[],this._isPointerMoveEvent=!1,this.rootTarget=t,this.hitPruneFn=this.hitPruneFn.bind(this),this.hitTestFn=this.hitTestFn.bind(this),this.mapPointerDown=this.mapPointerDown.bind(this),this.mapPointerMove=this.mapPointerMove.bind(this),this.mapPointerOut=this.mapPointerOut.bind(this),this.mapPointerOver=this.mapPointerOver.bind(this),this.mapPointerUp=this.mapPointerUp.bind(this),this.mapPointerUpOutside=this.mapPointerUpOutside.bind(this),this.mapWheel=this.mapWheel.bind(this),this.mappingTable={},this.addEventMapping("pointerdown",this.mapPointerDown),this.addEventMapping("pointermove",this.mapPointerMove),this.addEventMapping("pointerout",this.mapPointerOut),this.addEventMapping("pointerleave",this.mapPointerOut),this.addEventMapping("pointerover",this.mapPointerOver),this.addEventMapping("pointerup",this.mapPointerUp),this.addEventMapping("pointerupoutside",this.mapPointerUpOutside),this.addEventMapping("wheel",this.mapWheel)}addEventMapping(t,e){this.mappingTable[t]||(this.mappingTable[t]=[]),this.mappingTable[t].push({fn:e,priority:0}),this.mappingTable[t].sort(((t,e)=>t.priority-e.priority))}dispatchEvent(t,e){t.propagationStopped=!1,t.propagationImmediatelyStopped=!1,this.propagate(t,e),this.dispatch.emit(e||t.type,t)}mapEvent(t){if(!this.rootTarget)return;const e=this.mappingTable[t.type];if(e)for(let n=0,s=e.length;n<s;n++)e[n].fn(t);else console.warn(`[EventBoundary]: Event mapping not defined for ${t.type}`)}hitTest(t,e){Uu.pauseUpdate=!0;const n=this[this._isPointerMoveEvent&&this.enableGlobalMoveEvents?"hitTestMoveRecursive":"hitTestRecursive"](this.rootTarget,this.rootTarget.eventMode,Gu.set(t,e),this.hitTestFn,this.hitPruneFn);return n&&n[0]}propagate(t,e){if(!t.target)return;const n=t.composedPath();t.eventPhase=t.CAPTURING_PHASE;for(let s=0,i=n.length-1;s<i;s++)if(t.currentTarget=n[s],this.notifyTarget(t,e),t.propagationStopped||t.propagationImmediatelyStopped)return;if(t.eventPhase=t.AT_TARGET,t.currentTarget=t.target,this.notifyTarget(t,e),!t.propagationStopped&&!t.propagationImmediatelyStopped){t.eventPhase=t.BUBBLING_PHASE;for(let s=n.length-2;s>=0;s--)if(t.currentTarget=n[s],this.notifyTarget(t,e),t.propagationStopped||t.propagationImmediatelyStopped)return}}all(t,e,n=this._allInteractiveElements){if(0===n.length)return;t.eventPhase=t.BUBBLING_PHASE;const s=Array.isArray(e)?e:[e];for(let i=n.length-1;i>=0;i--)s.forEach((e=>{t.currentTarget=n[i],this.notifyTarget(t,e)}))}propagationPath(t){const e=[t];for(let n=0;n<2048&&t!==this.rootTarget;n++){if(!t.parent)throw new Error("Cannot find propagation path to disconnected target");e.push(t.parent),t=t.parent}return e.reverse(),e}hitTestMoveRecursive(t,e,n,s,i,r=!1){let a=!1;if(this._interactivePrune(t))return null;if("dynamic"!==t.eventMode&&"dynamic"!==e||(Uu.pauseUpdate=!1),t.interactiveChildren&&t.children){const o=t.children;for(let l=o.length-1;l>=0;l--){const h=o[l],c=this.hitTestMoveRecursive(h,this._isInteractive(e)?e:h.eventMode,n,s,i,r||i(t,n));if(c){if(c.length>0&&!c[c.length-1].parent)continue;const e=t.isInteractive();(c.length>0||e)&&(e&&this._allInteractiveElements.push(t),c.push(t)),0===this._hitElements.length&&(this._hitElements=c),a=!0}}}const o=this._isInteractive(e),l=t.isInteractive();return l&&l&&this._allInteractiveElements.push(t),r||this._hitElements.length>0?null:a?this._hitElements:o&&!i(t,n)&&s(t,n)?l?[t]:[]:null}hitTestRecursive(t,e,n,s,i){if(this._interactivePrune(t)||i(t,n))return null;if("dynamic"!==t.eventMode&&"dynamic"!==e||(Uu.pauseUpdate=!1),t.interactiveChildren&&t.children){const r=t.children;for(let a=r.length-1;a>=0;a--){const o=r[a],l=this.hitTestRecursive(o,this._isInteractive(e)?e:o.eventMode,n,s,i);if(l){if(l.length>0&&!l[l.length-1].parent)continue;const e=t.isInteractive();return(l.length>0||e)&&l.push(t),l}}}const r=this._isInteractive(e),a=t.isInteractive();return r&&s(t,n)?a?[t]:[]:null}_isInteractive(t){return"static"===t||"dynamic"===t}_interactivePrune(t){return!(t&&!t.isMask&&t.visible&&t.renderable)||("none"===t.eventMode||("passive"===t.eventMode&&!t.interactiveChildren||!!t.isMask))}hitPruneFn(t,e){var n;if(t.hitArea&&(t.worldTransform.applyInverse(e,Hu),!t.hitArea.contains(Hu.x,Hu.y)))return!0;if(t._mask){const s=t._mask.isMaskData?t._mask.maskObject:t._mask;if(s&&!(null==(n=s.containsPoint)?void 0:n.call(s,e)))return!0}return!1}hitTestFn(t,e){return"passive"!==t.eventMode&&(!!t.hitArea||!!t.containsPoint&&t.containsPoint(e))}notifyTarget(t,e){var n,s;const i=`on${e=null!=e?e:t.type}`;null==(s=(n=t.currentTarget)[i])||s.call(n,t);const r=t.eventPhase===t.CAPTURING_PHASE||t.eventPhase===t.AT_TARGET?`${e}capture`:e;this.notifyListeners(t,r),t.eventPhase===t.AT_TARGET&&this.notifyListeners(t,e)}mapPointerDown(t){if(!(t instanceof Wu))return void console.warn("EventBoundary cannot map a non-pointer event as a pointer event");const e=this.createPointerEvent(t);if(this.dispatchEvent(e,"pointerdown"),"touch"===e.pointerType)this.dispatchEvent(e,"touchstart");else if("mouse"===e.pointerType||"pen"===e.pointerType){const t=2===e.button;this.dispatchEvent(e,t?"rightdown":"mousedown")}this.trackingData(t.pointerId).pressTargetsByButton[t.button]=e.composedPath(),this.freeEvent(e)}mapPointerMove(t){var e,n,s;if(!(t instanceof Wu))return void console.warn("EventBoundary cannot map a non-pointer event as a pointer event");this._allInteractiveElements.length=0,this._hitElements.length=0,this._isPointerMoveEvent=!0;const i=this.createPointerEvent(t);this._isPointerMoveEvent=!1;const r="mouse"===i.pointerType||"pen"===i.pointerType,a=this.trackingData(t.pointerId),o=this.findMountedTarget(a.overTargets);if((null==(e=a.overTargets)?void 0:e.length)>0&&o!==i.target){const e="mousemove"===t.type?"mouseout":"pointerout",n=this.createPointerEvent(t,e,o);if(this.dispatchEvent(n,"pointerout"),r&&this.dispatchEvent(n,"mouseout"),!i.composedPath().includes(o)){const e=this.createPointerEvent(t,"pointerleave",o);for(e.eventPhase=e.AT_TARGET;e.target&&!i.composedPath().includes(e.target);)e.currentTarget=e.target,this.notifyTarget(e),r&&this.notifyTarget(e,"mouseleave"),e.target=e.target.parent;this.freeEvent(e)}this.freeEvent(n)}if(o!==i.target){const e="mousemove"===t.type?"mouseover":"pointerover",n=this.clonePointerEvent(i,e);this.dispatchEvent(n,"pointerover"),r&&this.dispatchEvent(n,"mouseover");let s=null==o?void 0:o.parent;for(;s&&s!==this.rootTarget.parent&&s!==i.target;)s=s.parent;if(!s||s===this.rootTarget.parent){const t=this.clonePointerEvent(i,"pointerenter");for(t.eventPhase=t.AT_TARGET;t.target&&t.target!==o&&t.target!==this.rootTarget.parent;)t.currentTarget=t.target,this.notifyTarget(t),r&&this.notifyTarget(t,"mouseenter"),t.target=t.target.parent;this.freeEvent(t)}this.freeEvent(n)}const l=[],h=null==(n=this.enableGlobalMoveEvents)||n;this.moveOnAll?l.push("pointermove"):this.dispatchEvent(i,"pointermove"),h&&l.push("globalpointermove"),"touch"===i.pointerType&&(this.moveOnAll?l.splice(1,0,"touchmove"):this.dispatchEvent(i,"touchmove"),h&&l.push("globaltouchmove")),r&&(this.moveOnAll?l.splice(1,0,"mousemove"):this.dispatchEvent(i,"mousemove"),h&&l.push("globalmousemove"),this.cursor=null==(s=i.target)?void 0:s.cursor),l.length>0&&this.all(i,l),this._allInteractiveElements.length=0,this._hitElements.length=0,a.overTargets=i.composedPath(),this.freeEvent(i)}mapPointerOver(t){var e;if(!(t instanceof Wu))return void console.warn("EventBoundary cannot map a non-pointer event as a pointer event");const n=this.trackingData(t.pointerId),s=this.createPointerEvent(t),i="mouse"===s.pointerType||"pen"===s.pointerType;this.dispatchEvent(s,"pointerover"),i&&this.dispatchEvent(s,"mouseover"),"mouse"===s.pointerType&&(this.cursor=null==(e=s.target)?void 0:e.cursor);const r=this.clonePointerEvent(s,"pointerenter");for(r.eventPhase=r.AT_TARGET;r.target&&r.target!==this.rootTarget.parent;)r.currentTarget=r.target,this.notifyTarget(r),i&&this.notifyTarget(r,"mouseenter"),r.target=r.target.parent;n.overTargets=s.composedPath(),this.freeEvent(s),this.freeEvent(r)}mapPointerOut(t){if(!(t instanceof Wu))return void console.warn("EventBoundary cannot map a non-pointer event as a pointer event");const e=this.trackingData(t.pointerId);if(e.overTargets){const n="mouse"===t.pointerType||"pen"===t.pointerType,s=this.findMountedTarget(e.overTargets),i=this.createPointerEvent(t,"pointerout",s);this.dispatchEvent(i),n&&this.dispatchEvent(i,"mouseout");const r=this.createPointerEvent(t,"pointerleave",s);for(r.eventPhase=r.AT_TARGET;r.target&&r.target!==this.rootTarget.parent;)r.currentTarget=r.target,this.notifyTarget(r),n&&this.notifyTarget(r,"mouseleave"),r.target=r.target.parent;e.overTargets=null,this.freeEvent(i),this.freeEvent(r)}this.cursor=null}mapPointerUp(t){if(!(t instanceof Wu))return void console.warn("EventBoundary cannot map a non-pointer event as a pointer event");const e=performance.now(),n=this.createPointerEvent(t);if(this.dispatchEvent(n,"pointerup"),"touch"===n.pointerType)this.dispatchEvent(n,"touchend");else if("mouse"===n.pointerType||"pen"===n.pointerType){const t=2===n.button;this.dispatchEvent(n,t?"rightup":"mouseup")}const s=this.trackingData(t.pointerId),i=this.findMountedTarget(s.pressTargetsByButton[t.button]);let r=i;if(i&&!n.composedPath().includes(i)){let e=i;for(;e&&!n.composedPath().includes(e);){if(n.currentTarget=e,this.notifyTarget(n,"pointerupoutside"),"touch"===n.pointerType)this.notifyTarget(n,"touchendoutside");else if("mouse"===n.pointerType||"pen"===n.pointerType){const t=2===n.button;this.notifyTarget(n,t?"rightupoutside":"mouseupoutside")}e=e.parent}delete s.pressTargetsByButton[t.button],r=e}if(r){const i=this.clonePointerEvent(n,"click");i.target=r,i.path=null,s.clicksByButton[t.button]||(s.clicksByButton[t.button]={clickCount:0,target:i.target,timeStamp:e});const a=s.clicksByButton[t.button];if(a.target===i.target&&e-a.timeStamp<200?++a.clickCount:a.clickCount=1,a.target=i.target,a.timeStamp=e,i.detail=a.clickCount,"mouse"===i.pointerType){const t=2===i.button;this.dispatchEvent(i,t?"rightclick":"click")}else"touch"===i.pointerType&&this.dispatchEvent(i,"tap");this.dispatchEvent(i,"pointertap"),this.freeEvent(i)}this.freeEvent(n)}mapPointerUpOutside(t){if(!(t instanceof Wu))return void console.warn("EventBoundary cannot map a non-pointer event as a pointer event");const e=this.trackingData(t.pointerId),n=this.findMountedTarget(e.pressTargetsByButton[t.button]),s=this.createPointerEvent(t);if(n){let i=n;for(;i;)s.currentTarget=i,this.notifyTarget(s,"pointerupoutside"),"touch"===s.pointerType?this.notifyTarget(s,"touchendoutside"):"mouse"!==s.pointerType&&"pen"!==s.pointerType||this.notifyTarget(s,2===s.button?"rightupoutside":"mouseupoutside"),i=i.parent;delete e.pressTargetsByButton[t.button]}this.freeEvent(s)}mapWheel(t){if(!(t instanceof zu))return void console.warn("EventBoundary cannot map a non-wheel event as a wheel event");const e=this.createWheelEvent(t);this.dispatchEvent(e),this.freeEvent(e)}findMountedTarget(t){if(!t)return null;let e=t[0];for(let n=1;n<t.length&&t[n].parent===e;n++)e=t[n];return e}createPointerEvent(t,e,n){var s;const i=this.allocateEvent(Wu);return this.copyPointerData(t,i),this.copyMouseData(t,i),this.copyData(t,i),i.nativeEvent=t.nativeEvent,i.originalEvent=t,i.target=null!=(s=null!=n?n:this.hitTest(i.global.x,i.global.y))?s:this._hitElements[0],"string"==typeof e&&(i.type=e),i}createWheelEvent(t){const e=this.allocateEvent(zu);return this.copyWheelData(t,e),this.copyMouseData(t,e),this.copyData(t,e),e.nativeEvent=t.nativeEvent,e.originalEvent=t,e.target=this.hitTest(e.global.x,e.global.y),e}clonePointerEvent(t,e){const n=this.allocateEvent(Wu);return n.nativeEvent=t.nativeEvent,n.originalEvent=t.originalEvent,this.copyPointerData(t,n),this.copyMouseData(t,n),this.copyData(t,n),n.target=t.target,n.path=t.composedPath().slice(),n.type=null!=e?e:n.type,n}copyWheelData(t,e){e.deltaMode=t.deltaMode,e.deltaX=t.deltaX,e.deltaY=t.deltaY,e.deltaZ=t.deltaZ}copyPointerData(t,e){t instanceof Wu&&e instanceof Wu&&(e.pointerId=t.pointerId,e.width=t.width,e.height=t.height,e.isPrimary=t.isPrimary,e.pointerType=t.pointerType,e.pressure=t.pressure,e.tangentialPressure=t.tangentialPressure,e.tiltX=t.tiltX,e.tiltY=t.tiltY,e.twist=t.twist)}copyMouseData(t,e){t instanceof Yu&&e instanceof Yu&&(e.altKey=t.altKey,e.button=t.button,e.buttons=t.buttons,e.client.copyFrom(t.client),e.ctrlKey=t.ctrlKey,e.metaKey=t.metaKey,e.movement.copyFrom(t.movement),e.screen.copyFrom(t.screen),e.shiftKey=t.shiftKey,e.global.copyFrom(t.global))}copyData(t,e){e.isTrusted=t.isTrusted,e.srcElement=t.srcElement,e.timeStamp=performance.now(),e.type=t.type,e.detail=t.detail,e.view=t.view,e.which=t.which,e.layer.copyFrom(t.layer),e.page.copyFrom(t.page)}trackingData(t){return this.mappingState.trackingData[t]||(this.mappingState.trackingData[t]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[t]}allocateEvent(t){this.eventPool.has(t)||this.eventPool.set(t,[]);const e=this.eventPool.get(t).pop()||new t(this);return e.eventPhase=e.NONE,e.currentTarget=null,e.path=null,e.target=null,e}freeEvent(t){if(t.manager!==this)throw new Error("It is illegal to free an event not managed by this EventBoundary!");const e=t.constructor;this.eventPool.has(e)||this.eventPool.set(e,[]),this.eventPool.get(e).push(t)}notifyListeners(t,e){const n=t.currentTarget._events[e];if(n&&t.currentTarget.isInteractive())if("fn"in n)n.once&&t.currentTarget.removeListener(e,n.fn,void 0,!0),n.fn.call(n.context,t);else for(let s=0,i=n.length;s<i&&!t.propagationImmediatelyStopped;s++)n[s].once&&t.currentTarget.removeListener(e,n[s].fn,void 0,!0),n[s].fn.call(n[s].context,t)}}const $u={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"},qu=class{constructor(t){this.supportsTouchEvents="ontouchstart"in globalThis,this.supportsPointerEvents=!!globalThis.PointerEvent,this.domElement=null,this.resolution=1,this.renderer=t,this.rootBoundary=new ju(null),Uu.init(this),this.autoPreventDefault=!0,this.eventsAdded=!1,this.rootPointerEvent=new Wu(null),this.rootWheelEvent=new zu(null),this.cursorStyles={default:"inherit",pointer:"pointer"},this.features=new Proxy(u({},qu.defaultEventFeatures),{set:(t,e,n)=>("globalMove"===e&&(this.rootBoundary.enableGlobalMoveEvents=n),t[e]=n,!0)}),this.onPointerDown=this.onPointerDown.bind(this),this.onPointerMove=this.onPointerMove.bind(this),this.onPointerUp=this.onPointerUp.bind(this),this.onPointerOverOut=this.onPointerOverOut.bind(this),this.onWheel=this.onWheel.bind(this)}static get defaultEventMode(){return this._defaultEventMode}init(t){var e,n;const{view:s,resolution:i}=this.renderer;this.setTargetElement(s),this.resolution=i,qu._defaultEventMode=null!=(e=t.eventMode)?e:"auto",Object.assign(this.features,null!=(n=t.eventFeatures)?n:{}),this.rootBoundary.enableGlobalMoveEvents=this.features.globalMove}resolutionChange(t){this.resolution=t}destroy(){this.setTargetElement(null),this.renderer=null}setCursor(t){t=t||"default";let e=!0;if(globalThis.OffscreenCanvas&&this.domElement instanceof OffscreenCanvas&&(e=!1),this.currentCursor===t)return;this.currentCursor=t;const n=this.cursorStyles[t];if(n)switch(typeof n){case"string":e&&(this.domElement.style.cursor=n);break;case"function":n(t);break;case"object":e&&Object.assign(this.domElement.style,n)}else e&&"string"==typeof t&&!Object.prototype.hasOwnProperty.call(this.cursorStyles,t)&&(this.domElement.style.cursor=t)}get pointer(){return this.rootPointerEvent}onPointerDown(t){if(!this.features.click)return;if(this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.supportsTouchEvents&&"touch"===t.pointerType)return;const e=this.normalizeToPointerData(t);if(this.autoPreventDefault&&e[0].isNormalized){(t.cancelable||!("cancelable"in t))&&t.preventDefault()}for(let n=0,s=e.length;n<s;n++){const t=e[n],s=this.bootstrapEvent(this.rootPointerEvent,t);this.rootBoundary.mapEvent(s)}this.setCursor(this.rootBoundary.cursor)}onPointerMove(t){if(!this.features.move)return;if(this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.supportsTouchEvents&&"touch"===t.pointerType)return;Uu.pointerMoved();const e=this.normalizeToPointerData(t);for(let n=0,s=e.length;n<s;n++){const t=this.bootstrapEvent(this.rootPointerEvent,e[n]);this.rootBoundary.mapEvent(t)}this.setCursor(this.rootBoundary.cursor)}onPointerUp(t){if(!this.features.click)return;if(this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.supportsTouchEvents&&"touch"===t.pointerType)return;let e=t.target;t.composedPath&&t.composedPath().length>0&&(e=t.composedPath()[0]);const n=e!==this.domElement?"outside":"",s=this.normalizeToPointerData(t);for(let i=0,r=s.length;i<r;i++){const t=this.bootstrapEvent(this.rootPointerEvent,s[i]);t.type+=n,this.rootBoundary.mapEvent(t)}this.setCursor(this.rootBoundary.cursor)}onPointerOverOut(t){if(!this.features.click)return;if(this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.supportsTouchEvents&&"touch"===t.pointerType)return;const e=this.normalizeToPointerData(t);for(let n=0,s=e.length;n<s;n++){const t=this.bootstrapEvent(this.rootPointerEvent,e[n]);this.rootBoundary.mapEvent(t)}this.setCursor(this.rootBoundary.cursor)}onWheel(t){if(!this.features.wheel)return;const e=this.normalizeWheelEvent(t);this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.rootBoundary.mapEvent(e)}setTargetElement(t){this.removeEvents(),this.domElement=t,Uu.domElement=t,this.addEvents()}addEvents(){if(this.eventsAdded||!this.domElement)return;Uu.addTickerListener();const t=this.domElement.style;t&&(globalThis.navigator.msPointerEnabled?(t.msContentZooming="none",t.msTouchAction="none"):this.supportsPointerEvents&&(t.touchAction="none")),this.supportsPointerEvents?(globalThis.document.addEventListener("pointermove",this.onPointerMove,!0),this.domElement.addEventListener("pointerdown",this.onPointerDown,!0),this.domElement.addEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.addEventListener("pointerover",this.onPointerOverOut,!0),globalThis.addEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.addEventListener("mousemove",this.onPointerMove,!0),this.domElement.addEventListener("mousedown",this.onPointerDown,!0),this.domElement.addEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.addEventListener("mouseover",this.onPointerOverOut,!0),globalThis.addEventListener("mouseup",this.onPointerUp,!0)),this.supportsTouchEvents&&(this.domElement.addEventListener("touchstart",this.onPointerDown,!0),this.domElement.addEventListener("touchend",this.onPointerUp,!0),this.domElement.addEventListener("touchmove",this.onPointerMove,!0)),this.domElement.addEventListener("wheel",this.onWheel,{passive:!0,capture:!0}),this.eventsAdded=!0}removeEvents(){if(!this.eventsAdded||!this.domElement)return;Uu.removeTickerListener();const t=this.domElement.style;globalThis.navigator.msPointerEnabled?(t.msContentZooming="",t.msTouchAction=""):this.supportsPointerEvents&&(t.touchAction=""),this.supportsPointerEvents?(globalThis.document.removeEventListener("pointermove",this.onPointerMove,!0),this.domElement.removeEventListener("pointerdown",this.onPointerDown,!0),this.domElement.removeEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.removeEventListener("pointerover",this.onPointerOverOut,!0),globalThis.removeEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.removeEventListener("mousemove",this.onPointerMove,!0),this.domElement.removeEventListener("mousedown",this.onPointerDown,!0),this.domElement.removeEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.removeEventListener("mouseover",this.onPointerOverOut,!0),globalThis.removeEventListener("mouseup",this.onPointerUp,!0)),this.supportsTouchEvents&&(this.domElement.removeEventListener("touchstart",this.onPointerDown,!0),this.domElement.removeEventListener("touchend",this.onPointerUp,!0),this.domElement.removeEventListener("touchmove",this.onPointerMove,!0)),this.domElement.removeEventListener("wheel",this.onWheel,!0),this.domElement=null,this.eventsAdded=!1}mapPositionToPoint(t,e,n){let s;s=this.domElement.parentElement?this.domElement.getBoundingClientRect():{x:0,y:0,width:this.domElement.width,height:this.domElement.height,left:0,top:0};const i=1/this.resolution;t.x=(e-s.left)*(this.domElement.width/s.width)*i,t.y=(n-s.top)*(this.domElement.height/s.height)*i}normalizeToPointerData(t){const e=[];if(this.supportsTouchEvents&&t instanceof TouchEvent)for(let n=0,s=t.changedTouches.length;n<s;n++){const s=t.changedTouches[n];void 0===s.button&&(s.button=0),void 0===s.buttons&&(s.buttons=1),void 0===s.isPrimary&&(s.isPrimary=1===t.touches.length&&"touchstart"===t.type),void 0===s.width&&(s.width=s.radiusX||1),void 0===s.height&&(s.height=s.radiusY||1),void 0===s.tiltX&&(s.tiltX=0),void 0===s.tiltY&&(s.tiltY=0),void 0===s.pointerType&&(s.pointerType="touch"),void 0===s.pointerId&&(s.pointerId=s.identifier||0),void 0===s.pressure&&(s.pressure=s.force||.5),void 0===s.twist&&(s.twist=0),void 0===s.tangentialPressure&&(s.tangentialPressure=0),void 0===s.layerX&&(s.layerX=s.offsetX=s.clientX),void 0===s.layerY&&(s.layerY=s.offsetY=s.clientY),s.isNormalized=!0,s.type=t.type,e.push(s)}else if(globalThis.MouseEvent&&(!(t instanceof MouseEvent)||this.supportsPointerEvents&&t instanceof globalThis.PointerEvent))e.push(t);else{const n=t;void 0===n.isPrimary&&(n.isPrimary=!0),void 0===n.width&&(n.width=1),void 0===n.height&&(n.height=1),void 0===n.tiltX&&(n.tiltX=0),void 0===n.tiltY&&(n.tiltY=0),void 0===n.pointerType&&(n.pointerType="mouse"),void 0===n.pointerId&&(n.pointerId=1),void 0===n.pressure&&(n.pressure=.5),void 0===n.twist&&(n.twist=0),void 0===n.tangentialPressure&&(n.tangentialPressure=0),n.isNormalized=!0,e.push(n)}return e}normalizeWheelEvent(t){const e=this.rootWheelEvent;return this.transferMouseData(e,t),e.deltaX=t.deltaX,e.deltaY=t.deltaY,e.deltaZ=t.deltaZ,e.deltaMode=t.deltaMode,this.mapPositionToPoint(e.screen,t.clientX,t.clientY),e.global.copyFrom(e.screen),e.offset.copyFrom(e.screen),e.nativeEvent=t,e.type=t.type,e}bootstrapEvent(t,e){return t.originalEvent=null,t.nativeEvent=e,t.pointerId=e.pointerId,t.width=e.width,t.height=e.height,t.isPrimary=e.isPrimary,t.pointerType=e.pointerType,t.pressure=e.pressure,t.tangentialPressure=e.tangentialPressure,t.tiltX=e.tiltX,t.tiltY=e.tiltY,t.twist=e.twist,this.transferMouseData(t,e),this.mapPositionToPoint(t.screen,e.clientX,e.clientY),t.global.copyFrom(t.screen),t.offset.copyFrom(t.screen),t.isTrusted=e.isTrusted,"pointerleave"===t.type&&(t.type="pointerout"),t.type.startsWith("mouse")&&(t.type=t.type.replace("mouse","pointer")),t.type.startsWith("touch")&&(t.type=$u[t.type]||t.type),t}transferMouseData(t,e){t.isTrusted=e.isTrusted,t.srcElement=e.srcElement,t.timeStamp=performance.now(),t.type=e.type,t.altKey=e.altKey,t.button=e.button,t.buttons=e.buttons,t.client.x=e.clientX,t.client.y=e.clientY,t.ctrlKey=e.ctrlKey,t.metaKey=e.metaKey,t.movement.x=e.movementX,t.movement.y=e.movementY,t.page.x=e.pageX,t.page.y=e.pageY,t.relatedTarget=null,t.shiftKey=e.shiftKey}};let Ku=qu;function Zu(t){return"dynamic"===t||"static"===t}Ku.extension={name:"events",type:[yl.RendererSystem,yl.CanvasRendererSystem]},Ku.defaultEventFeatures={move:!0,globalMove:!0,click:!0,wheel:!0},wl.add(Ku);const Qu={onclick:null,onmousedown:null,onmouseenter:null,onmouseleave:null,onmousemove:null,onglobalmousemove:null,onmouseout:null,onmouseover:null,onmouseup:null,onmouseupoutside:null,onpointercancel:null,onpointerdown:null,onpointerenter:null,onpointerleave:null,onpointermove:null,onglobalpointermove:null,onpointerout:null,onpointerover:null,onpointertap:null,onpointerup:null,onpointerupoutside:null,onrightclick:null,onrightdown:null,onrightup:null,onrightupoutside:null,ontap:null,ontouchcancel:null,ontouchend:null,ontouchendoutside:null,ontouchmove:null,onglobaltouchmove:null,ontouchstart:null,onwheel:null,_internalInteractive:void 0,get interactive(){var t;return null!=(t=this._internalInteractive)?t:Zu(Ku.defaultEventMode)},set interactive(t){vo("7.2.0","Setting interactive is deprecated, use eventMode = 'none'/'passive'/'auto'/'static'/'dynamic' instead."),this._internalInteractive=t,this.eventMode=t?"static":"auto"},_internalEventMode:void 0,get eventMode(){var t;return null!=(t=this._internalEventMode)?t:Ku.defaultEventMode},set eventMode(t){this._internalInteractive=Zu(t),this._internalEventMode=t},isInteractive(){return"static"===this.eventMode||"dynamic"===this.eventMode},interactiveChildren:!0,hitArea:null,addEventListener(t,e,n){const s="function"==typeof e?void 0:e;t="boolean"==typeof n&&n||"object"==typeof n&&n.capture?`${t}capture`:t,e="function"==typeof e?e:e.handleEvent,this.on(t,e,s)},removeEventListener(t,e,n){const s="function"==typeof e?void 0:e;t="boolean"==typeof n&&n||"object"==typeof n&&n.capture?`${t}capture`:t,e="function"==typeof e?e:e.handleEvent,this.off(t,e,s)},dispatchEvent(t){if(!(t instanceof Xu))throw new Error("DisplayObject cannot propagate events outside of the Federated Events API");return t.defaultPrevented=!1,t.path=null,t.target=this,t.manager.dispatchEvent(t),!t.defaultPrevented}};Eu.mixin(Qu);Eu.mixin({accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:null,accessibleType:"button",accessiblePointerEvents:"auto",accessibleChildren:!0,renderId:-1});class Ju{constructor(t){this.debug=!1,this._isActive=!1,this._isMobileAccessibility=!1,this.pool=[],this.renderId=0,this.children=[],this.androidUpdateCount=0,this.androidUpdateFrequency=500,this._hookDiv=null,(la.tablet||la.phone)&&this.createTouchHook();const e=document.createElement("div");e.style.width="100px",e.style.height="100px",e.style.position="absolute",e.style.top="0px",e.style.left="0px",e.style.zIndex=2..toString(),this.div=e,this.renderer=t,this._onKeyDown=this._onKeyDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),globalThis.addEventListener("keydown",this._onKeyDown,!1)}get isActive(){return this._isActive}get isMobileAccessibility(){return this._isMobileAccessibility}createTouchHook(){const t=document.createElement("button");t.style.width="1px",t.style.height="1px",t.style.position="absolute",t.style.top="-1000px",t.style.left="-1000px",t.style.zIndex=2..toString(),t.style.backgroundColor="#FF0000",t.title="select to enable accessibility for this content",t.addEventListener("focus",(()=>{this._isMobileAccessibility=!0,this.activate(),this.destroyTouchHook()})),document.body.appendChild(t),this._hookDiv=t}destroyTouchHook(){this._hookDiv&&(document.body.removeChild(this._hookDiv),this._hookDiv=null)}activate(){var t;this._isActive||(this._isActive=!0,globalThis.document.addEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown,!1),this.renderer.on("postrender",this.update,this),null==(t=this.renderer.view.parentNode)||t.appendChild(this.div))}deactivate(){var t;this._isActive&&!this._isMobileAccessibility&&(this._isActive=!1,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.addEventListener("keydown",this._onKeyDown,!1),this.renderer.off("postrender",this.update),null==(t=this.div.parentNode)||t.removeChild(this.div))}updateAccessibleObjects(t){if(!t.visible||!t.accessibleChildren)return;t.accessible&&t.isInteractive()&&(t._accessibleActive||this.addChild(t),t.renderId=this.renderId);const e=t.children;if(e)for(let n=0;n<e.length;n++)this.updateAccessibleObjects(e[n])}update(){const t=performance.now();if(la.android.device&&t<this.androidUpdateCount)return;if(this.androidUpdateCount=t+this.androidUpdateFrequency,!this.renderer.renderingToScreen)return;this.renderer.lastObjectRendered&&this.updateAccessibleObjects(this.renderer.lastObjectRendered);const{x:e,y:n,width:s,height:i}=this.renderer.view.getBoundingClientRect(),{width:r,height:a,resolution:o}=this.renderer,l=s/r*o,h=i/a*o;let c=this.div;c.style.left=`${e}px`,c.style.top=`${n}px`,c.style.width=`${r}px`,c.style.height=`${a}px`;for(let u=0;u<this.children.length;u++){const t=this.children[u];if(t.renderId!==this.renderId)t._accessibleActive=!1,il(this.children,u,1),this.div.removeChild(t._accessibleDiv),this.pool.push(t._accessibleDiv),t._accessibleDiv=null,u--;else{c=t._accessibleDiv;let e=t.hitArea;const n=t.worldTransform;t.hitArea?(c.style.left=(n.tx+e.x*n.a)*l+"px",c.style.top=(n.ty+e.y*n.d)*h+"px",c.style.width=e.width*n.a*l+"px",c.style.height=e.height*n.d*h+"px"):(e=t.getBounds(),this.capHitArea(e),c.style.left=e.x*l+"px",c.style.top=e.y*h+"px",c.style.width=e.width*l+"px",c.style.height=e.height*h+"px",c.title!==t.accessibleTitle&&null!==t.accessibleTitle&&(c.title=t.accessibleTitle),c.getAttribute("aria-label")!==t.accessibleHint&&null!==t.accessibleHint&&c.setAttribute("aria-label",t.accessibleHint)),t.accessibleTitle===c.title&&t.tabIndex===c.tabIndex||(c.title=t.accessibleTitle,c.tabIndex=t.tabIndex,this.debug&&this.updateDebugHTML(c))}}this.renderId++}updateDebugHTML(t){t.innerHTML=`type: ${t.type}</br> title : ${t.title}</br> tabIndex: ${t.tabIndex}`}capHitArea(t){t.x<0&&(t.width+=t.x,t.x=0),t.y<0&&(t.height+=t.y,t.y=0);const{width:e,height:n}=this.renderer;t.x+t.width>e&&(t.width=e-t.x),t.y+t.height>n&&(t.height=n-t.y)}addChild(t){let e=this.pool.pop();e||(e=document.createElement("button"),e.style.width="100px",e.style.height="100px",e.style.backgroundColor=this.debug?"rgba(255,255,255,0.5)":"transparent",e.style.position="absolute",e.style.zIndex=2..toString(),e.style.borderStyle="none",navigator.userAgent.toLowerCase().includes("chrome")?e.setAttribute("aria-live","off"):e.setAttribute("aria-live","polite"),navigator.userAgent.match(/rv:.*Gecko\//)?e.setAttribute("aria-relevant","additions"):e.setAttribute("aria-relevant","text"),e.addEventListener("click",this._onClick.bind(this)),e.addEventListener("focus",this._onFocus.bind(this)),e.addEventListener("focusout",this._onFocusOut.bind(this))),e.style.pointerEvents=t.accessiblePointerEvents,e.type=t.accessibleType,t.accessibleTitle&&null!==t.accessibleTitle?e.title=t.accessibleTitle:t.accessibleHint&&null!==t.accessibleHint||(e.title=`displayObject ${t.tabIndex}`),t.accessibleHint&&null!==t.accessibleHint&&e.setAttribute("aria-label",t.accessibleHint),this.debug&&this.updateDebugHTML(e),t._accessibleActive=!0,t._accessibleDiv=e,e.displayObject=t,this.children.push(t),this.div.appendChild(t._accessibleDiv),t._accessibleDiv.tabIndex=t.tabIndex}_dispatchEvent(t,e){const{displayObject:n}=t.target,s=this.renderer.events.rootBoundary,i=Object.assign(new Xu(s),{target:n});s.rootTarget=this.renderer.lastObjectRendered,e.forEach((t=>s.dispatchEvent(i,t)))}_onClick(t){this._dispatchEvent(t,["click","pointertap","tap"])}_onFocus(t){t.target.getAttribute("aria-live")||t.target.setAttribute("aria-live","assertive"),this._dispatchEvent(t,["mouseover"])}_onFocusOut(t){t.target.getAttribute("aria-live")||t.target.setAttribute("aria-live","polite"),this._dispatchEvent(t,["mouseout"])}_onKeyDown(t){9===t.keyCode&&this.activate()}_onMouseMove(t){0===t.movementX&&0===t.movementY||this.deactivate()}destroy(){this.destroyTouchHook(),this.div=null,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown),this.pool=null,this.children=null,this.renderer=null}}Ju.extension={name:"accessibility",type:[yl.RendererPlugin,yl.CanvasRendererPlugin]},wl.add(Ju);const td=class{constructor(t){this.stage=new Iu,t=Object.assign({forceCanvas:!1},t),this.renderer=function(t){for(const e of au)if(e.test(t))return new e(t);throw new Error("Unable to auto-detect a suitable renderer.")}(t),td._plugins.forEach((e=>{e.init.call(this,t)}))}render(){this.renderer.render(this.stage)}get view(){return this.renderer.view}get screen(){return this.renderer.screen}destroy(t,e){const n=td._plugins.slice(0);n.reverse(),n.forEach((t=>{t.destroy.call(this)})),this.stage.destroy(e),this.stage=null,this.renderer.destroy(t),this.renderer=null}};let ed=td;ed._plugins=[],wl.handleByList(yl.Application,ed._plugins);class nd{static init(t){Object.defineProperty(this,"resizeTo",{set(t){globalThis.removeEventListener("resize",this.queueResize),this._resizeTo=t,t&&(globalThis.addEventListener("resize",this.queueResize),this.resize())},get(){return this._resizeTo}}),this.queueResize=()=>{this._resizeTo&&(this.cancelResize(),this._resizeId=requestAnimationFrame((()=>this.resize())))},this.cancelResize=()=>{this._resizeId&&(cancelAnimationFrame(this._resizeId),this._resizeId=null)},this.resize=()=>{if(!this._resizeTo)return;let t,e;if(this.cancelResize(),this._resizeTo===globalThis.window)t=globalThis.innerWidth,e=globalThis.innerHeight;else{const{clientWidth:n,clientHeight:s}=this._resizeTo;t=n,e=s}this.renderer.resize(t,e),this.render()},this._resizeId=null,this._resizeTo=null,this.resizeTo=t.resizeTo||null}static destroy(){globalThis.removeEventListener("resize",this.queueResize),this.cancelResize(),this.cancelResize=null,this.queueResize=null,this.resizeTo=null,this.resize=null}}nd.extension=yl.Application,wl.add(nd);const sd={loader:yl.LoadParser,resolver:yl.ResolveParser,cache:yl.CacheParser,detection:yl.DetectionParser};wl.handle(yl.Asset,(t=>{const e=t.ref;Object.entries(sd).filter((([t])=>!!e[t])).forEach((([t,n])=>{var s;return wl.add(Object.assign(e[t],{extension:null!=(s=e[t].extension)?s:n}))}))}),(t=>{const e=t.ref;Object.keys(sd).filter((t=>!!e[t])).forEach((t=>wl.remove(e[t])))}));class id{constructor(t,e=!1){this._loader=t,this._assetList=[],this._isLoading=!1,this._maxConcurrent=1,this.verbose=e}add(t){t.forEach((t=>{this._assetList.push(t)})),this.verbose&&console.log("[BackgroundLoader] assets: ",this._assetList),this._isActive&&!this._isLoading&&this._next()}_next(){return m(this,null,(function*(){if(this._assetList.length&&this._isActive){this._isLoading=!0;const t=[],e=Math.min(this._assetList.length,this._maxConcurrent);for(let n=0;n<e;n++)t.push(this._assetList.pop());yield this._loader.load(t),this._isLoading=!1,this._next()}}))}get active(){return this._isActive}set active(t){this._isActive!==t&&(this._isActive=t,t&&!this._isLoading&&this._next())}}function rd(t,e){if(Array.isArray(e)){for(const n of e)if(t.startsWith(`data:${n}`))return!0;return!1}return t.startsWith(`data:${e}`)}function ad(t,e){const n=t.split("?")[0],s=mo.extname(n).toLowerCase();return Array.isArray(e)?e.includes(s):s===e}const od=(t,e)=>(Array.isArray(t)||(t=[t]),e?t.map((t=>"string"==typeof t?e(t):t)):t),ld=(t,e)=>{const n=e.split("?")[1];return n&&(t+=`?${n}`),t};function hd(t,e,n,s,i){const r=e[n];for(let a=0;a<r.length;a++){const o=r[a];n<e.length-1?hd(t.replace(s[n],o),e,n+1,s,i):i.push(t.replace(s[n],o))}}function cd(t){const e=t.match(/\{(.*?)\}/g),n=[];if(e){const s=[];e.forEach((t=>{const e=t.substring(1,t.length-1).split(",");s.push(e)})),hd(t,s,0,e,n)}else n.push(t);return n}const ud=t=>!Array.isArray(t);const dd=new class{constructor(){this._parsers=[],this._cache=new Map,this._cacheMap=new Map}reset(){this._cacheMap.clear(),this._cache.clear()}has(t){return this._cache.has(t)}get(t){const e=this._cache.get(t);return e||console.warn(`[Assets] Asset id ${t} was not found in the Cache`),e}set(t,e){const n=od(t);let s;for(let a=0;a<this.parsers.length;a++){const t=this.parsers[a];if(t.test(e)){s=t.getCacheableAssets(n,e);break}}s||(s={},n.forEach((t=>{s[t]=e})));const i=Object.keys(s),r={cacheKeys:i,keys:n};if(n.forEach((t=>{this._cacheMap.set(t,r)})),i.forEach((t=>{this._cache.has(t)&&this._cache.get(t)!==e&&console.warn("[Cache] already has key:",t),this._cache.set(t,s[t])})),e instanceof ic){const t=e;n.forEach((e=>{t.baseTexture!==ic.EMPTY.baseTexture&&Ol.addToCache(t.baseTexture,e),ic.addToCache(t,e)}))}}remove(t){if(this._cacheMap.get(t),!this._cacheMap.has(t))return void console.warn(`[Assets] Asset id ${t} was not found in the Cache`);const e=this._cacheMap.get(t);e.cacheKeys.forEach((t=>{this._cache.delete(t)})),e.keys.forEach((t=>{this._cacheMap.delete(t)}))}get parsers(){return this._parsers}};class fd{constructor(){this._parsers=[],this._parsersValidated=!1,this.parsers=new Proxy(this._parsers,{set:(t,e,n)=>(this._parsersValidated=!1,t[e]=n,!0)}),this.promiseCache={}}reset(){this._parsersValidated=!1,this.promiseCache={}}_getLoadPromiseAndParser(t,e){const n={promise:null,parser:null};return n.promise=(()=>m(this,null,(function*(){var s,i;let r=null,a=null;if(e.loadParser&&(a=this._parserHash[e.loadParser],a||console.warn(`[Assets] specified load parser "${e.loadParser}" not found while loading ${t}`)),!a){for(let n=0;n<this.parsers.length;n++){const i=this.parsers[n];if(i.load&&(null==(s=i.test)?void 0:s.call(i,t,e,this))){a=i;break}}if(!a)return console.warn(`[Assets] ${t} could not be loaded as we don't know how to parse it, ensure the correct parser has been added`),null}r=yield a.load(t,e,this),n.parser=a;for(let t=0;t<this.parsers.length;t++){const s=this.parsers[t];s.parse&&s.parse&&(yield null==(i=s.testParse)?void 0:i.call(s,r,e,this))&&(r=(yield s.parse(r,e,this))||r,n.parser=s)}return r})))(),n}load(t,e){return m(this,null,(function*(){this._parsersValidated||this._validateParsers();let n=0;const s={},i=ud(t),r=od(t,(t=>({src:t}))),a=r.length,o=r.map((t=>m(this,null,(function*(){const i=mo.toAbsolute(t.src);if(!s[t.src])try{this.promiseCache[i]||(this.promiseCache[i]=this._getLoadPromiseAndParser(i,t)),s[t.src]=yield this.promiseCache[i].promise,e&&e(++n/a)}catch(_m){throw delete this.promiseCache[i],delete s[t.src],new Error(`[Loader.load] Failed to load ${i}.\n${_m}`)}}))));return yield Promise.all(o),i?s[r[0].src]:s}))}unload(t){return m(this,null,(function*(){const e=od(t,(t=>({src:t}))).map((t=>m(this,null,(function*(){var e,n;const s=mo.toAbsolute(t.src),i=this.promiseCache[s];if(i){const r=yield i.promise;null==(n=null==(e=i.parser)?void 0:e.unload)||n.call(e,r,t,this),delete this.promiseCache[s]}}))));yield Promise.all(e)}))}_validateParsers(){this._parsersValidated=!0,this._parserHash=this._parsers.filter((t=>t.name)).reduce(((t,e)=>(t[e.name]&&console.warn(`[Assets] loadParser name conflict "${e.name}"`),d(u({},t),{[e.name]:e}))),{})}}var pd=(t=>(t[t.Low=0]="Low",t[t.Normal=1]="Normal",t[t.High=2]="High",t))(pd||{});const md={extension:{type:yl.LoadParser,priority:pd.Low},name:"loadJson",test:t=>rd(t,"application/json")||ad(t,".json"),load(t){return m(this,null,(function*(){const e=yield zr.ADAPTER.fetch(t);return yield e.json()}))}};wl.add(md);const gd={name:"loadTxt",extension:{type:yl.LoadParser,priority:pd.Low},test:t=>rd(t,"text/plain")||ad(t,".txt"),load(t){return m(this,null,(function*(){const e=yield zr.ADAPTER.fetch(t);return yield e.text()}))}};wl.add(gd);const vd=["normal","bold","100","200","300","400","500","600","700","800","900"],xd=[".ttf",".otf",".woff",".woff2"],yd=["font/ttf","font/otf","font/woff","font/woff2"],_d=/^(--|-?[A-Z_])[0-9A-Z_-]*$/i;const bd={extension:{type:yl.LoadParser,priority:pd.Low},name:"loadWebFont",test:t=>rd(t,yd)||ad(t,xd),load(t,e){return m(this,null,(function*(){var n,s,i,r,a,o;const l=zr.ADAPTER.getFontFaceSet();if(l){const h=[],c=null!=(s=null==(n=e.data)?void 0:n.family)?s:function(t){const e=mo.extname(t),n=mo.basename(t,e).replace(/(-|_)/g," ").toLowerCase().split(" ").map((t=>t.charAt(0).toUpperCase()+t.slice(1)));let s=n.length>0;for(const r of n)if(!r.match(_d)){s=!1;break}let i=n.join(" ");return s||(i=`"${i.replace(/[\\"]/g,"\\$&")}"`),i}(t),f=null!=(a=null==(r=null==(i=e.data)?void 0:i.weights)?void 0:r.filter((t=>vd.includes(t))))?a:["normal"],p=null!=(o=e.data)?o:{};for(let e=0;e<f.length;e++){const n=f[e],s=new FontFace(c,`url(${encodeURI(t)})`,d(u({},p),{weight:n}));yield s.load(),l.add(s),h.push(s)}return 1===h.length?h[0]:h}return console.warn("[loadWebFont] FontFace API is not supported. Skipping loading font"),null}))},unload(t){(Array.isArray(t)?t:[t]).forEach((t=>zr.ADAPTER.getFontFaceSet().delete(t)))}};wl.add(bd);let wd,Ed=0;const Td={id:"checkImageBitmap",code:"\n    async function checkImageBitmap()\n    {\n        try\n        {\n            if (typeof createImageBitmap !== 'function') return false;\n\n            const response = await fetch('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=');\n            const imageBlob =  await response.blob();\n            const imageBitmap = await createImageBitmap(imageBlob);\n\n            return imageBitmap.width === 1 && imageBitmap.height === 1;\n        }\n        catch (e)\n        {\n            return false;\n        }\n    }\n    checkImageBitmap().then((result) => { self.postMessage(result); });\n    "},Sd={id:"loadImageBitmap",code:"\n    async function loadImageBitmap(url)\n    {\n        const response = await fetch(url);\n\n        if (!response.ok)\n        {\n            throw new Error(`[WorkerManager.loadImageBitmap] Failed to fetch ${url}: `\n                + `${response.status} ${response.statusText}`);\n        }\n\n        const imageBlob =  await response.blob();\n        const imageBitmap = await createImageBitmap(imageBlob);\n\n        return imageBitmap;\n    }\n    self.onmessage = async (event) =>\n    {\n        try\n        {\n            const imageBitmap = await loadImageBitmap(event.data.data[0]);\n\n            self.postMessage({\n                data: imageBitmap,\n                uuid: event.data.uuid,\n                id: event.data.id,\n            }, [imageBitmap]);\n        }\n        catch(e)\n        {\n            self.postMessage({\n                error: e,\n                uuid: event.data.uuid,\n                id: event.data.id,\n            });\n        }\n    };"};let Ad;const Cd=new class{constructor(){this._initialized=!1,this._createdWorkers=0,this.workerPool=[],this.queue=[],this.resolveHash={}}isImageBitmapSupported(){return void 0!==this._isImageBitmapSupported||(this._isImageBitmapSupported=new Promise((t=>{const e=URL.createObjectURL(new Blob([Td.code],{type:"application/javascript"})),n=new Worker(e);n.addEventListener("message",(s=>{n.terminate(),URL.revokeObjectURL(e),t(s.data)}))}))),this._isImageBitmapSupported}loadImageBitmap(t){return this._run("loadImageBitmap",[t])}_initWorkers(){return m(this,null,(function*(){this._initialized||(this._initialized=!0)}))}getWorker(){void 0===wd&&(wd=navigator.hardwareConcurrency||4);let t=this.workerPool.pop();return!t&&this._createdWorkers<wd&&(Ad||(Ad=URL.createObjectURL(new Blob([Sd.code],{type:"application/javascript"}))),this._createdWorkers++,t=new Worker(Ad),t.addEventListener("message",(t=>{this.complete(t.data),this.returnWorker(t.target),this.next()}))),t}returnWorker(t){this.workerPool.push(t)}complete(t){void 0!==t.error?this.resolveHash[t.uuid].reject(t.error):this.resolveHash[t.uuid].resolve(t.data),this.resolveHash[t.uuid]=null}_run(t,e){return m(this,null,(function*(){yield this._initWorkers();const n=new Promise(((n,s)=>{this.queue.push({id:t,arguments:e,resolve:n,reject:s})}));return this.next(),n}))}next(){if(!this.queue.length)return;const t=this.getWorker();if(!t)return;const e=this.queue.pop(),n=e.id;this.resolveHash[Ed]={resolve:e.resolve,reject:e.reject},t.postMessage({data:e.arguments,uuid:Ed++,id:n})}};function Id(t,e,n){const s=new ic(t);return s.baseTexture.on("dispose",(()=>{delete e.promiseCache[n]})),s}const Md=[".jpeg",".jpg",".png",".webp",".avif"],Rd=["image/jpeg","image/png","image/webp","image/avif"];const Pd={name:"loadTextures",extension:{type:yl.LoadParser,priority:pd.High},config:{preferWorkers:!0,preferCreateImageBitmap:!0,crossOrigin:"anonymous"},test:t=>rd(t,Rd)||ad(t,Md),load(t,e,n){return m(this,null,(function*(){let s=null;s=globalThis.createImageBitmap&&this.config.preferCreateImageBitmap?this.config.preferWorkers&&(yield Cd.isImageBitmapSupported())?yield Cd.loadImageBitmap(t):yield function(t){return m(this,null,(function*(){const e=yield zr.ADAPTER.fetch(t);if(!e.ok)throw new Error(`[loadImageBitmap] Failed to fetch ${t}: ${e.status} ${e.statusText}`);const n=yield e.blob();return yield createImageBitmap(n)}))}(t):yield new Promise((e=>{s=new Image,s.crossOrigin=this.config.crossOrigin,s.src=t,s.complete?e(s):s.onload=()=>{e(s)}}));const i=new Ol(s,u({resolution:xl(t)},e.data));return i.resource.src=t,Id(i,n,t)}))},unload(t){t.destroy(!0)}};wl.add(Pd);const kd={extension:{type:yl.LoadParser,priority:pd.High},name:"loadSVG",test:t=>rd(t,"image/svg+xml")||ad(t,".svg"),testParse(t){return m(this,null,(function*(){return yu.test(t)}))},parse(t,e,n){return m(this,null,(function*(){var s;const i=new yu(t,null==(s=null==e?void 0:e.data)?void 0:s.resourceOptions);yield i.load();const r=new Ol(i,u({resolution:xl(t)},null==e?void 0:e.data));r.resource.src=t;return Id(r,n,t)}))},load(t,e){return m(this,null,(function*(){return(yield zr.ADAPTER.fetch(t)).text()}))},unload:Pd.unload};wl.add(kd);class Fd{constructor(){this._defaultBundleIdentifierOptions={connector:"-",createBundleAssetId:(t,e)=>`${t}${this._bundleIdConnector}${e}`,extractAssetIdFromBundle:(t,e)=>e.replace(`${t}${this._bundleIdConnector}`,"")},this._bundleIdConnector=this._defaultBundleIdentifierOptions.connector,this._createBundleAssetId=this._defaultBundleIdentifierOptions.createBundleAssetId,this._extractAssetIdFromBundle=this._defaultBundleIdentifierOptions.extractAssetIdFromBundle,this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={}}setBundleIdentifier(t){var e,n,s;if(this._bundleIdConnector=null!=(e=t.connector)?e:this._bundleIdConnector,this._createBundleAssetId=null!=(n=t.createBundleAssetId)?n:this._createBundleAssetId,this._extractAssetIdFromBundle=null!=(s=t.extractAssetIdFromBundle)?s:this._extractAssetIdFromBundle,"bar"!==this._extractAssetIdFromBundle("foo",this._createBundleAssetId("foo","bar")))throw new Error("[Resolver] GenerateBundleAssetId are not working correctly")}prefer(...t){t.forEach((t=>{this._preferredOrder.push(t),t.priority||(t.priority=Object.keys(t.params))})),this._resolverHash={}}set basePath(t){this._basePath=t}get basePath(){return this._basePath}set rootPath(t){this._rootPath=t}get rootPath(){return this._rootPath}get parsers(){return this._parsers}reset(){this.setBundleIdentifier(this._defaultBundleIdentifierOptions),this._assetMap={},this._preferredOrder=[],this._resolverHash={},this._rootPath=null,this._basePath=null,this._manifest=null,this._bundles={},this._defaultSearchParams=null}setDefaultSearchParams(t){if("string"==typeof t)this._defaultSearchParams=t;else{const e=t;this._defaultSearchParams=Object.keys(e).map((t=>`${encodeURIComponent(t)}=${encodeURIComponent(e[t])}`)).join("&")}}addManifest(t){this._manifest&&console.warn("[Resolver] Manifest already exists, this will be overwritten"),this._manifest=t,t.bundles.forEach((t=>{this.addBundle(t.name,t.assets)}))}addBundle(t,e){const n=[];Array.isArray(e)?e.forEach((e=>{if("string"==typeof e.name){const s=this._createBundleAssetId(t,e.name);n.push(s),this.add([e.name,s],e.srcs,e.data)}else{const s=e.name.map((e=>this._createBundleAssetId(t,e)));s.forEach((t=>{n.push(t)})),this.add([...e.name,...s],e.srcs)}})):Object.keys(e).forEach((s=>{n.push(this._createBundleAssetId(t,s)),this.add([s,this._createBundleAssetId(t,s)],e[s])})),this._bundles[t]=n}add(t,e,n){const s=od(t);s.forEach((t=>{this.hasKey(t)&&console.warn(`[Resolver] already has key: ${t} overwriting`)})),Array.isArray(e)||(e="string"==typeof e?cd(e):[e]);const i=e.map((t=>{var e;let i=t;if("string"==typeof t){let e=!1;for(let n=0;n<this._parsers.length;n++){const s=this._parsers[n];if(s.test(t)){i=s.parse(t),e=!0;break}}e||(i={src:t})}return i.format||(i.format=i.src.split(".").pop()),i.alias||(i.alias=s),(this._basePath||this._rootPath)&&(i.src=mo.toAbsolute(i.src,this._basePath,this._rootPath)),i.src=this._appendDefaultSearchParams(i.src),i.data=null!=(e=i.data)?e:n,i}));s.forEach((t=>{this._assetMap[t]=i}))}resolveBundle(t){const e=ud(t);t=od(t);const n={};return t.forEach((t=>{const e=this._bundles[t];if(e){const s=this.resolve(e),i={};for(const e in s){const n=s[e];i[this._extractAssetIdFromBundle(t,e)]=n}n[t]=i}})),e?n[t[0]]:n}resolveUrl(t){const e=this.resolve(t);if("string"!=typeof t){const t={};for(const n in e)t[n]=e[n].src;return t}return e.src}resolve(t){const e=ud(t);t=od(t);const n={};return t.forEach((t=>{var e;if(!this._resolverHash[t])if(this._assetMap[t]){let n=this._assetMap[t];const s=this._getPreferredOrder(n),i=n[0];null==s||s.priority.forEach((t=>{s.params[t].forEach((e=>{const s=n.filter((n=>!!n[t]&&n[t]===e));s.length&&(n=s)}))})),this._resolverHash[t]=null!=(e=n[0])?e:i}else{let e=t;(this._basePath||this._rootPath)&&(e=mo.toAbsolute(e,this._basePath,this._rootPath)),e=this._appendDefaultSearchParams(e),this._resolverHash[t]={src:e}}n[t]=this._resolverHash[t]})),e?n[t[0]]:n}hasKey(t){return!!this._assetMap[t]}hasBundle(t){return!!this._bundles[t]}_getPreferredOrder(t){for(let e=0;e<t.length;e++){const e=t[0],n=this._preferredOrder.find((t=>t.params.format.includes(e.format)));if(n)return n}return this._preferredOrder[0]}_appendDefaultSearchParams(t){if(!this._defaultSearchParams)return t;return`${t}${/\?/.test(t)?"&":"?"}${this._defaultSearchParams}`}}class Od{constructor(){this._detections=[],this._initialized=!1,this.resolver=new Fd,this.loader=new fd,this.cache=dd,this._backgroundLoader=new id(this.loader),this._backgroundLoader.active=!0,this.reset()}init(){return m(this,arguments,(function*(t={}){var e,n,s,i;if(this._initialized)return void console.warn("[Assets]AssetManager already initialized, did you load before calling this Asset.init()?");if(this._initialized=!0,t.defaultSearchParams&&this.resolver.setDefaultSearchParams(t.defaultSearchParams),t.basePath&&(this.resolver.basePath=t.basePath),t.bundleIdentifier&&this.resolver.setBundleIdentifier(t.bundleIdentifier),t.manifest){let e=t.manifest;"string"==typeof e&&(e=yield this.load(e)),this.resolver.addManifest(e)}const r=null!=(n=null==(e=t.texturePreference)?void 0:e.resolution)?n:1,a="number"==typeof r?[r]:r;let o=[];if(null==(s=t.texturePreference)?void 0:s.format){const e=null==(i=t.texturePreference)?void 0:i.format;o="string"==typeof e?[e]:e;for(const t of this._detections)(yield t.test())||(o=yield t.remove(o))}else for(const l of this._detections)(yield l.test())&&(o=yield l.add(o));this.resolver.prefer({params:{format:o,resolution:a}}),t.preferences&&this.setPreferences(t.preferences)}))}add(t,e,n){this.resolver.add(t,e,n)}load(t,e){return m(this,null,(function*(){this._initialized||(yield this.init());const n=ud(t),s=od(t).map((t=>"string"!=typeof t?(this.resolver.add(t.src,t),t.src):(this.resolver.hasKey(t)||this.resolver.add(t,t),t))),i=this.resolver.resolve(s),r=yield this._mapLoadToResolve(i,e);return n?r[s[0]]:r}))}addBundle(t,e){this.resolver.addBundle(t,e)}loadBundle(t,e){return m(this,null,(function*(){this._initialized||(yield this.init());let n=!1;"string"==typeof t&&(n=!0,t=[t]);const s=this.resolver.resolveBundle(t),i={},r=Object.keys(s);let a=0,o=0;const l=()=>{null==e||e(++a/o)},h=r.map((t=>{const e=s[t];return o+=Object.keys(e).length,this._mapLoadToResolve(e,l).then((e=>{i[t]=e}))}));return yield Promise.all(h),n?i[t[0]]:i}))}backgroundLoad(t){return m(this,null,(function*(){this._initialized||(yield this.init()),"string"==typeof t&&(t=[t]);const e=this.resolver.resolve(t);this._backgroundLoader.add(Object.values(e))}))}backgroundLoadBundle(t){return m(this,null,(function*(){this._initialized||(yield this.init()),"string"==typeof t&&(t=[t]);const e=this.resolver.resolveBundle(t);Object.values(e).forEach((t=>{this._backgroundLoader.add(Object.values(t))}))}))}reset(){this.resolver.reset(),this.loader.reset(),this.cache.reset(),this._initialized=!1}get(t){if("string"==typeof t)return dd.get(t);const e={};for(let n=0;n<t.length;n++)e[n]=dd.get(t[n]);return e}_mapLoadToResolve(t,e){return m(this,null,(function*(){const n=Object.values(t),s=Object.keys(t);this._backgroundLoader.active=!1;const i=yield this.loader.load(n,e);this._backgroundLoader.active=!0;const r={};return n.forEach(((t,e)=>{const n=i[t.src],a=[t.src];t.alias&&a.push(...t.alias),r[s[e]]=n,dd.set(a,n)})),r}))}unload(t){return m(this,null,(function*(){this._initialized||(yield this.init());const e=od(t).map((t=>"string"!=typeof t?t.src:t)),n=this.resolver.resolve(e);yield this._unloadFromResolved(n)}))}unloadBundle(t){return m(this,null,(function*(){this._initialized||(yield this.init()),t=od(t);const e=this.resolver.resolveBundle(t),n=Object.keys(e).map((t=>this._unloadFromResolved(e[t])));yield Promise.all(n)}))}_unloadFromResolved(t){return m(this,null,(function*(){const e=Object.values(t);e.forEach((t=>{dd.remove(t.src)})),yield this.loader.unload(e)}))}get detections(){return this._detections}get preferWorkers(){return Pd.config.preferWorkers}set preferWorkers(t){vo("7.2.0","Assets.prefersWorkers is deprecated, use Assets.setPreferences({ preferWorkers: true }) instead."),this.setPreferences({preferWorkers:t})}setPreferences(t){this.loader.parsers.forEach((e=>{e.config&&Object.keys(e.config).filter((e=>e in t)).forEach((n=>{e.config[n]=t[n]}))}))}}const Dd=new Od;wl.handleByList(yl.LoadParser,Dd.loader.parsers).handleByList(yl.ResolveParser,Dd.resolver.parsers).handleByList(yl.CacheParser,Dd.cache.parsers).handleByList(yl.DetectionParser,Dd.detections);const Ld={extension:yl.CacheParser,test:t=>Array.isArray(t)&&t.every((t=>t instanceof ic)),getCacheableAssets:(t,e)=>{const n={};return t.forEach((t=>{e.forEach(((e,s)=>{n[t+(0===s?"":s+1)]=e}))})),n}};wl.add(Ld);const Nd={extension:{type:yl.DetectionParser,priority:1},test:()=>m(void 0,null,(function*(){if(!globalThis.createImageBitmap)return!1;const t=yield zr.ADAPTER.fetch("data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A=").then((t=>t.blob()));return createImageBitmap(t).then((()=>!0),(()=>!1))})),add:t=>m(void 0,null,(function*(){return[...t,"avif"]})),remove:t=>m(void 0,null,(function*(){return t.filter((t=>"avif"!==t))}))};wl.add(Nd);const Bd={extension:{type:yl.DetectionParser,priority:0},test:()=>m(void 0,null,(function*(){if(!globalThis.createImageBitmap)return!1;const t=yield zr.ADAPTER.fetch("data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA=").then((t=>t.blob()));return createImageBitmap(t).then((()=>!0),(()=>!1))})),add:t=>m(void 0,null,(function*(){return[...t,"webp"]})),remove:t=>m(void 0,null,(function*(){return t.filter((t=>"webp"!==t))}))};wl.add(Bd);const Vd=["png","jpg","jpeg"],Ud={extension:{type:yl.DetectionParser,priority:-1},test:()=>Promise.resolve(!0),add:t=>m(void 0,null,(function*(){return[...t,...Vd]})),remove:t=>m(void 0,null,(function*(){return t.filter((t=>!Vd.includes(t)))}))};wl.add(Ud);const Xd={extension:yl.ResolveParser,test:Pd.test,parse:t=>{var e,n;return{resolution:parseFloat(null!=(n=null==(e=zr.RETINA_PREFIX.exec(t))?void 0:e[1])?n:"1"),format:t.split(".").pop(),src:t}}};wl.add(Xd);var Yd=(t=>(t[t.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",t[t.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",t[t.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",t[t.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",t[t.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",t[t.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",t[t.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",t[t.COMPRESSED_RGBA8_ETC2_EAC=37496]="COMPRESSED_RGBA8_ETC2_EAC",t[t.COMPRESSED_SRGB8_ETC2=37493]="COMPRESSED_SRGB8_ETC2",t[t.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37497]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",t[t.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37494]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",t[t.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37495]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",t[t.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",t[t.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",t[t.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",t[t.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",t[t.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",t[t.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",t[t.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35986]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",t[t.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL",t[t.COMPRESSED_RGBA_ASTC_4x4_KHR=37808]="COMPRESSED_RGBA_ASTC_4x4_KHR",t))(Yd||{});const Wd={33776:.5,33777:.5,33778:1,33779:1,35916:.5,35917:.5,35918:1,35919:1,37488:.5,37489:.5,37490:1,37491:1,37492:.5,37496:1,37493:.5,37497:1,37494:.5,37495:.5,35840:.5,35842:.5,35841:.25,35843:.25,36196:.5,35986:.5,35986:1,34798:1,37808:1};let zd,Gd;function Hd(){Gd={s3tc:zd.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:zd.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:zd.getExtension("WEBGL_compressed_texture_etc"),etc1:zd.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:zd.getExtension("WEBGL_compressed_texture_pvrtc")||zd.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:zd.getExtension("WEBGL_compressed_texture_atc"),astc:zd.getExtension("WEBGL_compressed_texture_astc")}}const jd={extension:{type:yl.DetectionParser,priority:2},test:()=>m(void 0,null,(function*(){const t=zr.ADAPTER.createCanvas().getContext("webgl");return t?(zd=t,!0):(console.warn("WebGL not available for compressed textures."),!1)})),add:t=>m(void 0,null,(function*(){Gd||Hd();const e=[];for(const t in Gd){Gd[t]&&e.push(t)}return[...e,...t]})),remove:t=>m(void 0,null,(function*(){return Gd||Hd(),t.filter((t=>!(t in Gd)))}))};wl.add(jd);class $d extends Pl{constructor(t,e={width:1,height:1,autoLoad:!0}){let n,s;"string"==typeof t?(n=t,s=new Uint8Array):(n=null,s=t),super(s,e),this.origin=n,this.buffer=s?new El(s):null,this._load=null,this.loaded=!1,null!==this.origin&&!1!==e.autoLoad&&this.load(),null===this.origin&&this.buffer&&(this._load=Promise.resolve(this),this.loaded=!0,this.onBlobLoaded(this.buffer.rawBinaryData))}onBlobLoaded(t){}load(){return this._load||(this._load=fetch(this.origin).then((t=>t.blob())).then((t=>t.arrayBuffer())).then((t=>(this.data=new Uint32Array(t),this.buffer=new El(t),this.loaded=!0,this.onBlobLoaded(t),this.update(),this)))),this._load}}class qd extends $d{constructor(t,e){super(t,e),this.format=e.format,this.levels=e.levels||1,this._width=e.width,this._height=e.height,this._extension=qd._formatToExtension(this.format),(e.levelBuffers||this.buffer)&&(this._levelBuffers=e.levelBuffers||qd._createLevelBuffers(t instanceof Uint8Array?t:this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height))}upload(t,e,n){const s=t.gl;if(!t.context.extensions[this._extension])throw new Error(`${this._extension} textures are not supported on the current machine`);if(!this._levelBuffers)return!1;for(let i=0,r=this.levels;i<r;i++){const{levelID:t,levelWidth:e,levelHeight:n,levelBuffer:r}=this._levelBuffers[i];s.compressedTexImage2D(s.TEXTURE_2D,t,this.format,e,n,0,r)}return!0}onBlobLoaded(){this._levelBuffers=qd._createLevelBuffers(this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height)}static _formatToExtension(t){if(t>=33776&&t<=33779)return"s3tc";if(t>=37488&&t<=37497)return"etc";if(t>=35840&&t<=35843)return"pvrtc";if(t>=36196)return"etc1";if(t>=35986&&t<=34798)return"atc";throw new Error("Invalid (compressed) texture format given!")}static _createLevelBuffers(t,e,n,s,i,r,a){const o=new Array(n);let l=t.byteOffset,h=r,c=a,u=h+s-1&~(s-1),d=c+i-1&~(i-1),f=u*d*Wd[e];for(let p=0;p<n;p++)o[p]={levelID:p,levelWidth:n>1?h:u,levelHeight:n>1?c:d,levelBuffer:new Uint8Array(t.buffer,l,f)},l+=f,h=h>>1||1,c=c>>1||1,u=h+s-1&~(s-1),d=c+i-1&~(i-1),f=u*d*Wd[e];return o}}const Kd=4,Zd=124,Qd=32,Jd=20,tf=542327876,ef={SIZE:1,FLAGS:2,HEIGHT:3,WIDTH:4,MIPMAP_COUNT:7,PIXEL_FORMAT:19},nf={SIZE:0,FLAGS:1,FOURCC:2,RGB_BITCOUNT:3,R_BIT_MASK:4,G_BIT_MASK:5,B_BIT_MASK:6,A_BIT_MASK:7},sf={DXGI_FORMAT:0,RESOURCE_DIMENSION:1,MISC_FLAG:2,ARRAY_SIZE:3,MISC_FLAGS2:4},rf=1,af=2,of=4,lf=64,hf=512,cf=131072,uf=808540228,df=4,ff={827611204:Yd.COMPRESSED_RGBA_S3TC_DXT1_EXT,861165636:Yd.COMPRESSED_RGBA_S3TC_DXT3_EXT,894720068:Yd.COMPRESSED_RGBA_S3TC_DXT5_EXT},pf={70:Yd.COMPRESSED_RGBA_S3TC_DXT1_EXT,71:Yd.COMPRESSED_RGBA_S3TC_DXT1_EXT,73:Yd.COMPRESSED_RGBA_S3TC_DXT3_EXT,74:Yd.COMPRESSED_RGBA_S3TC_DXT3_EXT,76:Yd.COMPRESSED_RGBA_S3TC_DXT5_EXT,77:Yd.COMPRESSED_RGBA_S3TC_DXT5_EXT,72:Yd.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT,75:Yd.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT,78:Yd.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT};const mf=[171,75,84,88,32,49,49,187,13,10,26,10],gf=67305985,vf={FILE_IDENTIFIER:0,ENDIANNESS:12,GL_TYPE:16,GL_TYPE_SIZE:20,GL_FORMAT:24,GL_INTERNAL_FORMAT:28,GL_BASE_INTERNAL_FORMAT:32,PIXEL_WIDTH:36,PIXEL_HEIGHT:40,PIXEL_DEPTH:44,NUMBER_OF_ARRAY_ELEMENTS:48,NUMBER_OF_FACES:52,NUMBER_OF_MIPMAP_LEVELS:56,BYTES_OF_KEY_VALUE_DATA:60},xf=64,yf={[kr.UNSIGNED_BYTE]:1,[kr.UNSIGNED_SHORT]:2,[kr.INT]:4,[kr.UNSIGNED_INT]:4,[kr.FLOAT]:4,[kr.HALF_FLOAT]:8},_f={[Rr.RGBA]:4,[Rr.RGB]:3,[Rr.RG]:2,[Rr.RED]:1,[Rr.LUMINANCE]:1,[Rr.LUMINANCE_ALPHA]:2,[Rr.ALPHA]:1},bf={[kr.UNSIGNED_SHORT_4_4_4_4]:2,[kr.UNSIGNED_SHORT_5_5_5_1]:2,[kr.UNSIGNED_SHORT_5_6_5]:2};function wf(t,e,n=!1){const s=new DataView(e);if(!function(t,e){for(let n=0;n<mf.length;n++)if(e.getUint8(n)!==mf[n])return console.error(`${t} is not a valid *.ktx file!`),!1;return!0}(t,s))return null;const i=s.getUint32(vf.ENDIANNESS,!0)===gf,r=s.getUint32(vf.GL_TYPE,i),a=s.getUint32(vf.GL_FORMAT,i),o=s.getUint32(vf.GL_INTERNAL_FORMAT,i),l=s.getUint32(vf.PIXEL_WIDTH,i),h=s.getUint32(vf.PIXEL_HEIGHT,i)||1,c=s.getUint32(vf.PIXEL_DEPTH,i)||1,u=s.getUint32(vf.NUMBER_OF_ARRAY_ELEMENTS,i)||1,d=s.getUint32(vf.NUMBER_OF_FACES,i),f=s.getUint32(vf.NUMBER_OF_MIPMAP_LEVELS,i),p=s.getUint32(vf.BYTES_OF_KEY_VALUE_DATA,i);if(0===h||1!==c)throw new Error("Only 2D textures are supported");if(1!==d)throw new Error("CubeTextures are not supported by KTXLoader yet!");if(1!==u)throw new Error("WebGL does not support array textures");const m=l+3&-4,g=h+3&-4,v=new Array(u);let x,y=l*h;if(0===r&&(y=m*g),x=0!==r?yf[r]?yf[r]*_f[a]:bf[r]:Wd[o],void 0===x)throw new Error("Unable to resolve the pixel format stored in the *.ktx file!");const _=n?function(t,e,n){const s=new Map;let i=0;for(;i<e;){const r=t.getUint32(xf+i,n),a=xf+i+4,o=3-(r+3)%4;if(0===r||r>e-i){console.error("KTXLoader: keyAndValueByteSize out of bounds");break}let l=0;for(;l<r&&0!==t.getUint8(a+l);l++);if(-1===l){console.error("KTXLoader: Failed to find null byte terminating kvData key");break}const h=(new TextDecoder).decode(new Uint8Array(t.buffer,a,l)),c=new DataView(t.buffer,a+l+1,r-l-1);s.set(h,c),i+=4+r+o}return s}(s,p,i):null;let b=y*x,w=l,E=h,T=m,S=g,A=xf+p;for(let C=0;C<f;C++){const t=s.getUint32(A,i);let n=A+4;for(let s=0;s<u;s++){let t=v[s];t||(t=v[s]=new Array(f)),t[C]={levelID:C,levelWidth:f>1||0!==r?w:T,levelHeight:f>1||0!==r?E:S,levelBuffer:new Uint8Array(e,n,b)},n+=b}A+=t+4,A=A%4!=0?A+4-A%4:A,w=w>>1||1,E=E>>1||1,T=w+4-1&-4,S=E+4-1&-4,b=T*S*x}return 0!==r?{uncompressed:v.map((t=>{let e=t[0].levelBuffer,n=!1;return r===kr.FLOAT?e=new Float32Array(t[0].levelBuffer.buffer,t[0].levelBuffer.byteOffset,t[0].levelBuffer.byteLength/4):r===kr.UNSIGNED_INT?(n=!0,e=new Uint32Array(t[0].levelBuffer.buffer,t[0].levelBuffer.byteOffset,t[0].levelBuffer.byteLength/4)):r===kr.INT&&(n=!0,e=new Int32Array(t[0].levelBuffer.buffer,t[0].levelBuffer.byteOffset,t[0].levelBuffer.byteLength/4)),{resource:new Pl(e,{width:t[0].levelWidth,height:t[0].levelHeight}),type:r,format:n?Ef(a):a}})),kvData:_}:{compressed:v.map((t=>new qd(null,{format:o,width:l,height:h,levels:f,levelBuffers:t}))),kvData:_}}function Ef(t){switch(t){case Rr.RGBA:return Rr.RGBA_INTEGER;case Rr.RGB:return Rr.RGB_INTEGER;case Rr.RG:return Rr.RG_INTEGER;case Rr.RED:return Rr.RED_INTEGER;default:return t}}const Tf={extension:{type:yl.LoadParser,priority:pd.High},name:"loadDDS",test:t=>ad(t,".dds"),load(t,e,n){return m(this,null,(function*(){const s=yield zr.ADAPTER.fetch(t),i=function(t){const e=new Uint32Array(t);if(e[0]!==tf)throw new Error("Invalid DDS file magic word");const n=new Uint32Array(t,0,Zd/Uint32Array.BYTES_PER_ELEMENT),s=n[ef.HEIGHT],i=n[ef.WIDTH],r=n[ef.MIPMAP_COUNT],a=new Uint32Array(t,ef.PIXEL_FORMAT*Uint32Array.BYTES_PER_ELEMENT,Qd/Uint32Array.BYTES_PER_ELEMENT),o=a[rf];if(o&of){const n=a[nf.FOURCC];if(n!==uf){const e=ff[n],a=new Uint8Array(t,Kd+Zd);return[new qd(a,{format:e,width:i,height:s,levels:r})]}const o=Kd+Zd,l=new Uint32Array(e.buffer,o,Jd/Uint32Array.BYTES_PER_ELEMENT),h=l[sf.DXGI_FORMAT],c=l[sf.RESOURCE_DIMENSION],u=l[sf.MISC_FLAG],d=l[sf.ARRAY_SIZE],f=pf[h];if(void 0===f)throw new Error(`DDSParser cannot parse texture data with DXGI format ${h}`);if(u===df)throw new Error("DDSParser does not support cubemap textures");if(6===c)throw new Error("DDSParser does not supported 3D texture data");const p=new Array,m=Kd+Zd+Jd;if(1===d)p.push(new Uint8Array(t,m));else{const e=Wd[f];let n=0,a=i,o=s;for(let t=0;t<r;t++)n+=Math.max(1,a+3&-4)*Math.max(1,o+3&-4)*e,a>>>=1,o>>>=1;let l=m;for(let s=0;s<d;s++)p.push(new Uint8Array(t,l,n)),l+=n}return p.map((t=>new qd(t,{format:f,width:i,height:s,levels:r})))}if(o&lf)throw new Error("DDSParser does not support uncompressed texture data.");if(o&hf)throw new Error("DDSParser does not supported YUV uncompressed texture data.");if(o&cf)throw new Error("DDSParser does not support single-channel (lumninance) texture data!");if(o&af)throw new Error("DDSParser does not support single-channel (alpha) texture data!");throw new Error("DDSParser failed to load a texture file due to an unknown reason!")}(yield s.arrayBuffer()),r=i.map((s=>Id(new Ol(s,u({mipmap:Lr.OFF,alphaMode:Nr.NO_PREMULTIPLIED_ALPHA,resolution:xl(t)},e.data)),n,t)));return 1===r.length?r[0]:r}))},unload(t){Array.isArray(t)?t.forEach((t=>t.destroy(!0))):t.destroy(!0)}};wl.add(Tf);const Sf={extension:{type:yl.LoadParser,priority:pd.High},name:"loadKTX",test:t=>ad(t,".ktx"),load(t,e,n){return m(this,null,(function*(){const s=yield zr.ADAPTER.fetch(t),i=yield s.arrayBuffer(),{compressed:r,uncompressed:a,kvData:o}=wf(t,i),l=null!=r?r:a,h=u({mipmap:Lr.OFF,alphaMode:Nr.NO_PREMULTIPLIED_ALPHA,resolution:xl(t)},e.data),c=l.map((e=>{l===a&&Object.assign(h,{type:e.type,format:e.format});const s=new Ol(e,h);return s.ktxKeyValueData=o,Id(s,n,t)}));return 1===c.length?c[0]:c}))},unload(t){Array.isArray(t)?t.forEach((t=>t.destroy(!0))):t.destroy(!0)}};wl.add(Sf);const Af={extension:yl.ResolveParser,test:t=>{const e=t.split("?")[0].split(".").pop();return["basis","ktx","dds"].includes(e)},parse:t=>{var e,n,s,i;if("ktx"===t.split("?")[0].split(".").pop()){const s=[".s3tc.ktx",".s3tc_sRGB.ktx",".etc.ktx",".etc1.ktx",".pvrt.ktx",".atc.ktx",".astc.ktx"];if(s.some((e=>t.endsWith(e))))return{resolution:parseFloat(null!=(n=null==(e=zr.RETINA_PREFIX.exec(t))?void 0:e[1])?n:"1"),format:s.find((e=>t.endsWith(e))),src:t}}return{resolution:parseFloat(null!=(i=null==(s=zr.RETINA_PREFIX.exec(t))?void 0:s[1])?i:"1"),format:t.split(".").pop(),src:t}}};wl.add(Af);const Cf=new Zl,If=class{constructor(t){this.renderer=t}image(t,e,n){return m(this,null,(function*(){const s=new Image;return s.src=yield this.base64(t,e,n),s}))}base64(t,e,n){return m(this,null,(function*(){const s=this.canvas(t);if(void 0!==s.toBlob)return new Promise(((t,i)=>{s.toBlob((e=>{if(!e)return void i(new Error("ICanvas.toBlob failed!"));const n=new FileReader;n.onload=()=>t(n.result),n.onerror=i,n.readAsDataURL(e)}),e,n)}));if(void 0!==s.toDataURL)return s.toDataURL(e,n);if(void 0!==s.convertToBlob){const t=yield s.convertToBlob({type:e,quality:n});return new Promise(((e,n)=>{const s=new FileReader;s.onload=()=>e(s.result),s.onerror=n,s.readAsDataURL(t)}))}throw new Error("Extract.base64() requires ICanvas.toDataURL, ICanvas.toBlob, or ICanvas.convertToBlob to be implemented")}))}canvas(t,e){const{pixels:n,width:s,height:i,flipY:r}=this._rawPixels(t,e);r&&If._flipY(n,s,i),If._unpremultiplyAlpha(n);const a=new fl(s,i,1),o=new ImageData(new Uint8ClampedArray(n.buffer),s,i);return a.context.putImageData(o,0,0),a.canvas}pixels(t,e){const{pixels:n,width:s,height:i,flipY:r}=this._rawPixels(t,e);return r&&If._flipY(n,s,i),If._unpremultiplyAlpha(n),n}_rawPixels(t,e){const n=this.renderer;if(!n)throw new Error("The Extract has already been destroyed");let s,i,r=!1,a=!1;if(t&&(t instanceof rc?i=t:(i=n.generateTexture(t,{resolution:n.resolution,multisample:n.multisample}),a=!0)),i){if(s=i.baseTexture.resolution,e=null!=e?e:i.frame,r=!1,!a){n.renderTexture.bind(i);const t=i.framebuffer.glFramebuffers[n.CONTEXT_UID];t.blitFramebuffer&&n.framebuffer.bind(t.blitFramebuffer)}}else s=n.resolution,e||((e=Cf).width=n.width/s,e.height=n.height/s),r=!0,n.renderTexture.bind();const o=Math.round(e.width*s),l=Math.round(e.height*s),h=new Uint8Array(4*o*l),c=n.gl;return c.readPixels(Math.round(e.x*s),Math.round(e.y*s),o,l,c.RGBA,c.UNSIGNED_BYTE,h),a&&(null==i||i.destroy(!0)),{pixels:h,width:o,height:l,flipY:r}}destroy(){this.renderer=null}static _flipY(t,e,n){const s=e<<2,i=n>>1,r=new Uint8Array(s);for(let a=0;a<i;a++){const e=a*s,i=(n-a-1)*s;r.set(t.subarray(e,e+s)),t.copyWithin(e,i,i+s),t.set(r,i)}}static _unpremultiplyAlpha(t){t instanceof Uint8ClampedArray&&(t=new Uint8Array(t.buffer));const e=t.length;for(let n=0;n<e;n+=4){const e=t[n+3];if(0!==e){const s=255.001/e;t[n]=t[n]*s+.5,t[n+1]=t[n+1]*s+.5,t[n+2]=t[n+2]*s+.5}}}};let Mf=If;Mf.extension={name:"extract",type:yl.RendererSystem},wl.add(Mf);const Rf={build(t){const e=t.points;let n,s,i,r,a,o;if(t.type===$l.CIRC){const e=t.shape;n=e.x,s=e.y,a=o=e.radius,i=r=0}else if(t.type===$l.ELIP){const e=t.shape;n=e.x,s=e.y,a=e.width,o=e.height,i=r=0}else{const e=t.shape,l=e.width/2,h=e.height/2;n=e.x+l,s=e.y+h,a=o=Math.max(0,Math.min(e.radius,Math.min(l,h))),i=l-a,r=h-o}if(!(a>=0&&o>=0&&i>=0&&r>=0))return void(e.length=0);const l=Math.ceil(2.3*Math.sqrt(a+o)),h=8*l+(i?4:0)+(r?4:0);if(e.length=h,0===h)return;if(0===l)return e.length=8,e[0]=e[6]=n+i,e[1]=e[3]=s+r,e[2]=e[4]=n-i,void(e[5]=e[7]=s-r);let c=0,u=4*l+(i?2:0)+2,d=u,f=h;{const t=i+a,o=r,l=n+t,h=n-t,p=s+o;if(e[c++]=l,e[c++]=p,e[--u]=p,e[--u]=h,r){const t=s-o;e[d++]=h,e[d++]=t,e[--f]=t,e[--f]=l}}for(let p=1;p<l;p++){const t=Math.PI/2*(p/l),h=i+Math.cos(t)*a,m=r+Math.sin(t)*o,g=n+h,v=n-h,x=s+m,y=s-m;e[c++]=g,e[c++]=x,e[--u]=x,e[--u]=v,e[d++]=v,e[d++]=y,e[--f]=y,e[--f]=g}{const t=r+o,a=n+i,l=n-i,h=s+t,u=s-t;e[c++]=a,e[c++]=h,e[--f]=u,e[--f]=a,i&&(e[c++]=l,e[c++]=h,e[--f]=u,e[--f]=l)}},triangulate(t,e){const n=t.points,s=e.points,i=e.indices;if(0===n.length)return;let r=s.length/2;const a=r;let o,l;if(t.type!==$l.RREC){const e=t.shape;o=e.x,l=e.y}else{const e=t.shape;o=e.x+e.width/2,l=e.y+e.height/2}const h=t.matrix;s.push(t.matrix?h.a*o+h.c*l+h.tx:o,t.matrix?h.b*o+h.d*l+h.ty:l),r++,s.push(n[0],n[1]);for(let c=2;c<n.length;c+=2)s.push(n[c],n[c+1]),i.push(r++,a,r);i.push(a+1,a,r)}};function Pf(t,e=!1){const n=t.length;if(n<6)return;let s=0;for(let i=0,r=t[n-2],a=t[n-1];i<n;i+=2){const e=t[i],n=t[i+1];s+=(e-r)*(n+a),r=e,a=n}if(!e&&s>0||e&&s<=0){const e=n/2;for(let s=e+e%2;s<n;s+=2){const e=n-s-2,i=n-s-1,r=s,a=s+1;[t[e],t[r]]=[t[r],t[e]],[t[i],t[a]]=[t[a],t[i]]}}}const kf={build(t){t.points=t.shape.points.slice()},triangulate(t,e){let n=t.points;const s=t.holes,i=e.points,r=e.indices;if(n.length>=6){Pf(n,!1);const t=[];for(let i=0;i<s.length;i++){const e=s[i];Pf(e.points,!0),t.push(n.length/2),n=n.concat(e.points)}const e=da(n,t,2);if(!e)return;const a=i.length/2;for(let n=0;n<e.length;n+=3)r.push(e[n]+a),r.push(e[n+1]+a),r.push(e[n+2]+a);for(let s=0;s<n.length;s++)i.push(n[s])}}},Ff={build(t){const e=t.shape,n=e.x,s=e.y,i=e.width,r=e.height,a=t.points;a.length=0,i>=0&&r>=0&&a.push(n,s,n+i,s,n+i,s+r,n,s+r)},triangulate(t,e){const n=t.points,s=e.points;if(0===n.length)return;const i=s.length/2;s.push(n[0],n[1],n[2],n[3],n[6],n[7],n[4],n[5]),e.indices.push(i,i+1,i+2,i+1,i+2,i+3)}},Of={build(t){Rf.build(t)},triangulate(t,e){Rf.triangulate(t,e)}};var Df=(t=>(t.MITER="miter",t.BEVEL="bevel",t.ROUND="round",t))(Df||{}),Lf=(t=>(t.BUTT="butt",t.ROUND="round",t.SQUARE="square",t))(Lf||{});const Nf={adaptive:!0,maxLength:10,minSegments:8,maxSegments:2048,epsilon:1e-4,_segmentsCount(t,e=20){if(!this.adaptive||!t||isNaN(t))return e;let n=Math.ceil(t/this.maxLength);return n<this.minSegments?n=this.minSegments:n>this.maxSegments&&(n=this.maxSegments),n}};class Bf{static curveTo(t,e,n,s,i,r){const a=r[r.length-2],o=r[r.length-1]-e,l=a-t,h=s-e,c=n-t,u=Math.abs(o*c-l*h);if(u<1e-8||0===i)return r[r.length-2]===t&&r[r.length-1]===e||r.push(t,e),null;const d=o*o+l*l,f=h*h+c*c,p=o*h+l*c,m=i*Math.sqrt(d)/u,g=i*Math.sqrt(f)/u,v=m*p/d,x=g*p/f,y=m*c+g*l,_=m*h+g*o,b=l*(g+v),w=o*(g+v),E=c*(m+x),T=h*(m+x);return{cx:y+t,cy:_+e,radius:i,startAngle:Math.atan2(w-_,b-y),endAngle:Math.atan2(T-_,E-y),anticlockwise:l*h>c*o}}static arc(t,e,n,s,i,r,a,o,l){const h=a-r,c=Nf._segmentsCount(Math.abs(h)*i,40*Math.ceil(Math.abs(h)/Gl)),u=h/(2*c),d=2*u,f=Math.cos(u),p=Math.sin(u),m=c-1,g=m%1/m;for(let v=0;v<=m;++v){const t=u+r+d*(v+g*v),e=Math.cos(t),a=-Math.sin(t);l.push((f*e+p*a)*i+n,(f*-a+p*e)*i+s)}}}class Vf{constructor(){this.reset()}begin(t,e,n){this.reset(),this.style=t,this.start=e,this.attribStart=n}end(t,e){this.attribSize=e-this.attribStart,this.size=t-this.start}reset(){this.style=null,this.size=0,this.start=0,this.attribStart=0,this.attribSize=0}}class Uf{static curveLength(t,e,n,s,i,r,a,o){let l=0,h=0,c=0,u=0,d=0,f=0,p=0,m=0,g=0,v=0,x=0,y=t,_=e;for(let b=1;b<=10;++b)h=b/10,c=h*h,u=c*h,d=1-h,f=d*d,p=f*d,m=p*t+3*f*h*n+3*d*c*i+u*a,g=p*e+3*f*h*s+3*d*c*r+u*o,v=y-m,x=_-g,y=m,_=g,l+=Math.sqrt(v*v+x*x);return l}static curveTo(t,e,n,s,i,r,a){const o=a[a.length-2],l=a[a.length-1];a.length-=2;const h=Nf._segmentsCount(Uf.curveLength(o,l,t,e,n,s,i,r));let c=0,u=0,d=0,f=0,p=0;a.push(o,l);for(let m=1,g=0;m<=h;++m)g=m/h,c=1-g,u=c*c,d=u*c,f=g*g,p=f*g,a.push(d*o+3*u*g*t+3*c*f*n+p*i,d*l+3*u*g*e+3*c*f*s+p*r)}}function Xf(t,e,n,s,i,r,a,o){let l,h;a?(l=s,h=-n):(l=-s,h=n);const c=t-n*i+l,u=e-s*i+h,d=t+n*r+l,f=e+s*r+h;return o.push(c,u,d,f),2}function Yf(t,e,n,s,i,r,a,o){const l=n-t,h=s-e;let c=Math.atan2(l,h),u=Math.atan2(i-t,r-e);o&&c<u?c+=2*Math.PI:!o&&c>u&&(u+=2*Math.PI);let d=c;const f=u-c,p=Math.abs(f),m=Math.sqrt(l*l+h*h),g=1+(15*p*Math.sqrt(m)/Math.PI>>0),v=f/g;if(d+=v,o){a.push(t,e,n,s);for(let n=1,s=d;n<g;n++,s+=v)a.push(t,e,t+Math.sin(s)*m,e+Math.cos(s)*m);a.push(t,e,i,r)}else{a.push(n,s,t,e);for(let n=1,s=d;n<g;n++,s+=v)a.push(t+Math.sin(s)*m,e+Math.cos(s)*m,t,e);a.push(i,r,t,e)}return 2*g}function Wf(t,e){t.lineStyle.native?function(t,e){let n=0;const s=t.shape,i=t.points||s.points,r=s.type!==$l.POLY||s.closeStroke;if(0===i.length)return;const a=e.points,o=e.indices,l=i.length/2,h=a.length/2;let c=h;for(a.push(i[0],i[1]),n=1;n<l;n++)a.push(i[2*n],i[2*n+1]),o.push(c,c+1),c++;r&&o.push(c,h)}(t,e):function(t,e){const n=t.shape;let s=t.points||n.points.slice();const i=e.closePointEps;if(0===s.length)return;const r=t.lineStyle,a=new ql(s[0],s[1]),o=new ql(s[s.length-2],s[s.length-1]),l=n.type!==$l.POLY||n.closeStroke,h=Math.abs(a.x-o.x)<i&&Math.abs(a.y-o.y)<i;if(l){s=s.slice(),h&&(s.pop(),s.pop(),o.set(s[s.length-2],s[s.length-1]));const t=.5*(a.x+o.x),e=.5*(o.y+a.y);s.unshift(t,e),s.push(t,e)}const c=e.points,u=s.length/2;let d=s.length;const f=c.length/2,p=r.width/2,m=p*p,g=r.miterLimit*r.miterLimit;let v=s[0],x=s[1],y=s[2],_=s[3],b=0,w=0,E=-(x-_),T=v-y,S=0,A=0,C=Math.sqrt(E*E+T*T);E/=C,T/=C,E*=p,T*=p;const I=r.alignment,M=2*(1-I),R=2*I;l||(r.cap===Lf.ROUND?d+=Yf(v-E*(M-R)*.5,x-T*(M-R)*.5,v-E*M,x-T*M,v+E*R,x+T*R,c,!0)+2:r.cap===Lf.SQUARE&&(d+=Xf(v,x,E,T,M,R,!0,c))),c.push(v-E*M,x-T*M,v+E*R,x+T*R);for(let F=1;F<u-1;++F){v=s[2*(F-1)],x=s[2*(F-1)+1],y=s[2*F],_=s[2*F+1],b=s[2*(F+1)],w=s[2*(F+1)+1],E=-(x-_),T=v-y,C=Math.sqrt(E*E+T*T),E/=C,T/=C,E*=p,T*=p,S=-(_-w),A=y-b,C=Math.sqrt(S*S+A*A),S/=C,A/=C,S*=p,A*=p;const t=y-v,e=x-_,n=y-b,i=w-_,a=t*n+e*i,o=e*n-i*t,l=o<0;if(Math.abs(o)<.001*Math.abs(a)){c.push(y-E*M,_-T*M,y+E*R,_+T*R),a>=0&&(r.join===Df.ROUND?d+=Yf(y,_,y-E*M,_-T*M,y-S*M,_-A*M,c,!1)+4:d+=2,c.push(y-S*R,_-A*R,y+S*M,_+A*M));continue}const h=(-E+v)*(-T+_)-(-E+y)*(-T+x),u=(-S+b)*(-A+_)-(-S+y)*(-A+w),f=(t*u-n*h)/o,I=(i*h-e*u)/o,P=(f-y)*(f-y)+(I-_)*(I-_),k=y+(f-y)*M,O=_+(I-_)*M,D=y-(f-y)*R,L=_-(I-_)*R,N=l?M:R,B=P<=Math.min(t*t+e*e,n*n+i*i)+N*N*m;let V=r.join;if(V===Df.MITER&&P/m>g&&(V=Df.BEVEL),B)switch(V){case Df.MITER:c.push(k,O,D,L);break;case Df.BEVEL:l?c.push(k,O,y+E*R,_+T*R,k,O,y+S*R,_+A*R):c.push(y-E*M,_-T*M,D,L,y-S*M,_-A*M,D,L),d+=2;break;case Df.ROUND:l?(c.push(k,O,y+E*R,_+T*R),d+=Yf(y,_,y+E*R,_+T*R,y+S*R,_+A*R,c,!0)+4,c.push(k,O,y+S*R,_+A*R)):(c.push(y-E*M,_-T*M,D,L),d+=Yf(y,_,y-E*M,_-T*M,y-S*M,_-A*M,c,!1)+4,c.push(y-S*M,_-A*M,D,L))}else{switch(c.push(y-E*M,_-T*M,y+E*R,_+T*R),V){case Df.MITER:l?c.push(D,L,D,L):c.push(k,O,k,O),d+=2;break;case Df.ROUND:d+=l?Yf(y,_,y+E*R,_+T*R,y+S*R,_+A*R,c,!0)+2:Yf(y,_,y-E*M,_-T*M,y-S*M,_-A*M,c,!1)+2}c.push(y-S*M,_-A*M,y+S*R,_+A*R),d+=2}}v=s[2*(u-2)],x=s[2*(u-2)+1],y=s[2*(u-1)],_=s[2*(u-1)+1],E=-(x-_),T=v-y,C=Math.sqrt(E*E+T*T),E/=C,T/=C,E*=p,T*=p,c.push(y-E*M,_-T*M,y+E*R,_+T*R),l||(r.cap===Lf.ROUND?d+=Yf(y-E*(M-R)*.5,_-T*(M-R)*.5,y-E*M,_-T*M,y+E*R,_+T*R,c,!1)+2:r.cap===Lf.SQUARE&&(d+=Xf(y,_,E,T,M,R,!1,c)));const P=e.indices,k=Nf.epsilon*Nf.epsilon;for(let F=f;F<d+f-2;++F)v=c[2*F],x=c[2*F+1],y=c[2*(F+1)],_=c[2*(F+1)+1],b=c[2*(F+2)],w=c[2*(F+2)+1],Math.abs(v*(_-w)+y*(w-x)+b*(x-_))<k||P.push(F,F+1,F+2)}(t,e)}class zf{static curveLength(t,e,n,s,i,r){const a=t-2*n+i,o=e-2*s+r,l=2*n-2*t,h=2*s-2*e,c=4*(a*a+o*o),u=4*(a*l+o*h),d=l*l+h*h,f=2*Math.sqrt(c+u+d),p=Math.sqrt(c),m=2*c*p,g=2*Math.sqrt(d),v=u/p;return(m*f+p*u*(f-g)+(4*d*c-u*u)*Math.log((2*p+v+f)/(v+g)))/(4*m)}static curveTo(t,e,n,s,i){const r=i[i.length-2],a=i[i.length-1],o=Nf._segmentsCount(zf.curveLength(r,a,t,e,n,s));let l=0,h=0;for(let c=1;c<=o;++c){const u=c/o;l=r+(t-r)*u,h=a+(e-a)*u,i.push(l+(t+(n-t)*u-l)*u,h+(e+(s-e)*u-h)*u)}}}const Gf={[$l.POLY]:kf,[$l.CIRC]:Rf,[$l.ELIP]:Rf,[$l.RECT]:Ff,[$l.RREC]:Of},Hf=[],jf=[];class $f{constructor(t,e=null,n=null,s=null){this.points=[],this.holes=[],this.shape=t,this.lineStyle=n,this.fillStyle=e,this.matrix=s,this.type=t.type}clone(){return new $f(this.shape,this.fillStyle,this.lineStyle,this.matrix)}destroy(){this.shape=null,this.holes.length=0,this.holes=null,this.points.length=0,this.points=null,this.lineStyle=null,this.fillStyle=null}}const qf=new ql,Kf=class extends zl{constructor(){super(),this.closePointEps=1e-4,this.boundsPadding=0,this.uvsFloat32=null,this.indicesUint16=null,this.batchable=!1,this.points=[],this.colors=[],this.uvs=[],this.indices=[],this.textureIds=[],this.graphicsData=[],this.drawCalls=[],this.batchDirty=-1,this.batches=[],this.dirty=0,this.cacheDirty=-1,this.clearDirty=0,this.shapeIndex=0,this._bounds=new wu,this.boundsDirty=-1}get bounds(){return this.updateBatches(),this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.calculateBounds()),this._bounds}invalidate(){this.boundsDirty=-1,this.dirty++,this.batchDirty++,this.shapeIndex=0,this.points.length=0,this.colors.length=0,this.uvs.length=0,this.indices.length=0,this.textureIds.length=0;for(let t=0;t<this.drawCalls.length;t++)this.drawCalls[t].texArray.clear(),jf.push(this.drawCalls[t]);this.drawCalls.length=0;for(let t=0;t<this.batches.length;t++){const e=this.batches[t];e.reset(),Hf.push(e)}this.batches.length=0}clear(){return this.graphicsData.length>0&&(this.invalidate(),this.clearDirty++,this.graphicsData.length=0),this}drawShape(t,e=null,n=null,s=null){const i=new $f(t,e,n,s);return this.graphicsData.push(i),this.dirty++,this}drawHole(t,e=null){if(!this.graphicsData.length)return null;const n=new $f(t,null,null,e),s=this.graphicsData[this.graphicsData.length-1];return n.lineStyle=s.lineStyle,s.holes.push(n),this.dirty++,this}destroy(){super.destroy();for(let t=0;t<this.graphicsData.length;++t)this.graphicsData[t].destroy();this.points.length=0,this.points=null,this.colors.length=0,this.colors=null,this.uvs.length=0,this.uvs=null,this.indices.length=0,this.indices=null,this.indexBuffer.destroy(),this.indexBuffer=null,this.graphicsData.length=0,this.graphicsData=null,this.drawCalls.length=0,this.drawCalls=null,this.batches.length=0,this.batches=null,this._bounds=null}containsPoint(t){const e=this.graphicsData;for(let n=0;n<e.length;++n){const s=e[n];if(s.fillStyle.visible&&(s.shape&&(s.matrix?s.matrix.applyInverse(t,qf):qf.copyFrom(t),s.shape.contains(qf.x,qf.y)))){let t=!1;if(s.holes)for(let e=0;e<s.holes.length;e++){if(s.holes[e].shape.contains(qf.x,qf.y)){t=!0;break}}if(!t)return!0}}return!1}updateBatches(){if(!this.graphicsData.length)return void(this.batchable=!0);if(!this.validateBatching())return;this.cacheDirty=this.dirty;const t=this.uvs,e=this.graphicsData;let n=null,s=null;this.batches.length>0&&(n=this.batches[this.batches.length-1],s=n.style);for(let o=this.shapeIndex;o<e.length;o++){this.shapeIndex++;const i=e[o],r=i.fillStyle,a=i.lineStyle;Gf[i.type].build(i),i.matrix&&this.transformPoints(i.points,i.matrix),(r.visible||a.visible)&&this.processHoles(i.holes);for(let e=0;e<2;e++){const o=0===e?r:a;if(!o.visible)continue;const l=o.texture.baseTexture,h=this.indices.length,c=this.points.length/2;l.wrapMode=Dr.REPEAT,0===e?this.processFill(i):this.processLine(i);const u=this.points.length/2-c;0!==u&&(n&&!this._compareStyles(s,o)&&(n.end(h,c),n=null),n||(n=Hf.pop()||new Vf,n.begin(o,h,c),this.batches.push(n),s=o),this.addUvs(this.points,t,o.texture,c,u,o.matrix))}}const i=this.indices.length,r=this.points.length/2;if(n&&n.end(i,r),0===this.batches.length)return void(this.batchable=!0);const a=r>65535;this.indicesUint16&&this.indices.length===this.indicesUint16.length&&a===this.indicesUint16.BYTES_PER_ELEMENT>2?this.indicesUint16.set(this.indices):this.indicesUint16=a?new Uint32Array(this.indices):new Uint16Array(this.indices),this.batchable=this.isBatchable(),this.batchable?this.packBatches():this.buildDrawCalls()}_compareStyles(t,e){return!(!t||!e)&&(t.texture.baseTexture===e.texture.baseTexture&&(t.color+t.alpha===e.color+e.alpha&&!!t.native==!!e.native))}validateBatching(){if(this.dirty===this.cacheDirty||!this.graphicsData.length)return!1;for(let t=0,e=this.graphicsData.length;t<e;t++){const e=this.graphicsData[t],n=e.fillStyle,s=e.lineStyle;if(n&&!n.texture.baseTexture.valid)return!1;if(s&&!s.texture.baseTexture.valid)return!1}return!0}packBatches(){this.batchDirty++,this.uvsFloat32=new Float32Array(this.uvs);const t=this.batches;for(let e=0,n=t.length;e<n;e++){const n=t[e];for(let t=0;t<n.size;t++){const e=n.start+t;this.indicesUint16[e]=this.indicesUint16[e]-n.attribStart}}}isBatchable(){if(this.points.length>131070)return!1;const t=this.batches;for(let e=0;e<t.length;e++)if(t[e].style.native)return!1;return this.points.length<2*Kf.BATCHABLE_SIZE}buildDrawCalls(){let t=++Ol._globalBatch;for(let c=0;c<this.drawCalls.length;c++)this.drawCalls[c].texArray.clear(),jf.push(this.drawCalls[c]);this.drawCalls.length=0;const e=this.colors,n=this.textureIds;let s=jf.pop();s||(s=new Dl,s.texArray=new Uh),s.texArray.count=0,s.start=0,s.size=0,s.type=Mr.TRIANGLES;let i=0,r=null,a=0,o=!1,l=Mr.TRIANGLES,h=0;this.drawCalls.push(s);for(let c=0;c<this.batches.length;c++){const u=this.batches[c],d=8,f=u.style,p=f.texture.baseTexture;o!==!!f.native&&(o=!!f.native,l=o?Mr.LINES:Mr.TRIANGLES,r=null,i=d,t++),r!==p&&(r=p,p._batchEnabled!==t&&(i===d&&(t++,i=0,s.size>0&&(s=jf.pop(),s||(s=new Dl,s.texArray=new Uh),this.drawCalls.push(s)),s.start=h,s.size=0,s.texArray.count=0,s.type=l),p.touched=1,p._batchEnabled=t,p._batchLocation=i,p.wrapMode=Dr.REPEAT,s.texArray.elements[s.texArray.count++]=p,i++)),s.size+=u.size,h+=u.size,a=p._batchLocation,this.addColors(e,f.color,f.alpha,u.attribSize,u.attribStart),this.addTextureIds(n,a,u.attribSize,u.attribStart)}Ol._globalBatch=t,this.packAttributes()}packAttributes(){const t=this.points,e=this.uvs,n=this.colors,s=this.textureIds,i=new ArrayBuffer(3*t.length*4),r=new Float32Array(i),a=new Uint32Array(i);let o=0;for(let l=0;l<t.length/2;l++)r[o++]=t[2*l],r[o++]=t[2*l+1],r[o++]=e[2*l],r[o++]=e[2*l+1],a[o++]=n[l],r[o++]=s[l];this._buffer.update(i),this._indexBuffer.update(this.indicesUint16)}processFill(t){if(t.holes.length)kf.triangulate(t,this);else{Gf[t.type].triangulate(t,this)}}processLine(t){Wf(t,this);for(let e=0;e<t.holes.length;e++)Wf(t.holes[e],this)}processHoles(t){for(let e=0;e<t.length;e++){const n=t[e];Gf[n.type].build(n),n.matrix&&this.transformPoints(n.points,n.matrix)}}calculateBounds(){const t=this._bounds;t.clear(),t.addVertexData(this.points,0,this.points.length),t.pad(this.boundsPadding,this.boundsPadding)}transformPoints(t,e){for(let n=0;n<t.length/2;n++){const s=t[2*n],i=t[2*n+1];t[2*n]=e.a*s+e.c*i+e.tx,t[2*n+1]=e.b*s+e.d*i+e.ty}}addColors(t,e,n,s,i=0){const r=qo.shared.setValue(e).toLittleEndianNumber(),a=qo.shared.setValue(r).toPremultiplied(n);t.length=Math.max(t.length,i+s);for(let o=0;o<s;o++)t[i+o]=a}addTextureIds(t,e,n,s=0){t.length=Math.max(t.length,s+n);for(let i=0;i<n;i++)t[s+i]=e}addUvs(t,e,n,s,i,r=null){let a=0;const o=e.length,l=n.frame;for(;a<i;){let n=t[2*(s+a)],i=t[2*(s+a)+1];if(r){const t=r.a*n+r.c*i+r.tx;i=r.b*n+r.d*i+r.ty,n=t}a++,e.push(n/l.width,i/l.height)}const h=n.baseTexture;(l.width<h.width||l.height<h.height)&&this.adjustUvs(e,n,o,i)}adjustUvs(t,e,n,s){const i=e.baseTexture,r=1e-6,a=n+2*s,o=e.frame,l=o.width/i.width,h=o.height/i.height;let c=o.x/o.width,u=o.y/o.height,d=Math.floor(t[n]+r),f=Math.floor(t[n+1]+r);for(let p=n+2;p<a;p+=2)d=Math.min(d,Math.floor(t[p]+r)),f=Math.min(f,Math.floor(t[p+1]+r));c-=d,u-=f;for(let p=n;p<a;p+=2)t[p]=(t[p]+c)*l,t[p+1]=(t[p+1]+u)*h}};let Zf=Kf;Zf.BATCHABLE_SIZE=100;class Qf{constructor(){this.color=16777215,this.alpha=1,this.texture=ic.WHITE,this.matrix=null,this.visible=!1,this.reset()}clone(){const t=new Qf;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t}reset(){this.color=16777215,this.alpha=1,this.texture=ic.WHITE,this.matrix=null,this.visible=!1}destroy(){this.texture=null,this.matrix=null}}class Jf extends Qf{constructor(){super(...arguments),this.width=0,this.alignment=.5,this.native=!1,this.cap=Lf.BUTT,this.join=Df.MITER,this.miterLimit=10}clone(){const t=new Jf;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t.width=this.width,t.alignment=this.alignment,t.native=this.native,t.cap=this.cap,t.join=this.join,t.miterLimit=this.miterLimit,t}reset(){super.reset(),this.color=0,this.alignment=.5,this.width=0,this.native=!1}}const tp={},ep=class extends Iu{constructor(t=null){super(),this.shader=null,this.pluginName="batch",this.currentPath=null,this.batches=[],this.batchTint=-1,this.batchDirty=-1,this.vertexData=null,this._fillStyle=new Qf,this._lineStyle=new Jf,this._matrix=null,this._holeMode=!1,this.state=Al.for2d(),this._geometry=t||new Zf,this._geometry.refCount++,this._transformID=-1,this._tintColor=new qo(16777215),this.blendMode=Ir.NORMAL}get geometry(){return this._geometry}clone(){return this.finishPoly(),new ep(this._geometry)}set blendMode(t){this.state.blendMode=t}get blendMode(){return this.state.blendMode}get tint(){return this._tintColor.value}set tint(t){this._tintColor.setValue(t)}get fill(){return this._fillStyle}get line(){return this._lineStyle}lineStyle(t=null,e=0,n,s=.5,i=!1){return"number"==typeof t&&(t={width:t,color:e,alpha:n,alignment:s,native:i}),this.lineTextureStyle(t)}lineTextureStyle(t){const e={width:0,texture:ic.WHITE,color:(null==t?void 0:t.texture)?16777215:0,matrix:null,alignment:.5,native:!1,cap:Lf.BUTT,join:Df.MITER,miterLimit:10};t=Object.assign(e,t),this.normalizeColor(t),this.currentPath&&this.startPoly();const n=t.width>0&&t.alpha>0;return n?(t.matrix&&(t.matrix=t.matrix.clone(),t.matrix.invert()),Object.assign(this._lineStyle,{visible:n},t)):this._lineStyle.reset(),this}startPoly(){if(this.currentPath){const t=this.currentPath.points,e=this.currentPath.points.length;e>2&&(this.drawShape(this.currentPath),this.currentPath=new th,this.currentPath.closeStroke=!1,this.currentPath.points.push(t[e-2],t[e-1]))}else this.currentPath=new th,this.currentPath.closeStroke=!1}finishPoly(){this.currentPath&&(this.currentPath.points.length>2?(this.drawShape(this.currentPath),this.currentPath=null):this.currentPath.points.length=0)}moveTo(t,e){return this.startPoly(),this.currentPath.points[0]=t,this.currentPath.points[1]=e,this}lineTo(t,e){this.currentPath||this.moveTo(0,0);const n=this.currentPath.points,s=n[n.length-2],i=n[n.length-1];return s===t&&i===e||n.push(t,e),this}_initCurve(t=0,e=0){this.currentPath?0===this.currentPath.points.length&&(this.currentPath.points=[t,e]):this.moveTo(t,e)}quadraticCurveTo(t,e,n,s){this._initCurve();const i=this.currentPath.points;return 0===i.length&&this.moveTo(0,0),zf.curveTo(t,e,n,s,i),this}bezierCurveTo(t,e,n,s,i,r){return this._initCurve(),Uf.curveTo(t,e,n,s,i,r,this.currentPath.points),this}arcTo(t,e,n,s,i){this._initCurve(t,e);const r=this.currentPath.points,a=Bf.curveTo(t,e,n,s,i,r);if(a){const{cx:t,cy:e,radius:n,startAngle:s,endAngle:i,anticlockwise:r}=a;this.arc(t,e,n,s,i,r)}return this}arc(t,e,n,s,i,r=!1){if(s===i)return this;!r&&i<=s?i+=Gl:r&&s<=i&&(s+=Gl);if(0===i-s)return this;const a=t+Math.cos(s)*n,o=e+Math.sin(s)*n,l=this._geometry.closePointEps;let h=this.currentPath?this.currentPath.points:null;if(h){const t=Math.abs(h[h.length-2]-a),e=Math.abs(h[h.length-1]-o);t<l&&e<l||h.push(a,o)}else this.moveTo(a,o),h=this.currentPath.points;return Bf.arc(a,o,t,e,n,s,i,r,h),this}beginFill(t=0,e){return this.beginTextureFill({texture:ic.WHITE,color:t,alpha:e})}normalizeColor(t){var e;const n=qo.shared.setValue(null!=(e=t.color)?e:0);t.color=n.toNumber(),null!=t.alpha||(t.alpha=n.alpha)}beginTextureFill(t){const e={texture:ic.WHITE,color:16777215,matrix:null};t=Object.assign(e,t),this.normalizeColor(t),this.currentPath&&this.startPoly();const n=t.alpha>0;return n?(t.matrix&&(t.matrix=t.matrix.clone(),t.matrix.invert()),Object.assign(this._fillStyle,{visible:n},t)):this._fillStyle.reset(),this}endFill(){return this.finishPoly(),this._fillStyle.reset(),this}drawRect(t,e,n,s){return this.drawShape(new Zl(t,e,n,s))}drawRoundedRect(t,e,n,s,i){return this.drawShape(new eh(t,e,n,s,i))}drawCircle(t,e,n){return this.drawShape(new Ql(t,e,n))}drawEllipse(t,e,n,s){return this.drawShape(new Jl(t,e,n,s))}drawPolygon(...t){let e,n=!0;const s=t[0];s.points?(n=s.closeStroke,e=s.points):e=Array.isArray(t[0])?t[0]:t;const i=new th(e);return i.closeStroke=n,this.drawShape(i),this}drawShape(t){return this._holeMode?this._geometry.drawHole(t,this._matrix):this._geometry.drawShape(t,this._fillStyle.clone(),this._lineStyle.clone(),this._matrix),this}clear(){return this._geometry.clear(),this._lineStyle.reset(),this._fillStyle.reset(),this._boundsID++,this._matrix=null,this._holeMode=!1,this.currentPath=null,this}isFastRect(){const t=this._geometry.graphicsData;return!(1!==t.length||t[0].shape.type!==$l.RECT||t[0].matrix||t[0].holes.length||t[0].lineStyle.visible&&t[0].lineStyle.width)}_render(t){this.finishPoly();const e=this._geometry;e.updateBatches(),e.batchable?(this.batchDirty!==e.batchDirty&&this._populateBatches(),this._renderBatched(t)):(t.batch.flush(),this._renderDirect(t))}_populateBatches(){const t=this._geometry,e=this.blendMode,n=t.batches.length;this.batchTint=-1,this._transformID=-1,this.batchDirty=t.batchDirty,this.batches.length=n,this.vertexData=new Float32Array(t.points);for(let s=0;s<n;s++){const n=t.batches[s],i=n.style.color,r=new Float32Array(this.vertexData.buffer,4*n.attribStart*2,2*n.attribSize),a=new Float32Array(t.uvsFloat32.buffer,4*n.attribStart*2,2*n.attribSize),o={vertexData:r,blendMode:e,indices:new Uint16Array(t.indicesUint16.buffer,2*n.start,n.size),uvs:a,_batchRGB:qo.shared.setValue(i).toRgbArray(),_tintRGB:i,_texture:n.style.texture,alpha:n.style.alpha,worldAlpha:1};this.batches[s]=o}}_renderBatched(t){if(this.batches.length){t.batch.setObjectRenderer(t.plugins[this.pluginName]),this.calculateVertices(),this.calculateTints();for(let e=0,n=this.batches.length;e<n;e++){const n=this.batches[e];n.worldAlpha=this.worldAlpha*n.alpha,t.plugins[this.pluginName].render(n)}}}_renderDirect(t){const e=this._resolveDirectShader(t),n=this._geometry,s=this.worldAlpha,i=e.uniforms,r=n.drawCalls;i.translationMatrix=this.transform.worldTransform,qo.shared.setValue(this._tintColor).premultiply(s).toArray(i.tint),t.shader.bind(e),t.geometry.bind(n,e),t.state.set(this.state);for(let a=0,o=r.length;a<o;a++)this._renderDrawCallDirect(t,n.drawCalls[a])}_renderDrawCallDirect(t,e){const{texArray:n,type:s,size:i,start:r}=e,a=n.count;for(let o=0;o<a;o++)t.texture.bind(n.elements[o],o);t.geometry.draw(s,i,r)}_resolveDirectShader(t){let e=this.shader;const n=this.pluginName;if(!e){if(!tp[n]){const{maxTextures:e}=t.plugins[n],s=new Int32Array(e);for(let t=0;t<e;t++)s[t]=t;const i={tint:new Float32Array([1,1,1,1]),translationMatrix:new nh,default:Nh.from({uSamplers:s},!0)},r=t.plugins[n]._shader.program;tp[n]=new Bh(r,i)}e=tp[n]}return e}_calculateBounds(){this.finishPoly();const t=this._geometry;if(!t.graphicsData.length)return;const{minX:e,minY:n,maxX:s,maxY:i}=t.bounds;this._bounds.addFrame(this.transform,e,n,s,i)}containsPoint(t){return this.worldTransform.applyInverse(t,ep._TEMP_POINT),this._geometry.containsPoint(ep._TEMP_POINT)}calculateTints(){if(this.batchTint!==this.tint){this.batchTint=this._tintColor.toNumber();for(let t=0;t<this.batches.length;t++){const e=this.batches[t];e._tintRGB=qo.shared.setValue(this._tintColor).multiply(e._batchRGB).toLittleEndianNumber()}}}calculateVertices(){const t=this.transform._worldID;if(this._transformID===t)return;this._transformID=t;const e=this.transform.worldTransform,n=e.a,s=e.b,i=e.c,r=e.d,a=e.tx,o=e.ty,l=this._geometry.points,h=this.vertexData;let c=0;for(let u=0;u<l.length;u+=2){const t=l[u],e=l[u+1];h[c++]=n*t+i*e+a,h[c++]=r*e+s*t+o}}closePath(){const t=this.currentPath;return t&&(t.closeStroke=!0,this.finishPoly()),this}setMatrix(t){return this._matrix=t,this}beginHole(){return this.finishPoly(),this._holeMode=!0,this}endHole(){return this.finishPoly(),this._holeMode=!1,this}destroy(t){this._geometry.refCount--,0===this._geometry.refCount&&this._geometry.dispose(),this._matrix=null,this.currentPath=null,this._lineStyle.destroy(),this._lineStyle=null,this._fillStyle.destroy(),this._fillStyle=null,this._geometry=null,this.shader=null,this.vertexData=null,this.batches.length=0,this.batches=null,super.destroy(t)}};let np=ep;np.curves=Nf,np._TEMP_POINT=new ql;class sp{constructor(t,e){this.uvBuffer=t,this.uvMatrix=e,this.data=null,this._bufferUpdateId=-1,this._textureUpdateId=-1,this._updateID=0}update(t){if(!t&&this._bufferUpdateId===this.uvBuffer._updateID&&this._textureUpdateId===this.uvMatrix._updateID)return;this._bufferUpdateId=this.uvBuffer._updateID,this._textureUpdateId=this.uvMatrix._updateID;const e=this.uvBuffer.data;this.data&&this.data.length===e.length||(this.data=new Float32Array(e.length)),this.uvMatrix.multiplyUvs(e,this.data),this._updateID++}}const ip=new ql,rp=new th,ap=class extends Iu{constructor(t,e,n,s=Mr.TRIANGLES){super(),this.geometry=t,this.shader=e,this.state=n||Al.for2d(),this.drawMode=s,this.start=0,this.size=0,this.uvs=null,this.indices=null,this.vertexData=new Float32Array(1),this.vertexDirty=-1,this._transformID=-1,this._roundPixels=zr.ROUND_PIXELS,this.batchUvs=null}get geometry(){return this._geometry}set geometry(t){this._geometry!==t&&(this._geometry&&(this._geometry.refCount--,0===this._geometry.refCount&&this._geometry.dispose()),this._geometry=t,this._geometry&&this._geometry.refCount++,this.vertexDirty=-1)}get uvBuffer(){return this.geometry.buffers[1]}get verticesBuffer(){return this.geometry.buffers[0]}set material(t){this.shader=t}get material(){return this.shader}set blendMode(t){this.state.blendMode=t}get blendMode(){return this.state.blendMode}set roundPixels(t){this._roundPixels!==t&&(this._transformID=-1),this._roundPixels=t}get roundPixels(){return this._roundPixels}get tint(){return"tint"in this.shader?this.shader.tint:null}set tint(t){this.shader.tint=t}get tintValue(){return this.shader.tintValue}get texture(){return"texture"in this.shader?this.shader.texture:null}set texture(t){this.shader.texture=t}_render(t){const e=this.geometry.buffers[0].data;this.shader.batchable&&this.drawMode===Mr.TRIANGLES&&e.length<2*ap.BATCHABLE_SIZE?this._renderToBatch(t):this._renderDefault(t)}_renderDefault(t){const e=this.shader;e.alpha=this.worldAlpha,e.update&&e.update(),t.batch.flush(),e.uniforms.translationMatrix=this.transform.worldTransform.toArray(!0),t.shader.bind(e),t.state.set(this.state),t.geometry.bind(this.geometry,e),t.geometry.draw(this.drawMode,this.size,this.start,this.geometry.instanceCount)}_renderToBatch(t){const e=this.geometry,n=this.shader;n.uvMatrix&&(n.uvMatrix.update(),this.calculateUvs()),this.calculateVertices(),this.indices=e.indexBuffer.data,this._tintRGB=n._tintRGB,this._texture=n.texture;const s=this.material.pluginName;t.batch.setObjectRenderer(t.plugins[s]),t.plugins[s].render(this)}calculateVertices(){const t=this.geometry.buffers[0],e=t.data,n=t._updateID;if(n===this.vertexDirty&&this._transformID===this.transform._worldID)return;this._transformID=this.transform._worldID,this.vertexData.length!==e.length&&(this.vertexData=new Float32Array(e.length));const s=this.transform.worldTransform,i=s.a,r=s.b,a=s.c,o=s.d,l=s.tx,h=s.ty,c=this.vertexData;for(let u=0;u<c.length/2;u++){const t=e[2*u],n=e[2*u+1];c[2*u]=i*t+a*n+l,c[2*u+1]=r*t+o*n+h}if(this._roundPixels){const t=zr.RESOLUTION;for(let e=0;e<c.length;++e)c[e]=Math.round(c[e]*t)/t}this.vertexDirty=n}calculateUvs(){const t=this.geometry.buffers[1],e=this.shader;e.uvMatrix.isSimple?this.uvs=t.data:(this.batchUvs||(this.batchUvs=new sp(t,e.uvMatrix)),this.batchUvs.update(),this.uvs=this.batchUvs.data)}_calculateBounds(){this.calculateVertices(),this._bounds.addVertexData(this.vertexData,0,this.vertexData.length)}containsPoint(t){if(!this.getBounds().contains(t.x,t.y))return!1;this.worldTransform.applyInverse(t,ip);const e=this.geometry.getBuffer("aVertexPosition").data,n=rp.points,s=this.geometry.getIndex().data,i=s.length,r=4===this.drawMode?3:1;for(let a=0;a+2<i;a+=r){const t=2*s[a],i=2*s[a+1],r=2*s[a+2];if(n[0]=e[t],n[1]=e[t+1],n[2]=e[i],n[3]=e[i+1],n[4]=e[r],n[5]=e[r+1],rp.contains(ip.x,ip.y))return!0}return!1}destroy(t){super.destroy(t),this._cachedTexture&&(this._cachedTexture.destroy(),this._cachedTexture=null),this.geometry=null,this.shader=null,this.state=null,this.uvs=null,this.indices=null,this.vertexData=null}};let op=ap;op.BATCHABLE_SIZE=100;class lp extends Wl{constructor(t,e,n){super();const s=new Nl(t),i=new Nl(e,!0),r=new Nl(n,!0,!0);this.addAttribute("aVertexPosition",s,2,!1,kr.FLOAT).addAttribute("aTextureCoord",i,2,!1,kr.FLOAT).addIndex(r),this._updateId=-1}get vertexDirtyId(){return this.buffers[0]._updateID}}class hp extends Bh{constructor(t,e){const n={uSampler:t,alpha:1,uTextureMatrix:nh.IDENTITY,uColor:new Float32Array([1,1,1,1])};(e=Object.assign({tint:16777215,alpha:1,pluginName:"batch"},e)).uniforms&&Object.assign(n,e.uniforms),super(e.program||Dh.from("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTextureMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\n}\n","varying vec2 vTextureCoord;\nuniform vec4 uColor;\n\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n    gl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;\n}\n"),n),this._colorDirty=!1,this.uvMatrix=new yc(t),this.batchable=void 0===e.program,this.pluginName=e.pluginName,this._tintColor=new qo(e.tint),this._tintRGB=this._tintColor.toLittleEndianNumber(),this._colorDirty=!0,this.alpha=e.alpha}get texture(){return this.uniforms.uSampler}set texture(t){this.uniforms.uSampler!==t&&(!this.uniforms.uSampler.baseTexture.alphaMode!=!t.baseTexture.alphaMode&&(this._colorDirty=!0),this.uniforms.uSampler=t,this.uvMatrix.texture=t)}set alpha(t){t!==this._alpha&&(this._alpha=t,this._colorDirty=!0)}get alpha(){return this._alpha}set tint(t){t!==this.tint&&(this._tintColor.setValue(t),this._tintRGB=this._tintColor.toLittleEndianNumber(),this._colorDirty=!0)}get tint(){return this._tintColor.value}get tintValue(){return this._tintColor.toNumber()}update(){if(this._colorDirty){this._colorDirty=!1;const t=this.texture.baseTexture.alphaMode;qo.shared.setValue(this._tintColor).premultiply(this._alpha,t).toArray(this.uniforms.uColor)}this.uvMatrix.update()&&(this.uniforms.uTextureMatrix=this.uvMatrix.mapCoord)}}class cp extends op{constructor(t=ic.EMPTY,e,n,s,i){const r=new lp(e,n,s);r.getBuffer("aVertexPosition").static=!1;super(r,new hp(t),null,i),this.autoUpdate=!0}get vertices(){return this.geometry.getBuffer("aVertexPosition").data}set vertices(t){this.geometry.getBuffer("aVertexPosition").data=t}_render(t){this.autoUpdate&&this.geometry.getBuffer("aVertexPosition").update(),super._render(t)}}class up extends Iu{constructor(t=1500,e,n=16384,s=!1){super();n>16384&&(n=16384),this._properties=[!1,!0,!1,!1,!1],this._maxSize=t,this._batchSize=n,this._buffers=null,this._bufferUpdateIDs=[],this._updateID=0,this.interactiveChildren=!1,this.blendMode=Ir.NORMAL,this.autoResize=s,this.roundPixels=!0,this.baseTexture=null,this.setProperties(e),this._tintColor=new qo(0),this.tintRgb=new Float32Array(3),this.tint=16777215}setProperties(t){t&&(this._properties[0]="vertices"in t||"scale"in t?!!t.vertices||!!t.scale:this._properties[0],this._properties[1]="position"in t?!!t.position:this._properties[1],this._properties[2]="rotation"in t?!!t.rotation:this._properties[2],this._properties[3]="uvs"in t?!!t.uvs:this._properties[3],this._properties[4]="tint"in t||"alpha"in t?!!t.tint||!!t.alpha:this._properties[4])}updateTransform(){this.displayObjectUpdateTransform()}get tint(){return this._tintColor.value}set tint(t){this._tintColor.setValue(t),this._tintColor.toRgbArray(this.tintRgb)}render(t){this.visible&&!(this.worldAlpha<=0)&&this.children.length&&this.renderable&&(this.baseTexture||(this.baseTexture=this.children[0]._texture.baseTexture,this.baseTexture.valid||this.baseTexture.once("update",(()=>this.onChildrenChange(0)))),t.batch.setObjectRenderer(t.plugins.particle),t.plugins.particle.render(this))}onChildrenChange(t){const e=Math.floor(t/this._batchSize);for(;this._bufferUpdateIDs.length<e;)this._bufferUpdateIDs.push(0);this._bufferUpdateIDs[e]=++this._updateID}dispose(){if(this._buffers){for(let t=0;t<this._buffers.length;++t)this._buffers[t].destroy();this._buffers=null}}destroy(t){super.destroy(t),this.dispose(),this._properties=null,this._buffers=null,this._bufferUpdateIDs=null}}class dp{constructor(t,e,n){this.geometry=new Wl,this.indexBuffer=null,this.size=n,this.dynamicProperties=[],this.staticProperties=[];for(let s=0;s<t.length;++s){let n=t[s];n={attributeName:n.attributeName,size:n.size,uploadFunction:n.uploadFunction,type:n.type||kr.FLOAT,offset:n.offset},e[s]?this.dynamicProperties.push(n):this.staticProperties.push(n)}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this._updateID=0,this.initBuffers()}initBuffers(){const t=this.geometry;let e=0;this.indexBuffer=new Nl(function(t,e=null){const n=6*t;if((e=e||new Uint16Array(n)).length!==n)throw new Error(`Out buffer length is incorrect, got ${e.length} and expected ${n}`);for(let s=0,i=0;s<n;s+=6,i+=4)e[s+0]=i+0,e[s+1]=i+1,e[s+2]=i+2,e[s+3]=i+0,e[s+4]=i+2,e[s+5]=i+3;return e}(this.size),!0,!0),t.addIndex(this.indexBuffer),this.dynamicStride=0;for(let r=0;r<this.dynamicProperties.length;++r){const t=this.dynamicProperties[r];t.offset=e,e+=t.size,this.dynamicStride+=t.size}const n=new ArrayBuffer(this.size*this.dynamicStride*4*4);this.dynamicData=new Float32Array(n),this.dynamicDataUint32=new Uint32Array(n),this.dynamicBuffer=new Nl(this.dynamicData,!1,!1);let s=0;this.staticStride=0;for(let r=0;r<this.staticProperties.length;++r){const t=this.staticProperties[r];t.offset=s,s+=t.size,this.staticStride+=t.size}const i=new ArrayBuffer(this.size*this.staticStride*4*4);this.staticData=new Float32Array(i),this.staticDataUint32=new Uint32Array(i),this.staticBuffer=new Nl(this.staticData,!0,!1);for(let r=0;r<this.dynamicProperties.length;++r){const e=this.dynamicProperties[r];t.addAttribute(e.attributeName,this.dynamicBuffer,0,e.type===kr.UNSIGNED_BYTE,e.type,4*this.dynamicStride,4*e.offset)}for(let r=0;r<this.staticProperties.length;++r){const e=this.staticProperties[r];t.addAttribute(e.attributeName,this.staticBuffer,0,e.type===kr.UNSIGNED_BYTE,e.type,4*this.staticStride,4*e.offset)}}uploadDynamic(t,e,n){for(let s=0;s<this.dynamicProperties.length;s++){const i=this.dynamicProperties[s];i.uploadFunction(t,e,n,i.type===kr.UNSIGNED_BYTE?this.dynamicDataUint32:this.dynamicData,this.dynamicStride,i.offset)}this.dynamicBuffer._updateID++}uploadStatic(t,e,n){for(let s=0;s<this.staticProperties.length;s++){const i=this.staticProperties[s];i.uploadFunction(t,e,n,i.type===kr.UNSIGNED_BYTE?this.staticDataUint32:this.staticData,this.staticStride,i.offset)}this.staticBuffer._updateID++}destroy(){this.indexBuffer=null,this.dynamicProperties=null,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this.staticProperties=null,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.geometry.destroy()}}class fp extends Xh{constructor(t){super(t),this.shader=null,this.properties=null,this.tempMatrix=new nh,this.properties=[{attributeName:"aVertexPosition",size:2,uploadFunction:this.uploadVertices,offset:0},{attributeName:"aPositionCoord",size:2,uploadFunction:this.uploadPosition,offset:0},{attributeName:"aRotation",size:1,uploadFunction:this.uploadRotation,offset:0},{attributeName:"aTextureCoord",size:2,uploadFunction:this.uploadUvs,offset:0},{attributeName:"aColor",size:1,type:kr.UNSIGNED_BYTE,uploadFunction:this.uploadTint,offset:0}],this.shader=Bh.from("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\n\nattribute vec2 aPositionCoord;\nattribute float aRotation;\n\nuniform mat3 translationMatrix;\nuniform vec4 uColor;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nvoid main(void){\n    float x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);\n    float y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);\n\n    vec2 v = vec2(x, y);\n    v = v + aPositionCoord;\n\n    gl_Position = vec4((translationMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vColor = aColor * uColor;\n}\n","varying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n    vec4 color = texture2D(uSampler, vTextureCoord) * vColor;\n    gl_FragColor = color;\n}",{}),this.state=Al.for2d()}render(t){const e=t.children,n=t._maxSize,s=t._batchSize,i=this.renderer;let r=e.length;if(0===r)return;r>n&&!t.autoResize&&(r=n);let a=t._buffers;a||(a=t._buffers=this.generateBuffers(t));const o=e[0]._texture.baseTexture,l=o.alphaMode>0;this.state.blendMode=Jo(t.blendMode,l),i.state.set(this.state);const h=i.gl,c=t.worldTransform.copyTo(this.tempMatrix);c.prepend(i.globalUniforms.uniforms.projectionMatrix),this.shader.uniforms.translationMatrix=c.toArray(!0),this.shader.uniforms.uColor=qo.shared.setValue(t.tintRgb).premultiply(t.worldAlpha,l).toArray(this.shader.uniforms.uColor),this.shader.uniforms.uSampler=o,this.renderer.shader.bind(this.shader);let u=!1;for(let d=0,f=0;d<r;d+=s,f+=1){let n=r-d;n>s&&(n=s),f>=a.length&&a.push(this._generateOneMoreBuffer(t));const o=a[f];o.uploadDynamic(e,d,n);const l=t._bufferUpdateIDs[f]||0;u=u||o._updateID<l,u&&(o._updateID=t._updateID,o.uploadStatic(e,d,n)),i.geometry.bind(o.geometry),h.drawElements(h.TRIANGLES,6*n,h.UNSIGNED_SHORT,0)}}generateBuffers(t){const e=[],n=t._maxSize,s=t._batchSize,i=t._properties;for(let r=0;r<n;r+=s)e.push(new dp(this.properties,i,s));return e}_generateOneMoreBuffer(t){const e=t._batchSize,n=t._properties;return new dp(this.properties,n,e)}uploadVertices(t,e,n,s,i,r){let a=0,o=0,l=0,h=0;for(let c=0;c<n;++c){const n=t[e+c],u=n._texture,d=n.scale.x,f=n.scale.y,p=u.trim,m=u.orig;p?(o=p.x-n.anchor.x*m.width,a=o+p.width,h=p.y-n.anchor.y*m.height,l=h+p.height):(a=m.width*(1-n.anchor.x),o=m.width*-n.anchor.x,l=m.height*(1-n.anchor.y),h=m.height*-n.anchor.y),s[r]=o*d,s[r+1]=h*f,s[r+i]=a*d,s[r+i+1]=h*f,s[r+2*i]=a*d,s[r+2*i+1]=l*f,s[r+3*i]=o*d,s[r+3*i+1]=l*f,r+=4*i}}uploadPosition(t,e,n,s,i,r){for(let a=0;a<n;a++){const n=t[e+a].position;s[r]=n.x,s[r+1]=n.y,s[r+i]=n.x,s[r+i+1]=n.y,s[r+2*i]=n.x,s[r+2*i+1]=n.y,s[r+3*i]=n.x,s[r+3*i+1]=n.y,r+=4*i}}uploadRotation(t,e,n,s,i,r){for(let a=0;a<n;a++){const n=t[e+a].rotation;s[r]=n,s[r+i]=n,s[r+2*i]=n,s[r+3*i]=n,r+=4*i}}uploadUvs(t,e,n,s,i,r){for(let a=0;a<n;++a){const n=t[e+a]._texture._uvs;n?(s[r]=n.x0,s[r+1]=n.y0,s[r+i]=n.x1,s[r+i+1]=n.y1,s[r+2*i]=n.x2,s[r+2*i+1]=n.y2,s[r+3*i]=n.x3,s[r+3*i+1]=n.y3,r+=4*i):(s[r]=0,s[r+1]=0,s[r+i]=0,s[r+i+1]=0,s[r+2*i]=0,s[r+2*i+1]=0,s[r+3*i]=0,s[r+3*i+1]=0,r+=4*i)}}uploadTint(t,e,n,s,i,r){for(let a=0;a<n;++a){const n=t[e+a],o=qo.shared.setValue(n._tintRGB).toPremultiplied(n.alpha,n.texture.baseTexture.alphaMode>0);s[r]=o,s[r+i]=o,s[r+2*i]=o,s[r+3*i]=o,r+=4*i}}destroy(){super.destroy(),this.shader&&(this.shader.destroy(),this.shader=null),this.tempMatrix=null}}fp.extension={name:"particle",type:yl.RendererPlugin},wl.add(fp);var pp=(t=>(t[t.LINEAR_VERTICAL=0]="LINEAR_VERTICAL",t[t.LINEAR_HORIZONTAL=1]="LINEAR_HORIZONTAL",t))(pp||{});const mp={willReadFrequently:!0},gp=class{static get experimentalLetterSpacingSupported(){let t=gp._experimentalLetterSpacingSupported;if(void 0!==t){const e=zr.ADAPTER.getCanvasRenderingContext2D().prototype;t=gp._experimentalLetterSpacingSupported="letterSpacing"in e||"textLetterSpacing"in e}return t}constructor(t,e,n,s,i,r,a,o,l){this.text=t,this.style=e,this.width=n,this.height=s,this.lines=i,this.lineWidths=r,this.lineHeight=a,this.maxLineWidth=o,this.fontProperties=l}static measureText(t,e,n,s=gp._canvas){n=null==n?e.wordWrap:n;const i=e.toFontString(),r=gp.measureFont(i);0===r.fontSize&&(r.fontSize=e.fontSize,r.ascent=e.fontSize);const a=s.getContext("2d",mp);a.font=i;const o=(n?gp.wordWrap(t,e,s):t).split(/(?:\r\n|\r|\n)/),l=new Array(o.length);let h=0;for(let f=0;f<o.length;f++){const t=gp._measureText(o[f],e.letterSpacing,a);l[f]=t,h=Math.max(h,t)}let c=h+e.strokeThickness;e.dropShadow&&(c+=e.dropShadowDistance);const u=e.lineHeight||r.fontSize+e.strokeThickness;let d=Math.max(u,r.fontSize+2*e.strokeThickness)+(o.length-1)*(u+e.leading);return e.dropShadow&&(d+=e.dropShadowDistance),new gp(t,e,c,d,o,l,u+e.leading,h,r)}static _measureText(t,e,n){let s=!1;gp.experimentalLetterSpacingSupported&&(gp.experimentalLetterSpacing?(n.letterSpacing=`${e}px`,n.textLetterSpacing=`${e}px`,s=!0):(n.letterSpacing="0px",n.textLetterSpacing="0px"));let i=n.measureText(t).width;return i>0&&(s?i-=e:i+=(gp.graphemeSegmenter(t).length-1)*e),i}static wordWrap(t,e,n=gp._canvas){const s=n.getContext("2d",mp);let i=0,r="",a="";const o=Object.create(null),{letterSpacing:l,whiteSpace:h}=e,c=gp.collapseSpaces(h),u=gp.collapseNewlines(h);let d=!c;const f=e.wordWrapWidth+l,p=gp.tokenize(t);for(let m=0;m<p.length;m++){let t=p[m];if(gp.isNewline(t)){if(!u){a+=gp.addLine(r),d=!c,r="",i=0;continue}t=" "}if(c){const e=gp.isBreakingSpace(t),n=gp.isBreakingSpace(r[r.length-1]);if(e&&n)continue}const n=gp.getFromCache(t,l,o,s);if(n>f)if(""!==r&&(a+=gp.addLine(r),r="",i=0),gp.canBreakWords(t,e.breakWords)){const n=gp.wordWrapSplit(t);for(let h=0;h<n.length;h++){let c=n[h],u=c,p=1;for(;n[h+p];){const s=n[h+p];if(gp.canBreakChars(u,s,t,h,e.breakWords))break;c+=s,u=s,p++}h+=p-1;const m=gp.getFromCache(c,l,o,s);m+i>f&&(a+=gp.addLine(r),d=!1,r="",i=0),r+=c,i+=m}}else{r.length>0&&(a+=gp.addLine(r),r="",i=0);const e=m===p.length-1;a+=gp.addLine(t,!e),d=!1,r="",i=0}else n+i>f&&(d=!1,a+=gp.addLine(r),r="",i=0),(r.length>0||!gp.isBreakingSpace(t)||d)&&(r+=t,i+=n)}return a+=gp.addLine(r,!1),a}static addLine(t,e=!0){return t=gp.trimRight(t),t=e?`${t}\n`:t}static getFromCache(t,e,n,s){let i=n[t];return"number"!=typeof i&&(i=gp._measureText(t,e,s)+e,n[t]=i),i}static collapseSpaces(t){return"normal"===t||"pre-line"===t}static collapseNewlines(t){return"normal"===t}static trimRight(t){if("string"!=typeof t)return"";for(let e=t.length-1;e>=0;e--){const n=t[e];if(!gp.isBreakingSpace(n))break;t=t.slice(0,-1)}return t}static isNewline(t){return"string"==typeof t&&gp._newlines.includes(t.charCodeAt(0))}static isBreakingSpace(t,e){return"string"==typeof t&&gp._breakingSpaces.includes(t.charCodeAt(0))}static tokenize(t){const e=[];let n="";if("string"!=typeof t)return e;for(let s=0;s<t.length;s++){const i=t[s],r=t[s+1];gp.isBreakingSpace(i,r)||gp.isNewline(i)?(""!==n&&(e.push(n),n=""),e.push(i)):n+=i}return""!==n&&e.push(n),e}static canBreakWords(t,e){return e}static canBreakChars(t,e,n,s,i){return!0}static wordWrapSplit(t){return gp.graphemeSegmenter(t)}static measureFont(t){if(gp._fonts[t])return gp._fonts[t];const e={ascent:0,descent:0,fontSize:0},n=gp._canvas,s=gp._context;s.font=t;const i=gp.METRICS_STRING+gp.BASELINE_SYMBOL,r=Math.ceil(s.measureText(i).width);let a=Math.ceil(s.measureText(gp.BASELINE_SYMBOL).width);const o=Math.ceil(gp.HEIGHT_MULTIPLIER*a);if(a=a*gp.BASELINE_MULTIPLIER|0,0===r||0===o)return gp._fonts[t]=e,e;n.width=r,n.height=o,s.fillStyle="#f00",s.fillRect(0,0,r,o),s.font=t,s.textBaseline="alphabetic",s.fillStyle="#000",s.fillText(i,0,a);const l=s.getImageData(0,0,r,o).data,h=l.length,c=4*r;let u=0,d=0,f=!1;for(u=0;u<a;++u){for(let t=0;t<c;t+=4)if(255!==l[d+t]){f=!0;break}if(f)break;d+=c}for(e.ascent=a-u,d=h-c,f=!1,u=o;u>a;--u){for(let t=0;t<c;t+=4)if(255!==l[d+t]){f=!0;break}if(f)break;d-=c}return e.descent=u-a,e.fontSize=e.ascent+e.descent,gp._fonts[t]=e,e}static clearMetrics(t=""){t?delete gp._fonts[t]:gp._fonts={}}static get _canvas(){if(!gp.__canvas){let e;try{const t=new OffscreenCanvas(0,0),n=t.getContext("2d",mp);if(null==n?void 0:n.measureText)return gp.__canvas=t,t;e=zr.ADAPTER.createCanvas()}catch(t){e=zr.ADAPTER.createCanvas()}e.width=e.height=10,gp.__canvas=e}return gp.__canvas}static get _context(){return gp.__context||(gp.__context=gp._canvas.getContext("2d",mp)),gp.__context}};let vp=gp;vp.METRICS_STRING="|ÉqÅ",vp.BASELINE_SYMBOL="M",vp.BASELINE_MULTIPLIER=1.4,vp.HEIGHT_MULTIPLIER=2,vp.graphemeSegmenter=(()=>{if("function"==typeof(null==Intl?void 0:Intl.Segmenter)){const t=new Intl.Segmenter;return e=>[...t.segment(e)].map((t=>t.segment))}return t=>[...t]})(),vp.experimentalLetterSpacing=!1,vp._fonts={},vp._newlines=[10,13],vp._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];const xp=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],yp=class{constructor(t){this.styleID=0,this.reset(),wp(this,t,t)}clone(){const t={};return wp(t,this,yp.defaultStyle),new yp(t)}reset(){wp(this,yp.defaultStyle,yp.defaultStyle)}get align(){return this._align}set align(t){this._align!==t&&(this._align=t,this.styleID++)}get breakWords(){return this._breakWords}set breakWords(t){this._breakWords!==t&&(this._breakWords=t,this.styleID++)}get dropShadow(){return this._dropShadow}set dropShadow(t){this._dropShadow!==t&&(this._dropShadow=t,this.styleID++)}get dropShadowAlpha(){return this._dropShadowAlpha}set dropShadowAlpha(t){this._dropShadowAlpha!==t&&(this._dropShadowAlpha=t,this.styleID++)}get dropShadowAngle(){return this._dropShadowAngle}set dropShadowAngle(t){this._dropShadowAngle!==t&&(this._dropShadowAngle=t,this.styleID++)}get dropShadowBlur(){return this._dropShadowBlur}set dropShadowBlur(t){this._dropShadowBlur!==t&&(this._dropShadowBlur=t,this.styleID++)}get dropShadowColor(){return this._dropShadowColor}set dropShadowColor(t){const e=bp(t);this._dropShadowColor!==e&&(this._dropShadowColor=e,this.styleID++)}get dropShadowDistance(){return this._dropShadowDistance}set dropShadowDistance(t){this._dropShadowDistance!==t&&(this._dropShadowDistance=t,this.styleID++)}get fill(){return this._fill}set fill(t){const e=bp(t);this._fill!==e&&(this._fill=e,this.styleID++)}get fillGradientType(){return this._fillGradientType}set fillGradientType(t){this._fillGradientType!==t&&(this._fillGradientType=t,this.styleID++)}get fillGradientStops(){return this._fillGradientStops}set fillGradientStops(t){(function(t,e){if(!Array.isArray(t)||!Array.isArray(e))return!1;if(t.length!==e.length)return!1;for(let n=0;n<t.length;++n)if(t[n]!==e[n])return!1;return!0})(this._fillGradientStops,t)||(this._fillGradientStops=t,this.styleID++)}get fontFamily(){return this._fontFamily}set fontFamily(t){this.fontFamily!==t&&(this._fontFamily=t,this.styleID++)}get fontSize(){return this._fontSize}set fontSize(t){this._fontSize!==t&&(this._fontSize=t,this.styleID++)}get fontStyle(){return this._fontStyle}set fontStyle(t){this._fontStyle!==t&&(this._fontStyle=t,this.styleID++)}get fontVariant(){return this._fontVariant}set fontVariant(t){this._fontVariant!==t&&(this._fontVariant=t,this.styleID++)}get fontWeight(){return this._fontWeight}set fontWeight(t){this._fontWeight!==t&&(this._fontWeight=t,this.styleID++)}get letterSpacing(){return this._letterSpacing}set letterSpacing(t){this._letterSpacing!==t&&(this._letterSpacing=t,this.styleID++)}get lineHeight(){return this._lineHeight}set lineHeight(t){this._lineHeight!==t&&(this._lineHeight=t,this.styleID++)}get leading(){return this._leading}set leading(t){this._leading!==t&&(this._leading=t,this.styleID++)}get lineJoin(){return this._lineJoin}set lineJoin(t){this._lineJoin!==t&&(this._lineJoin=t,this.styleID++)}get miterLimit(){return this._miterLimit}set miterLimit(t){this._miterLimit!==t&&(this._miterLimit=t,this.styleID++)}get padding(){return this._padding}set padding(t){this._padding!==t&&(this._padding=t,this.styleID++)}get stroke(){return this._stroke}set stroke(t){const e=bp(t);this._stroke!==e&&(this._stroke=e,this.styleID++)}get strokeThickness(){return this._strokeThickness}set strokeThickness(t){this._strokeThickness!==t&&(this._strokeThickness=t,this.styleID++)}get textBaseline(){return this._textBaseline}set textBaseline(t){this._textBaseline!==t&&(this._textBaseline=t,this.styleID++)}get trim(){return this._trim}set trim(t){this._trim!==t&&(this._trim=t,this.styleID++)}get whiteSpace(){return this._whiteSpace}set whiteSpace(t){this._whiteSpace!==t&&(this._whiteSpace=t,this.styleID++)}get wordWrap(){return this._wordWrap}set wordWrap(t){this._wordWrap!==t&&(this._wordWrap=t,this.styleID++)}get wordWrapWidth(){return this._wordWrapWidth}set wordWrapWidth(t){this._wordWrapWidth!==t&&(this._wordWrapWidth=t,this.styleID++)}toFontString(){const t="number"==typeof this.fontSize?`${this.fontSize}px`:this.fontSize;let e=this.fontFamily;Array.isArray(this.fontFamily)||(e=this.fontFamily.split(","));for(let n=e.length-1;n>=0;n--){let t=e[n].trim();/([\"\'])[^\'\"]+\1/.test(t)||xp.includes(t)||(t=`"${t}"`),e[n]=t}return`${this.fontStyle} ${this.fontVariant} ${this.fontWeight} ${t} ${e.join(",")}`}};let _p=yp;function bp(t){const e=qo.shared;return Array.isArray(t)?t.map((t=>e.setValue(t).toHex())):e.setValue(t).toHex()}function wp(t,e,n){for(const s in n)Array.isArray(e[s])?t[s]=e[s].slice():t[s]=e[s]}_p.defaultStyle={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fillGradientType:pp.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",leading:0,letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100};const Ep={texture:!0,children:!1,baseTexture:!0},Tp=class extends Pu{constructor(t,e,n){var s;let i=!1;n||(n=zr.ADAPTER.createCanvas(),i=!0),n.width=3,n.height=3;const r=ic.from(n);r.orig=new Zl,r.trim=new Zl,super(r),this._ownCanvas=i,this.canvas=n,this.context=n.getContext("2d",{willReadFrequently:!0}),this._resolution=null!=(s=Tp.defaultResolution)?s:zr.RESOLUTION,this._autoResolution=Tp.defaultAutoResolution,this._text=null,this._style=null,this._styleListener=null,this._font="",this.text=t,this.style=e,this.localStyleID=-1}static get experimentalLetterSpacing(){return vp.experimentalLetterSpacing}static set experimentalLetterSpacing(t){vo("7.1.0","Text.experimentalLetterSpacing is deprecated, use TextMetrics.experimentalLetterSpacing"),vp.experimentalLetterSpacing=t}updateText(t){const e=this._style;if(this.localStyleID!==e.styleID&&(this.dirty=!0,this.localStyleID=e.styleID),!this.dirty&&t)return;this._font=this._style.toFontString();const n=this.context,s=vp.measureText(this._text||" ",this._style,this._style.wordWrap,this.canvas),i=s.width,r=s.height,a=s.lines,o=s.lineHeight,l=s.lineWidths,h=s.maxLineWidth,c=s.fontProperties;let u,d;this.canvas.width=Math.ceil(Math.ceil(Math.max(1,i)+2*e.padding)*this._resolution),this.canvas.height=Math.ceil(Math.ceil(Math.max(1,r)+2*e.padding)*this._resolution),n.scale(this._resolution,this._resolution),n.clearRect(0,0,this.canvas.width,this.canvas.height),n.font=this._font,n.lineWidth=e.strokeThickness,n.textBaseline=e.textBaseline,n.lineJoin=e.lineJoin,n.miterLimit=e.miterLimit;const f=e.dropShadow?2:1;for(let p=0;p<f;++p){const t=e.dropShadow&&0===p,i=t?Math.ceil(Math.max(1,r)+2*e.padding):0,f=i*this._resolution;if(t){n.fillStyle="black",n.strokeStyle="black";const t=e.dropShadowColor,s=e.dropShadowBlur*this._resolution,i=e.dropShadowDistance*this._resolution;n.shadowColor=qo.shared.setValue(t).setAlpha(e.dropShadowAlpha).toRgbaString(),n.shadowBlur=s,n.shadowOffsetX=Math.cos(e.dropShadowAngle)*i,n.shadowOffsetY=Math.sin(e.dropShadowAngle)*i+f}else n.fillStyle=this._generateFillStyle(e,a,s),n.strokeStyle=e.stroke,n.shadowColor="black",n.shadowBlur=0,n.shadowOffsetX=0,n.shadowOffsetY=0;let m=(o-c.fontSize)/2;o-c.fontSize<0&&(m=0);for(let n=0;n<a.length;n++)u=e.strokeThickness/2,d=e.strokeThickness/2+n*o+c.ascent+m,"right"===e.align?u+=h-l[n]:"center"===e.align&&(u+=(h-l[n])/2),e.stroke&&e.strokeThickness&&this.drawLetterSpacing(a[n],u+e.padding,d+e.padding-i,!0),e.fill&&this.drawLetterSpacing(a[n],u+e.padding,d+e.padding-i)}this.updateTexture()}drawLetterSpacing(t,e,n,s=!1){const i=this._style.letterSpacing;let r=!1;if(vp.experimentalLetterSpacingSupported&&(vp.experimentalLetterSpacing?(this.context.letterSpacing=`${i}px`,this.context.textLetterSpacing=`${i}px`,r=!0):(this.context.letterSpacing="0px",this.context.textLetterSpacing="0px")),0===i||r)return void(s?this.context.strokeText(t,e,n):this.context.fillText(t,e,n));let a=e;const o=vp.graphemeSegmenter(t);let l=this.context.measureText(t).width,h=0;for(let c=0;c<o.length;++c){const t=o[c];s?this.context.strokeText(t,a,n):this.context.fillText(t,a,n);let e="";for(let n=c+1;n<o.length;++n)e+=o[n];h=this.context.measureText(e).width,a+=l-h+i,l=h}}updateTexture(){const t=this.canvas;if(this._style.trim){const e=gl(t);e.data&&(t.width=e.width,t.height=e.height,this.context.putImageData(e.data,0,0))}const e=this._texture,n=this._style,s=n.trim?0:n.padding,i=e.baseTexture;e.trim.width=e._frame.width=t.width/this._resolution,e.trim.height=e._frame.height=t.height/this._resolution,e.trim.x=-s,e.trim.y=-s,e.orig.width=e._frame.width-2*s,e.orig.height=e._frame.height-2*s,this._onTextureUpdate(),i.setRealSize(t.width,t.height,this._resolution),e.updateUvs(),this.dirty=!1}_render(t){this._autoResolution&&this._resolution!==t.resolution&&(this._resolution=t.resolution,this.dirty=!0),this.updateText(!0),super._render(t)}updateTransform(){this.updateText(!0),super.updateTransform()}getBounds(t,e){return this.updateText(!0),-1===this._textureID&&(t=!1),super.getBounds(t,e)}getLocalBounds(t){return this.updateText(!0),super.getLocalBounds.call(this,t)}_calculateBounds(){this.calculateVertices(),this._bounds.addQuad(this.vertexData)}_generateFillStyle(t,e,n){const s=t.fill;if(!Array.isArray(s))return s;if(1===s.length)return s[0];let i;const r=t.dropShadow?t.dropShadowDistance:0,a=t.padding||0,o=this.canvas.width/this._resolution-r-2*a,l=this.canvas.height/this._resolution-r-2*a,h=s.slice(),c=t.fillGradientStops.slice();if(!c.length){const t=h.length+1;for(let e=1;e<t;++e)c.push(e/t)}if(h.unshift(s[0]),c.unshift(0),h.push(s[s.length-1]),c.push(1),t.fillGradientType===pp.LINEAR_VERTICAL){i=this.context.createLinearGradient(o/2,a,o/2,l+a);const s=n.fontProperties.fontSize+t.strokeThickness;for(let t=0;t<e.length;t++){const r=n.lineHeight*(t-1)+s,a=n.lineHeight*t;let o=a;t>0&&r>a&&(o=(a+r)/2);const u=a+s,d=n.lineHeight*(t+1);let f=u;t+1<e.length&&d<u&&(f=(u+d)/2);const p=(f-o)/l;for(let t=0;t<h.length;t++){let e=0;e="number"==typeof c[t]?c[t]:t/h.length;let n=Math.min(1,Math.max(0,o/l+e*p));n=Number(n.toFixed(5)),i.addColorStop(n,h[t])}}}else{i=this.context.createLinearGradient(a,l/2,o+a,l/2);const t=h.length+1;let e=1;for(let n=0;n<h.length;n++){let s;s="number"==typeof c[n]?c[n]:e/t,i.addColorStop(s,h[n]),e++}}return i}destroy(t){"boolean"==typeof t&&(t={children:t}),t=Object.assign({},Ep,t),super.destroy(t),this._ownCanvas&&(this.canvas.height=this.canvas.width=0),this.context=null,this.canvas=null,this._style=null}get width(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width}set width(t){this.updateText(!0);const e=rl(this.scale.x)||1;this.scale.x=e*t/this._texture.orig.width,this._width=t}get height(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height}set height(t){this.updateText(!0);const e=rl(this.scale.y)||1;this.scale.y=e*t/this._texture.orig.height,this._height=t}get style(){return this._style}set style(t){t=t||{},this._style=t instanceof _p?t:new _p(t),this.localStyleID=-1,this.dirty=!0}get text(){return this._text}set text(t){t=String(null==t?"":t),this._text!==t&&(this._text=t,this.dirty=!0)}get resolution(){return this._resolution}set resolution(t){this._autoResolution=!1,this._resolution!==t&&(this._resolution=t,this.dirty=!0)}};let Sp=Tp;Sp.defaultAutoResolution=!0;class Ap{constructor(t){this.maxItemsPerFrame=t,this.itemsLeft=0}beginFrame(){this.itemsLeft=this.maxItemsPerFrame}allowedToUpload(){return this.itemsLeft-- >0}}function Cp(t,e){var n;let s=!1;if(null==(n=null==t?void 0:t._textures)?void 0:n.length)for(let i=0;i<t._textures.length;i++)if(t._textures[i]instanceof ic){const n=t._textures[i].baseTexture;e.includes(n)||(e.push(n),s=!0)}return s}function Ip(t,e){if(t.baseTexture instanceof Ol){const n=t.baseTexture;return e.includes(n)||e.push(n),!0}return!1}function Mp(t,e){if(t._texture&&t._texture instanceof ic){const n=t._texture.baseTexture;return e.includes(n)||e.push(n),!0}return!1}function Rp(t,e){return e instanceof Sp&&(e.updateText(!0),!0)}function Pp(t,e){if(e instanceof _p){const t=e.toFontString();return vp.measureFont(t),!0}return!1}function kp(t,e){if(t instanceof Sp){e.includes(t.style)||e.push(t.style),e.includes(t)||e.push(t);const n=t._texture.baseTexture;return e.includes(n)||e.push(n),!0}return!1}function Fp(t,e){return t instanceof _p&&(e.includes(t)||e.push(t),!0)}const Op=class{constructor(t){this.limiter=new Ap(Op.uploadsPerFrame),this.renderer=t,this.uploadHookHelper=null,this.queue=[],this.addHooks=[],this.uploadHooks=[],this.completes=[],this.ticking=!1,this.delayedTick=()=>{this.queue&&this.prepareItems()},this.registerFindHook(kp),this.registerFindHook(Fp),this.registerFindHook(Cp),this.registerFindHook(Ip),this.registerFindHook(Mp),this.registerUploadHook(Rp),this.registerUploadHook(Pp)}upload(t){return new Promise((e=>{t&&this.add(t),this.queue.length?(this.completes.push(e),this.ticking||(this.ticking=!0,iu.system.addOnce(this.tick,this,eu.UTILITY))):e()}))}tick(){setTimeout(this.delayedTick,0)}prepareItems(){for(this.limiter.beginFrame();this.queue.length&&this.limiter.allowedToUpload();){const t=this.queue[0];let e=!1;if(t&&!t._destroyed)for(let n=0,s=this.uploadHooks.length;n<s;n++)if(this.uploadHooks[n](this.uploadHookHelper,t)){this.queue.shift(),e=!0;break}e||this.queue.shift()}if(this.queue.length)iu.system.addOnce(this.tick,this,eu.UTILITY);else{this.ticking=!1;const t=this.completes.slice(0);this.completes.length=0;for(let e=0,n=t.length;e<n;e++)t[e]()}}registerFindHook(t){return t&&this.addHooks.push(t),this}registerUploadHook(t){return t&&this.uploadHooks.push(t),this}add(t){for(let e=0,n=this.addHooks.length;e<n&&!this.addHooks[e](t,this.queue);e++);if(t instanceof Iu)for(let e=t.children.length-1;e>=0;e--)this.add(t.children[e]);return this}destroy(){this.ticking&&iu.system.remove(this.tick,this),this.ticking=!1,this.addHooks=null,this.uploadHooks=null,this.renderer=null,this.completes=null,this.queue=null,this.limiter=null,this.uploadHookHelper=null}};let Dp=Op;function Lp(t,e){return e instanceof Ol&&(e._glTextures[t.CONTEXT_UID]||t.texture.bind(e),!0)}function Np(t,e){if(!(e instanceof np))return!1;const{geometry:n}=e;e.finishPoly(),n.updateBatches();const{batches:s}=n;for(let i=0;i<s.length;i++){const{texture:e}=s[i].style;e&&Lp(t,e.baseTexture)}return n.batchable||t.geometry.bind(n,e._resolveDirectShader(t)),!0}function Bp(t,e){return t instanceof np&&(e.push(t),!0)}Dp.uploadsPerFrame=4,Object.defineProperties(zr,{UPLOADS_PER_FRAME:{get:()=>Dp.uploadsPerFrame,set(t){vo("7.1.0","settings.UPLOADS_PER_FRAME is deprecated, use prepare.BasePrepare.uploadsPerFrame"),Dp.uploadsPerFrame=t}}});class Vp extends Dp{constructor(t){super(t),this.uploadHookHelper=this.renderer,this.registerFindHook(Bp),this.registerUploadHook(Lp),this.registerUploadHook(Np)}}Vp.extension={name:"prepare",type:yl.RendererSystem},wl.add(Vp);class Up extends Pu{constructor(t,e=!0){super(t[0]instanceof ic?t[0]:t[0].texture),this._textures=null,this._durations=null,this._autoUpdate=e,this._isConnectedToTicker=!1,this.animationSpeed=1,this.loop=!0,this.updateAnchor=!1,this.onComplete=null,this.onFrameChange=null,this.onLoop=null,this._currentTime=0,this._playing=!1,this._previousFrame=null,this.textures=t}stop(){this._playing&&(this._playing=!1,this._autoUpdate&&this._isConnectedToTicker&&(iu.shared.remove(this.update,this),this._isConnectedToTicker=!1))}play(){this._playing||(this._playing=!0,this._autoUpdate&&!this._isConnectedToTicker&&(iu.shared.add(this.update,this,eu.HIGH),this._isConnectedToTicker=!0))}gotoAndStop(t){this.stop(),this.currentFrame=t}gotoAndPlay(t){this.currentFrame=t,this.play()}update(t){if(!this._playing)return;const e=this.animationSpeed*t,n=this.currentFrame;if(null!==this._durations){let n=this._currentTime%1*this._durations[this.currentFrame];for(n+=e/60*1e3;n<0;)this._currentTime--,n+=this._durations[this.currentFrame];const s=Math.sign(this.animationSpeed*t);for(this._currentTime=Math.floor(this._currentTime);n>=this._durations[this.currentFrame];)n-=this._durations[this.currentFrame]*s,this._currentTime+=s;this._currentTime+=n/this._durations[this.currentFrame]}else this._currentTime+=e;this._currentTime<0&&!this.loop?(this.gotoAndStop(0),this.onComplete&&this.onComplete()):this._currentTime>=this._textures.length&&!this.loop?(this.gotoAndStop(this._textures.length-1),this.onComplete&&this.onComplete()):n!==this.currentFrame&&(this.loop&&this.onLoop&&(this.animationSpeed>0&&this.currentFrame<n||this.animationSpeed<0&&this.currentFrame>n)&&this.onLoop(),this.updateTexture())}updateTexture(){const t=this.currentFrame;this._previousFrame!==t&&(this._previousFrame=t,this._texture=this._textures[t],this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this.uvs=this._texture._uvs.uvsFloat32,this.updateAnchor&&this._anchor.copyFrom(this._texture.defaultAnchor),this.onFrameChange&&this.onFrameChange(this.currentFrame))}destroy(t){this.stop(),super.destroy(t),this.onComplete=null,this.onFrameChange=null,this.onLoop=null}static fromFrames(t){const e=[];for(let n=0;n<t.length;++n)e.push(ic.from(t[n]));return new Up(e)}static fromImages(t){const e=[];for(let n=0;n<t.length;++n)e.push(ic.from(t[n]));return new Up(e)}get totalFrames(){return this._textures.length}get textures(){return this._textures}set textures(t){if(t[0]instanceof ic)this._textures=t,this._durations=null;else{this._textures=[],this._durations=[];for(let e=0;e<t.length;e++)this._textures.push(t[e].texture),this._durations.push(t[e].time)}this._previousFrame=null,this.gotoAndStop(0),this.updateTexture()}get currentFrame(){let t=Math.floor(this._currentTime)%this._textures.length;return t<0&&(t+=this._textures.length),t}set currentFrame(t){if(t<0||t>this.totalFrames-1)throw new Error(`[AnimatedSprite]: Invalid frame index value ${t}, expected to be between 0 and totalFrames ${this.totalFrames}.`);const e=this.currentFrame;this._currentTime=t,e!==this.currentFrame&&this.updateTexture()}get playing(){return this._playing}get autoUpdate(){return this._autoUpdate}set autoUpdate(t){t!==this._autoUpdate&&(this._autoUpdate=t,!this._autoUpdate&&this._isConnectedToTicker?(iu.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._playing&&(iu.shared.add(this.update,this),this._isConnectedToTicker=!0))}}var Xp="#version 100\n#define SHADER_NAME Tiling-Sprite-100\n\nprecision lowp float;\n\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTransform;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;\n}\n";const Yp=new nh;class Wp extends Xh{constructor(t){super(t),t.runners.contextChange.add(this),this.quad=new lc,this.state=Al.for2d()}contextChange(){const t=this.renderer,e={globals:t.globalUniforms};this.simpleShader=Bh.from(Xp,"#version 100\n#define SHADER_NAME Tiling-Sprite-Simple-100\n\nprecision lowp float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\n\nvoid main(void)\n{\n    vec4 texSample = texture2D(uSampler, vTextureCoord);\n    gl_FragColor = texSample * uColor;\n}\n",e),this.shader=t.context.webGLVersion>1?Bh.from("#version 300 es\n#define SHADER_NAME Tiling-Sprite-300\n\nprecision lowp float;\n\nin vec2 aVertexPosition;\nin vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTransform;\n\nout vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;\n}\n","#version 300 es\n#define SHADER_NAME Tiling-Sprite-100\n\nprecision lowp float;\n\nin vec2 vTextureCoord;\n\nout vec4 fragmentColor;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\nuniform mat3 uMapCoord;\nuniform vec4 uClampFrame;\nuniform vec2 uClampOffset;\n\nvoid main(void)\n{\n    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);\n    coord = (uMapCoord * vec3(coord, 1.0)).xy;\n    vec2 unclamped = coord;\n    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);\n\n    vec4 texSample = texture(uSampler, coord, unclamped == coord ? 0.0f : -32.0f);// lod-bias very negative to force lod 0\n\n    fragmentColor = texSample * uColor;\n}\n",e):Bh.from(Xp,"#version 100\n#ifdef GL_EXT_shader_texture_lod\n    #extension GL_EXT_shader_texture_lod : enable\n#endif\n#define SHADER_NAME Tiling-Sprite-100\n\nprecision lowp float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\nuniform mat3 uMapCoord;\nuniform vec4 uClampFrame;\nuniform vec2 uClampOffset;\n\nvoid main(void)\n{\n    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);\n    coord = (uMapCoord * vec3(coord, 1.0)).xy;\n    vec2 unclamped = coord;\n    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);\n\n    #ifdef GL_EXT_shader_texture_lod\n        vec4 texSample = unclamped == coord\n            ? texture2D(uSampler, coord) \n            : texture2DLodEXT(uSampler, coord, 0);\n    #else\n        vec4 texSample = texture2D(uSampler, coord);\n    #endif\n\n    gl_FragColor = texSample * uColor;\n}\n",e)}render(t){const e=this.renderer,n=this.quad;let s=n.vertices;s[0]=s[6]=t._width*-t.anchor.x,s[1]=s[3]=t._height*-t.anchor.y,s[2]=s[4]=t._width*(1-t.anchor.x),s[5]=s[7]=t._height*(1-t.anchor.y);const i=t.uvRespectAnchor?t.anchor.x:0,r=t.uvRespectAnchor?t.anchor.y:0;s=n.uvs,s[0]=s[6]=-i,s[1]=s[3]=-r,s[2]=s[4]=1-i,s[5]=s[7]=1-r,n.invalidate();const a=t._texture,o=a.baseTexture,l=o.alphaMode>0,h=t.tileTransform.localTransform,c=t.uvMatrix;let u=o.isPowerOfTwo&&a.frame.width===o.width&&a.frame.height===o.height;u&&(o._glTextures[e.CONTEXT_UID]?u=o.wrapMode!==Dr.CLAMP:o.wrapMode===Dr.CLAMP&&(o.wrapMode=Dr.REPEAT));const d=u?this.simpleShader:this.shader,f=a.width,p=a.height,m=t._width,g=t._height;Yp.set(h.a*f/m,h.b*f/g,h.c*p/m,h.d*p/g,h.tx/m,h.ty/g),Yp.invert(),u?Yp.prepend(c.mapCoord):(d.uniforms.uMapCoord=c.mapCoord.toArray(!0),d.uniforms.uClampFrame=c.uClampFrame,d.uniforms.uClampOffset=c.uClampOffset),d.uniforms.uTransform=Yp.toArray(!0),d.uniforms.uColor=qo.shared.setValue(t.tint).premultiply(t.worldAlpha,l).toArray(d.uniforms.uColor),d.uniforms.translationMatrix=t.transform.worldTransform.toArray(!0),d.uniforms.uSampler=a,e.shader.bind(d),e.geometry.bind(n),this.state.blendMode=Jo(t.blendMode,l),e.state.set(this.state),e.geometry.draw(this.renderer.gl.TRIANGLES,6,0)}}Wp.extension={name:"tilingSprite",type:yl.RendererPlugin},wl.add(Wp);const zp=class{constructor(t,e,n=null){this.linkedSheets=[],this._texture=t instanceof ic?t:null,this.baseTexture=t instanceof Ol?t:this._texture.baseTexture,this.textures={},this.animations={},this.data=e;const s=this.baseTexture.resource;this.resolution=this._updateResolution(n||(s?s.url:null)),this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}_updateResolution(t=null){const{scale:e}=this.data.meta;let n=xl(t,null);return null===n&&(n=parseFloat(null!=e?e:"1")),1!==n&&this.baseTexture.setResolution(n),n}parse(){return new Promise((t=>{this._callback=t,this._batchIndex=0,this._frameKeys.length<=zp.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()}))}_processFrames(t){let e=t;const n=zp.BATCH_SIZE;for(;e-t<n&&e<this._frameKeys.length;){const t=this._frameKeys[e],n=this._frames[t],s=n.frame;if(s){let e=null,i=null;const r=!1!==n.trimmed&&n.sourceSize?n.sourceSize:n.frame,a=new Zl(0,0,Math.floor(r.w)/this.resolution,Math.floor(r.h)/this.resolution);e=n.rotated?new Zl(Math.floor(s.x)/this.resolution,Math.floor(s.y)/this.resolution,Math.floor(s.h)/this.resolution,Math.floor(s.w)/this.resolution):new Zl(Math.floor(s.x)/this.resolution,Math.floor(s.y)/this.resolution,Math.floor(s.w)/this.resolution,Math.floor(s.h)/this.resolution),!1!==n.trimmed&&n.spriteSourceSize&&(i=new Zl(Math.floor(n.spriteSourceSize.x)/this.resolution,Math.floor(n.spriteSourceSize.y)/this.resolution,Math.floor(s.w)/this.resolution,Math.floor(s.h)/this.resolution)),this.textures[t]=new ic(this.baseTexture,e,a,i,n.rotated?2:0,n.anchor,n.borders),ic.addToCache(this.textures[t],t)}e++}}_processAnimations(){const t=this.data.animations||{};for(const e in t){this.animations[e]=[];for(let n=0;n<t[e].length;n++){const s=t[e][n];this.animations[e].push(this.textures[s])}}}_parseComplete(){const t=this._callback;this._callback=null,this._batchIndex=0,t.call(this,this.textures)}_nextBatch(){this._processFrames(this._batchIndex*zp.BATCH_SIZE),this._batchIndex++,setTimeout((()=>{this._batchIndex*zp.BATCH_SIZE<this._frameKeys.length?this._nextBatch():(this._processAnimations(),this._parseComplete())}),0)}destroy(t=!1){var e;for(const n in this.textures)this.textures[n].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,t&&(null==(e=this._texture)||e.destroy(),this.baseTexture.destroy()),this._texture=null,this.baseTexture=null,this.linkedSheets=[]}};let Gp=zp;Gp.BATCH_SIZE=1e3;const Hp=["jpg","png","jpeg","avif","webp"];function jp(t,e,n){const s={};if(t.forEach((t=>{s[t]=e})),Object.keys(e.textures).forEach((t=>{s[t]=e.textures[t]})),!n){const n=mo.dirname(t[0]);e.linkedSheets.forEach(((t,i)=>{const r=jp([`${n}/${e.data.meta.related_multi_packs[i]}`],t,!0);Object.assign(s,r)}))}return s}const $p={extension:yl.Asset,cache:{test:t=>t instanceof Gp,getCacheableAssets:(t,e)=>jp(t,e,!1)},resolver:{test:t=>{const e=t.split("?")[0].split("."),n=e.pop(),s=e.pop();return"json"===n&&Hp.includes(s)},parse:t=>{var e,n;const s=t.split(".");return{resolution:parseFloat(null!=(n=null==(e=zr.RETINA_PREFIX.exec(t))?void 0:e[1])?n:"1"),format:s[s.length-2],src:t}}},loader:{name:"spritesheetLoader",extension:{type:yl.LoadParser,priority:pd.Normal},testParse(t,e){return m(this,null,(function*(){return".json"===mo.extname(e.src).toLowerCase()&&!!t.frames}))},parse(t,e,n){return m(this,null,(function*(){var s,i;let r=mo.dirname(e.src);r&&r.lastIndexOf("/")!==r.length-1&&(r+="/");let a=r+t.meta.image;a=ld(a,e.src);const o=(yield n.load([a]))[a],l=new Gp(o.baseTexture,t,e.src);yield l.parse();const h=null==(s=null==t?void 0:t.meta)?void 0:s.related_multi_packs;if(Array.isArray(h)){const t=[];for(const a of h){if("string"!=typeof a)continue;let s=r+a;(null==(i=e.data)?void 0:i.ignoreMultiPack)||(s=ld(s,e.src),t.push(n.load({src:s,data:{ignoreMultiPack:!0}})))}const s=yield Promise.all(t);l.linkedSheets=s,s.forEach((t=>{t.linkedSheets=[l].concat(l.linkedSheets.filter((e=>e!==t)))}))}return l}))},unload(t){t.destroy(!0)}}};wl.add($p);class qp{constructor(){this.info=[],this.common=[],this.page=[],this.char=[],this.kerning=[],this.distanceField=[]}}class Kp{static test(t){return"string"==typeof t&&t.startsWith("info face=")}static parse(t){const e=t.match(/^[a-z]+\s+.+$/gm),n={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(const i in e){const t=e[i].match(/^[a-z]+/gm)[0],s=e[i].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),r={};for(const e in s){const t=s[e].split("="),n=t[0],i=t[1].replace(/"/gm,""),a=parseFloat(i),o=isNaN(a)?i:a;r[n]=o}n[t].push(r)}const s=new qp;return n.info.forEach((t=>s.info.push({face:t.face,size:parseInt(t.size,10)}))),n.common.forEach((t=>s.common.push({lineHeight:parseInt(t.lineHeight,10)}))),n.page.forEach((t=>s.page.push({id:parseInt(t.id,10),file:t.file}))),n.char.forEach((t=>s.char.push({id:parseInt(t.id,10),page:parseInt(t.page,10),x:parseInt(t.x,10),y:parseInt(t.y,10),width:parseInt(t.width,10),height:parseInt(t.height,10),xoffset:parseInt(t.xoffset,10),yoffset:parseInt(t.yoffset,10),xadvance:parseInt(t.xadvance,10)}))),n.kerning.forEach((t=>s.kerning.push({first:parseInt(t.first,10),second:parseInt(t.second,10),amount:parseInt(t.amount,10)}))),n.distanceField.forEach((t=>s.distanceField.push({distanceRange:parseInt(t.distanceRange,10),fieldType:t.fieldType}))),s}}class Zp{static test(t){const e=t;return"getElementsByTagName"in e&&e.getElementsByTagName("page").length&&null!==e.getElementsByTagName("info")[0].getAttribute("face")}static parse(t){const e=new qp,n=t.getElementsByTagName("info"),s=t.getElementsByTagName("common"),i=t.getElementsByTagName("page"),r=t.getElementsByTagName("char"),a=t.getElementsByTagName("kerning"),o=t.getElementsByTagName("distanceField");for(let l=0;l<n.length;l++)e.info.push({face:n[l].getAttribute("face"),size:parseInt(n[l].getAttribute("size"),10)});for(let l=0;l<s.length;l++)e.common.push({lineHeight:parseInt(s[l].getAttribute("lineHeight"),10)});for(let l=0;l<i.length;l++)e.page.push({id:parseInt(i[l].getAttribute("id"),10)||0,file:i[l].getAttribute("file")});for(let l=0;l<r.length;l++){const t=r[l];e.char.push({id:parseInt(t.getAttribute("id"),10),page:parseInt(t.getAttribute("page"),10)||0,x:parseInt(t.getAttribute("x"),10),y:parseInt(t.getAttribute("y"),10),width:parseInt(t.getAttribute("width"),10),height:parseInt(t.getAttribute("height"),10),xoffset:parseInt(t.getAttribute("xoffset"),10),yoffset:parseInt(t.getAttribute("yoffset"),10),xadvance:parseInt(t.getAttribute("xadvance"),10)})}for(let l=0;l<a.length;l++)e.kerning.push({first:parseInt(a[l].getAttribute("first"),10),second:parseInt(a[l].getAttribute("second"),10),amount:parseInt(a[l].getAttribute("amount"),10)});for(let l=0;l<o.length;l++)e.distanceField.push({fieldType:o[l].getAttribute("fieldType"),distanceRange:parseInt(o[l].getAttribute("distanceRange"),10)});return e}}class Qp{static test(t){return!("string"!=typeof t||!t.includes("<font>"))&&Zp.test(zr.ADAPTER.parseXML(t))}static parse(t){return Zp.parse(zr.ADAPTER.parseXML(t))}}const Jp=[Kp,Zp,Qp];function tm(t,e,n,s,i,r,a){const o=n.text,l=n.fontProperties;e.translate(s,i),e.scale(r,r);const h=a.strokeThickness/2,c=-a.strokeThickness/2;if(e.font=a.toFontString(),e.lineWidth=a.strokeThickness,e.textBaseline=a.textBaseline,e.lineJoin=a.lineJoin,e.miterLimit=a.miterLimit,e.fillStyle=function(t,e,n,s,i,r){const a=n.fill;if(!Array.isArray(a))return a;if(1===a.length)return a[0];let o;const l=n.dropShadow?n.dropShadowDistance:0,h=n.padding||0,c=t.width/s-l-2*h,u=t.height/s-l-2*h,d=a.slice(),f=n.fillGradientStops.slice();if(!f.length){const t=d.length+1;for(let e=1;e<t;++e)f.push(e/t)}if(d.unshift(a[0]),f.unshift(0),d.push(a[a.length-1]),f.push(1),n.fillGradientType===pp.LINEAR_VERTICAL){o=e.createLinearGradient(c/2,h,c/2,u+h);let t=0;const s=(r.fontProperties.fontSize+n.strokeThickness)/u;for(let e=0;e<i.length;e++){const n=r.lineHeight*e;for(let e=0;e<d.length;e++){let i=0;i="number"==typeof f[e]?f[e]:e/d.length;const r=n/u+i*s;let a=Math.max(t,r);a=Math.min(a,1),o.addColorStop(a,d[e]),t=a}}}else{o=e.createLinearGradient(h,u/2,c+h,u/2);const t=d.length+1;let n=1;for(let e=0;e<d.length;e++){let s;s="number"==typeof f[e]?f[e]:n/t,o.addColorStop(s,d[e]),n++}}return o}(t,e,a,r,[o],n),e.strokeStyle=a.stroke,a.dropShadow){const t=a.dropShadowColor,n=a.dropShadowBlur*r,s=a.dropShadowDistance*r;e.shadowColor=qo.shared.setValue(t).setAlpha(a.dropShadowAlpha).toRgbaString(),e.shadowBlur=n,e.shadowOffsetX=Math.cos(a.dropShadowAngle)*s,e.shadowOffsetY=Math.sin(a.dropShadowAngle)*s}else e.shadowColor="black",e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0;a.stroke&&a.strokeThickness&&e.strokeText(o,h,c+n.lineHeight-l.descent),a.fill&&e.fillText(o,h,c+n.lineHeight-l.descent),e.setTransform(1,0,0,1,0,0),e.fillStyle="rgba(0, 0, 0, 0)"}function em(t){return t.codePointAt?t.codePointAt(0):t.charCodeAt(0)}function nm(t){return Array.from?Array.from(t):t.split("")}const sm=class{constructor(t,e,n){var s,i;const[r]=t.info,[a]=t.common,[o]=t.page,[l]=t.distanceField,h=xl(o.file),c={};this._ownsTextures=n,this.font=r.face,this.size=r.size,this.lineHeight=a.lineHeight/h,this.chars={},this.pageTextures=c;for(let u=0;u<t.page.length;u++){const{id:n,file:s}=t.page[u];c[n]=e instanceof Array?e[u]:e[s],(null==l?void 0:l.fieldType)&&"none"!==l.fieldType&&(c[n].baseTexture.alphaMode=Nr.NO_PREMULTIPLIED_ALPHA,c[n].baseTexture.mipmap=Lr.OFF)}for(let u=0;u<t.char.length;u++){const{id:e,page:n}=t.char[u];let{x:s,y:i,width:r,height:a,xoffset:o,yoffset:l,xadvance:d}=t.char[u];s/=h,i/=h,r/=h,a/=h,o/=h,l/=h,d/=h;const f=new Zl(s+c[n].frame.x/h,i+c[n].frame.y/h,r,a);this.chars[e]={xOffset:o,yOffset:l,xAdvance:d,kerning:{},texture:new ic(c[n].baseTexture,f),page:n}}for(let u=0;u<t.kerning.length;u++){let{first:e,second:n,amount:s}=t.kerning[u];e/=h,n/=h,s/=h,this.chars[n]&&(this.chars[n].kerning[e]=s)}this.distanceFieldRange=null==l?void 0:l.distanceRange,this.distanceFieldType=null!=(i=null==(s=null==l?void 0:l.fieldType)?void 0:s.toLowerCase())?i:"none"}destroy(){for(const t in this.chars)this.chars[t].texture.destroy(),this.chars[t].texture=null;for(const t in this.pageTextures)this._ownsTextures&&this.pageTextures[t].destroy(!0),this.pageTextures[t]=null;this.chars=null,this.pageTextures=null}static install(t,e,n){let s;if(t instanceof qp)s=t;else{const e=function(t){for(let e=0;e<Jp.length;e++)if(Jp[e].test(t))return Jp[e];return null}(t);if(!e)throw new Error("Unrecognized data format for font.");s=e.parse(t)}e instanceof ic&&(e=[e]);const i=new sm(s,e,n);return sm.available[i.font]=i,i}static uninstall(t){const e=sm.available[t];if(!e)throw new Error(`No font found named '${t}'`);e.destroy(),delete sm.available[t]}static from(t,e,n){if(!t)throw new Error("[BitmapFont] Property `name` is required.");const s=Object.assign({},sm.defaultOptions,n),{chars:i,padding:r,resolution:a,textureWidth:o,textureHeight:l}=s,h=f(s,["chars","padding","resolution","textureWidth","textureHeight"]),c=function(t){"string"==typeof t&&(t=[t]);const e=[];for(let n=0,s=t.length;n<s;n++){const s=t[n];if(Array.isArray(s)){if(2!==s.length)throw new Error(`[BitmapFont]: Invalid character range length, expecting 2 got ${s.length}.`);const t=s[0].charCodeAt(0),n=s[1].charCodeAt(0);if(n<t)throw new Error("[BitmapFont]: Invalid character range.");for(let s=t,i=n;s<=i;s++)e.push(String.fromCharCode(s))}else e.push(...nm(s))}if(0===e.length)throw new Error("[BitmapFont]: Empty set when resolving characters.");return e}(i),d=e instanceof _p?e:new _p(e),p=o,m=new qp;m.info[0]={face:d.fontFamily,size:d.fontSize},m.common[0]={lineHeight:d.fontSize};let g,v,x,y=0,_=0,b=0;const w=[];for(let f=0;f<c.length;f++){g||(g=zr.ADAPTER.createCanvas(),g.width=o,g.height=l,v=g.getContext("2d"),x=new Ol(g,u({resolution:a},h)),w.push(new ic(x)),m.page.push({id:w.length-1,file:""}));const t=c[f],e=vp.measureText(t,d,!1,g),n=e.width,s=Math.ceil(e.height),i=Math.ceil(("italic"===d.fontStyle?2:1)*n);if(_>=l-s*a){if(0===_)throw new Error(`[BitmapFont] textureHeight ${l}px is too small (fontFamily: '${d.fontFamily}', fontSize: ${d.fontSize}px, char: '${t}')`);--f,g=null,v=null,x=null,_=0,y=0,b=0;continue}if(b=Math.max(s+e.fontProperties.descent,b),i*a+y>=p){if(0===y)throw new Error(`[BitmapFont] textureWidth ${o}px is too small (fontFamily: '${d.fontFamily}', fontSize: ${d.fontSize}px, char: '${t}')`);--f,_+=b*a,_=Math.ceil(_),y=0,b=0;continue}tm(g,v,e,y,_,a,d);const E=em(e.text);m.char.push({id:E,page:w.length-1,x:y/a,y:_/a,width:i,height:s,xoffset:0,yoffset:0,xadvance:n-(d.dropShadow?d.dropShadowDistance:0)-(d.stroke?d.strokeThickness:0)}),y+=(i+2*r)*a,y=Math.ceil(y)}for(let u=0,f=c.length;u<f;u++){const t=c[u];for(let e=0;e<f;e++){const n=c[e],s=v.measureText(t).width,i=v.measureText(n).width,r=v.measureText(t+n).width-(s+i);r&&m.kerning.push({first:em(t),second:em(n),amount:r})}}const E=new sm(m,w,!0);return void 0!==sm.available[t]&&sm.uninstall(t),sm.available[t]=E,E}};let im=sm;im.ALPHA=[["a","z"],["A","Z"]," "],im.NUMERIC=[["0","9"]],im.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "],im.ASCII=[[" ","~"]],im.defaultOptions={resolution:1,textureWidth:512,textureHeight:512,padding:4,chars:sm.ALPHANUMERIC},im.available={};const rm=[],am=[],om=[],lm=class extends Iu{constructor(t,e={}){super();const{align:n,tint:s,maxWidth:i,letterSpacing:r,fontName:a,fontSize:o}=Object.assign({},lm.styleDefaults,e);if(!im.available[a])throw new Error(`Missing BitmapFont "${a}"`);this._activePagesMeshData=[],this._textWidth=0,this._textHeight=0,this._align=n,this._tintColor=new qo(s),this._font=void 0,this._fontName=a,this._fontSize=o,this.text=t,this._maxWidth=i,this._maxLineHeight=0,this._letterSpacing=r,this._anchor=new uh((()=>{this.dirty=!0}),this,0,0),this._roundPixels=zr.ROUND_PIXELS,this.dirty=!0,this._resolution=zr.RESOLUTION,this._autoResolution=!0,this._textureCache={}}updateText(){var t;const e=im.available[this._fontName],n=this.fontSize,s=n/e.size,i=new ql,r=[],a=[],o=[],l=nm(this._text.replace(/(?:\r\n|\r)/g,"\n")||" "),h=this._maxWidth*e.size/n,c="none"===e.distanceFieldType?rm:am;let u=null,d=0,f=0,p=0,m=-1,g=0,v=0,x=0,y=0;for(let A=0;A<l.length;A++){const t=l[A],n=em(t);if(/(?:\s)/.test(t)&&(m=A,g=d,y++),"\r"===t||"\n"===t){a.push(d),o.push(-1),f=Math.max(f,d),++p,++v,i.x=0,i.y+=e.lineHeight,u=null,y=0;continue}const s=e.chars[n];if(!s)continue;u&&s.kerning[u]&&(i.x+=s.kerning[u]);const c=om.pop()||{texture:ic.EMPTY,line:0,charCode:0,prevSpaces:0,position:new ql};c.texture=s.texture,c.line=p,c.charCode=n,c.position.x=Math.round(i.x+s.xOffset+this._letterSpacing/2),c.position.y=Math.round(i.y+s.yOffset),c.prevSpaces=y,r.push(c),d=c.position.x+Math.max(s.xAdvance-s.xOffset,s.texture.orig.width),i.x+=s.xAdvance+this._letterSpacing,x=Math.max(x,s.yOffset+s.texture.height),u=n,-1!==m&&h>0&&i.x>h&&(++v,il(r,1+m-v,1+A-m),A=m,m=-1,a.push(g),o.push(r.length>0?r[r.length-1].prevSpaces:0),f=Math.max(f,g),p++,i.x=0,i.y+=e.lineHeight,u=null,y=0)}const _=l[l.length-1];"\r"!==_&&"\n"!==_&&(/(?:\s)/.test(_)&&(d=g),a.push(d),f=Math.max(f,d),o.push(-1));const b=[];for(let A=0;A<=p;A++){let t=0;"right"===this._align?t=f-a[A]:"center"===this._align?t=(f-a[A])/2:"justify"===this._align&&(t=o[A]<0?0:(f-a[A])/o[A]),b.push(t)}const w=r.length,E={},T=[],S=this._activePagesMeshData;c.push(...S);for(let A=0;A<w;A++){const t=r[A].texture,n=t.baseTexture.uid;if(!E[n]){let s=c.pop();if(!s){const t=new lp;let n,i;"none"===e.distanceFieldType?(n=new hp(ic.EMPTY),i=Ir.NORMAL):(n=new hp(ic.EMPTY,{program:Dh.from("// Mesh material default fragment\r\nattribute vec2 aVertexPosition;\r\nattribute vec2 aTextureCoord;\r\n\r\nuniform mat3 projectionMatrix;\r\nuniform mat3 translationMatrix;\r\nuniform mat3 uTextureMatrix;\r\n\r\nvarying vec2 vTextureCoord;\r\n\r\nvoid main(void)\r\n{\r\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\r\n\r\n    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\r\n}\r\n","// Pixi texture info\r\nvarying vec2 vTextureCoord;\r\nuniform sampler2D uSampler;\r\n\r\n// Tint\r\nuniform vec4 uColor;\r\n\r\n// on 2D applications fwidth is screenScale / glyphAtlasScale * distanceFieldRange\r\nuniform float uFWidth;\r\n\r\nvoid main(void) {\r\n\r\n  // To stack MSDF and SDF we need a non-pre-multiplied-alpha texture.\r\n  vec4 texColor = texture2D(uSampler, vTextureCoord);\r\n\r\n  // MSDF\r\n  float median = texColor.r + texColor.g + texColor.b -\r\n                  min(texColor.r, min(texColor.g, texColor.b)) -\r\n                  max(texColor.r, max(texColor.g, texColor.b));\r\n  // SDF\r\n  median = min(median, texColor.a);\r\n\r\n  float screenPxDistance = uFWidth * (median - 0.5);\r\n  float alpha = clamp(screenPxDistance + 0.5, 0.0, 1.0);\r\n  if (median < 0.01) {\r\n    alpha = 0.0;\r\n  } else if (median > 0.99) {\r\n    alpha = 1.0;\r\n  }\r\n\r\n  // Gamma correction for coverage-like alpha\r\n  float luma = dot(uColor.rgb, vec3(0.299, 0.587, 0.114));\r\n  float gamma = mix(1.0, 1.0 / 2.2, luma);\r\n  float coverage = pow(uColor.a * alpha, gamma);  \r\n\r\n  // NPM Textures, NPM outputs\r\n  gl_FragColor = vec4(uColor.rgb, coverage);\r\n}\r\n"),uniforms:{uFWidth:0}}),i=Ir.NORMAL_NPM);const r=new op(t,n);r.blendMode=i,s={index:0,indexCount:0,vertexCount:0,uvsCount:0,total:0,mesh:r,vertices:null,uvs:null,indices:null}}s.index=0,s.indexCount=0,s.vertexCount=0,s.uvsCount=0,s.total=0;const{_textureCache:i}=this;i[n]=i[n]||new ic(t.baseTexture),s.mesh.texture=i[n],s.mesh.tint=this._tintColor.value,T.push(s),E[n]=s}E[n].total++}for(let A=0;A<S.length;A++)T.includes(S[A])||this.removeChild(S[A].mesh);for(let A=0;A<T.length;A++)T[A].mesh.parent!==this&&this.addChild(T[A].mesh);this._activePagesMeshData=T;for(const A in E){const e=E[A],n=e.total;if(!((null==(t=e.indices)?void 0:t.length)>6*n)||e.vertices.length<2*op.BATCHABLE_SIZE)e.vertices=new Float32Array(8*n),e.uvs=new Float32Array(8*n),e.indices=new Uint16Array(6*n);else{const t=e.total,n=e.vertices;for(let e=4*t*2;e<n.length;e++)n[e]=0}e.mesh.size=6*n}for(let A=0;A<w;A++){const t=r[A];let e=t.position.x+b[t.line]*("justify"===this._align?t.prevSpaces:1);this._roundPixels&&(e=Math.round(e));const n=e*s,i=t.position.y*s,a=t.texture,o=E[a.baseTexture.uid],l=a.frame,h=a._uvs,c=o.index++;o.indices[6*c+0]=0+4*c,o.indices[6*c+1]=1+4*c,o.indices[6*c+2]=2+4*c,o.indices[6*c+3]=0+4*c,o.indices[6*c+4]=2+4*c,o.indices[6*c+5]=3+4*c,o.vertices[8*c+0]=n,o.vertices[8*c+1]=i,o.vertices[8*c+2]=n+l.width*s,o.vertices[8*c+3]=i,o.vertices[8*c+4]=n+l.width*s,o.vertices[8*c+5]=i+l.height*s,o.vertices[8*c+6]=n,o.vertices[8*c+7]=i+l.height*s,o.uvs[8*c+0]=h.x0,o.uvs[8*c+1]=h.y0,o.uvs[8*c+2]=h.x1,o.uvs[8*c+3]=h.y1,o.uvs[8*c+4]=h.x2,o.uvs[8*c+5]=h.y2,o.uvs[8*c+6]=h.x3,o.uvs[8*c+7]=h.y3}this._textWidth=f*s,this._textHeight=(i.y+e.lineHeight)*s;for(const A in E){const t=E[A];if(0!==this.anchor.x||0!==this.anchor.y){let e=0;const n=this._textWidth*this.anchor.x,s=this._textHeight*this.anchor.y;for(let i=0;i<t.total;i++)t.vertices[e++]-=n,t.vertices[e++]-=s,t.vertices[e++]-=n,t.vertices[e++]-=s,t.vertices[e++]-=n,t.vertices[e++]-=s,t.vertices[e++]-=n,t.vertices[e++]-=s}this._maxLineHeight=x*s;const e=t.mesh.geometry.getBuffer("aVertexPosition"),n=t.mesh.geometry.getBuffer("aTextureCoord"),i=t.mesh.geometry.getIndex();e.data=t.vertices,n.data=t.uvs,i.data=t.indices,e.update(),n.update(),i.update()}for(let A=0;A<r.length;A++)om.push(r[A]);this._font=e,this.dirty=!1}updateTransform(){this.validate(),this.containerUpdateTransform()}_render(t){this._autoResolution&&this._resolution!==t.resolution&&(this._resolution=t.resolution,this.dirty=!0);const{distanceFieldRange:e,distanceFieldType:n,size:s}=im.available[this._fontName];if("none"!==n){const{a:n,b:i,c:r,d:a}=this.worldTransform,o=Math.sqrt(n*n+i*i),l=Math.sqrt(r*r+a*a),h=(Math.abs(o)+Math.abs(l))/2,c=this.fontSize/s,u=t._view.resolution;for(const t of this._activePagesMeshData)t.mesh.shader.uniforms.uFWidth=h*e*c*u}super._render(t)}getLocalBounds(){return this.validate(),super.getLocalBounds()}validate(){const t=im.available[this._fontName];if(!t)throw new Error(`Missing BitmapFont "${this._fontName}"`);this._font!==t&&(this.dirty=!0),this.dirty&&this.updateText()}get tint(){return this._tintColor.value}set tint(t){if(this.tint!==t){this._tintColor.setValue(t);for(let e=0;e<this._activePagesMeshData.length;e++)this._activePagesMeshData[e].mesh.tint=t}}get align(){return this._align}set align(t){this._align!==t&&(this._align=t,this.dirty=!0)}get fontName(){return this._fontName}set fontName(t){if(!im.available[t])throw new Error(`Missing BitmapFont "${t}"`);this._fontName!==t&&(this._fontName=t,this.dirty=!0)}get fontSize(){var t;return null!=(t=this._fontSize)?t:im.available[this._fontName].size}set fontSize(t){this._fontSize!==t&&(this._fontSize=t,this.dirty=!0)}get anchor(){return this._anchor}set anchor(t){"number"==typeof t?this._anchor.set(t):this._anchor.copyFrom(t)}get text(){return this._text}set text(t){t=String(null==t?"":t),this._text!==t&&(this._text=t,this.dirty=!0)}get maxWidth(){return this._maxWidth}set maxWidth(t){this._maxWidth!==t&&(this._maxWidth=t,this.dirty=!0)}get maxLineHeight(){return this.validate(),this._maxLineHeight}get textWidth(){return this.validate(),this._textWidth}get letterSpacing(){return this._letterSpacing}set letterSpacing(t){this._letterSpacing!==t&&(this._letterSpacing=t,this.dirty=!0)}get roundPixels(){return this._roundPixels}set roundPixels(t){t!==this._roundPixels&&(this._roundPixels=t,this.dirty=!0)}get textHeight(){return this.validate(),this._textHeight}get resolution(){return this._resolution}set resolution(t){this._autoResolution=!1,this._resolution!==t&&(this._resolution=t,this.dirty=!0)}destroy(t){const{_textureCache:e}=this,n="none"===im.available[this._fontName].distanceFieldType?rm:am;n.push(...this._activePagesMeshData);for(const s of this._activePagesMeshData)this.removeChild(s.mesh);this._activePagesMeshData=[],n.filter((t=>e[t.mesh.texture.baseTexture.uid])).forEach((t=>{t.mesh.texture=ic.EMPTY}));for(const s in e){e[s].destroy(),delete e[s]}this._font=null,this._tintColor=null,this._textureCache=null,super.destroy(t)}};lm.styleDefaults={align:"left",tint:16777215,maxWidth:0,letterSpacing:0};const hm=[".xml",".fnt"],cm={extension:{type:yl.LoadParser,priority:pd.Normal},name:"loadBitmapFont",test:t=>hm.includes(mo.extname(t).toLowerCase()),testParse(t){return m(this,null,(function*(){return Kp.test(t)||Qp.test(t)}))},parse(t,e,n){return m(this,null,(function*(){const s=Kp.test(t)?Kp.parse(t):Qp.parse(t),{src:i}=e,{page:r}=s,a=[];for(let t=0;t<r.length;++t){const e=r[t].file;let n=mo.join(mo.dirname(i),e);n=ld(n,i),a.push(n)}const o=yield n.load(a),l=a.map((t=>o[t]));return im.install(s,l,!0)}))},load(t,e){return m(this,null,(function*(){return(yield zr.ADAPTER.fetch(t)).text()}))},unload(t){t.destroy()}};wl.add(cm);const um=class extends _p{constructor(){super(...arguments),this._fonts=[],this._overrides=[],this._stylesheet="",this.fontsDirty=!1}static from(t){return new um(Object.keys(um.defaultOptions).reduce(((e,n)=>d(u({},e),{[n]:t[n]})),{}))}cleanFonts(){this._fonts.length>0&&(this._fonts.forEach((t=>{URL.revokeObjectURL(t.src),t.refs--,0===t.refs&&(t.fontFace&&document.fonts.delete(t.fontFace),delete um.availableFonts[t.originalUrl])})),this.fontFamily="Arial",this._fonts.length=0,this.styleID++,this.fontsDirty=!0)}loadFont(t,e={}){const{availableFonts:n}=um;if(n[t]){const e=n[t];return this._fonts.push(e),e.refs++,this.styleID++,this.fontsDirty=!0,Promise.resolve()}return zr.ADAPTER.fetch(t).then((t=>t.blob())).then((t=>m(this,null,(function*(){return new Promise(((e,n)=>{const s=URL.createObjectURL(t),i=new FileReader;i.onload=()=>e([s,i.result]),i.onerror=n,i.readAsDataURL(t)}))})))).then((s=>m(this,[s],(function*([s,i]){const r=Object.assign({family:mo.basename(t,mo.extname(t)),weight:"normal",style:"normal",src:s,dataSrc:i,refs:1,originalUrl:t,fontFace:null},e);n[t]=r,this._fonts.push(r),this.styleID++;const a=new FontFace(r.family,`url(${r.src})`,{weight:r.weight,style:r.style});r.fontFace=a,yield a.load(),document.fonts.add(a),yield document.fonts.ready,this.styleID++,this.fontsDirty=!0}))))}addOverride(...t){const e=t.filter((t=>!this._overrides.includes(t)));e.length>0&&(this._overrides.push(...e),this.styleID++)}removeOverride(...t){const e=t.filter((t=>this._overrides.includes(t)));e.length>0&&(this._overrides=this._overrides.filter((t=>!e.includes(t))),this.styleID++)}toCSS(t){return[`transform: scale(${t})`,"transform-origin: top left","display: inline-block",`color: ${this.normalizeColor(this.fill)}`,`font-size: ${this.fontSize}px`,`font-family: ${this.fontFamily}`,`font-weight: ${this.fontWeight}`,`font-style: ${this.fontStyle}`,`font-variant: ${this.fontVariant}`,`letter-spacing: ${this.letterSpacing}px`,`text-align: ${this.align}`,`padding: ${this.padding}px`,`white-space: ${this.whiteSpace}`,...this.lineHeight?[`line-height: ${this.lineHeight}px`]:[],...this.wordWrap?["word-wrap: "+(this.breakWords?"break-all":"break-word"),`max-width: ${this.wordWrapWidth}px`]:[],...this.strokeThickness?[`-webkit-text-stroke-width: ${this.strokeThickness}px`,`-webkit-text-stroke-color: ${this.normalizeColor(this.stroke)}`,`text-stroke-width: ${this.strokeThickness}px`,`text-stroke-color: ${this.normalizeColor(this.stroke)}`,"paint-order: stroke"]:[],...this.dropShadow?[this.dropShadowToCSS()]:[],...this._overrides].join(";")}toGlobalCSS(){return this._fonts.reduce(((t,e)=>`${t}\n            @font-face {\n                font-family: "${e.family}";\n                src: url('${e.dataSrc}');\n                font-weight: ${e.weight};\n                font-style: ${e.style}; \n            }`),this._stylesheet)}get stylesheet(){return this._stylesheet}set stylesheet(t){this._stylesheet!==t&&(this._stylesheet=t,this.styleID++)}normalizeColor(t){return Array.isArray(t)&&(t=Zo(t)),"number"==typeof t?(e=t,vo("7.2.0","utils.hex2string is deprecated, use Color#toHex instead"),qo.shared.setValue(e).toHex()):t;var e}dropShadowToCSS(){let t=this.normalizeColor(this.dropShadowColor);const e=this.dropShadowAlpha,n=Math.round(Math.cos(this.dropShadowAngle)*this.dropShadowDistance),s=Math.round(Math.sin(this.dropShadowAngle)*this.dropShadowDistance);t.startsWith("#")&&e<1&&(t+=(255*e|0).toString(16).padStart(2,"0"));const i=`${n}px ${s}px`;return this.dropShadowBlur>0?`text-shadow: ${i} ${this.dropShadowBlur}px ${t}`:`text-shadow: ${i} ${t}`}reset(){Object.assign(this,um.defaultOptions)}onBeforeDraw(){const{fontsDirty:t}=this;return this.fontsDirty=!1,this.isSafari&&this._fonts.length>0&&t?new Promise((t=>setTimeout(t,100))):Promise.resolve()}get isSafari(){const{userAgent:t}=zr.ADAPTER.getNavigator();return/^((?!chrome|android).)*safari/i.test(t)}set fillGradientStops(t){console.warn("[HTMLTextStyle] fillGradientStops is not supported by HTMLText")}get fillGradientStops(){return super.fillGradientStops}set fillGradientType(t){console.warn("[HTMLTextStyle] fillGradientType is not supported by HTMLText")}get fillGradientType(){return super.fillGradientType}set miterLimit(t){console.warn("[HTMLTextStyle] miterLimit is not supported by HTMLText")}get miterLimit(){return super.miterLimit}set trim(t){console.warn("[HTMLTextStyle] trim is not supported by HTMLText")}get trim(){return super.trim}set textBaseline(t){console.warn("[HTMLTextStyle] textBaseline is not supported by HTMLText")}get textBaseline(){return super.textBaseline}set leading(t){console.warn("[HTMLTextStyle] leading is not supported by HTMLText")}get leading(){return super.leading}set lineJoin(t){console.warn("[HTMLTextStyle] lineJoin is not supported by HTMLText")}get lineJoin(){return super.lineJoin}};let dm=um;dm.availableFonts={},dm.defaultOptions={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",letterSpacing:0,lineHeight:0,padding:0,stroke:"black",strokeThickness:0,whiteSpace:"normal",wordWrap:!1,wordWrapWidth:100};const fm=class extends Pu{constructor(t="",e={}){var n;super(ic.EMPTY),this._text=null,this._style=null,this._autoResolution=!0,this._loading=!1,this.localStyleID=-1,this.dirty=!1,this.ownsStyle=!1;const s=new Image,i=ic.from(s,{scaleMode:zr.SCALE_MODE,resourceOptions:{autoLoad:!1}});i.orig=new Zl,i.trim=new Zl,this.texture=i;const r="http://www.w3.org/2000/svg",a="http://www.w3.org/1999/xhtml",o=document.createElementNS(r,"svg"),l=document.createElementNS(r,"foreignObject"),h=document.createElementNS(a,"div"),c=document.createElementNS(a,"style");l.setAttribute("width","10000"),l.setAttribute("height","10000"),l.style.overflow="hidden",o.appendChild(l),this.maxWidth=fm.defaultMaxWidth,this.maxHeight=fm.defaultMaxHeight,this._domElement=h,this._styleElement=c,this._svgRoot=o,this._foreignObject=l,this._foreignObject.appendChild(c),this._foreignObject.appendChild(h),this._image=s,this._loadImage=new Image,this._autoResolution=fm.defaultAutoResolution,this._resolution=null!=(n=fm.defaultResolution)?n:zr.RESOLUTION,this.text=t,this.style=e}measureText(t){var e,n;const{text:s,style:i,resolution:r}=Object.assign({text:this._text,style:this._style,resolution:this._resolution},t);Object.assign(this._domElement,{innerHTML:s,style:i.toCSS(r)}),this._styleElement.textContent=i.toGlobalCSS(),document.body.appendChild(this._svgRoot);const a=this._domElement.getBoundingClientRect();this._svgRoot.remove();const o=Math.min(this.maxWidth,Math.ceil(a.width)),l=Math.min(this.maxHeight,Math.ceil(a.height));return this._svgRoot.setAttribute("width",o.toString()),this._svgRoot.setAttribute("height",l.toString()),s!==this._text&&(this._domElement.innerHTML=this._text),i!==this._style&&(Object.assign(this._domElement,{style:null==(e=this._style)?void 0:e.toCSS(r)}),this._styleElement.textContent=null==(n=this._style)?void 0:n.toGlobalCSS()),{width:o+2*i.padding,height:l+2*i.padding}}updateText(t=!0){return m(this,null,(function*(){const{style:e,_image:n,_loadImage:s}=this;if(this.localStyleID!==e.styleID&&(this.dirty=!0,this.localStyleID=e.styleID),!this.dirty&&t)return;const{width:i,height:r}=this.measureText();n.width=s.width=Math.ceil(Math.max(1,i)),n.height=s.height=Math.ceil(Math.max(1,r)),this._loading||(this._loading=!0,yield new Promise((t=>{s.onload=()=>m(this,null,(function*(){yield e.onBeforeDraw(),this._loading=!1,n.src=s.src,s.onload=null,s.src="",this.updateTexture(),t()}));const i=(new XMLSerializer).serializeToString(this._svgRoot);s.src=`data:image/svg+xml;charset=utf8,${encodeURIComponent(i)}`})))}))}get source(){return this._image}updateTexture(){const{style:t,texture:e,_image:n,resolution:s}=this,{padding:i}=t,{baseTexture:r}=e;e.trim.width=e._frame.width=n.width/s,e.trim.height=e._frame.height=n.height/s,e.trim.x=-i,e.trim.y=-i,e.orig.width=e._frame.width-2*i,e.orig.height=e._frame.height-2*i,this._onTextureUpdate(),r.setRealSize(n.width,n.height,s),this.dirty=!1}_render(t){this._autoResolution&&this._resolution!==t.resolution&&(this._resolution=t.resolution,this.dirty=!0),this.updateText(!0),super._render(t)}_renderCanvas(t){this._autoResolution&&this._resolution!==t.resolution&&(this._resolution=t.resolution,this.dirty=!0),this.updateText(!0),super._renderCanvas(t)}getLocalBounds(t){return this.updateText(!0),super.getLocalBounds(t)}_calculateBounds(){this.updateText(!0),this.calculateVertices(),this._bounds.addQuad(this.vertexData)}_onStyleChange(){this.dirty=!0}destroy(t){var e,n,s,i,r;"boolean"==typeof t&&(t={children:t}),t=Object.assign({},fm.defaultDestroyOptions,t),super.destroy(t);const a=null;this.ownsStyle&&(null==(e=this._style)||e.cleanFonts()),this._style=a,null==(n=this._svgRoot)||n.remove(),this._svgRoot=a,null==(s=this._domElement)||s.remove(),this._domElement=a,null==(i=this._foreignObject)||i.remove(),this._foreignObject=a,null==(r=this._styleElement)||r.remove(),this._styleElement=a,this._loadImage.src="",this._loadImage.onload=null,this._loadImage=a,this._image.src="",this._image=a}get width(){return this.updateText(!0),Math.abs(this.scale.x)*this._image.width/this.resolution}set width(t){this.updateText(!0);const e=rl(this.scale.x)||1;this.scale.x=e*t/this._image.width/this.resolution,this._width=t}get height(){return this.updateText(!0),Math.abs(this.scale.y)*this._image.height/this.resolution}set height(t){this.updateText(!0);const e=rl(this.scale.y)||1;this.scale.y=e*t/this._image.height/this.resolution,this._height=t}get style(){return this._style}set style(t){this._style!==t&&((t=t||{})instanceof dm?(this.ownsStyle=!1,this._style=t):t instanceof _p?(console.warn("[HTMLText] Cloning TextStyle, if this is not what you want, use HTMLTextStyle"),this.ownsStyle=!0,this._style=dm.from(t)):(this.ownsStyle=!0,this._style=new dm(t)),this.localStyleID=-1,this.dirty=!0)}get text(){return this._text}set text(t){t=String(""===t||null==t?" ":t),t=this.sanitiseText(t),this._text!==t&&(this._text=t,this.dirty=!0)}get resolution(){return this._resolution}set resolution(t){this._autoResolution=!1,this._resolution!==t&&(this._resolution=t,this.dirty=!0)}sanitiseText(t){return t.replace(/<br>/gi,"<br/>").replace(/<hr>/gi,"<hr/>").replace(/&nbsp;/gi,"&#160;")}};let pm=fm;pm.defaultDestroyOptions={texture:!0,children:!1,baseTexture:!0},pm.defaultMaxWidth=2024,pm.defaultMaxHeight=2024,pm.defaultAutoResolution=!0;let mm=class extends Gh{constructor(t=4,e=3,n=!1){super("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}",n?"\nvarying vec2 vTextureCoord;\nuniform sampler2D uSampler;\n\nuniform vec2 uOffset;\nuniform vec4 filterClamp;\n\nvoid main(void)\n{\n    vec4 color = vec4(0.0);\n\n    // Sample top left pixel\n    color += texture2D(uSampler, clamp(vec2(vTextureCoord.x - uOffset.x, vTextureCoord.y + uOffset.y), filterClamp.xy, filterClamp.zw));\n\n    // Sample top right pixel\n    color += texture2D(uSampler, clamp(vec2(vTextureCoord.x + uOffset.x, vTextureCoord.y + uOffset.y), filterClamp.xy, filterClamp.zw));\n\n    // Sample bottom right pixel\n    color += texture2D(uSampler, clamp(vec2(vTextureCoord.x + uOffset.x, vTextureCoord.y - uOffset.y), filterClamp.xy, filterClamp.zw));\n\n    // Sample bottom left pixel\n    color += texture2D(uSampler, clamp(vec2(vTextureCoord.x - uOffset.x, vTextureCoord.y - uOffset.y), filterClamp.xy, filterClamp.zw));\n\n    // Average\n    color *= 0.25;\n\n    gl_FragColor = color;\n}\n":"\nvarying vec2 vTextureCoord;\nuniform sampler2D uSampler;\n\nuniform vec2 uOffset;\n\nvoid main(void)\n{\n    vec4 color = vec4(0.0);\n\n    // Sample top left pixel\n    color += texture2D(uSampler, vec2(vTextureCoord.x - uOffset.x, vTextureCoord.y + uOffset.y));\n\n    // Sample top right pixel\n    color += texture2D(uSampler, vec2(vTextureCoord.x + uOffset.x, vTextureCoord.y + uOffset.y));\n\n    // Sample bottom right pixel\n    color += texture2D(uSampler, vec2(vTextureCoord.x + uOffset.x, vTextureCoord.y - uOffset.y));\n\n    // Sample bottom left pixel\n    color += texture2D(uSampler, vec2(vTextureCoord.x - uOffset.x, vTextureCoord.y - uOffset.y));\n\n    // Average\n    color *= 0.25;\n\n    gl_FragColor = color;\n}"),this._kernels=[],this._blur=4,this._quality=3,this.uniforms.uOffset=new Float32Array(2),this._pixelSize=new ql,this.pixelSize=1,this._clamp=n,Array.isArray(t)?this.kernels=t:(this._blur=t,this.quality=e)}apply(t,e,n,s){const i=this._pixelSize.x/e._frame.width,r=this._pixelSize.y/e._frame.height;let a;if(1===this._quality||0===this._blur)a=this._kernels[0]+.5,this.uniforms.uOffset[0]=a*i,this.uniforms.uOffset[1]=a*r,t.applyFilter(this,e,n,s);else{const o=t.getFilterTexture();let l,h=e,c=o;const u=this._quality-1;for(let e=0;e<u;e++)a=this._kernels[e]+.5,this.uniforms.uOffset[0]=a*i,this.uniforms.uOffset[1]=a*r,t.applyFilter(this,h,c,1),l=h,h=c,c=l;a=this._kernels[u]+.5,this.uniforms.uOffset[0]=a*i,this.uniforms.uOffset[1]=a*r,t.applyFilter(this,h,n,s),t.returnFilterTexture(o)}}_updatePadding(){this.padding=Math.ceil(this._kernels.reduce(((t,e)=>t+e+.5),0))}_generateKernels(){const t=this._blur,e=this._quality,n=[t];if(t>0){let s=t;const i=t/e;for(let t=1;t<e;t++)s-=i,n.push(s)}this._kernels=n,this._updatePadding()}get kernels(){return this._kernels}set kernels(t){Array.isArray(t)&&t.length>0?(this._kernels=t,this._quality=t.length,this._blur=Math.max(...t)):(this._kernels=[0],this._quality=1)}get clamp(){return this._clamp}set pixelSize(t){"number"==typeof t?(this._pixelSize.x=t,this._pixelSize.y=t):Array.isArray(t)?(this._pixelSize.x=t[0],this._pixelSize.y=t[1]):t instanceof ql?(this._pixelSize.x=t.x,this._pixelSize.y=t.y):(this._pixelSize.x=1,this._pixelSize.y=1)}get pixelSize(){return this._pixelSize}get quality(){return this._quality}set quality(t){this._quality=Math.max(1,Math.round(t)),this._generateKernels()}get blur(){return this._blur}set blur(t){this._blur=t,this._generateKernels()}};var gm="attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}";let vm=class extends Gh{constructor(t=.5){super(gm,"\nuniform sampler2D uSampler;\nvarying vec2 vTextureCoord;\n\nuniform float threshold;\n\nvoid main() {\n    vec4 color = texture2D(uSampler, vTextureCoord);\n\n    // A simple & fast algorithm for getting brightness.\n    // It's inaccuracy , but good enought for this feature.\n    float _max = max(max(color.r, color.g), color.b);\n    float _min = min(min(color.r, color.g), color.b);\n    float brightness = (_max + _min) * 0.5;\n\n    if(brightness > threshold) {\n        gl_FragColor = color;\n    } else {\n        gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);\n    }\n}\n"),this.threshold=t}get threshold(){return this.uniforms.threshold}set threshold(t){this.uniforms.threshold=t}};const xm=class extends Gh{constructor(t){super(gm,"uniform sampler2D uSampler;\nvarying vec2 vTextureCoord;\n\nuniform sampler2D bloomTexture;\nuniform float bloomScale;\nuniform float brightness;\n\nvoid main() {\n    vec4 color = texture2D(uSampler, vTextureCoord);\n    color.rgb *= brightness;\n    vec4 bloomColor = vec4(texture2D(bloomTexture, vTextureCoord).rgb, 0.0);\n    bloomColor.rgb *= bloomScale;\n    gl_FragColor = color + bloomColor;\n}\n"),this.bloomScale=1,this.brightness=1,this._resolution=zr.FILTER_RESOLUTION,"number"==typeof t&&(t={threshold:t});const e=Object.assign(xm.defaults,t);this.bloomScale=e.bloomScale,this.brightness=e.brightness;const{kernels:n,blur:s,quality:i,pixelSize:r,resolution:a}=e;this._extractFilter=new vm(e.threshold),this._extractFilter.resolution=a,this._blurFilter=n?new mm(n):new mm(s,i),this.pixelSize=r,this.resolution=a}apply(t,e,n,s,i){const r=t.getFilterTexture();this._extractFilter.apply(t,e,r,1,i);const a=t.getFilterTexture();this._blurFilter.apply(t,r,a,1),this.uniforms.bloomScale=this.bloomScale,this.uniforms.brightness=this.brightness,this.uniforms.bloomTexture=a,t.applyFilter(this,e,n,s),t.returnFilterTexture(a),t.returnFilterTexture(r)}get resolution(){return this._resolution}set resolution(t){this._resolution=t,this._extractFilter&&(this._extractFilter.resolution=t),this._blurFilter&&(this._blurFilter.resolution=t)}get threshold(){return this._extractFilter.threshold}set threshold(t){this._extractFilter.threshold=t}get kernels(){return this._blurFilter.kernels}set kernels(t){this._blurFilter.kernels=t}get blur(){return this._blurFilter.blur}set blur(t){this._blurFilter.blur=t}get quality(){return this._blurFilter.quality}set quality(t){this._blurFilter.quality=t}get pixelSize(){return this._blurFilter.pixelSize}set pixelSize(t){this._blurFilter.pixelSize=t}};xm.defaults={threshold:.5,bloomScale:1,brightness:1,kernels:null,blur:8,quality:4,pixelSize:1,resolution:zr.FILTER_RESOLUTION};const ym=class extends Gh{constructor(t){super("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","uniform float radius;\nuniform float strength;\nuniform vec2 center;\nuniform sampler2D uSampler;\nvarying vec2 vTextureCoord;\n\nuniform vec4 filterArea;\nuniform vec4 filterClamp;\nuniform vec2 dimensions;\n\nvoid main()\n{\n    vec2 coord = vTextureCoord * filterArea.xy;\n    coord -= center * dimensions.xy;\n    float distance = length(coord);\n    if (distance < radius) {\n        float percent = distance / radius;\n        if (strength > 0.0) {\n            coord *= mix(1.0, smoothstep(0.0, radius / distance, percent), strength * 0.75);\n        } else {\n            coord *= mix(1.0, pow(percent, 1.0 + strength * 0.75) * radius / distance, 1.0 - percent);\n        }\n    }\n    coord += center * dimensions.xy;\n    coord /= filterArea.xy;\n    vec2 clampedCoord = clamp(coord, filterClamp.xy, filterClamp.zw);\n    vec4 color = texture2D(uSampler, clampedCoord);\n    if (coord != clampedCoord) {\n        color *= max(0.0, 1.0 - length(coord - clampedCoord));\n    }\n\n    gl_FragColor = color;\n}\n"),this.uniforms.dimensions=new Float32Array(2),Object.assign(this,ym.defaults,t)}apply(t,e,n,s){const{width:i,height:r}=e.filterFrame;this.uniforms.dimensions[0]=i,this.uniforms.dimensions[1]=r,t.applyFilter(this,e,n,s)}get radius(){return this.uniforms.radius}set radius(t){this.uniforms.radius=t}get strength(){return this.uniforms.strength}set strength(t){this.uniforms.strength=t}get center(){return this.uniforms.center}set center(t){this.uniforms.center=t}};ym.defaults={center:[.5,.5],radius:100,strength:1};var _m,bm;(bm=bm||{}).stringify=(_m={"visit_linear-gradient":function(t){return _m.visit_gradient(t)},"visit_repeating-linear-gradient":function(t){return _m.visit_gradient(t)},"visit_radial-gradient":function(t){return _m.visit_gradient(t)},"visit_repeating-radial-gradient":function(t){return _m.visit_gradient(t)},visit_gradient:function(t){var e=_m.visit(t.orientation);return e&&(e+=", "),t.type+"("+e+_m.visit(t.colorStops)+")"},visit_shape:function(t){var e=t.value,n=_m.visit(t.at),s=_m.visit(t.style);return s&&(e+=" "+s),n&&(e+=" at "+n),e},"visit_default-radial":function(t){var e="",n=_m.visit(t.at);return n&&(e+=n),e},"visit_extent-keyword":function(t){var e=t.value,n=_m.visit(t.at);return n&&(e+=" at "+n),e},"visit_position-keyword":function(t){return t.value},visit_position:function(t){return _m.visit(t.value.x)+" "+_m.visit(t.value.y)},"visit_%":function(t){return t.value+"%"},visit_em:function(t){return t.value+"em"},visit_px:function(t){return t.value+"px"},visit_literal:function(t){return _m.visit_color(t.value,t)},visit_hex:function(t){return _m.visit_color("#"+t.value,t)},visit_rgb:function(t){return _m.visit_color("rgb("+t.value.join(", ")+")",t)},visit_rgba:function(t){return _m.visit_color("rgba("+t.value.join(", ")+")",t)},visit_color:function(t,e){var n=t,s=_m.visit(e.length);return s&&(n+=" "+s),n},visit_angular:function(t){return t.value+"deg"},visit_directional:function(t){return"to "+t.value},visit_array:function(t){var e="",n=t.length;return t.forEach((function(t,s){e+=_m.visit(t),s<n-1&&(e+=", ")})),e},visit:function(t){if(!t)return"";if(t instanceof Array)return _m.visit_array(t,"");if(t.type){var e=_m["visit_"+t.type];if(e)return e(t);throw Error("Missing visitor visit_"+t.type)}throw Error("Invalid node.")}},function(t){return _m.visit(t)}),(bm=bm||{}).parse=function(){var t={linearGradient:/^(\-(webkit|o|ms|moz)\-)?(linear\-gradient)/i,repeatingLinearGradient:/^(\-(webkit|o|ms|moz)\-)?(repeating\-linear\-gradient)/i,radialGradient:/^(\-(webkit|o|ms|moz)\-)?(radial\-gradient)/i,repeatingRadialGradient:/^(\-(webkit|o|ms|moz)\-)?(repeating\-radial\-gradient)/i,sideOrCorner:/^to (left (top|bottom)|right (top|bottom)|left|right|top|bottom)/i,extentKeywords:/^(closest\-side|closest\-corner|farthest\-side|farthest\-corner|contain|cover)/,positionKeywords:/^(left|center|right|top|bottom)/i,pixelValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))px/,percentageValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))\%/,emValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))em/,angleValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))deg/,startCall:/^\(/,endCall:/^\)/,comma:/^,/,hexColor:/^\#([0-9a-fA-F]+)/,literalColor:/^([a-zA-Z]+)/,rgbColor:/^rgb/i,rgbaColor:/^rgba/i,number:/^(([0-9]*\.[0-9]+)|([0-9]+\.?))/},e="";function n(t){var n=new Error(e+": "+t);throw n.source=e,n}function s(){var t=f(i);return e.length>0&&n("Invalid input not EOF"),t}function i(){return r("linear-gradient",t.linearGradient,o)||r("repeating-linear-gradient",t.repeatingLinearGradient,o)||r("radial-gradient",t.radialGradient,l)||r("repeating-radial-gradient",t.repeatingRadialGradient,l)}function r(e,s,i){return a(s,(function(s){var r=i();return r&&(y(t.comma)||n("Missing comma before color stops")),{type:e,orientation:r,colorStops:f(p)}}))}function a(e,s){var i=y(e);if(i){y(t.startCall)||n("Missing (");var r=s(i);return y(t.endCall)||n("Missing )"),r}}function o(){return x("directional",t.sideOrCorner,1)||x("angular",t.angleValue,1)}function l(){var n,s,i=h();return i&&((n=[]).push(i),s=e,y(t.comma)&&((i=h())?n.push(i):e=s)),n}function h(){var t=function(){var t=x("shape",/^(circle)/i,0);return t&&(t.style=v()||c()),t}()||function(){var t=x("shape",/^(ellipse)/i,0);return t&&(t.style=g()||c()),t}();if(t)t.at=u();else{var e=c();if(e){t=e;var n=u();n&&(t.at=n)}else{var s=d();s&&(t={type:"default-radial",at:s})}}return t}function c(){return x("extent-keyword",t.extentKeywords,1)}function u(){if(x("position",/^at/,0)){var t=d();return t||n("Missing positioning value"),t}}function d(){var t={x:g(),y:g()};if(t.x||t.y)return{type:"position",value:t}}function f(e){var s=e(),i=[];if(s)for(i.push(s);y(t.comma);)(s=e())?i.push(s):n("One extra comma");return i}function p(){var e=x("hex",t.hexColor,1)||a(t.rgbaColor,(function(){return{type:"rgba",value:f(m)}}))||a(t.rgbColor,(function(){return{type:"rgb",value:f(m)}}))||x("literal",t.literalColor,0);return e||n("Expected color definition"),e.length=g(),e}function m(){return y(t.number)[1]}function g(){return x("%",t.percentageValue,1)||x("position-keyword",t.positionKeywords,1)||v()}function v(){return x("px",t.pixelValue,1)||x("em",t.emValue,1)}function x(t,e,n){var s=y(e);if(s)return{type:t,value:s[n]}}function y(t){var n,s;return(s=/^[\n\r\t\s]+/.exec(e))&&_(s[0].length),(n=t.exec(e))&&_(n[0].length),n}function _(t){e=e.substr(t)}return function(t){return e=t.toString(),s()}}();var wm=bm.parse;bm.stringify;var Em={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},Tm={red:0,orange:60,yellow:120,green:180,blue:240,purple:300};var Sm={name:"rgb",min:[0,0,0],max:[255,255,255],channel:["red","green","blue"],alias:["RGB"]},Am={name:"hsl",min:[0,0,0],max:[360,100,100],channel:["hue","saturation","lightness"],alias:["HSL"],rgb:function(t){var e,n,s,i,r,a=t[0]/360,o=t[1]/100,l=t[2]/100;if(0===o)return[r=255*l,r,r];e=2*l-(n=l<.5?l*(1+o):l+o-l*o),i=[0,0,0];for(var h=0;h<3;h++)(s=a+1/3*-(h-1))<0?s++:s>1&&s--,r=6*s<1?e+6*(n-e)*s:2*s<1?n:3*s<2?e+(n-e)*(2/3-s)*6:e,i[h]=255*r;return i}};function Cm(t){Array.isArray(t)&&t.raw&&(t=String.raw(...arguments));var e,n=function(t){var e,n,s=[],i=1;if("string"==typeof t)if(Em[t])s=Em[t].slice(),n="rgb";else if("transparent"===t)i=0,n="rgb",s=[0,0,0];else if(/^#[A-Fa-f0-9]+$/.test(t)){var r=t.slice(1);i=1,(l=r.length)<=4?(s=[parseInt(r[0]+r[0],16),parseInt(r[1]+r[1],16),parseInt(r[2]+r[2],16)],4===l&&(i=parseInt(r[3]+r[3],16)/255)):(s=[parseInt(r[0]+r[1],16),parseInt(r[2]+r[3],16),parseInt(r[4]+r[5],16)],8===l&&(i=parseInt(r[6]+r[7],16)/255)),s[0]||(s[0]=0),s[1]||(s[1]=0),s[2]||(s[2]=0),n="rgb"}else if(e=/^((?:rgb|hs[lvb]|hwb|cmyk?|xy[zy]|gray|lab|lchu?v?|[ly]uv|lms)a?)\s*\(([^\)]*)\)/.exec(t)){var a=e[1],o="rgb"===a;n=r=a.replace(/a$/,"");var l="cmyk"===r?4:"gray"===r?1:3;s=e[2].trim().split(/\s*[,\/]\s*|\s+/).map((function(t,e){if(/%$/.test(t))return e===l?parseFloat(t)/100:"rgb"===r?255*parseFloat(t)/100:parseFloat(t);if("h"===r[e]){if(/deg$/.test(t))return parseFloat(t);if(void 0!==Tm[t])return Tm[t]}return parseFloat(t)})),a===r&&s.push(1),i=o||void 0===s[l]?1:s[l],s=s.slice(0,l)}else t.length>10&&/[0-9](?:\s|\/)/.test(t)&&(s=t.match(/([0-9]+)/g).map((function(t){return parseFloat(t)})),n=t.match(/([a-z])/gi).join("").toLowerCase());else isNaN(t)?Array.isArray(t)||t.length?(s=[t[0],t[1],t[2]],n="rgb",i=4===t.length?t[3]:1):t instanceof Object&&(null!=t.r||null!=t.red||null!=t.R?(n="rgb",s=[t.r||t.red||t.R||0,t.g||t.green||t.G||0,t.b||t.blue||t.B||0]):(n="hsl",s=[t.h||t.hue||t.H||0,t.s||t.saturation||t.S||0,t.l||t.lightness||t.L||t.b||t.brightness]),i=t.a||t.alpha||t.opacity||1,null!=t.opacity&&(i/=100)):(n="rgb",s=[t>>>16,(65280&t)>>>8,255&t]);return{space:n,values:s,alpha:i}}(t);if(!n.space)return[];const s="h"===n.space[0]?Am.min:Sm.min,i="h"===n.space[0]?Am.max:Sm.max;return(e=Array(3))[0]=Math.min(Math.max(n.values[0],s[0]),i[0]),e[1]=Math.min(Math.max(n.values[1],s[1]),i[1]),e[2]=Math.min(Math.max(n.values[2],s[2]),i[2]),"h"===n.space[0]&&(e=Am.rgb(e)),e.push(Math.min(Math.max(n.alpha,0),1)),e}function Im(t){switch(typeof t){case"string":return function(t){const e=Cm(t);if(!e)throw new Error(`Unable to parse color "${t}" as RGBA.`);return[e[0]/255,e[1]/255,e[2]/255,e[3]]}(t);case"number":return Ko(t);default:return t}}function Mm(t){const e=wm(function(t){let e=t.replace(/\s{2,}/gu," ");return e=e.replace(/;/g,""),e=e.replace(/ ,/g,","),e=e.replace(/\( /g,"("),e=e.replace(/ \)/g,")"),e.trim()}(t));if(0===e.length)throw new Error("Invalid CSS gradient.");if(1!==e.length)throw new Error("Unsupported CSS gradient (multiple gradients is not supported).");const n=e[0],s=function(t){const e={"linear-gradient":0,"radial-gradient":1};if(!(t in e))throw new Error(`Unsupported gradient type "${t}"`);return e[t]}(n.type),i=function(t){const e=function(t){const e=[];for(let i=0;i<t.length;i++){const n=t[i];let s=-1;"literal"===n.type&&n.length&&"type"in n.length&&"%"===n.length.type&&"value"in n.length&&(s=parseFloat(n.length.value)/100),e.push(s)}const n=t=>{for(let n=t;n<e.length;n++)if(-1!==e[n])return{indexDelta:n-t,offset:e[n]};return{indexDelta:e.length-1-t,offset:1}};let s=0;for(let i=0;i<e.length;i++){const t=e[i];if(-1!==t)s=t;else if(0===i)e[i]=0;else if(i+1===e.length)e[i]=1;else{const t=n(i),r=(t.offset-s)/(1+t.indexDelta);for(let n=0;n<=t.indexDelta;n++)e[i+n]=s+(n+1)*r;i+=t.indexDelta,s=e[i]}}return e.map(Pm)}(t),n=[];for(let s=0;s<t.length;s++){const i=Rm(t[s]);n.push({offset:e[s],color:i.slice(0,3),alpha:i[3]})}return n}(n.colorStops),r=function(t){if(void 0===t)return 0;if("type"in t&&"value"in t)switch(t.type){case"angular":return parseFloat(t.value);case"directional":return function(t){const e={left:270,top:0,bottom:180,right:90,"left top":315,"top left":315,"left bottom":225,"bottom left":225,"right top":45,"top right":45,"right bottom":135,"bottom right":135};if(!(t in e))throw new Error(`Unsupported directional value "${t}"`);return e[t]}(t.value)}return 0}(n.orientation);return{type:s,stops:i,angle:r}}function Rm(t){return Im(function(t){switch(t.type){case"hex":return`#${t.value}`;case"literal":return t.value;default:return`${t.type}(${t.value.join(",")})`}}(t))}function Pm(t){return t.toString().length>6?parseFloat(t.toString().substring(0,6)):t}Sm.hsl=function(t){var e,n,s=t[0]/255,i=t[1]/255,r=t[2]/255,a=Math.min(s,i,r),o=Math.max(s,i,r),l=o-a;return o===a?e=0:s===o?e=(i-r)/l:i===o?e=2+(r-s)/l:r===o&&(e=4+(s-i)/l),(e=Math.min(60*e,360))<0&&(e+=360),n=(a+o)/2,[e,100*(o===a?0:n<=.5?l/(o+a):l/(2-o-a)),100*n]};var km=Object.defineProperty,Fm=Object.defineProperties,Om=Object.getOwnPropertyDescriptors,Dm=Object.getOwnPropertySymbols,Lm=Object.prototype.hasOwnProperty,Nm=Object.prototype.propertyIsEnumerable,Bm=(t,e,n)=>e in t?km(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Vm=(t,e)=>{for(var n in e||(e={}))Lm.call(e,n)&&Bm(t,n,e[n]);if(Dm)for(var n of Dm(e))Nm.call(e,n)&&Bm(t,n,e[n]);return t};const Um=class extends Gh{constructor(t){t&&"css"in t&&(t=((t,e)=>Fm(t,Om(e)))(Vm({},Mm(t.css||"")),{alpha:t.alpha,maxColors:t.maxColors}));const e=Vm(Vm({},Um.defaults),t);if(!e.stops||e.stops.length<2)throw new Error("ColorGradientFilter requires at least 2 color stops.");super("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvarying vec2 vTextureCoord;\nvarying vec2 vFilterCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n    vFilterCoord = vTextureCoord * inputSize.xy / outputFrame.zw;\n}\n","const float PI = 3.1415926538;\nconst float PI_2 = PI*2.;\n\nvarying vec2 vTextureCoord;\nvarying vec2 vFilterCoord;\nuniform sampler2D uSampler;\n\nconst int TYPE_LINEAR = 0;\nconst int TYPE_RADIAL = 1;\nconst int TYPE_CONIC = 2;\nconst int MAX_STOPS = 32;\n\nuniform int uNumStops;\nuniform float uAlphas[3*MAX_STOPS];\nuniform vec3 uColors[MAX_STOPS];\nuniform float uOffsets[MAX_STOPS];\nuniform int uType;\nuniform float uAngle;\nuniform float uAlpha;\nuniform int uMaxColors;\n\nstruct ColorStop {\n    float offset;\n    vec3 color;\n    float alpha;\n};\n\nmat2 rotate2d(float angle){\n    return mat2(cos(angle), -sin(angle),\n    sin(angle), cos(angle));\n}\n\nfloat projectLinearPosition(vec2 pos, float angle){\n    vec2 center = vec2(0.5);\n    vec2 result = pos - center;\n    result = rotate2d(angle) * result;\n    result = result + center;\n    return clamp(result.x, 0., 1.);\n}\n\nfloat projectRadialPosition(vec2 pos) {\n    float r = distance(vFilterCoord, vec2(0.5));\n    return clamp(2.*r, 0., 1.);\n}\n\nfloat projectAnglePosition(vec2 pos, float angle) {\n    vec2 center = pos - vec2(0.5);\n    float polarAngle=atan(-center.y, center.x);\n    return mod(polarAngle + angle, PI_2) / PI_2;\n}\n\nfloat projectPosition(vec2 pos, int type, float angle) {\n    if (type == TYPE_LINEAR) {\n        return projectLinearPosition(pos, angle);\n    } else if (type == TYPE_RADIAL) {\n        return projectRadialPosition(pos);\n    } else if (type == TYPE_CONIC) {\n        return projectAnglePosition(pos, angle);\n    }\n\n    return pos.y;\n}\n\nvoid main(void) {\n    // current/original color\n    vec4 currentColor = texture2D(uSampler, vTextureCoord);\n\n    // skip calculations if gradient alpha is 0\n    if (0.0 == uAlpha) {\n        gl_FragColor = currentColor;\n        return;\n    }\n\n    // project position\n    float y = projectPosition(vFilterCoord, uType, radians(uAngle));\n\n    // check gradient bounds\n    float offsetMin = uOffsets[0];\n    float offsetMax = 0.0;\n\n    for (int i = 0; i < MAX_STOPS; i++) {\n        if (i == uNumStops-1){ // last index\n            offsetMax = uOffsets[i];\n        }\n    }\n\n    if (y  < offsetMin || y > offsetMax) {\n        gl_FragColor = currentColor;\n        return;\n    }\n\n    // limit colors\n    if (uMaxColors > 0) {\n        float stepSize = 1./float(uMaxColors);\n        float stepNumber = float(floor(y/stepSize));\n        y = stepSize * (stepNumber + 0.5);// offset by 0.5 to use color from middle of segment\n    }\n\n    // find color stops\n    ColorStop from;\n    ColorStop to;\n\n    for (int i = 0; i < MAX_STOPS; i++) {\n        if (y >= uOffsets[i]) {\n            from = ColorStop(uOffsets[i], uColors[i], uAlphas[i]);\n            to = ColorStop(uOffsets[i+1], uColors[i+1], uAlphas[i+1]);\n        }\n\n        if (i == uNumStops-1){ // last index\n            break;\n        }\n    }\n\n    // mix colors from stops\n    vec4 colorFrom = vec4(from.color * from.alpha, from.alpha);\n    vec4 colorTo = vec4(to.color * to.alpha, to.alpha);\n\n    float segmentHeight = to.offset - from.offset;\n    float relativePos = y - from.offset;// position from 0 to [segmentHeight]\n    float relativePercent = relativePos / segmentHeight;// position in percent between [from.offset] and [to.offset].\n\n    float gradientAlpha = uAlpha * currentColor.a;\n    vec4 gradientColor = mix(colorFrom, colorTo, relativePercent) * gradientAlpha;\n\n    // mix resulting color with current color\n    gl_FragColor = gradientColor + currentColor*(1.-gradientColor.a);\n}\n"),this._stops=[],this.autoFit=!1,Object.assign(this,e)}get stops(){return this._stops}set stops(t){const e=function(t){return[...t].sort(((t,e)=>t.offset-e.offset))}(t),n=new Float32Array(3*e.length);for(let s=0;s<e.length;s++){const t=Im(e[s].color),i=3*s;n[i+0]=t[0],n[i+1]=t[1],n[i+2]=t[2]}this.uniforms.uColors=n,this.uniforms.uOffsets=e.map((t=>t.offset)),this.uniforms.uAlphas=e.map((t=>t.alpha)),this.uniforms.uNumStops=e.length,this._stops=e}set type(t){this.uniforms.uType=t}get type(){return this.uniforms.uType}set angle(t){this.uniforms.uAngle=t-90}get angle(){return this.uniforms.uAngle+90}set alpha(t){this.uniforms.uAlpha=t}get alpha(){return this.uniforms.uAlpha}set maxColors(t){this.uniforms.uMaxColors=t}get maxColors(){return this.uniforms.uMaxColors}};let Xm=Um;Xm.LINEAR=0,Xm.RADIAL=1,Xm.CONIC=2,Xm.defaults={type:Um.LINEAR,stops:[{offset:0,color:16711680,alpha:1},{offset:1,color:255,alpha:1}],alpha:1,angle:90,maxColors:0};let Ym=class extends Gh{constructor(t=0,e=1){super("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform vec3 color;\nuniform float alpha;\n\nvoid main(void) {\n    vec4 currentColor = texture2D(uSampler, vTextureCoord);\n    gl_FragColor = vec4(mix(currentColor.rgb, color.rgb, currentColor.a * alpha), currentColor.a);\n}\n"),this._color=0,this._alpha=1,this.uniforms.color=new Float32Array(3),this.color=t,this.alpha=e}set color(t){const e=this.uniforms.color;"number"==typeof t?(Ko(t,e),this._color=t):(e[0]=t[0],e[1]=t[1],e[2]=t[2],this._color=Zo(e))}get color(){return this._color}set alpha(t){this.uniforms.alpha=t,this._alpha=t}get alpha(){return this._alpha}};const Wm=class extends Gh{constructor(t){super("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\n\nuniform vec4 filterArea;\nuniform vec2 dimensions;\n\nconst float SQRT_2 = 1.414213;\n\nconst float light = 1.0;\n\nuniform float curvature;\nuniform float lineWidth;\nuniform float lineContrast;\nuniform bool verticalLine;\nuniform float noise;\nuniform float noiseSize;\n\nuniform float vignetting;\nuniform float vignettingAlpha;\nuniform float vignettingBlur;\n\nuniform float seed;\nuniform float time;\n\nfloat rand(vec2 co) {\n    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);\n}\n\nvoid main(void)\n{\n    vec2 pixelCoord = vTextureCoord.xy * filterArea.xy;\n    vec2 dir = vec2(vTextureCoord.xy * filterArea.xy / dimensions - vec2(0.5, 0.5));\n    \n    gl_FragColor = texture2D(uSampler, vTextureCoord);\n    vec3 rgb = gl_FragColor.rgb;\n\n    if (noise > 0.0 && noiseSize > 0.0)\n    {\n        pixelCoord.x = floor(pixelCoord.x / noiseSize);\n        pixelCoord.y = floor(pixelCoord.y / noiseSize);\n        float _noise = rand(pixelCoord * noiseSize * seed) - 0.5;\n        rgb += _noise * noise;\n    }\n\n    if (lineWidth > 0.0)\n    {\n        float _c = curvature > 0. ? curvature : 1.;\n        float k = curvature > 0. ?(length(dir * dir) * 0.25 * _c * _c + 0.935 * _c) : 1.;\n        vec2 uv = dir * k;\n\n        float v = (verticalLine ? uv.x * dimensions.x : uv.y * dimensions.y) * min(1.0, 2.0 / lineWidth ) / _c;\n        float j = 1. + cos(v * 1.2 - time) * 0.5 * lineContrast;\n        rgb *= j;\n        float segment = verticalLine ? mod((dir.x + .5) * dimensions.x, 4.) : mod((dir.y + .5) * dimensions.y, 4.);\n        rgb *= 0.99 + ceil(segment) * 0.015;\n    }\n\n    if (vignetting > 0.0)\n    {\n        float outter = SQRT_2 - vignetting * SQRT_2;\n        float darker = clamp((outter - length(dir) * SQRT_2) / ( 0.00001 + vignettingBlur * SQRT_2), 0.0, 1.0);\n        rgb *= darker + (1.0 - darker) * (1.0 - vignettingAlpha);\n    }\n\n    gl_FragColor.rgb = rgb;\n}\n"),this.time=0,this.seed=0,this.uniforms.dimensions=new Float32Array(2),Object.assign(this,Wm.defaults,t)}apply(t,e,n,s){const{width:i,height:r}=e.filterFrame;this.uniforms.dimensions[0]=i,this.uniforms.dimensions[1]=r,this.uniforms.seed=this.seed,this.uniforms.time=this.time,t.applyFilter(this,e,n,s)}set curvature(t){this.uniforms.curvature=t}get curvature(){return this.uniforms.curvature}set lineWidth(t){this.uniforms.lineWidth=t}get lineWidth(){return this.uniforms.lineWidth}set lineContrast(t){this.uniforms.lineContrast=t}get lineContrast(){return this.uniforms.lineContrast}set verticalLine(t){this.uniforms.verticalLine=t}get verticalLine(){return this.uniforms.verticalLine}set noise(t){this.uniforms.noise=t}get noise(){return this.uniforms.noise}set noiseSize(t){this.uniforms.noiseSize=t}get noiseSize(){return this.uniforms.noiseSize}set vignetting(t){this.uniforms.vignetting=t}get vignetting(){return this.uniforms.vignetting}set vignettingAlpha(t){this.uniforms.vignettingAlpha=t}get vignettingAlpha(){return this.uniforms.vignettingAlpha}set vignettingBlur(t){this.uniforms.vignettingBlur=t}get vignettingBlur(){return this.uniforms.vignettingBlur}};Wm.defaults={curvature:1,lineWidth:1,lineContrast:.25,verticalLine:!1,noise:0,noiseSize:1,seed:0,vignetting:.3,vignettingAlpha:1,vignettingBlur:.3,time:0};var zm=Object.defineProperty,Gm=Object.getOwnPropertySymbols,Hm=Object.prototype.hasOwnProperty,jm=Object.prototype.propertyIsEnumerable,$m=(t,e,n)=>e in t?zm(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,qm=(t,e)=>{for(var n in e||(e={}))Hm.call(e,n)&&$m(t,n,e[n]);if(Gm)for(var n of Gm(e))jm.call(e,n)&&$m(t,n,e[n]);return t};const Km=class extends Gh{constructor(t){super(),this.angle=45,this._distance=5,this._resolution=zr.FILTER_RESOLUTION;const e=t?qm(qm({},Km.defaults),t):Km.defaults,{kernels:n,blur:s,quality:i,pixelSize:r,resolution:a}=e;this._offset=new uh(this._updatePadding,this),this._tintFilter=new Gh("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform float alpha;\nuniform vec3 color;\n\nuniform vec2 shift;\nuniform vec4 inputSize;\n\nvoid main(void){\n    vec4 sample = texture2D(uSampler, vTextureCoord - shift * inputSize.zw);\n\n    // Premultiply alpha\n    sample.rgb = color.rgb * sample.a;\n\n    // alpha user alpha\n    sample *= alpha;\n\n    gl_FragColor = sample;\n}"),this._tintFilter.uniforms.color=new Float32Array(4),this._tintFilter.uniforms.shift=this._offset,this._tintFilter.resolution=a,this._blurFilter=n?new mm(n):new mm(s,i),this.pixelSize=r,this.resolution=a;const{shadowOnly:o,rotation:l,distance:h,offset:c,alpha:u,color:d}=e;this.shadowOnly=o,void 0!==l&&void 0!==h?(this.rotation=l,this.distance=h):this.offset=c,this.alpha=u,this.color=d}apply(t,e,n,s){const i=t.getFilterTexture();this._tintFilter.apply(t,e,i,1),this._blurFilter.apply(t,i,n,s),!0!==this.shadowOnly&&t.applyFilter(this,e,n,0),t.returnFilterTexture(i)}_updatePadding(){const t=Math.max(Math.abs(this._offset.x),Math.abs(this._offset.y));this.padding=t+2*this.blur}_updateShift(){this._tintFilter.uniforms.shift.set(this.distance*Math.cos(this.angle),this.distance*Math.sin(this.angle))}set offset(t){this._offset.copyFrom(t),this._updatePadding()}get offset(){return this._offset}get resolution(){return this._resolution}set resolution(t){this._resolution=t,this._tintFilter&&(this._tintFilter.resolution=t),this._blurFilter&&(this._blurFilter.resolution=t)}get distance(){return this._distance}set distance(t){vo("5.3.0","DropShadowFilter distance is deprecated, use offset"),this._distance=t,this._updatePadding(),this._updateShift()}get rotation(){return this.angle/jl}set rotation(t){vo("5.3.0","DropShadowFilter rotation is deprecated, use offset"),this.angle=t*jl,this._updateShift()}get alpha(){return this._tintFilter.uniforms.alpha}set alpha(t){this._tintFilter.uniforms.alpha=t}get color(){return Zo(this._tintFilter.uniforms.color)}set color(t){Ko(t,this._tintFilter.uniforms.color)}get kernels(){return this._blurFilter.kernels}set kernels(t){this._blurFilter.kernels=t}get blur(){return this._blurFilter.blur}set blur(t){this._blurFilter.blur=t,this._updatePadding()}get quality(){return this._blurFilter.quality}set quality(t){this._blurFilter.quality=t}get pixelSize(){return this._blurFilter.pixelSize}set pixelSize(t){this._blurFilter.pixelSize=t}};Km.defaults={offset:{x:4,y:4},color:0,alpha:.5,shadowOnly:!1,kernels:null,blur:2,quality:3,pixelSize:1,resolution:zr.FILTER_RESOLUTION};const Zm=class extends Gh{constructor(t){super("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","// precision highp float;\n\nvarying vec2 vTextureCoord;\nuniform sampler2D uSampler;\n\nuniform vec4 filterArea;\nuniform vec4 filterClamp;\nuniform vec2 dimensions;\nuniform float aspect;\n\nuniform sampler2D displacementMap;\nuniform float offset;\nuniform float sinDir;\nuniform float cosDir;\nuniform int fillMode;\n\nuniform float seed;\nuniform vec2 red;\nuniform vec2 green;\nuniform vec2 blue;\n\nconst int TRANSPARENT = 0;\nconst int ORIGINAL = 1;\nconst int LOOP = 2;\nconst int CLAMP = 3;\nconst int MIRROR = 4;\n\nvoid main(void)\n{\n    vec2 coord = (vTextureCoord * filterArea.xy) / dimensions;\n\n    if (coord.x > 1.0 || coord.y > 1.0) {\n        return;\n    }\n\n    float cx = coord.x - 0.5;\n    float cy = (coord.y - 0.5) * aspect;\n    float ny = (-sinDir * cx + cosDir * cy) / aspect + 0.5;\n\n    // displacementMap: repeat\n    // ny = ny > 1.0 ? ny - 1.0 : (ny < 0.0 ? 1.0 + ny : ny);\n\n    // displacementMap: mirror\n    ny = ny > 1.0 ? 2.0 - ny : (ny < 0.0 ? -ny : ny);\n\n    vec4 dc = texture2D(displacementMap, vec2(0.5, ny));\n\n    float displacement = (dc.r - dc.g) * (offset / filterArea.x);\n\n    coord = vTextureCoord + vec2(cosDir * displacement, sinDir * displacement * aspect);\n\n    if (fillMode == CLAMP) {\n        coord = clamp(coord, filterClamp.xy, filterClamp.zw);\n    } else {\n        if( coord.x > filterClamp.z ) {\n            if (fillMode == TRANSPARENT) {\n                discard;\n            } else if (fillMode == LOOP) {\n                coord.x -= filterClamp.z;\n            } else if (fillMode == MIRROR) {\n                coord.x = filterClamp.z * 2.0 - coord.x;\n            }\n        } else if( coord.x < filterClamp.x ) {\n            if (fillMode == TRANSPARENT) {\n                discard;\n            } else if (fillMode == LOOP) {\n                coord.x += filterClamp.z;\n            } else if (fillMode == MIRROR) {\n                coord.x *= -filterClamp.z;\n            }\n        }\n\n        if( coord.y > filterClamp.w ) {\n            if (fillMode == TRANSPARENT) {\n                discard;\n            } else if (fillMode == LOOP) {\n                coord.y -= filterClamp.w;\n            } else if (fillMode == MIRROR) {\n                coord.y = filterClamp.w * 2.0 - coord.y;\n            }\n        } else if( coord.y < filterClamp.y ) {\n            if (fillMode == TRANSPARENT) {\n                discard;\n            } else if (fillMode == LOOP) {\n                coord.y += filterClamp.w;\n            } else if (fillMode == MIRROR) {\n                coord.y *= -filterClamp.w;\n            }\n        }\n    }\n\n    gl_FragColor.r = texture2D(uSampler, coord + red * (1.0 - seed * 0.4) / filterArea.xy).r;\n    gl_FragColor.g = texture2D(uSampler, coord + green * (1.0 - seed * 0.3) / filterArea.xy).g;\n    gl_FragColor.b = texture2D(uSampler, coord + blue * (1.0 - seed * 0.2) / filterArea.xy).b;\n    gl_FragColor.a = texture2D(uSampler, coord).a;\n}\n"),this.offset=100,this.fillMode=Zm.TRANSPARENT,this.average=!1,this.seed=0,this.minSize=8,this.sampleSize=512,this._slices=0,this._offsets=new Float32Array(1),this._sizes=new Float32Array(1),this._direction=-1,this.uniforms.dimensions=new Float32Array(2),this._canvas=document.createElement("canvas"),this._canvas.width=4,this._canvas.height=this.sampleSize,this.texture=ic.from(this._canvas,{scaleMode:Or.NEAREST}),Object.assign(this,Zm.defaults,t)}apply(t,e,n,s){const{width:i,height:r}=e.filterFrame;this.uniforms.dimensions[0]=i,this.uniforms.dimensions[1]=r,this.uniforms.aspect=r/i,this.uniforms.seed=this.seed,this.uniforms.offset=this.offset,this.uniforms.fillMode=this.fillMode,t.applyFilter(this,e,n,s)}_randomizeSizes(){const t=this._sizes,e=this._slices-1,n=this.sampleSize,s=Math.min(this.minSize/n,.9/this._slices);if(this.average){const n=this._slices;let i=1;for(let r=0;r<e;r++){const e=i/(n-r),a=Math.max(e*(1-.6*Math.random()),s);t[r]=a,i-=a}t[e]=i}else{let n=1;const i=Math.sqrt(1/this._slices);for(let r=0;r<e;r++){const e=Math.max(i*n*Math.random(),s);t[r]=e,n-=e}t[e]=n}this.shuffle()}shuffle(){const t=this._sizes;for(let e=this._slices-1;e>0;e--){const n=Math.random()*e>>0,s=t[e];t[e]=t[n],t[n]=s}}_randomizeOffsets(){for(let t=0;t<this._slices;t++)this._offsets[t]=Math.random()*(Math.random()<.5?-1:1)}refresh(){this._randomizeSizes(),this._randomizeOffsets(),this.redraw()}redraw(){const t=this.sampleSize,e=this.texture,n=this._canvas.getContext("2d");n.clearRect(0,0,8,t);let s,i=0;for(let r=0;r<this._slices;r++){s=Math.floor(256*this._offsets[r]);const e=this._sizes[r]*t,a=s>0?s:0,o=s<0?-s:0;n.fillStyle=`rgba(${a}, ${o}, 0, 1)`,n.fillRect(0,i>>0,t,e+1>>0),i+=e}e.baseTexture.update(),this.uniforms.displacementMap=e}set sizes(t){const e=Math.min(this._slices,t.length);for(let n=0;n<e;n++)this._sizes[n]=t[n]}get sizes(){return this._sizes}set offsets(t){const e=Math.min(this._slices,t.length);for(let n=0;n<e;n++)this._offsets[n]=t[n]}get offsets(){return this._offsets}get slices(){return this._slices}set slices(t){this._slices!==t&&(this._slices=t,this.uniforms.slices=t,this._sizes=this.uniforms.slicesWidth=new Float32Array(t),this._offsets=this.uniforms.slicesOffset=new Float32Array(t),this.refresh())}get direction(){return this._direction}set direction(t){if(this._direction===t)return;this._direction=t;const e=t*jl;this.uniforms.sinDir=Math.sin(e),this.uniforms.cosDir=Math.cos(e)}get red(){return this.uniforms.red}set red(t){this.uniforms.red=t}get green(){return this.uniforms.green}set green(t){this.uniforms.green=t}get blue(){return this.uniforms.blue}set blue(t){this.uniforms.blue=t}destroy(){var t;null==(t=this.texture)||t.destroy(!0),this.texture=this._canvas=this.red=this.green=this.blue=this._sizes=this._offsets=null}};let Qm=Zm;Qm.defaults={slices:5,offset:100,direction:0,fillMode:0,average:!1,seed:0,red:[0,0],green:[0,0],blue:[0,0],minSize:8,sampleSize:512},Qm.TRANSPARENT=0,Qm.ORIGINAL=1,Qm.LOOP=2,Qm.CLAMP=3,Qm.MIRROR=4;var Jm="varying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform sampler2D uSampler;\n\nuniform float outerStrength;\nuniform float innerStrength;\n\nuniform vec4 glowColor;\n\nuniform vec4 filterArea;\nuniform vec4 filterClamp;\nuniform bool knockout;\nuniform float alpha;\n\nconst float PI = 3.14159265358979323846264;\n\nconst float DIST = __DIST__;\nconst float ANGLE_STEP_SIZE = min(__ANGLE_STEP_SIZE__, PI * 2.0);\nconst float ANGLE_STEP_NUM = ceil(PI * 2.0 / ANGLE_STEP_SIZE);\n\nconst float MAX_TOTAL_ALPHA = ANGLE_STEP_NUM * DIST * (DIST + 1.0) / 2.0;\n\nvoid main(void) {\n    vec2 px = vec2(1.0 / filterArea.x, 1.0 / filterArea.y);\n\n    float totalAlpha = 0.0;\n\n    vec2 direction;\n    vec2 displaced;\n    vec4 curColor;\n\n    for (float angle = 0.0; angle < PI * 2.0; angle += ANGLE_STEP_SIZE) {\n       direction = vec2(cos(angle), sin(angle)) * px;\n\n       for (float curDistance = 0.0; curDistance < DIST; curDistance++) {\n           displaced = clamp(vTextureCoord + direction * \n                   (curDistance + 1.0), filterClamp.xy, filterClamp.zw);\n\n           curColor = texture2D(uSampler, displaced);\n\n           totalAlpha += (DIST - curDistance) * curColor.a;\n       }\n    }\n    \n    curColor = texture2D(uSampler, vTextureCoord);\n\n    float alphaRatio = (totalAlpha / MAX_TOTAL_ALPHA);\n\n    float innerGlowAlpha = (1.0 - alphaRatio) * innerStrength * curColor.a;\n    float innerGlowStrength = min(1.0, innerGlowAlpha);\n    \n    vec4 innerColor = mix(curColor, glowColor, innerGlowStrength);\n\n    float outerGlowAlpha = alphaRatio * outerStrength * (1. - curColor.a);\n    float outerGlowStrength = min(1.0 - innerColor.a, outerGlowAlpha);\n\n    if (knockout) {\n      float resultAlpha = (outerGlowAlpha + innerGlowAlpha) * alpha;\n      gl_FragColor = vec4(glowColor.rgb * resultAlpha, resultAlpha);\n    }\n    else {\n      vec4 outerGlowColor = outerGlowStrength * glowColor.rgba * alpha;\n      gl_FragColor = innerColor + outerGlowColor;\n    }\n}\n";const tg=class extends Gh{constructor(t){const e=Object.assign({},tg.defaults,t),{outerStrength:n,innerStrength:s,color:i,knockout:r,quality:a,alpha:o}=e,l=Math.round(e.distance);super("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}",Jm.replace(/__ANGLE_STEP_SIZE__/gi,`${(1/a/l).toFixed(7)}`).replace(/__DIST__/gi,`${l.toFixed(0)}.0`)),this.uniforms.glowColor=new Float32Array([0,0,0,1]),this.uniforms.alpha=1,Object.assign(this,{color:i,outerStrength:n,innerStrength:s,padding:l,knockout:r,alpha:o})}get color(){return Zo(this.uniforms.glowColor)}set color(t){Ko(t,this.uniforms.glowColor)}get outerStrength(){return this.uniforms.outerStrength}set outerStrength(t){this.uniforms.outerStrength=t}get innerStrength(){return this.uniforms.innerStrength}set innerStrength(t){this.uniforms.innerStrength=t}get knockout(){return this.uniforms.knockout}set knockout(t){this.uniforms.knockout=t}get alpha(){return this.uniforms.alpha}set alpha(t){this.uniforms.alpha=t}};tg.defaults={distance:10,outerStrength:4,innerStrength:0,color:16777215,quality:.1,knockout:!1,alpha:1};var eg="varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform vec4 filterArea;\nuniform vec2 dimensions;\n\nuniform vec2 light;\nuniform bool parallel;\nuniform float aspect;\n\nuniform float gain;\nuniform float lacunarity;\nuniform float time;\nuniform float alpha;\n\n${perlin}\n\nvoid main(void) {\n    vec2 coord = vTextureCoord * filterArea.xy / dimensions.xy;\n\n    float d;\n\n    if (parallel) {\n        float _cos = light.x;\n        float _sin = light.y;\n        d = (_cos * coord.x) + (_sin * coord.y * aspect);\n    } else {\n        float dx = coord.x - light.x / dimensions.x;\n        float dy = (coord.y - light.y / dimensions.y) * aspect;\n        float dis = sqrt(dx * dx + dy * dy) + 0.00001;\n        d = dy / dis;\n    }\n\n    vec3 dir = vec3(d, d, 0.0);\n\n    float noise = turb(dir + vec3(time, 0.0, 62.1 + time) * 0.05, vec3(480.0, 320.0, 480.0), lacunarity, gain);\n    noise = mix(noise, 0.0, 0.3);\n    //fade vertically.\n    vec4 mist = vec4(noise, noise, noise, 1.0) * (1.0 - coord.y);\n    mist.a = 1.0;\n    // apply user alpha\n    mist *= alpha;\n\n    gl_FragColor = texture2D(uSampler, vTextureCoord) + mist;\n\n}\n";const ng=class extends Gh{constructor(t){super("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}",eg.replace("${perlin}","vec3 mod289(vec3 x)\n{\n    return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\nvec4 mod289(vec4 x)\n{\n    return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\nvec4 permute(vec4 x)\n{\n    return mod289(((x * 34.0) + 1.0) * x);\n}\nvec4 taylorInvSqrt(vec4 r)\n{\n    return 1.79284291400159 - 0.85373472095314 * r;\n}\nvec3 fade(vec3 t)\n{\n    return t * t * t * (t * (t * 6.0 - 15.0) + 10.0);\n}\n// Classic Perlin noise, periodic variant\nfloat pnoise(vec3 P, vec3 rep)\n{\n    vec3 Pi0 = mod(floor(P), rep); // Integer part, modulo period\n    vec3 Pi1 = mod(Pi0 + vec3(1.0), rep); // Integer part + 1, mod period\n    Pi0 = mod289(Pi0);\n    Pi1 = mod289(Pi1);\n    vec3 Pf0 = fract(P); // Fractional part for interpolation\n    vec3 Pf1 = Pf0 - vec3(1.0); // Fractional part - 1.0\n    vec4 ix = vec4(Pi0.x, Pi1.x, Pi0.x, Pi1.x);\n    vec4 iy = vec4(Pi0.yy, Pi1.yy);\n    vec4 iz0 = Pi0.zzzz;\n    vec4 iz1 = Pi1.zzzz;\n    vec4 ixy = permute(permute(ix) + iy);\n    vec4 ixy0 = permute(ixy + iz0);\n    vec4 ixy1 = permute(ixy + iz1);\n    vec4 gx0 = ixy0 * (1.0 / 7.0);\n    vec4 gy0 = fract(floor(gx0) * (1.0 / 7.0)) - 0.5;\n    gx0 = fract(gx0);\n    vec4 gz0 = vec4(0.5) - abs(gx0) - abs(gy0);\n    vec4 sz0 = step(gz0, vec4(0.0));\n    gx0 -= sz0 * (step(0.0, gx0) - 0.5);\n    gy0 -= sz0 * (step(0.0, gy0) - 0.5);\n    vec4 gx1 = ixy1 * (1.0 / 7.0);\n    vec4 gy1 = fract(floor(gx1) * (1.0 / 7.0)) - 0.5;\n    gx1 = fract(gx1);\n    vec4 gz1 = vec4(0.5) - abs(gx1) - abs(gy1);\n    vec4 sz1 = step(gz1, vec4(0.0));\n    gx1 -= sz1 * (step(0.0, gx1) - 0.5);\n    gy1 -= sz1 * (step(0.0, gy1) - 0.5);\n    vec3 g000 = vec3(gx0.x, gy0.x, gz0.x);\n    vec3 g100 = vec3(gx0.y, gy0.y, gz0.y);\n    vec3 g010 = vec3(gx0.z, gy0.z, gz0.z);\n    vec3 g110 = vec3(gx0.w, gy0.w, gz0.w);\n    vec3 g001 = vec3(gx1.x, gy1.x, gz1.x);\n    vec3 g101 = vec3(gx1.y, gy1.y, gz1.y);\n    vec3 g011 = vec3(gx1.z, gy1.z, gz1.z);\n    vec3 g111 = vec3(gx1.w, gy1.w, gz1.w);\n    vec4 norm0 = taylorInvSqrt(vec4(dot(g000, g000), dot(g010, g010), dot(g100, g100), dot(g110, g110)));\n    g000 *= norm0.x;\n    g010 *= norm0.y;\n    g100 *= norm0.z;\n    g110 *= norm0.w;\n    vec4 norm1 = taylorInvSqrt(vec4(dot(g001, g001), dot(g011, g011), dot(g101, g101), dot(g111, g111)));\n    g001 *= norm1.x;\n    g011 *= norm1.y;\n    g101 *= norm1.z;\n    g111 *= norm1.w;\n    float n000 = dot(g000, Pf0);\n    float n100 = dot(g100, vec3(Pf1.x, Pf0.yz));\n    float n010 = dot(g010, vec3(Pf0.x, Pf1.y, Pf0.z));\n    float n110 = dot(g110, vec3(Pf1.xy, Pf0.z));\n    float n001 = dot(g001, vec3(Pf0.xy, Pf1.z));\n    float n101 = dot(g101, vec3(Pf1.x, Pf0.y, Pf1.z));\n    float n011 = dot(g011, vec3(Pf0.x, Pf1.yz));\n    float n111 = dot(g111, Pf1);\n    vec3 fade_xyz = fade(Pf0);\n    vec4 n_z = mix(vec4(n000, n100, n010, n110), vec4(n001, n101, n011, n111), fade_xyz.z);\n    vec2 n_yz = mix(n_z.xy, n_z.zw, fade_xyz.y);\n    float n_xyz = mix(n_yz.x, n_yz.y, fade_xyz.x);\n    return 2.2 * n_xyz;\n}\nfloat turb(vec3 P, vec3 rep, float lacunarity, float gain)\n{\n    float sum = 0.0;\n    float sc = 1.0;\n    float totalgain = 1.0;\n    for (float i = 0.0; i < 6.0; i++)\n    {\n        sum += totalgain * pnoise(P * sc, rep);\n        sc *= lacunarity;\n        totalgain *= gain;\n    }\n    return abs(sum);\n}\n")),this.parallel=!0,this.time=0,this._angle=0,this.uniforms.dimensions=new Float32Array(2);const e=Object.assign(ng.defaults,t);this._angleLight=new ql,this.angle=e.angle,this.gain=e.gain,this.lacunarity=e.lacunarity,this.alpha=e.alpha,this.parallel=e.parallel,this.center=e.center,this.time=e.time}apply(t,e,n,s){const{width:i,height:r}=e.filterFrame;this.uniforms.light=this.parallel?this._angleLight:this.center,this.uniforms.parallel=this.parallel,this.uniforms.dimensions[0]=i,this.uniforms.dimensions[1]=r,this.uniforms.aspect=r/i,this.uniforms.time=this.time,this.uniforms.alpha=this.alpha,t.applyFilter(this,e,n,s)}get angle(){return this._angle}set angle(t){this._angle=t;const e=t*jl;this._angleLight.x=Math.cos(e),this._angleLight.y=Math.sin(e)}get gain(){return this.uniforms.gain}set gain(t){this.uniforms.gain=t}get lacunarity(){return this.uniforms.lacunarity}set lacunarity(t){this.uniforms.lacunarity=t}get alpha(){return this.uniforms.alpha}set alpha(t){this.uniforms.alpha=t}};ng.defaults={angle:30,gain:.5,lacunarity:2.5,time:0,parallel:!0,center:[0,0],alpha:1};const sg=class extends Gh{constructor(t){super("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","precision mediump float;\n\nvarying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform float uHue;\nuniform float uAlpha;\nuniform bool uColorize;\nuniform float uSaturation;\nuniform float uLightness;\n\n// https://en.wikipedia.org/wiki/Luma_(video)\nconst vec3 weight = vec3(0.299, 0.587, 0.114);\n\nfloat getWeightedAverage(vec3 rgb) {\n    return rgb.r * weight.r + rgb.g * weight.g + rgb.b * weight.b;\n}\n\n// https://gist.github.com/mairod/a75e7b44f68110e1576d77419d608786?permalink_comment_id=3195243#gistcomment-3195243\nconst vec3 k = vec3(0.57735, 0.57735, 0.57735);\n\nvec3 hueShift(vec3 color, float angle) {\n    float cosAngle = cos(angle);\n    return vec3(\n    color * cosAngle +\n    cross(k, color) * sin(angle) +\n    k * dot(k, color) * (1.0 - cosAngle)\n    );\n}\n\nvoid main()\n{\n    vec4 color = texture2D(uSampler, vTextureCoord);\n    vec4 result = color;\n\n    // colorize\n    if (uColorize) {\n        result.rgb = vec3(getWeightedAverage(result.rgb), 0., 0.);\n    }\n\n    // hue\n    result.rgb = hueShift(result.rgb, uHue);\n\n    // saturation\n    // https://github.com/evanw/glfx.js/blob/master/src/filters/adjust/huesaturation.js\n    float average = (result.r + result.g + result.b) / 3.0;\n\n    if (uSaturation > 0.) {\n        result.rgb += (average - result.rgb) * (1. - 1. / (1.001 - uSaturation));\n    } else {\n        result.rgb -= (average - result.rgb) * uSaturation;\n    }\n\n    // lightness\n    result.rgb = mix(result.rgb, vec3(ceil(uLightness)) * color.a, abs(uLightness));\n\n    // alpha\n    gl_FragColor = mix(color, result, uAlpha);\n}\n"),this._hue=0;const e=Object.assign({},sg.defaults,t);Object.assign(this,e)}get hue(){return this._hue}set hue(t){this._hue=t,this.uniforms.uHue=this._hue*(Math.PI/180)}get alpha(){return this.uniforms.uAlpha}set alpha(t){this.uniforms.uAlpha=t}get colorize(){return this.uniforms.uColorize}set colorize(t){this.uniforms.uColorize=t}get lightness(){return this.uniforms.uLightness}set lightness(t){this.uniforms.uLightness=t}get saturation(){return this.uniforms.uSaturation}set saturation(t){this.uniforms.uSaturation=t}};sg.defaults={hue:0,saturation:0,lightness:0,colorize:!1,alpha:1};const ig=class extends Gh{constructor(t,e=0){super("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform vec4 filterArea;\nuniform vec2 dimensions;\n\nuniform float sepia;\nuniform float noise;\nuniform float noiseSize;\nuniform float scratch;\nuniform float scratchDensity;\nuniform float scratchWidth;\nuniform float vignetting;\nuniform float vignettingAlpha;\nuniform float vignettingBlur;\nuniform float seed;\n\nconst float SQRT_2 = 1.414213;\nconst vec3 SEPIA_RGB = vec3(112.0 / 255.0, 66.0 / 255.0, 20.0 / 255.0);\n\nfloat rand(vec2 co) {\n    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);\n}\n\nvec3 Overlay(vec3 src, vec3 dst)\n{\n    // if (dst <= 0.5) then: 2 * src * dst\n    // if (dst > 0.5) then: 1 - 2 * (1 - dst) * (1 - src)\n    return vec3((dst.x <= 0.5) ? (2.0 * src.x * dst.x) : (1.0 - 2.0 * (1.0 - dst.x) * (1.0 - src.x)),\n                (dst.y <= 0.5) ? (2.0 * src.y * dst.y) : (1.0 - 2.0 * (1.0 - dst.y) * (1.0 - src.y)),\n                (dst.z <= 0.5) ? (2.0 * src.z * dst.z) : (1.0 - 2.0 * (1.0 - dst.z) * (1.0 - src.z)));\n}\n\n\nvoid main()\n{\n    gl_FragColor = texture2D(uSampler, vTextureCoord);\n    vec3 color = gl_FragColor.rgb;\n\n    if (sepia > 0.0)\n    {\n        float gray = (color.x + color.y + color.z) / 3.0;\n        vec3 grayscale = vec3(gray);\n\n        color = Overlay(SEPIA_RGB, grayscale);\n\n        color = grayscale + sepia * (color - grayscale);\n    }\n\n    vec2 coord = vTextureCoord * filterArea.xy / dimensions.xy;\n\n    if (vignetting > 0.0)\n    {\n        float outter = SQRT_2 - vignetting * SQRT_2;\n        vec2 dir = vec2(vec2(0.5, 0.5) - coord);\n        dir.y *= dimensions.y / dimensions.x;\n        float darker = clamp((outter - length(dir) * SQRT_2) / ( 0.00001 + vignettingBlur * SQRT_2), 0.0, 1.0);\n        color.rgb *= darker + (1.0 - darker) * (1.0 - vignettingAlpha);\n    }\n\n    if (scratchDensity > seed && scratch != 0.0)\n    {\n        float phase = seed * 256.0;\n        float s = mod(floor(phase), 2.0);\n        float dist = 1.0 / scratchDensity;\n        float d = distance(coord, vec2(seed * dist, abs(s - seed * dist)));\n        if (d < seed * 0.6 + 0.4)\n        {\n            highp float period = scratchDensity * 10.0;\n\n            float xx = coord.x * period + phase;\n            float aa = abs(mod(xx, 0.5) * 4.0);\n            float bb = mod(floor(xx / 0.5), 2.0);\n            float yy = (1.0 - bb) * aa + bb * (2.0 - aa);\n\n            float kk = 2.0 * period;\n            float dw = scratchWidth / dimensions.x * (0.75 + seed);\n            float dh = dw * kk;\n\n            float tine = (yy - (2.0 - dh));\n\n            if (tine > 0.0) {\n                float _sign = sign(scratch);\n\n                tine = s * tine / period + scratch + 0.1;\n                tine = clamp(tine + 1.0, 0.5 + _sign * 0.5, 1.5 + _sign * 0.5);\n\n                color.rgb *= tine;\n            }\n        }\n    }\n\n    if (noise > 0.0 && noiseSize > 0.0)\n    {\n        vec2 pixelCoord = vTextureCoord.xy * filterArea.xy;\n        pixelCoord.x = floor(pixelCoord.x / noiseSize);\n        pixelCoord.y = floor(pixelCoord.y / noiseSize);\n        // vec2 d = pixelCoord * noiseSize * vec2(1024.0 + seed * 512.0, 1024.0 - seed * 512.0);\n        // float _noise = snoise(d) * 0.5;\n        float _noise = rand(pixelCoord * noiseSize * seed) - 0.5;\n        color += _noise * noise;\n    }\n\n    gl_FragColor.rgb = color;\n}\n"),this.seed=0,this.uniforms.dimensions=new Float32Array(2),"number"==typeof t?(this.seed=t,t=void 0):this.seed=e,Object.assign(this,ig.defaults,t)}apply(t,e,n,s){var i,r;this.uniforms.dimensions[0]=null==(i=e.filterFrame)?void 0:i.width,this.uniforms.dimensions[1]=null==(r=e.filterFrame)?void 0:r.height,this.uniforms.seed=this.seed,t.applyFilter(this,e,n,s)}set sepia(t){this.uniforms.sepia=t}get sepia(){return this.uniforms.sepia}set noise(t){this.uniforms.noise=t}get noise(){return this.uniforms.noise}set noiseSize(t){this.uniforms.noiseSize=t}get noiseSize(){return this.uniforms.noiseSize}set scratch(t){this.uniforms.scratch=t}get scratch(){return this.uniforms.scratch}set scratchDensity(t){this.uniforms.scratchDensity=t}get scratchDensity(){return this.uniforms.scratchDensity}set scratchWidth(t){this.uniforms.scratchWidth=t}get scratchWidth(){return this.uniforms.scratchWidth}set vignetting(t){this.uniforms.vignetting=t}get vignetting(){return this.uniforms.vignetting}set vignettingAlpha(t){this.uniforms.vignettingAlpha=t}get vignettingAlpha(){return this.uniforms.vignettingAlpha}set vignettingBlur(t){this.uniforms.vignettingBlur=t}get vignettingBlur(){return this.uniforms.vignettingBlur}};ig.defaults={sepia:.3,noise:.3,noiseSize:1,scratch:.5,scratchDensity:.3,scratchWidth:1,vignetting:.3,vignettingAlpha:1,vignettingBlur:.3};var rg="varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform vec4 filterClamp;\n\nuniform float uAlpha;\nuniform vec2 uThickness;\nuniform vec4 uColor;\nuniform bool uKnockout;\n\nconst float DOUBLE_PI = 2. * 3.14159265358979323846264;\nconst float ANGLE_STEP = ${angleStep};\n\nfloat outlineMaxAlphaAtPos(vec2 pos) {\n    if (uThickness.x == 0. || uThickness.y == 0.) {\n        return 0.;\n    }\n\n    vec4 displacedColor;\n    vec2 displacedPos;\n    float maxAlpha = 0.;\n\n    for (float angle = 0.; angle <= DOUBLE_PI; angle += ANGLE_STEP) {\n        displacedPos.x = vTextureCoord.x + uThickness.x * cos(angle);\n        displacedPos.y = vTextureCoord.y + uThickness.y * sin(angle);\n        displacedColor = texture2D(uSampler, clamp(displacedPos, filterClamp.xy, filterClamp.zw));\n        maxAlpha = max(maxAlpha, displacedColor.a);\n    }\n\n    return maxAlpha;\n}\n\nvoid main(void) {\n    vec4 sourceColor = texture2D(uSampler, vTextureCoord);\n    vec4 contentColor = sourceColor * float(!uKnockout);\n    float outlineAlpha = uAlpha * outlineMaxAlphaAtPos(vTextureCoord.xy) * (1.-sourceColor.a);\n    vec4 outlineColor = vec4(vec3(uColor) * outlineAlpha, outlineAlpha);\n    gl_FragColor = contentColor + outlineColor;\n}\n";const ag=class extends Gh{constructor(t=1,e=0,n=.1,s=1,i=!1){super("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}",rg.replace(/\$\{angleStep\}/,ag.getAngleStep(n))),this._thickness=1,this._alpha=1,this._knockout=!1,this.uniforms.uThickness=new Float32Array([0,0]),this.uniforms.uColor=new Float32Array([0,0,0,1]),this.uniforms.uAlpha=s,this.uniforms.uKnockout=i,Object.assign(this,{thickness:t,color:e,quality:n,alpha:s,knockout:i})}static getAngleStep(t){const e=Math.max(t*ag.MAX_SAMPLES,ag.MIN_SAMPLES);return(2*Math.PI/e).toFixed(7)}apply(t,e,n,s){this.uniforms.uThickness[0]=this._thickness/e._frame.width,this.uniforms.uThickness[1]=this._thickness/e._frame.height,this.uniforms.uAlpha=this._alpha,this.uniforms.uKnockout=this._knockout,t.applyFilter(this,e,n,s)}get alpha(){return this._alpha}set alpha(t){this._alpha=t}get color(){return Zo(this.uniforms.uColor)}set color(t){Ko(t,this.uniforms.uColor)}get knockout(){return this._knockout}set knockout(t){this._knockout=t}get thickness(){return this._thickness}set thickness(t){this._thickness=t,this.padding=t}};let og=ag;og.MIN_SAMPLES=1,og.MAX_SAMPLES=100;const lg=class extends Gh{constructor(t){super("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\n\nuniform vec4 filterArea;\nuniform vec4 filterClamp;\nuniform vec2 dimensions;\n\nuniform bool mirror;\nuniform float boundary;\nuniform vec2 amplitude;\nuniform vec2 waveLength;\nuniform vec2 alpha;\nuniform float time;\n\nfloat rand(vec2 co) {\n    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);\n}\n\nvoid main(void)\n{\n    vec2 pixelCoord = vTextureCoord.xy * filterArea.xy;\n    vec2 coord = pixelCoord / dimensions;\n\n    if (coord.y < boundary) {\n        gl_FragColor = texture2D(uSampler, vTextureCoord);\n        return;\n    }\n\n    float k = (coord.y - boundary) / (1. - boundary + 0.0001);\n    float areaY = boundary * dimensions.y / filterArea.y;\n    float v = areaY + areaY - vTextureCoord.y;\n    float y = mirror ? v : vTextureCoord.y;\n\n    float _amplitude = ((amplitude.y - amplitude.x) * k + amplitude.x ) / filterArea.x;\n    float _waveLength = ((waveLength.y - waveLength.x) * k + waveLength.x) / filterArea.y;\n    float _alpha = (alpha.y - alpha.x) * k + alpha.x;\n\n    float x = vTextureCoord.x + cos(v * 6.28 / _waveLength - time) * _amplitude;\n    x = clamp(x, filterClamp.x, filterClamp.z);\n\n    vec4 color = texture2D(uSampler, vec2(x, y));\n\n    gl_FragColor = color * _alpha;\n}\n"),this.time=0,this.uniforms.amplitude=new Float32Array(2),this.uniforms.waveLength=new Float32Array(2),this.uniforms.alpha=new Float32Array(2),this.uniforms.dimensions=new Float32Array(2),Object.assign(this,lg.defaults,t)}apply(t,e,n,s){var i,r;this.uniforms.dimensions[0]=null==(i=e.filterFrame)?void 0:i.width,this.uniforms.dimensions[1]=null==(r=e.filterFrame)?void 0:r.height,this.uniforms.time=this.time,t.applyFilter(this,e,n,s)}set mirror(t){this.uniforms.mirror=t}get mirror(){return this.uniforms.mirror}set boundary(t){this.uniforms.boundary=t}get boundary(){return this.uniforms.boundary}set amplitude(t){this.uniforms.amplitude[0]=t[0],this.uniforms.amplitude[1]=t[1]}get amplitude(){return this.uniforms.amplitude}set waveLength(t){this.uniforms.waveLength[0]=t[0],this.uniforms.waveLength[1]=t[1]}get waveLength(){return this.uniforms.waveLength}set alpha(t){this.uniforms.alpha[0]=t[0],this.uniforms.alpha[1]=t[1]}get alpha(){return this.uniforms.alpha}};lg.defaults={mirror:!0,boundary:.5,amplitude:[0,20],waveLength:[30,100],alpha:[1,1],time:0};const hg=class extends Gh{constructor(t=[0,0],e,n=0){super("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform vec4 filterArea;\nuniform vec4 filterClamp;\n\nuniform vec2 center;\n\nuniform float amplitude;\nuniform float wavelength;\n// uniform float power;\nuniform float brightness;\nuniform float speed;\nuniform float radius;\n\nuniform float time;\n\nconst float PI = 3.14159;\n\nvoid main()\n{\n    float halfWavelength = wavelength * 0.5 / filterArea.x;\n    float maxRadius = radius / filterArea.x;\n    float currentRadius = time * speed / filterArea.x;\n\n    float fade = 1.0;\n\n    if (maxRadius > 0.0) {\n        if (currentRadius > maxRadius) {\n            gl_FragColor = texture2D(uSampler, vTextureCoord);\n            return;\n        }\n        fade = 1.0 - pow(currentRadius / maxRadius, 2.0);\n    }\n\n    vec2 dir = vec2(vTextureCoord - center / filterArea.xy);\n    dir.y *= filterArea.y / filterArea.x;\n    float dist = length(dir);\n\n    if (dist <= 0.0 || dist < currentRadius - halfWavelength || dist > currentRadius + halfWavelength) {\n        gl_FragColor = texture2D(uSampler, vTextureCoord);\n        return;\n    }\n\n    vec2 diffUV = normalize(dir);\n\n    float diff = (dist - currentRadius) / halfWavelength;\n\n    float p = 1.0 - pow(abs(diff), 2.0);\n\n    // float powDiff = diff * pow(p, 2.0) * ( amplitude * fade );\n    float powDiff = 1.25 * sin(diff * PI) * p * ( amplitude * fade );\n\n    vec2 offset = diffUV * powDiff / filterArea.xy;\n\n    // Do clamp :\n    vec2 coord = vTextureCoord + offset;\n    vec2 clampedCoord = clamp(coord, filterClamp.xy, filterClamp.zw);\n    vec4 color = texture2D(uSampler, clampedCoord);\n    if (coord != clampedCoord) {\n        color *= max(0.0, 1.0 - length(coord - clampedCoord));\n    }\n\n    // No clamp :\n    // gl_FragColor = texture2D(uSampler, vTextureCoord + offset);\n\n    color.rgb *= 1.0 + (brightness - 1.0) * p * fade;\n\n    gl_FragColor = color;\n}\n"),this.center=t,Object.assign(this,hg.defaults,e),this.time=n}apply(t,e,n,s){this.uniforms.time=this.time,t.applyFilter(this,e,n,s)}get center(){return this.uniforms.center}set center(t){this.uniforms.center=t}get amplitude(){return this.uniforms.amplitude}set amplitude(t){this.uniforms.amplitude=t}get wavelength(){return this.uniforms.wavelength}set wavelength(t){this.uniforms.wavelength=t}get brightness(){return this.uniforms.brightness}set brightness(t){this.uniforms.brightness=t}get speed(){return this.uniforms.speed}set speed(t){this.uniforms.speed=t}get radius(){return this.uniforms.radius}set radius(t){this.uniforms.radius=t}};hg.defaults={amplitude:30,wavelength:160,brightness:1,speed:500,radius:-1};let cg=class extends Gh{constructor(t){var e,n;super("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform float blur;\nuniform float gradientBlur;\nuniform vec2 start;\nuniform vec2 end;\nuniform vec2 delta;\nuniform vec2 texSize;\n\nfloat random(vec3 scale, float seed)\n{\n    return fract(sin(dot(gl_FragCoord.xyz + seed, scale)) * 43758.5453 + seed);\n}\n\nvoid main(void)\n{\n    vec4 color = vec4(0.0);\n    float total = 0.0;\n\n    float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);\n    vec2 normal = normalize(vec2(start.y - end.y, end.x - start.x));\n    float radius = smoothstep(0.0, 1.0, abs(dot(vTextureCoord * texSize - start, normal)) / gradientBlur) * blur;\n\n    for (float t = -30.0; t <= 30.0; t++)\n    {\n        float percent = (t + offset - 0.5) / 30.0;\n        float weight = 1.0 - abs(percent);\n        vec4 sample = texture2D(uSampler, vTextureCoord + delta / texSize * percent * radius);\n        sample.rgb *= sample.a;\n        color += sample * weight;\n        total += weight;\n    }\n\n    color /= total;\n    color.rgb /= color.a + 0.00001;\n\n    gl_FragColor = color;\n}\n"),this.uniforms.blur=t.blur,this.uniforms.gradientBlur=t.gradientBlur,this.uniforms.start=null!=(e=t.start)?e:new ql(0,window.innerHeight/2),this.uniforms.end=null!=(n=t.end)?n:new ql(600,window.innerHeight/2),this.uniforms.delta=new ql(30,30),this.uniforms.texSize=new ql(window.innerWidth,window.innerHeight),this.updateDelta()}updateDelta(){this.uniforms.delta.x=0,this.uniforms.delta.y=0}get blur(){return this.uniforms.blur}set blur(t){this.uniforms.blur=t}get gradientBlur(){return this.uniforms.gradientBlur}set gradientBlur(t){this.uniforms.gradientBlur=t}get start(){return this.uniforms.start}set start(t){this.uniforms.start=t,this.updateDelta()}get end(){return this.uniforms.end}set end(t){this.uniforms.end=t,this.updateDelta()}},ug=class extends cg{updateDelta(){const t=this.uniforms.end.x-this.uniforms.start.x,e=this.uniforms.end.y-this.uniforms.start.y,n=Math.sqrt(t*t+e*e);this.uniforms.delta.x=t/n,this.uniforms.delta.y=e/n}},dg=class extends cg{updateDelta(){const t=this.uniforms.end.x-this.uniforms.start.x,e=this.uniforms.end.y-this.uniforms.start.y,n=Math.sqrt(t*t+e*e);this.uniforms.delta.x=-e/n,this.uniforms.delta.y=t/n}};const fg=class extends Gh{constructor(t,e,n,s){super(),"number"==typeof t&&(vo("5.3.0","TiltShiftFilter constructor arguments is deprecated, use options."),t={blur:t,gradientBlur:e,start:n,end:s}),t=Object.assign({},fg.defaults,t),this.tiltShiftXFilter=new ug(t),this.tiltShiftYFilter=new dg(t)}apply(t,e,n,s){const i=t.getFilterTexture();this.tiltShiftXFilter.apply(t,e,i,1),this.tiltShiftYFilter.apply(t,i,n,s),t.returnFilterTexture(i)}get blur(){return this.tiltShiftXFilter.blur}set blur(t){this.tiltShiftXFilter.blur=this.tiltShiftYFilter.blur=t}get gradientBlur(){return this.tiltShiftXFilter.gradientBlur}set gradientBlur(t){this.tiltShiftXFilter.gradientBlur=this.tiltShiftYFilter.gradientBlur=t}get start(){return this.tiltShiftXFilter.start}set start(t){this.tiltShiftXFilter.start=this.tiltShiftYFilter.start=t}get end(){return this.tiltShiftXFilter.end}set end(t){this.tiltShiftXFilter.end=this.tiltShiftYFilter.end=t}};fg.defaults={blur:100,gradientBlur:600,start:void 0,end:void 0};const pg=class extends Gh{constructor(t){super("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform float radius;\nuniform float angle;\nuniform vec2 offset;\nuniform vec4 filterArea;\n\nvec2 mapCoord( vec2 coord )\n{\n    coord *= filterArea.xy;\n    coord += filterArea.zw;\n\n    return coord;\n}\n\nvec2 unmapCoord( vec2 coord )\n{\n    coord -= filterArea.zw;\n    coord /= filterArea.xy;\n\n    return coord;\n}\n\nvec2 twist(vec2 coord)\n{\n    coord -= offset;\n\n    float dist = length(coord);\n\n    if (dist < radius)\n    {\n        float ratioDist = (radius - dist) / radius;\n        float angleMod = ratioDist * ratioDist * angle;\n        float s = sin(angleMod);\n        float c = cos(angleMod);\n        coord = vec2(coord.x * c - coord.y * s, coord.x * s + coord.y * c);\n    }\n\n    coord += offset;\n\n    return coord;\n}\n\nvoid main(void)\n{\n\n    vec2 coord = mapCoord(vTextureCoord);\n\n    coord = twist(coord);\n\n    coord = unmapCoord(coord);\n\n    gl_FragColor = texture2D(uSampler, coord );\n\n}\n"),Object.assign(this,pg.defaults,t)}get offset(){return this.uniforms.offset}set offset(t){this.uniforms.offset=t}get radius(){return this.uniforms.radius}set radius(t){this.uniforms.radius=t}get angle(){return this.uniforms.angle}set angle(t){this.uniforms.angle=t}};pg.defaults={radius:200,angle:4,padding:20,offset:new ql};var mg="varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform vec4 filterArea;\n\nuniform vec2 uCenter;\nuniform float uStrength;\nuniform float uInnerRadius;\nuniform float uRadius;\n\nconst float MAX_KERNEL_SIZE = ${maxKernelSize};\n\n// author: http://byteblacksmith.com/improvements-to-the-canonical-one-liner-glsl-rand-for-opengl-es-2-0/\nhighp float rand(vec2 co, float seed) {\n    const highp float a = 12.9898, b = 78.233, c = 43758.5453;\n    highp float dt = dot(co + seed, vec2(a, b)), sn = mod(dt, 3.14159);\n    return fract(sin(sn) * c + seed);\n}\n\nvoid main() {\n\n    float minGradient = uInnerRadius * 0.3;\n    float innerRadius = (uInnerRadius + minGradient * 0.5) / filterArea.x;\n\n    float gradient = uRadius * 0.3;\n    float radius = (uRadius - gradient * 0.5) / filterArea.x;\n\n    float countLimit = MAX_KERNEL_SIZE;\n\n    vec2 dir = vec2(uCenter.xy / filterArea.xy - vTextureCoord);\n    float dist = length(vec2(dir.x, dir.y * filterArea.y / filterArea.x));\n\n    float strength = uStrength;\n\n    float delta = 0.0;\n    float gap;\n    if (dist < innerRadius) {\n        delta = innerRadius - dist;\n        gap = minGradient;\n    } else if (radius >= 0.0 && dist > radius) { // radius < 0 means it's infinity\n        delta = dist - radius;\n        gap = gradient;\n    }\n\n    if (delta > 0.0) {\n        float normalCount = gap / filterArea.x;\n        delta = (normalCount - delta) / normalCount;\n        countLimit *= delta;\n        strength *= delta;\n        if (countLimit < 1.0)\n        {\n            gl_FragColor = texture2D(uSampler, vTextureCoord);\n            return;\n        }\n    }\n\n    // randomize the lookup values to hide the fixed number of samples\n    float offset = rand(vTextureCoord, 0.0);\n\n    float total = 0.0;\n    vec4 color = vec4(0.0);\n\n    dir *= strength;\n\n    for (float t = 0.0; t < MAX_KERNEL_SIZE; t++) {\n        float percent = (t + offset) / MAX_KERNEL_SIZE;\n        float weight = 4.0 * (percent - percent * percent);\n        vec2 p = vTextureCoord + dir * percent;\n        vec4 sample = texture2D(uSampler, p);\n\n        // switch to pre-multiplied alpha to correctly blur transparent images\n        // sample.rgb *= sample.a;\n\n        color += sample * weight;\n        total += weight;\n\n        if (t > countLimit){\n            break;\n        }\n    }\n\n    color /= total;\n    // switch back from pre-multiplied alpha\n    // color.rgb /= color.a + 0.00001;\n\n    gl_FragColor = color;\n}\n",gg=Object.getOwnPropertySymbols,vg=Object.prototype.hasOwnProperty,xg=Object.prototype.propertyIsEnumerable;const yg=class extends Gh{constructor(t){const e=Object.assign(yg.defaults,t),{maxKernelSize:n}=e,s=((t,e)=>{var n={};for(var s in t)vg.call(t,s)&&e.indexOf(s)<0&&(n[s]=t[s]);if(null!=t&&gg)for(var s of gg(t))e.indexOf(s)<0&&xg.call(t,s)&&(n[s]=t[s]);return n})(e,["maxKernelSize"]);super("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}",mg.replace("${maxKernelSize}",n.toFixed(1))),Object.assign(this,s)}get center(){return this.uniforms.uCenter}set center(t){this.uniforms.uCenter=t}get strength(){return this.uniforms.uStrength}set strength(t){this.uniforms.uStrength=t}get innerRadius(){return this.uniforms.uInnerRadius}set innerRadius(t){this.uniforms.uInnerRadius=t}get radius(){return this.uniforms.uRadius}set radius(t){(t<0||t===1/0)&&(t=-1),this.uniforms.uRadius=t}};yg.defaults={strength:.1,center:[0,0],innerRadius:0,radius:-1,maxKernelSize:32};var _g=(t=>(t[t.None=0]="None",t[t.TopLeft=1]="TopLeft",t[t.TopMiddle=2]="TopMiddle",t[t.TopRight=3]="TopRight",t[t.Center=4]="Center",t[t.MiddleLeft=5]="MiddleLeft",t[t.MiddleRight=6]="MiddleRight",t[t.BottomLeft=7]="BottomLeft",t[t.BottomMiddle=8]="BottomMiddle",t[t.BottomRight=9]="BottomRight",t))(_g||{});function bg(t,e,n){switch(e){case 1:t.set(n.x,n.y);break;case 2:t.set(n.x+n.width/2,n.y);break;case 3:t.set(n.x+n.width,n.y);break;case 4:t.set(n.x+n.width/2,n.y+n.height/2);break;case 5:t.set(n.x,n.y+n.height/2);break;case 6:t.set(n.x+n.width,n.y+n.height/2);break;case 7:t.set(n.x,n.y+n.height);break;case 8:t.set(n.x+n.width/2,n.y+n.height);break;case 9:t.set(n.x+n.width,n.y+n.height)}}function wg(t,e){switch(e){case 1:t.set(0);break;case 2:t.set(.5,0);break;case 3:t.set(1,0);break;case 4:t.set(.5);break;case 5:t.set(0,.5);break;case 6:t.set(1,.5);break;case 7:t.set(0,1);break;case 8:t.set(.5,1);break;case 9:t.set(1,1)}}const Eg={Black:0,White:16777215,Gray:8421504,LightGray:13882323,DarkGray:6316128,Brown:7217408,Red:16711680,DarkRed:9109504,Pink:16761035,DeepPink:16716947,Orange:16753920,Gold:16766720,Yellow:16776960,LightYellow:13613654,Green:65280,DarkGreen:25600,SpringGreen:65407,Aqua:8388564,Blue:255,DarkBlue:139,SkyBlue:49151,LightBlue:8900346,Purple:8388736,Magneta:16711935},Tg={e:2.718281828459045,log2e:1.4426950408889634,log10e:.4342944819032518,ln2:.6931471805599453,ln10:2.302585092994046,pi:3.141592653589793,pi2:6.283185307179586,pi1_2:1.5707963267948966,pi1_4:.7853981633974483,_1_pi:.3183098861837907,_2_pi:.6366197723675814,sqrt2:1.4142135623730951,_1_sqrt2:.7071067811865476},Sg=new class{constructor(){p(this,"minLayer",-9999),p(this,"maxLayer",9999),p(this,"colorFilter")}init(){this.colorFilter=new Ym}};function Ag(t){const e=t,n=e===Pu||Pu.prototype.isPrototypeOf(e.prototype);class s extends e{constructor(){super(...arguments),p(this,"name",""),p(this,"_pivotRule",_g.None)}get parentContainer(){return this.parent}get pivotRule(){return this._pivotRule}set pivotRule(t){if(this._pivotRule=t,this.debugBox){this._hideDebugBox();const e=this.unscaledBound;n?wg(this.anchor,t):bg(this.pivot,t,e),this._drawDebugBox(e)}else n?wg(this.anchor,t):bg(this.pivot,t,this.unscaledBound)}refreshPivotPoint(){this.pivotRule=this._pivotRule}get unscaledBound(){return this.getLocalBounds(void 0,!0)}get layer(){return this.zIndex}set layer(t){this.zIndex=t}hasParent(){return!!this.parent}get radian(){return this.rotation}set radian(t){this.rotation=t%Tg.pi2}useViewStyle(t){void 0!==t.xy&&(this.x=t.xy[0],this.y=t.xy[1]),void 0!==t.s&&(Array.isArray(t.s)?(this.width=t.s[0],this.height=t.s[1]):this.scale.set(t.s)),void 0!==t.vis&&(this.visible=t.vis)}addFilter(t){null===this.filters&&(this.filters=[]),this.filters.push(t)}get debugBox(){return void 0!==this._debugBox&&this._debugBox.visible}set debugBox(t){t?this._drawDebugBox(this.unscaledBound):this._hideDebugBox()}_drawDebugBox(t){void 0===this._debugBox?(this._debugBox=new np,this._debugBox.name="debugBox",this._debugBox.zIndex=Sg.maxLayer+1,this.addChild(this._debugBox)):this._debugBox.visible=!0;const e=Object.getPrototypeOf(this).constructor._debugFillStyle,s=Object.getPrototypeOf(this).constructor._debugLineStyle;s.alignment=0;const i=n?new Zl(0,0,5,5):new Zl(this.pivot.x,this.pivot.y,5,5);this._debugBox.geometry.clear().drawShape(t,e,s).drawShape(i,s,s)}_hideDebugBox(){void 0!==this._debugBox&&(this._debugBox.visible=!1)}}return p(s,"_debugFillStyle",(()=>{const t=new Qf;return t.visible=!1,t})()),p(s,"_debugLineStyle",(()=>{const t=new Jf;return t.visible=!0,t.color=Eg.Blue,t.alpha=1,t.width=2,t})()),s}function Cg(t){return void 0!==t.useViewStyle}function Ig(t){return void 0!==t.useLocale}globalThis.doNothing=()=>{},Iu.prototype.update=globalThis.doNothing;const Mg={code:"",name:"",defaultFont:"",dict:{},styles:{}},Rg={Linear:{None:function(t){return t}},Quadratic:{In:function(t){return t*t},Out:function(t){return t*(2-t)},InOut:function(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)}},Cubic:{In:function(t){return t*t*t},Out:function(t){return--t*t*t+1},InOut:function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)}},Quartic:{In:function(t){return t*t*t*t},Out:function(t){return 1- --t*t*t*t},InOut:function(t){return(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)}},Quintic:{In:function(t){return t*t*t*t*t},Out:function(t){return--t*t*t*t*t+1},InOut:function(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)}},Sinusoidal:{In:function(t){return 1-Math.sin((1-t)*Math.PI/2)},Out:function(t){return Math.sin(t*Math.PI/2)},InOut:function(t){return.5*(1-Math.sin(Math.PI*(.5-t)))}},Exponential:{In:function(t){return 0===t?0:Math.pow(1024,t-1)},Out:function(t){return 1===t?1:1-Math.pow(2,-10*t)},InOut:function(t){return 0===t?0:1===t?1:(t*=2)<1?.5*Math.pow(1024,t-1):.5*(2-Math.pow(2,-10*(t-1)))}},Circular:{In:function(t){return 1-Math.sqrt(1-t*t)},Out:function(t){return Math.sqrt(1- --t*t)},InOut:function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)}},Elastic:{In:function(t){return 0===t?0:1===t?1:-Math.pow(2,10*(t-1))*Math.sin(5*(t-1.1)*Math.PI)},Out:function(t){return 0===t?0:1===t?1:Math.pow(2,-10*t)*Math.sin(5*(t-.1)*Math.PI)+1},InOut:function(t){return 0===t?0:1===t?1:(t*=2)<1?-.5*Math.pow(2,10*(t-1))*Math.sin(5*(t-1.1)*Math.PI):.5*Math.pow(2,-10*(t-1))*Math.sin(5*(t-1.1)*Math.PI)+1}},Back:{In:function(t){const e=1.70158;return 1===t?1:t*t*((e+1)*t-e)},Out:function(t){const e=1.70158;return 0===t?0:--t*t*((e+1)*t+e)+1},InOut:function(t){const e=2.5949095;return(t*=2)<1?t*t*((e+1)*t-e)*.5:.5*((t-=2)*t*((e+1)*t+e)+2)}},Bounce:{In:function(t){return 1-Rg.Bounce.Out(1-t)},Out:function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},InOut:function(t){return t<.5?.5*Rg.Bounce.In(2*t):.5*Rg.Bounce.Out(2*t-1)+.5}},generatePow:function(t=4){return t=(t=t<Number.EPSILON?Number.EPSILON:t)>1e4?1e4:t,{In:function(e){return h(e,t)},Out:function(e){return 1-h(1-e,t)},InOut:function(e){return e<.5?h(2*e,t)/2:(1-h(2-2*e,t))/2+.5}}}},Pg={Linear:function(t,e){const n=t.length-1,s=n*e,i=Math.floor(s),r=Pg.Utils.Linear;return e<0?r(t[0],t[1],s):e>1?r(t[n],t[n-1],n-s):r(t[i],t[i+1>n?n:i+1],s-i)},Bezier:function(t,e){let n=0;const s=t.length-1,i=Math.pow,r=Pg.Utils.Bernstein;for(let a=0;a<=s;a++)n+=i(1-e,s-a)*i(e,a)*t[a]*r(s,a);return n},CatmullRom:function(t,e){const n=t.length-1;let s=n*e,i=Math.floor(s);const r=Pg.Utils.CatmullRom;return t[0]===t[n]?(e<0&&(i=Math.floor(s=n*(1+e))),r(t[(i-1+n)%n],t[i],t[(i+1)%n],t[(i+2)%n],s-i)):e<0?t[0]-(r(t[0],t[0],t[1],t[1],-s)-t[0]):e>1?t[n]-(r(t[n],t[n],t[n-1],t[n-1],s-n)-t[n]):r(t[i?i-1:0],t[i],t[n<i+1?n:i+1],t[n<i+2?n:i+2],s-i)},Utils:{Linear:function(t,e,n){return(e-t)*n+t},Bernstein:function(t,e){const n=Pg.Utils.Factorial;return n(t)/n(e)/n(t-e)},Factorial:function(){const t=[1];return function(e){let n=1;if(t[e])return t[e];for(let t=e;t>1;t--)n*=t;return t[e]=n,n}}(),CatmullRom:function(t,e,n,s,i){const r=.5*(n-t),a=.5*(s-e),o=i*i;return(2*e-2*n+r+a)*(i*o)+(-3*e+3*n-2*r-a)*o+r*i+e}}};class kg{constructor(t,e,n){p(this,"_name"),p(this,"_object"),p(this,"_group"),p(this,"_valuesStart",{}),p(this,"_valuesEnd",{}),p(this,"_valuesStartRepeat",{}),p(this,"_startTime",0),p(this,"_delayTime",0),p(this,"_duration",1e3),p(this,"_repeat",0),p(this,"_repeatDelayTime",0),p(this,"_isPlaying",!1),p(this,"_isPaused",!1),p(this,"_pauseStart",0),p(this,"_yoyo",!1),p(this,"_yoyoDelayTime",0),p(this,"_reversed",!1),p(this,"_easingFunction",Rg.Linear.None),p(this,"_interpolationFunction",Pg.Linear),p(this,"_chainedTweens",[]),p(this,"_isChainStopped",!1),p(this,"_allowChainedStop",!0),p(this,"_events",{}),p(this,"_onStartCallbackFired",!1),this._name=t,this._object=e,this._group=n}get name(){return this._name}isPlaying(){return this._isPlaying}isPaused(){return this._isPaused}isReversed(){return this._reversed}getRepeat(){return this._repeat}to(t,e=1e3){return this._valuesEnd=Object.create(t),this._duration=e,this}start(t=!1,e=globalThis.pgame.TotalMS){if(this._isPlaying){if(!t)return this}else this._group&&this._group.add(this);if(this._reversed){this._reversed=!1;for(const t in this._valuesStartRepeat)this._swapEndStartRepeatValues(t),this._valuesStart[t]=this._valuesStartRepeat[t]}return this._isPlaying=!0,this._isPaused=!1,this._onStartCallbackFired=!1,this._isChainStopped=!1,this._startTime=e,this._startTime+=this._delayTime,this._setupProperties(this._object,this._valuesStart,this._valuesEnd,this._valuesStartRepeat),this}stop(t=!1){return this.stopChainedTweens(),this._isPlaying?(this._group&&this._group.remove(this),this._isPlaying=!1,this._isPaused=!1,this.emit("stop",this._object),t&&this.emit("end",this._object),this):this}end(){return this.updateTillEnd(),this._group&&this._group.remove(this),this}endRepeat(){return this._yoyo?this._reversed?this._repeat=0:this._repeat=1:this._repeat=0,this}pause(t=globalThis.pgame.TotalMS){return this._isPaused||!this._isPlaying||(this._isPaused=!0,this._pauseStart=t,this._group&&this._group.remove(this)),this}resume(t=globalThis.pgame.TotalMS){return this._isPaused&&this._isPlaying?(this._isPaused=!1,this._startTime+=t-this._pauseStart,this._pauseStart=0,this._group&&this._group.add(this),this):this.start(!1,t)}group(t){return this._group=t,this}duration(t){return this._duration=t,this}delay(t){return this._delayTime=t,this}repeat(t){return this._repeat=t,this}repeatDelay(t){return this._repeatDelayTime=t,this}yoyo(t){return this._yoyo=t,this}yoyoDelay(t){return this._yoyoDelayTime=t,this}easing(t){return this._easingFunction=t,this}interpolation(t){return this._interpolationFunction=t,this}on(t,e){const n=this._events[t];return void 0===n?this._events[t]=[e]:n.push(e),this}single(t,e){const n=this._events[t];return void 0===n?this._events[t]=[e]:(n.clear(),n.push(e)),this}off(t){const e=this._events[t];return void 0!==e&&e.clear(),this}emit(t,...e){const n=this._events[t];if(void 0!==n)for(const s of n)s(...e);return this}chain(...t){return this._chainedTweens=t,this}allowChainedStop(t){return this._allowChainedStop=t,this}stopChainedTweens(){if(this._isChainStopped)return this;for(const t of this._chainedTweens)t._allowChainedStop&&t.stop();return this._isChainStopped=!0,this}endChainedTweens(){if(this._isChainStopped)return this;for(const t of this._chainedTweens)t._allowChainedStop&&t.end();return this._isChainStopped=!0,this}update(t){if(this._isPaused)return!0;if(!this._isPlaying)return!1;if(t<this._startTime)return!0;!1===this._onStartCallbackFired&&(this.emit("start",this._object),this._onStartCallbackFired=!0);let e,n=0!==this._duration?(t-this._startTime)/this._duration:1;n>1?(e=1,this._yoyo?n%=2:n%=1):e=0;do{if(e>0||n>=1){if(!(this._repeat>0))return this._updateProperties(this._object,this._valuesStart,this._valuesEnd,1),this.emit("update",this._object,1),this._isPlaying=!1,this._handleEndPlaying();{let t=Math.min(n,1);const e=this._easingFunction(t);this._updateProperties(this._object,this._valuesStart,this._valuesEnd,e),this.emit("update",this._object,t),this._handleRepeatEnd()}}else{let t=Math.min(n,1);const e=this._easingFunction(t);this._updateProperties(this._object,this._valuesStart,this._valuesEnd,e),this.emit("update",this._object,t)}n-=1,e=0}while(n>0);return!0}_handleRepeatEnd(){for(const t in this._valuesStartRepeat)this._yoyo||"string"!=typeof this._valuesEnd[t]||(this._valuesStartRepeat[t]=this._valuesStartRepeat[t]+parseFloat(this._valuesEnd[t])),this._yoyo&&this._swapEndStartRepeatValues(t),this._valuesStart[t]=this._valuesStartRepeat[t];return this._yoyo?this._reversed?(this._reversed=!1,this.emit("repeat",this._object,this._repeat),this._startTime+=this._duration+this._repeatDelayTime):(this._repeat--,this._reversed=!0,this.emit("yoyo",this._object,this._repeat),this._startTime+=this._duration+this._yoyoDelayTime):(this._repeat--,this.emit("repeat",this._object,this._repeat),this._startTime+=this._duration+this._repeatDelayTime),!0}_handleEndPlaying(){this.emit("end",this._object);for(const t of this._chainedTweens)t.start(!1,this._startTime+this._duration);return this._isPlaying}updateTillEnd(){return!1===this._onStartCallbackFired&&(this.emit("start",this._object),this._onStartCallbackFired=!0),this._yoyo&&!this._reversed?this._updateProperties(this._object,this._valuesEnd,this._valuesStart,1):this._updateProperties(this._object,this._valuesStart,this._valuesEnd,1),this.emit("update",this._object,1),this.emit("end",this._object),this.endChainedTweens(),this._isPlaying=!1,!1}_setupProperties(t,e,n,s){for(const i in n){const r=t[i],a=Array.isArray(r),o=a?"array":typeof r,l=!a&&Array.isArray(n[i]);if("undefined"!==o&&"function"!==o){if(l){let t=n[i];if(0===t.length)continue;t=t.map(this._handleRelativeValue.bind(this,r)),n[i]=[r].concat(t)}if("object"!==o&&!a||!r||l)e[i]=r,a||(e[i]*=1),s[i]=l?n[i].slice().reverse():e[i]||0;else{e[i]=a?[]:{};for(const t in r)e[i][t]=r[t];s[i]=a?[]:{},this._setupProperties(r,e[i],n[i],s[i])}}}}_updateProperties(t,e,n,s){for(const i in n){if(void 0===e[i])continue;const r=e[i]||0;let a=n[i];const o=Array.isArray(t[i]),l=Array.isArray(a);!o&&l?t[i]=this._interpolationFunction(a,s):"object"==typeof a&&a?this._updateProperties(t[i],r,a,s):(a=this._handleRelativeValue(r,a),"number"==typeof a&&(t[i]=r+(a-r)*s))}}_handleRelativeValue(t,e){return"string"!=typeof e?e:"+"===e.charAt(0)||"-"===e.charAt(0)?t+parseFloat(e):parseFloat(e)}_swapEndStartRepeatValues(t){const e=this._valuesStartRepeat[t],n=this._valuesEnd[t];this._valuesStartRepeat[t]="string"==typeof n?this._valuesStartRepeat[t]+parseFloat(n):this._valuesEnd[t],this._valuesEnd[t]=e}}class Fg{constructor(){p(this,"_twMap"),p(this,"_tweensAddedDuringUpdate")}create(t,e,n,s=1e3){return new kg(t,e,this).to(n,s)}getByName(t){var e;return null==(e=this._twMap)?void 0:e.get(t)}size(){return void 0===this._twMap?0:this._twMap.size}add(t){void 0!==this._twMap&&void 0!==this._tweensAddedDuringUpdate||(this._twMap=new Map,this._tweensAddedDuringUpdate=new Map),this._twMap.set(t.name,t),this._tweensAddedDuringUpdate.set(t.name,t)}remove(t){var e,n;null==(e=this._twMap)||e.delete(t.name),null==(n=this._tweensAddedDuringUpdate)||n.delete(t.name)}getAll(){return void 0!==this._twMap?[...this._twMap.values()]:[]}removeAll(){var t,e;null==(t=this._twMap)||t.clear(),null==(e=this._tweensAddedDuringUpdate)||e.clear()}endAll(){this.updateTillEnd()}update(t){if(void 0===this._twMap||0==this._twMap.size||void 0===this._tweensAddedDuringUpdate)return;let e=[...this._twMap.keys()];for(;e.length>0;){this._tweensAddedDuringUpdate.clear();for(const n of e){const e=this._twMap.get(n);void 0!==e&&(!1===e.update(t)&&this._twMap.delete(e.name))}e=[...this._tweensAddedDuringUpdate.keys()]}}updateTillEnd(){if(void 0===this._twMap||0==this._twMap.size||void 0===this._tweensAddedDuringUpdate)return;let t=[...this._twMap.keys()];for(;t.length>0;){this._tweensAddedDuringUpdate.clear();for(const e of t){const t=this._twMap.get(e);void 0!==t&&(t.updateTillEnd(),this._twMap.delete(t.name))}t=[...this._tweensAddedDuringUpdate.keys()]}}}class Og extends(Ag(Iu)){constructor(t=!1){super(),this.sortableChildren=!0,t&&(this.eventMode="passive")}setObj(t,e,n){return void 0!==e&&(t.layer=e),void 0!==n&&(t.name=n),this}addObj(t,e,n){return void 0!==e&&(t.layer=e),void 0!==n&&(t.name=n),this.addChild(t),this}removeObj(t){this.removeChild(t)}useLocale(t){for(const e of this.children)Ig(e)&&e.useLocale(t)}}const Dg=class extends Og{constructor(...t){super(!0),p(this,"tweens",new Fg),p(this,"desz"),p(this,"sceneObjs"),p(this,"_frontChild"),p(this,"_backChild"),this.desz=new Zl,t.length>0&&this.setDesiredSize(...t),this.update=this._update}setDesiredSize(...t){0==t.length?this.getLocalBounds(this.desz,!0):(t.length>=2&&(this.desz.width=t[0],this.desz.height=t[1]),t.length>=4&&(this.desz.x=t[2],this.desz.y=t[3])),bg(this.pivot,this._pivotRule,this.desz),this.debugBox&&this._drawDebugBox(this.desz)}get pivotRule(){return this._pivotRule}set pivotRule(t){this._pivotRule=t,bg(this.pivot,t,this.desz),this.debugBox&&this._drawDebugBox(this.desz)}refreshPivotPoint(){}get enable(){return this.update===this._update}set enable(t){this.update=t?this._update:globalThis.doNothing}_update(t){this.tweens.update(globalThis.pgame.TotalMS);for(const e of this.children){const n=e;n.visible&&n.update(t)}}addObjWithStyle(t,e,n){this.applyObjWithStyle(t,e,n),this.addChild(t)}applyObjWithStyle(t,e,n){const s=e[t.name];void 0!==s&&t.useViewStyle(s),Ig(t)&&t.useLocale(n)}sendObjToBack(t){void 0!==this._backChild&&(this._backChild.layer=Sg.minLayer+1),t.layer=Sg.minLayer,this._backChild=t}bringObjToFront(t){void 0!==this._frontChild&&(this._frontChild.layer=Sg.maxLayer-1),t.layer=Sg.maxLayer,this._frontChild=t}useViewStyle(t){super.useViewStyle(t),void 0!==t.dwh&&(this.desz.width=t.dwh[0],this.desz.height=t.dwh[1],this.setDesiredSize())}useViewStyleChildren(t){Dg._viewStyleChildren(t,this.children)}static _viewStyleChildren(t,e){for(const n of e){const e=n,s=t[e.name];void 0!==s&&e.useViewStyle(s),Bg(e)&&e.useViewStyleChildren(t)}}get debugBox(){return void 0!==this._debugBox&&this._debugBox.visible}set debugBox(t){t?this._drawDebugBox(this.desz):this._hideDebugBox()}};let Lg=Dg;function Ng(t){return void 0!==t.addObj}function Bg(t){return void 0!==t.desz}p(Lg,"_debugFillStyle",(()=>{const t=new Qf;return t.visible=!0,t.color=Eg.White,t.alpha=.08,t})()),p(Lg,"_debugLineStyle",(()=>{const t=new Jf;return t.visible=!0,t.color=Eg.Red,t.alpha=1,t.width=2.5,t})());class Vg extends(Ag(up)){}const Ug=/iPhone/i,Xg=/iPod/i,Yg=/iPad/i,Wg=/\bAndroid(?:.+)Mobile\b/i,zg=/Android/i,Gg=/Windows Phone/i,Hg=/\bWindows(?:.+)ARM\b/i,jg=/BlackBerry/i,$g=/BB10/i,qg=/Opera Mini/i,Kg=/\b(CriOS|Chrome)(?:.+)Mobile/i,Zg=/Mobile(?:.+)Firefox\b/i,Qg=t=>void 0!==t&&"MacIntel"===t.platform&&"number"==typeof t.maxTouchPoints&&t.maxTouchPoints>1;Element.prototype.requestFullscreen=Element.prototype.requestFullscreen||Element.prototype.mozRequestFullScreen||Element.prototype.webkitRequestFullscreen||Element.prototype.msRequestFullscreen||function(){return Promise.reject(new Error("Fullscreen API is not supported"))},Document.prototype.exitFullscreen=Document.prototype.exitFullscreen||Document.prototype.mozCancelFullScreen||Document.prototype.webkitExitFullscreen||Document.prototype.msExitFullscreen||function(){return Promise.reject(new Error("Fullscreen API is not supported"))};const Jg=function(){const t=navigator;let e=t.userAgent,n=e.split("[FBAN");void 0!==n[1]&&(e=n[0]),n=e.split("Twitter"),void 0!==n[1]&&(e=n[0]);const s=t=>t.test(e),i={apple:{phone:s(Ug)&&!s(Gg),ipod:s(Xg),tablet:!s(Ug)&&(s(Yg)||Qg(t))&&!s(Gg),any:!1},android:{phone:!s(Gg)&&s(Wg),tablet:!s(Gg)&&!s(Wg)&&s(zg),any:!1},windows:{phone:s(Gg),tablet:s(Hg),any:!1},other:{blackberry:s(jg)||s($g),opera:s(qg),firefox:s(Zg),chrome:s(Kg),any:!1},any:!1,phone:!1,tablet:!1};return i.apple.any=i.apple.phone||i.apple.ipod||i.apple.tablet,i.android.any=i.android.phone||i.android.tablet||s(/\bokhttp\b/i),i.windows.any=i.windows.phone||i.windows.tablet,i.other.any=i.other.blackberry||i.other.opera||i.other.firefox||i.other.chrome,i.any=i.apple.any||i.android.any||i.windows.any||i.other.any,i.phone=i.apple.phone||i.android.phone||i.windows.phone,i.tablet=i.apple.tablet||i.android.tablet||i.windows.tablet,i}();function tv(){return Jg.any}function ev(){return Jg.apple.any}function nv(){return navigator.userAgent.includes("Firefox")}function sv(){return!!(document.fullscreenElement||document.webkitFullscreenElement||document.msFullscreenElement||document.mozFullScreenElement)}function iv(){document.documentElement.requestFullscreen().catch((()=>{}))}function rv(){document.exitFullscreen().catch((()=>{}))}function av(){sv()?rv():iv()}let ov,lv=!0,hv=0;function cv(){if(lv)return iv(),void(lv=!1);let t=performance.now(),e=t-hv;e<600&&e>0&&iv(),hv=t}function uv(t,e){for(const n in e)if(n in t){const s=t[n];"object"!=typeof s||Array.isArray(s)||uv(s,e[n])}else t[n]=e[n]}function dv(t,e){for(const n in e){const s=t[n];"object"!=typeof s||Array.isArray(s)?t[n]=e[n]:dv(s,e[n])}}function fv(){return ov}Array.prototype.clear=function(){this.length=0},Array.prototype.front=function(){return this[0]},Array.prototype.back=function(){return this[this.length-1]},Array.prototype.moveToBack=function(t){let e=this[t];this.splice(t,1),this.push(e)},Array.prototype.swap=function(t,e){let n=this[t];this[t]=this[e],this[e]=n},Array.prototype.removeOnce=function(t){let e=this.indexOf(t);return e>-1&&this.splice(e,1),this},Array.prototype.union=function(t){return[...new Set([...this,...t])]},Array.prototype.intersect=function(t){return this.filter((e=>t.includes(e)))},Array.prototype.diff=function(t){return this.filter((e=>!t.includes(e)))},Array.isEqual=function(t,e){if(t.length!=e.length)return!1;for(let n of Array.range(t.length))if(t[n]!=e[n])return!1;return!0},Array.rangeFrom=function(t,e,n){return void 0===n&&(n=1),void 0===e&&(e=t,t=0),Array.from({length:(e-t)/n},((e,s)=>t+s*n))},Array.range=function(t,e,n){void 0===n&&(n=1),void 0===e&&(e=t,t=0);return function*(){for(let s=t;s!=e;s+=n)yield s}()},String.prototype.mapReplace=function(t){let e=this.toString();for(let[n,s]of t)e=e.replace(n,s);return e},String.prototype.format=function(...t){let e=this.toString();for(let n=0;n<t.length;n++)e=e.replace(`{${n}}`,t[n]);return e},Number.prototype.pad=function(t,e){return String(this).padStart(t,e)},Number.prototype.pad0=function(t){return String(this).padStart(t,"0")},Object.removeUndef=function(t){Object.keys(t).forEach((e=>void 0===t[e]&&delete t[e]))},Object.merge=function(t,e,n=!0){n?uv(t,e):dv(t,e)},Object.rename=function(t,e,n){const s=t[e];void 0!==s&&(delete t[e],t[n]=s)},Set.prototype.union=function(t){return new Set([...this,...t])},Set.prototype.intersect=function(t){return new Set(Array.from(this).filter((e=>t.has(e))))},Set.prototype.diff=function(t){return new Set(Array.from(this).filter((e=>!t.has(e))))},Math.randInt=function(t){return Math.floor(Math.random()*t)},Math.randPickFromProbs=function(t){let e=[];for(let s=0;s<t.length;s++)e.push([t[s],s]);e.sort(((t,e)=>t[0]-e[0]));for(let s=1;s<t.length;s++)e[s][0]+=e[s-1][0];let n=Math.random();for(let[s,i]of e)if(n<=s)return i;return-1},Math.shuffle=function(t,e){void 0===e&&(e=t.length);for(let n=0;n<e;n++)t.swap(n,Math.randInt(t.length))};let pv=0;const mv=class extends ua{constructor(t){super(),this.id=pv++,this.init(t)}set(t,e){if(void 0===this[t])throw new Error(`Property with name ${t} does not exist.`);switch(t){case"speed":this.speed=e;break;case"volume":this.volume=e;break;case"paused":this.paused=e;break;case"loop":this.loop=e;break;case"muted":this.muted=e}return this}get progress(){const{currentTime:t}=this._source;return t/this._duration}get paused(){return this._paused}set paused(t){this._paused=t,this.refreshPaused()}_onPlay(){this._playing=!0}_onPause(){this._playing=!1}init(t){this._playing=!1,this._duration=t.source.duration;const e=this._source=t.source.cloneNode(!1);e.src=t.parent.url,e.onplay=this._onPlay.bind(this),e.onpause=this._onPause.bind(this),t.context.on("refresh",this.refresh,this),t.context.on("refreshPaused",this.refreshPaused,this),this._media=t}_internalStop(){this._source&&this._playing&&(this._source.onended=null,this._source.pause())}stop(){this._internalStop(),this._source&&this.emit("stop")}get speed(){return this._speed}set speed(t){this._speed=t,this.refresh()}get volume(){return this._volume}set volume(t){this._volume=t,this.refresh()}get loop(){return this._loop}set loop(t){this._loop=t,this.refresh()}get muted(){return this._muted}set muted(t){this._muted=t,this.refresh()}get filters(){return console.warn("HTML Audio does not support filters"),null}set filters(t){console.warn("HTML Audio does not support filters")}refresh(){const t=this._media.context,e=this._media.parent;this._source.loop=this._loop||e.loop;const n=t.volume*(t.muted?0:1),s=e.volume*(e.muted?0:1),i=this._volume*(this._muted?0:1);this._source.volume=i*n*s,this._source.playbackRate=this._speed*t.speed*e.speed}refreshPaused(){const t=this._media.context,e=this._media.parent,n=this._paused||e.paused||t.paused;n!==this._pausedReal&&(this._pausedReal=n,n?(this._internalStop(),this.emit("paused")):(this.emit("resumed"),this.play({start:this._source.currentTime,end:this._end,volume:this._volume,speed:this._speed,loop:this._loop})),this.emit("pause",n))}play(t){const{start:e,end:n,speed:s,loop:i,volume:r,muted:a}=t;n&&console.assert(n>e,"End time is before start time"),this._speed=s,this._volume=r,this._loop=!!i,this._muted=a,this.refresh(),this.loop&&null!==n&&(console.warn('Looping not support when specifying an "end" time'),this.loop=!1),this._start=e,this._end=n||this._duration,this._start=Math.max(0,this._start-mv.PADDING),this._end=Math.min(this._end+mv.PADDING,this._duration),this._source.onloadedmetadata=()=>{this._source&&(this._source.currentTime=e,this._source.onloadedmetadata=null,this.emit("progress",e,this._duration),iu.shared.add(this._onUpdate,this))},this._source.onended=this._onComplete.bind(this),this._source.play(),this.emit("start")}_onUpdate(){this.emit("progress",this.progress,this._duration),this._source.currentTime>=this._end&&!this._source.loop&&this._onComplete()}_onComplete(){iu.shared.remove(this._onUpdate,this),this._internalStop(),this.emit("progress",1,this._duration),this.emit("end",this)}destroy(){iu.shared.remove(this._onUpdate,this),this.removeAllListeners();const t=this._source;t&&(t.onended=null,t.onplay=null,t.onpause=null,this._internalStop()),this._source=null,this._speed=1,this._volume=1,this._loop=!1,this._end=null,this._start=0,this._duration=0,this._playing=!1,this._pausedReal=!1,this._paused=!1,this._muted=!1,this._media&&(this._media.context.off("refresh",this.refresh,this),this._media.context.off("refreshPaused",this.refreshPaused,this),this._media=null)}toString(){return`[HTMLAudioInstance id=${this.id}]`}};let gv=mv;gv.PADDING=.1;let vv=class extends ua{init(t){this.parent=t,this._source=t.options.source||new Audio,t.url&&(this._source.src=t.url)}create(){return new gv(this)}get isPlayable(){return!!this._source&&4===this._source.readyState}get duration(){return this._source.duration}get context(){return this.parent.context}get filters(){return null}set filters(t){console.warn("HTML Audio does not support filters")}destroy(){this.removeAllListeners(),this.parent=null,this._source&&(this._source.src="",this._source.load(),this._source=null)}get source(){return this._source}load(t){const e=this._source,n=this.parent;if(4===e.readyState){n.isLoaded=!0;const e=n.autoPlayStart();return void(t&&setTimeout((()=>{t(null,n,e)}),0))}if(!n.url)return void t(new Error("sound.url or sound.source must be set"));e.src=n.url;const s=()=>{a(),n.isLoaded=!0;const e=n.autoPlayStart();t&&t(null,n,e)},i=()=>{a(),t&&t(new Error("Sound loading has been aborted"))},r=()=>{a();const n=`Failed to load audio element (code: ${e.error.code})`;t?t(new Error(n)):console.error(n)},a=()=>{e.removeEventListener("canplaythrough",s),e.removeEventListener("load",s),e.removeEventListener("abort",i),e.removeEventListener("error",r)};e.addEventListener("canplaythrough",s,!1),e.addEventListener("load",s,!1),e.addEventListener("abort",i,!1),e.addEventListener("error",r,!1),e.load()}},xv=class{static setParamValue(t,e){if(t.setValueAtTime){const n=fv().context;t.setValueAtTime(e,n.audioContext.currentTime)}else t.value=e;return e}},yv=0,_v=class extends ua{constructor(t){super(),this.id=yv++,this._media=null,this._paused=!1,this._muted=!1,this._elapsed=0,this.init(t)}set(t,e){if(void 0===this[t])throw new Error(`Property with name ${t} does not exist.`);switch(t){case"speed":this.speed=e;break;case"volume":this.volume=e;break;case"muted":this.muted=e;break;case"loop":this.loop=e;break;case"paused":this.paused=e}return this}stop(){this._source&&(this._internalStop(),this.emit("stop"))}get speed(){return this._speed}set speed(t){this._speed=t,this.refresh(),this._update(!0)}get volume(){return this._volume}set volume(t){this._volume=t,this.refresh()}get muted(){return this._muted}set muted(t){this._muted=t,this.refresh()}get loop(){return this._loop}set loop(t){this._loop=t,this.refresh()}get filters(){return this._filters}set filters(t){var e;this._filters&&(null==(e=this._filters)||e.filter((t=>t)).forEach((t=>t.disconnect())),this._filters=null,this._source.connect(this._gain)),this._filters=null!=t&&t.length?t.slice(0):null,this.refresh()}refresh(){if(!this._source)return;const t=this._media.context,e=this._media.parent;this._source.loop=this._loop||e.loop;const n=t.volume*(t.muted?0:1),s=e.volume*(e.muted?0:1),i=this._volume*(this._muted?0:1);xv.setParamValue(this._gain.gain,i*s*n),xv.setParamValue(this._source.playbackRate,this._speed*e.speed*t.speed),this.applyFilters()}applyFilters(){var t;if(null!=(t=this._filters)&&t.length){this._source.disconnect();let t=this._source;this._filters.forEach((e=>{t.connect(e.destination),t=e})),t.connect(this._gain)}}refreshPaused(){const t=this._media.context,e=this._media.parent,n=this._paused||e.paused||t.paused;n!==this._pausedReal&&(this._pausedReal=n,n?(this._internalStop(),this.emit("paused")):(this.emit("resumed"),this.play({start:this._elapsed%this._duration,end:this._end,speed:this._speed,loop:this._loop,volume:this._volume})),this.emit("pause",n))}play(t){const{start:e,end:n,speed:s,loop:i,volume:r,muted:a,filters:o}=t;n&&console.assert(n>e,"End time is before start time"),this._paused=!1;const{source:l,gain:h}=this._media.nodes.cloneBufferSource();this._source=l,this._gain=h,this._speed=s,this._volume=r,this._loop=!!i,this._muted=a,this._filters=o,this.refresh();const c=this._source.buffer.duration;this._duration=c,this._end=n,this._lastUpdate=this._now(),this._elapsed=e,this._source.onended=this._onComplete.bind(this),this._loop?(this._source.loopEnd=n,this._source.loopStart=e,this._source.start(0,e)):n?this._source.start(0,e,n-e):this._source.start(0,e),this.emit("start"),this._update(!0),this.enableTicker(!0)}enableTicker(t){iu.shared.remove(this._updateListener,this),t&&iu.shared.add(this._updateListener,this)}get progress(){return this._progress}get paused(){return this._paused}set paused(t){this._paused=t,this.refreshPaused()}destroy(){var t;this.removeAllListeners(),this._internalStop(),this._gain&&(this._gain.disconnect(),this._gain=null),this._media&&(this._media.context.events.off("refresh",this.refresh,this),this._media.context.events.off("refreshPaused",this.refreshPaused,this),this._media=null),null==(t=this._filters)||t.forEach((t=>t.disconnect())),this._filters=null,this._end=null,this._speed=1,this._volume=1,this._loop=!1,this._elapsed=0,this._duration=0,this._paused=!1,this._muted=!1,this._pausedReal=!1}toString(){return`[WebAudioInstance id=${this.id}]`}_now(){return this._media.context.audioContext.currentTime}_updateListener(){this._update()}_update(t=!1){if(this._source){const e=this._now(),n=e-this._lastUpdate;if(n>0||t){const t=this._source.playbackRate.value;this._elapsed+=n*t,this._lastUpdate=e;const s=this._duration;let i;if(this._source.loopStart){const t=this._source.loopEnd-this._source.loopStart;i=(this._source.loopStart+this._elapsed%t)/s}else i=this._elapsed%s/s;this._progress=i,this.emit("progress",this._progress,s)}}}init(t){this._media=t,t.context.events.on("refresh",this.refresh,this),t.context.events.on("refreshPaused",this.refreshPaused,this)}_internalStop(){if(this._source){this.enableTicker(!1),this._source.onended=null,this._source.stop(0),this._source.disconnect();try{this._source.buffer=null}catch(t){console.warn("Failed to set AudioBufferSourceNode.buffer to null:",t)}this._source=null}}_onComplete(){if(this._source){this.enableTicker(!1),this._source.onended=null,this._source.disconnect();try{this._source.buffer=null}catch(t){console.warn("Failed to set AudioBufferSourceNode.buffer to null:",t)}}this._source=null,this._progress=1,this.emit("progress",1,this._duration),this.emit("end",this)}},bv=class{constructor(t,e){this._output=e,this._input=t}get destination(){return this._input}get filters(){return this._filters}set filters(t){if(this._filters&&(this._filters.forEach((t=>{t&&t.disconnect()})),this._filters=null,this._input.connect(this._output)),t&&t.length){this._filters=t.slice(0),this._input.disconnect();let e=null;t.forEach((t=>{null===e?this._input.connect(t.destination):e.connect(t.destination),e=t})),e.connect(this._output)}}destroy(){this.filters=null,this._input=null,this._output=null}};const wv=class extends bv{constructor(t){const e=t.audioContext,n=e.createBufferSource(),s=e.createGain(),i=e.createAnalyser();n.connect(i),i.connect(s),s.connect(t.destination),super(i,s),this.context=t,this.bufferSource=n,this.gain=s,this.analyser=i}get script(){return this._script||(this._script=this.context.audioContext.createScriptProcessor(wv.BUFFER_SIZE),this._script.connect(this.context.destination)),this._script}destroy(){super.destroy(),this.bufferSource.disconnect(),this._script&&this._script.disconnect(),this.gain.disconnect(),this.analyser.disconnect(),this.bufferSource=null,this._script=null,this.gain=null,this.analyser=null,this.context=null}cloneBufferSource(){const t=this.bufferSource,e=this.context.audioContext.createBufferSource();e.buffer=t.buffer,xv.setParamValue(e.playbackRate,t.playbackRate.value),e.loop=t.loop;const n=this.context.audioContext.createGain();return e.connect(n),n.connect(this.destination),{source:e,gain:n}}get bufferSize(){return this.script.bufferSize}};let Ev=wv;Ev.BUFFER_SIZE=0;let Tv=class{init(t){this.parent=t,this._nodes=new Ev(this.context),this._source=this._nodes.bufferSource,this.source=t.options.source}destroy(){this.parent=null,this._nodes.destroy(),this._nodes=null;try{this._source.buffer=null}catch(t){console.warn("Failed to set AudioBufferSourceNode.buffer to null:",t)}this._source=null,this.source=null}create(){return new _v(this)}get context(){return this.parent.context}get isPlayable(){return!!this._source&&!!this._source.buffer}get filters(){return this._nodes.filters}set filters(t){this._nodes.filters=t}get duration(){return console.assert(this.isPlayable,"Sound not yet playable, no duration"),this._source.buffer.duration}get buffer(){return this._source.buffer}set buffer(t){this._source.buffer=t}get nodes(){return this._nodes}load(t){this.source?this._decode(this.source,t):this.parent.url?this._loadUrl(t):t?t(new Error("sound.url or sound.source must be set")):console.error("sound.url or sound.source must be set")}_loadUrl(t){return m(this,null,(function*(){const e=this.parent.url,n=yield zr.ADAPTER.fetch(e);this._decode(yield n.arrayBuffer(),t)}))}_decode(t,e){const n=(t,n)=>{if(t)e&&e(t);else{this.parent.isLoaded=!0,this.buffer=n;const t=this.parent.autoPlayStart();e&&e(null,this.parent,t)}};t instanceof AudioBuffer?n(null,t):this.parent.context.decode(t,n)}};var Sv=Object.defineProperty,Av=Object.getOwnPropertySymbols,Cv=Object.prototype.hasOwnProperty,Iv=Object.prototype.propertyIsEnumerable,Mv=(t,e,n)=>e in t?Sv(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Rv=(t,e)=>{for(var n in e||(e={}))Cv.call(e,n)&&Mv(t,n,e[n]);if(Av)for(var n of Av(e))Iv.call(e,n)&&Mv(t,n,e[n]);return t};const Pv=class{static from(t){let e={};"string"==typeof t?e.url=t:t instanceof ArrayBuffer||t instanceof AudioBuffer||t instanceof HTMLAudioElement?e.source=t:e=t,e=Rv({autoPlay:!1,singleInstance:!1,url:null,source:null,preload:!1,volume:1,speed:1,complete:null,loaded:null,loop:!1},e),Object.freeze(e);const n=fv().useLegacy?new vv:new Tv;return new Pv(n,e)}constructor(t,e){this.media=t,this.options=e,this._instances=[],this._sprites={},this.media.init(this);const n=e.complete;this._autoPlayOptions=n?{complete:n}:null,this.isLoaded=!1,this.isPlaying=!1,this.autoPlay=e.autoPlay,this.singleInstance=e.singleInstance,this.preload=e.preload||this.autoPlay,this.url=e.url,this.speed=e.speed,this.volume=e.volume,this.loop=e.loop,e.sprites&&this.addSprites(e.sprites),this.preload&&this._preload(e.loaded)}get context(){return fv().context}pause(){return this.isPlaying=!1,this.paused=!0,this}resume(){return this.isPlaying=this._instances.length>0,this.paused=!1,this}get paused(){return this._paused}set paused(t){this._paused=t,this.refreshPaused()}get speed(){return this._speed}set speed(t){this._speed=t,this.refresh()}get filters(){return this.media.filters}set filters(t){this.media.filters=t}addSprites(t,e){if("object"==typeof t){const e={};for(const n in t)e[n]=this.addSprites(n,t[n]);return e}console.assert(!this._sprites[t],`Alias ${t} is already taken`);const n=new class{constructor(t,e){this.parent=t,Object.assign(this,e),this.duration=this.end-this.start,console.assert(this.duration>0,"End time must be after start time")}play(t){return this.parent.play({complete:t,speed:this.speed||this.parent.speed,end:this.end,start:this.start,loop:this.loop})}destroy(){this.parent=null}}(this,e);return this._sprites[t]=n,n}destroy(){this._removeInstances(),this.removeSprites(),this.media.destroy(),this.media=null,this._sprites=null,this._instances=null}removeSprites(t){if(t){const e=this._sprites[t];void 0!==e&&(e.destroy(),delete this._sprites[t])}else for(const e in this._sprites)this.removeSprites(e);return this}get isPlayable(){return this.isLoaded&&this.media&&this.media.isPlayable}stop(){if(!this.isPlayable)return this.autoPlay=!1,this._autoPlayOptions=null,this;this.isPlaying=!1;for(let t=this._instances.length-1;t>=0;t--)this._instances[t].stop();return this}play(t,e){let n;if("string"==typeof t?n={sprite:t,loop:this.loop,complete:e}:"function"==typeof t?(n={},n.complete=t):n=t,n=Rv({complete:null,loaded:null,sprite:null,end:null,start:0,volume:1,speed:1,muted:!1,loop:!1},n||{}),n.sprite){const t=n.sprite;console.assert(!!this._sprites[t],`Alias ${t} is not available`);const e=this._sprites[t];n.start=e.start+(n.start||0),n.end=e.end,n.speed=e.speed||1,n.loop=e.loop||n.loop,delete n.sprite}if(n.offset&&(n.start=n.offset),!this.isLoaded)return new Promise(((t,e)=>{this.autoPlay=!0,this._autoPlayOptions=n,this._preload(((s,i,r)=>{s?e(s):(n.loaded&&n.loaded(s,i,r),t(r))}))}));(this.singleInstance||n.singleInstance)&&this._removeInstances();const s=this._createInstance();return this._instances.push(s),this.isPlaying=!0,s.once("end",(()=>{n.complete&&n.complete(this),this._onComplete(s)})),s.once("stop",(()=>{this._onComplete(s)})),s.play(n),s}refresh(){const t=this._instances.length;for(let e=0;e<t;e++)this._instances[e].refresh()}refreshPaused(){const t=this._instances.length;for(let e=0;e<t;e++)this._instances[e].refreshPaused()}get volume(){return this._volume}set volume(t){this._volume=t,this.refresh()}get muted(){return this._muted}set muted(t){this._muted=t,this.refresh()}get loop(){return this._loop}set loop(t){this._loop=t,this.refresh()}_preload(t){this.media.load(t)}get instances(){return this._instances}get sprites(){return this._sprites}get duration(){return this.media.duration}autoPlayStart(){let t;return this.autoPlay&&(t=this.play(this._autoPlayOptions)),t}_removeInstances(){for(let t=this._instances.length-1;t>=0;t--)this._poolInstance(this._instances[t]);this._instances.length=0}_onComplete(t){if(this._instances){const e=this._instances.indexOf(t);e>-1&&this._instances.splice(e,1),this.isPlaying=this._instances.length>0}this._poolInstance(t)}_createInstance(){if(Pv._pool.length>0){const t=Pv._pool.pop();return t.init(this.media),t}return this.media.create()}_poolInstance(t){t.destroy(),Pv._pool.indexOf(t)<0&&Pv._pool.push(t)}};let kv=Pv;kv._pool=[];let Fv=class extends ua{constructor(){super(...arguments),this.speed=1,this.muted=!1,this.volume=1,this.paused=!1}refresh(){this.emit("refresh")}refreshPaused(){this.emit("refreshPaused")}get filters(){return console.warn("HTML Audio does not support filters"),null}set filters(t){console.warn("HTML Audio does not support filters")}get audioContext(){return console.warn("HTML Audio does not support audioContext"),null}toggleMute(){return this.muted=!this.muted,this.refresh(),this.muted}togglePause(){return this.paused=!this.paused,this.refreshPaused(),this.paused}destroy(){this.removeAllListeners()}};class Ov extends bv{constructor(){const t=window,e=new Ov.AudioContext,n=e.createDynamicsCompressor(),s=e.createAnalyser();s.connect(n),n.connect(e.destination),super(s,n),this._ctx=e,this._offlineCtx=new Ov.OfflineAudioContext(1,2,t.OfflineAudioContext?Math.max(8e3,Math.min(96e3,e.sampleRate)):44100),this._unlocked=!1,this.compressor=n,this.analyser=s,this.events=new ua,this.volume=1,this.speed=1,this.muted=!1,this.paused=!1,"running"!==e.state&&(this._unlock(),this._unlock=this._unlock.bind(this),document.addEventListener("mousedown",this._unlock,!0),document.addEventListener("touchstart",this._unlock,!0),document.addEventListener("touchend",this._unlock,!0))}_unlock(){this._unlocked||(this.playEmptySound(),"running"===this._ctx.state&&(document.removeEventListener("mousedown",this._unlock,!0),document.removeEventListener("touchend",this._unlock,!0),document.removeEventListener("touchstart",this._unlock,!0),this._unlocked=!0))}playEmptySound(){const t=this._ctx.createBufferSource();t.buffer=this._ctx.createBuffer(1,1,22050),t.connect(this._ctx.destination),t.start(0,0,0),"suspended"===t.context.state&&t.context.resume()}static get AudioContext(){const t=window;return t.AudioContext||t.webkitAudioContext||null}static get OfflineAudioContext(){const t=window;return t.OfflineAudioContext||t.webkitOfflineAudioContext||null}destroy(){super.destroy();const t=this._ctx;void 0!==t.close&&t.close(),this.events.removeAllListeners(),this.analyser.disconnect(),this.compressor.disconnect(),this.analyser=null,this.compressor=null,this.events=null,this._offlineCtx=null,this._ctx=null}get audioContext(){return this._ctx}get offlineContext(){return this._offlineCtx}set paused(t){t&&"running"===this._ctx.state?this._ctx.suspend():!t&&"suspended"===this._ctx.state&&this._ctx.resume(),this._paused=t}get paused(){return this._paused}refresh(){this.events.emit("refresh")}refreshPaused(){this.events.emit("refreshPaused")}toggleMute(){return this.muted=!this.muted,this.refresh(),this.muted}togglePause(){return this.paused=!this.paused,this.refreshPaused(),this._paused}decode(t,e){const n=t=>{e(new Error((null==t?void 0:t.message)||"Unable to decode file"))},s=this._offlineCtx.decodeAudioData(t,(t=>{e(null,t)}),n);s&&s.catch(n)}}var Dv=Object.defineProperty,Lv=Object.getOwnPropertySymbols,Nv=Object.prototype.hasOwnProperty,Bv=Object.prototype.propertyIsEnumerable,Vv=(t,e,n)=>e in t?Dv(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Uv=(t,e)=>{for(var n in e||(e={}))Nv.call(e,n)&&Vv(t,n,e[n]);if(Lv)for(var n of Lv(e))Bv.call(e,n)&&Vv(t,n,e[n]);return t};let Xv=class{constructor(){this.init()}init(){return this.supported&&(this._webAudioContext=new Ov),this._htmlAudioContext=new Fv,this._sounds={},this.useLegacy=!this.supported,this}get context(){return this._context}get filtersAll(){return this.useLegacy?[]:this._context.filters}set filtersAll(t){this.useLegacy||(this._context.filters=t)}get supported(){return null!==Ov.AudioContext}add(t,e){if("object"==typeof t){const n={};for(const s in t){const i=this._getOptions(t[s],e);n[s]=this.add(s,i)}return n}if(console.assert(!this._sounds[t],`Sound with alias ${t} already exists.`),e instanceof kv)return this._sounds[t]=e,e;const n=this._getOptions(e),s=kv.from(n);return this._sounds[t]=s,s}_getOptions(t,e){let n;return n="string"==typeof t?{url:t}:t instanceof ArrayBuffer||t instanceof AudioBuffer||t instanceof HTMLAudioElement?{source:t}:t,n=Uv(Uv({},n),e||{}),n}get useLegacy(){return this._useLegacy}set useLegacy(t){this._useLegacy=t,this._context=!t&&this.supported?this._webAudioContext:this._htmlAudioContext}remove(t){return this.exists(t,!0),this._sounds[t].destroy(),delete this._sounds[t],this}get volumeAll(){return this._context.volume}set volumeAll(t){this._context.volume=t,this._context.refresh()}get speedAll(){return this._context.speed}set speedAll(t){this._context.speed=t,this._context.refresh()}togglePauseAll(){return this._context.togglePause()}pauseAll(){return this._context.paused=!0,this._context.refreshPaused(),this}resumeAll(){return this._context.paused=!1,this._context.refreshPaused(),this}toggleMuteAll(){return this._context.toggleMute()}muteAll(){return this._context.muted=!0,this._context.refresh(),this}unmuteAll(){return this._context.muted=!1,this._context.refresh(),this}removeAll(){for(const t in this._sounds)this._sounds[t].destroy(),delete this._sounds[t];return this}stopAll(){for(const t in this._sounds)this._sounds[t].stop();return this}exists(t,e=!1){const n=!!this._sounds[t];return e&&console.assert(n,`No sound matching alias '${t}'.`),n}find(t){return this.exists(t,!0),this._sounds[t]}play(t,e){return this.find(t).play(e)}stop(t){return this.find(t).stop()}pause(t){return this.find(t).pause()}resume(t){return this.find(t).resume()}volume(t,e){const n=this.find(t);return void 0!==e&&(n.volume=e),n.volume}speed(t,e){const n=this.find(t);return void 0!==e&&(n.speed=e),n.speed}duration(t){return this.find(t).duration}close(){return this.removeAll(),this._sounds=null,this._webAudioContext&&(this._webAudioContext.destroy(),this._webAudioContext=null),this._htmlAudioContext&&(this._htmlAudioContext.destroy(),this._htmlAudioContext=null),this._context=null,this}};var Yv={__proto__:null,HTMLAudioMedia:vv,HTMLAudioInstance:gv,HTMLAudioContext:Fv},Wv=_v;let zv=0;var Gv=Object.defineProperty,Hv=Object.getOwnPropertySymbols,jv=Object.prototype.hasOwnProperty,$v=Object.prototype.propertyIsEnumerable,qv=(t,e,n)=>e in t?Gv(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Kv=(t,e)=>{for(var n in e||(e={}))jv.call(e,n)&&qv(t,n,e[n]);if(Hv)for(var n of Hv(e))$v.call(e,n)&&qv(t,n,e[n]);return t};var Zv=Object.defineProperty,Qv=Object.getOwnPropertySymbols,Jv=Object.prototype.hasOwnProperty,tx=Object.prototype.propertyIsEnumerable,ex=(t,e,n)=>e in t?Zv(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,nx=(t,e)=>{for(var n in e||(e={}))Jv.call(e,n)&&ex(t,n,e[n]);if(Qv)for(var n of Qv(e))tx.call(e,n)&&ex(t,n,e[n]);return t};const sx=["mp3","ogg","oga","opus","mpeg","wav","m4a","aiff","wma","mid","caf"],ix={};function rx(t){const e=nx({m4a:"audio/mp4",oga:"audio/ogg",opus:'audio/ogg; codecs="opus"',caf:'audio/x-caf; codecs="opus"'},t||{}),n=document.createElement("audio"),s={},i=/^no$/;sx.forEach((t=>{const r=n.canPlayType(`audio/${t}`).replace(i,""),a=e[t]?n.canPlayType(e[t]).replace(i,""):"";s[t]=!!r||!!a})),Object.assign(ix,s)}rx();var ax={__proto__:null,playOnce:function(t,e){const n="alias"+zv++;return fv().add(n,{url:t,preload:!0,autoPlay:!0,loaded:t=>{t&&(console.error(t),fv().remove(n),e&&e(t))},complete:()=>{fv().remove(n),e&&e(null)}}),n},get PLAY_ID(){return zv},render:function(t,e){const n=document.createElement("canvas");e=Kv({width:512,height:128,fill:"black"},e||{}),n.width=e.width,n.height=e.height;const s=Ol.from(n);if(!(t.media instanceof Tv))return s;const i=t.media;console.assert(!!i.buffer,"No buffer found, load first");const r=n.getContext("2d");r.fillStyle=e.fill;const a=i.buffer.getChannelData(0),o=Math.ceil(a.length/e.width),l=e.height/2;for(let h=0;h<e.width;h++){let t=1,e=-1;for(let n=0;n<o;n++){const s=a[h*o+n];s<t&&(t=s),s>e&&(e=s)}r.fillRect(h,(1+t)*l,1,Math.max(1,(e-t)*l))}return s},sineTone:function(t=200,e=1){const n=kv.from({singleInstance:!0});if(!(n.media instanceof Tv))return n;const s=n.media,i=n.context.audioContext.createBuffer(1,48e3*e,48e3),r=i.getChannelData(0);for(let a=0;a<r.length;a++){const e=t*(a/i.sampleRate)*Math.PI;r[a]=2*Math.sin(e)}return s.buffer=i,n.isLoaded=!0,n},validateFormats:rx,supported:ix,extensions:sx},ox=Object.defineProperty,lx=Object.defineProperties,hx=Object.getOwnPropertyDescriptors,cx=Object.getOwnPropertySymbols,ux=Object.prototype.hasOwnProperty,dx=Object.prototype.propertyIsEnumerable,fx=(t,e,n)=>e in t?ox(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;const px=t=>{var e,n;const s=t.src;return null!=(n=null==(e=null==t?void 0:t.alias)?void 0:e[0])?n:mo.basename(s,mo.extname(s))},mx={extension:yl.Asset,detection:{test:()=>m(void 0,null,(function*(){return!0})),add:t=>m(void 0,null,(function*(){return[...t,...sx.filter((t=>ix[t]))]})),remove:t=>m(void 0,null,(function*(){return t.filter((e=>t.includes(e)))}))},loader:{extension:{type:[yl.LoadParser],priority:pd.High},test(t){const e=mo.extname(t).slice(1);return!!ix[e]},load(t,e){return m(this,null,(function*(){const n=yield new Promise(((n,s)=>kv.from(((t,e)=>lx(t,hx(e)))(((t,e)=>{for(var n in e||(e={}))ux.call(e,n)&&fx(t,n,e[n]);if(cx)for(var n of cx(e))dx.call(e,n)&&fx(t,n,e[n]);return t})({},e.data),{url:t,preload:!0,loaded(t,i){var r,a;t?s(t):n(i),null==(a=null==(r=e.data)?void 0:r.loaded)||a.call(r,t,i)}}))));return fv().add(px(e),n),n}))},unload(t,e){return m(this,null,(function*(){fv().remove(px(e))}))}}};wl.add(mx);const gx=(vx=new Xv,ov=vx,vx);var vx;class xx{constructor(t){p(this,"list"),p(this,"_volume",1),p(this,"_muted",!1),this.list=t;for(const e of this.list)e.group=this}get volume(){return this._volume}set volume(t){this._volume=t,this.refresh()}get muted(){return this._muted}set muted(t){this._muted=t,this.refresh()}refresh(){for(const t of this.list)t.refresh()}}class yx{constructor(t){p(this,"prev",null),p(this,"current",null),p(this,"list"),this.list=t;for(const e of this.list)e.mutexGroup=this,e.singleInstance=!0}}function _x(t,e){const n=t.sound;if(t.firstPlayed){if(t.fadeIn&&(t.fadeIn.startMS=pgame.TotalMS,t.fadeIn.endMS=pgame.TotalMS+t.fadeIn.timeMS),t.fadeOut){let s=1e3*((e.end||n.duration)-e.start);t.fadeOut.startMS=pgame.TotalMS+s-t.fadeOut.timeMS,t.fadeOut.endMS=pgame.TotalMS+s,t.fadeOut.wantsTo=" ",t.fadeOut.canStop=!1}}else{t.firstPlayed=!0;const s=e.fadeIn||n.fadeIn,i=e.fadeOut||n.fadeOut;if(!s&&!i)return;if(s&&(t.fadeIn={timeMS:s,startMS:pgame.TotalMS,endMS:pgame.TotalMS+s}),i){let s=1e3*(e.end||n.duration);t.fadeOut={timeMS:i,startMS:pgame.TotalMS+s-i,endMS:pgame.TotalMS+s,wantsTo:" ",canStop:!1}}const r=e.volume,a=(e,n)=>{if(t.fadeOut&&(" "!=t.fadeOut.wantsTo||!t.loopReal)&&pgame.TotalMS>=t.fadeOut.startMS){let e=(pgame.TotalMS-t.fadeOut.startMS)/t.fadeOut.timeMS;e=Math.min(e,1),1==e?(t.fadeOut.canStop=!0,"stop"==t.fadeOut.wantsTo?t.stop():"pause"==t.fadeOut.wantsTo&&t.refreshPaused()):t.volume=(1-e)*r}else if(t.fadeIn&&(pgame.TotalMS<=t.fadeIn.endMS||t.volume<r)){let e=(pgame.TotalMS-t.fadeIn.startMS)/t.fadeIn.timeMS;e=Math.min(e,1),t.volume=e*r}};t.on("progress",a)}}function bx(t,e){const n=t.fadeOut;return!n||(n.wantsTo!=e?(n.wantsTo=e,n.startMS=pgame.TotalMS,n.endMS=Math.min(n.endMS,pgame.TotalMS+n.timeMS),!1):n.canStop)}function wx(t){if(t.mutexGroup){if(t.mutexGroup.current){const e=t.mutexGroup.current;e.isPlaying&&(e.mutexPause?e.pause():e.stop()),t.mutexGroup.prev=e}t.mutexGroup.current=t}}const Ex=Wv.prototype,Tx={init:Ex.init,play:Ex.play,stop:Ex.stop,refreshPaused:Ex.refreshPaused},Sx=Yv.HTMLAudioInstance.prototype,Ax={init:Sx.init,play:Sx.play,stop:Sx.stop,refreshPaused:Sx.refreshPaused},Cx=kv.prototype,Ix={play:Cx.play,resume:Cx.resume},Mx=Xv.prototype;Ex.init=function(t){this.firstPlayed=!1,Tx.init.call(this,t)},Ex.play=function(t){_x(this,t),Tx.play.call(this,t)},Ex.stop=function(){bx(this,"stop")&&Tx.stop.call(this)},Ex.refreshPaused=function(){bx(this,"pause")&&Tx.refreshPaused.call(this)},Object.defineProperties(Ex,{sound:{get:function(){return this._media.parent}},loopReal:{get:function(){return this._loop||this._media.parent.loop}}}),Sx.init=function(t){this.firstPlayed=!1,Ax.init.call(this,t)},Sx.play=function(t){_x(this,t),Ax.play.call(this,t)},Sx.stop=function(){bx(this,"stop")&&Ax.stop.call(this)},Sx.refreshPaused=function(){bx(this,"pause")&&Ax.refreshPaused.call(this)},Object.defineProperties(Sx,{sound:{get:function(){return this._media.parent}},loopReal:{get:function(){return this._loop||this._media.parent.loop}}}),Cx.play=function(t,e){return wx(this),Ix.play.call(this,t,e)},Cx.resume=function(){return wx(this),Ix.resume.call(this)},Object.defineProperties(Cx,{volume:{get:function(){return this.group?this.group.volume*this._volume:this._volume}},muted:{get:function(){var t;return(null==(t=this.group)?void 0:t.muted)||this._muted}},selfVolume:{get:function(){return this._volume}},selfMuted:{get:function(){return this._muted}}}),gx.groups={},gx.mutexGroups={},Mx.setGroup=function(t,e){const n=Object.fromEntries(Object.entries(e).map((([t,e])=>[t,this.find(e)])));return this.groups[t]=new xx(Object.values(n)),n},Mx.setMutexGroup=function(t,e){const n="string"==typeof e[0]?e.map((t=>this.find(t))):e;return this.mutexGroups[t]=new yx(n),n};const Rx=ax.supported;var Px={};!function(t){!function(){function e(t,e){document.addEventListener?t.addEventListener("scroll",e,!1):t.attachEvent("scroll",e)}function n(t){this.g=document.createElement("div"),this.g.setAttribute("aria-hidden","true"),this.g.appendChild(document.createTextNode(t)),this.h=document.createElement("span"),this.i=document.createElement("span"),this.m=document.createElement("span"),this.j=document.createElement("span"),this.l=-1,this.h.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;",this.i.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;",this.j.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;",this.m.style.cssText="display:inline-block;width:200%;height:200%;font-size:16px;max-width:none;",this.h.appendChild(this.m),this.i.appendChild(this.j),this.g.appendChild(this.h),this.g.appendChild(this.i)}function s(t,e){t.g.style.cssText="max-width:none;min-width:20px;min-height:20px;display:inline-block;overflow:hidden;position:absolute;width:auto;margin:0;padding:0;top:-999px;white-space:nowrap;font-synthesis:none;font:"+e+";"}function i(t){var e=t.g.offsetWidth,n=e+100;return t.j.style.width=n+"px",t.i.scrollLeft=n,t.h.scrollLeft=t.h.scrollWidth+100,t.l!==e&&(t.l=e,!0)}function r(t,n){function s(){var t=r;i(t)&&null!==t.g.parentNode&&n(t.l)}var r=t;e(t.h,s),e(t.i,s),i(t)}function a(t,e,n){e=e||{},n=n||window,this.family=t,this.style=e.style||"normal",this.weight=e.weight||"normal",this.stretch=e.stretch||"normal",this.context=n}var o=null,l=null,h=null,c=null;function u(t){return null===c&&(c=!!t.document.fonts),c}function d(t,e){var n=t.style,s=t.weight;if(null===h){var i=document.createElement("div");try{i.style.font="condensed 100px sans-serif"}catch(r){}h=""!==i.style.font}return[n,s,h?t.stretch:"","100px",e].join(" ")}a.prototype.load=function(t,e){var i=this,a=t||"BESbswy",h=0,c=e||3e3,f=(new Date).getTime();return new Promise((function(t,e){if(u(i.context)&&!function(t){return null===l&&(u(t)&&/Apple/.test(window.navigator.vendor)?(t=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))(?:\.([0-9]+))/.exec(window.navigator.userAgent),l=!!t&&603>parseInt(t[1],10)):l=!1),l}(i.context)){var p=new Promise((function(t,e){!function n(){(new Date).getTime()-f>=c?e(Error(c+"ms timeout exceeded")):i.context.document.fonts.load(d(i,'"'+i.family+'"'),a).then((function(e){1<=e.length?t():setTimeout(n,25)}),e)}()})),m=new Promise((function(t,e){h=setTimeout((function(){e(Error(c+"ms timeout exceeded"))}),c)}));Promise.race([m,p]).then((function(){clearTimeout(h),t(i)}),e)}else!function(t){document.body?t():document.addEventListener?document.addEventListener("DOMContentLoaded",(function e(){document.removeEventListener("DOMContentLoaded",e),t()})):document.attachEvent("onreadystatechange",(function e(){"interactive"!=document.readyState&&"complete"!=document.readyState||(document.detachEvent("onreadystatechange",e),t())}))}((function(){function l(){var e;(e=-1!=g&&-1!=v||-1!=g&&-1!=x||-1!=v&&-1!=x)&&((e=g!=v&&g!=x&&v!=x)||(null===o&&(e=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))/.exec(window.navigator.userAgent),o=!!e&&(536>parseInt(e[1],10)||536===parseInt(e[1],10)&&11>=parseInt(e[2],10))),e=o&&(g==y&&v==y&&x==y||g==_&&v==_&&x==_||g==b&&v==b&&x==b)),e=!e),e&&(null!==w.parentNode&&w.parentNode.removeChild(w),clearTimeout(h),t(i))}var u=new n(a),p=new n(a),m=new n(a),g=-1,v=-1,x=-1,y=-1,_=-1,b=-1,w=document.createElement("div");w.dir="ltr",s(u,d(i,"sans-serif")),s(p,d(i,"serif")),s(m,d(i,"monospace")),w.appendChild(u.g),w.appendChild(p.g),w.appendChild(m.g),i.context.document.body.appendChild(w),y=u.g.offsetWidth,_=p.g.offsetWidth,b=m.g.offsetWidth,function t(){if((new Date).getTime()-f>=c)null!==w.parentNode&&w.parentNode.removeChild(w),e(Error(c+"ms timeout exceeded"));else{var n=i.context.document.hidden;!0!==n&&void 0!==n||(g=u.g.offsetWidth,v=p.g.offsetWidth,x=m.g.offsetWidth,l()),h=setTimeout(t,50)}}(),r(u,(function(t){g=t,l()})),s(u,d(i,'"'+i.family+'",sans-serif')),r(p,(function(t){v=t,l()})),s(p,d(i,'"'+i.family+'",serif')),r(m,(function(t){x=t,l()})),s(m,d(i,'"'+i.family+'",monospace'))}))}))},t.exports=a}()}({get exports(){return Px},set exports(t){Px=t}});const kx=Px;function Fx(t,e){const n=e.Resolution;if(void 0===n||!Array.isArray(n))throw Error("No resolution in style!");delete e.Resolution;const s={};return Object.assign(s,...Object.values(e)),{name:t,Resolution:n,list:s}}const Ox={name:"",Resolution:[1,1],list:{}};function Dx(t){return fetch(t).then((t=>t.json()))}Od.prototype.prepareLoading=function(t=!1){let e;this.starter={all:{n:0,nLoaded:0,fileSize:0},bundles:{},promises:[]},e=t?()=>Object.values(this.starter.bundles).reduce(((t,e)=>t+e.nLoaded/e.n*e.fileSize),0)/this.starter.all.fileSize:()=>this.starter.all.nLoaded/this.starter.all.n,this.starter.logProgress=(t,n)=>{var s;const i=(100*n).toFixed(2).padStart(6," ")+"%",r=e(),a=(100*r).toFixed(2).padStart(6," ")+"%";console.debug(`[LOADED] Total:${a}  |  ${t}:${i}`),null==(s=this.onTotalProgress)||s.call(this,r)}},Od.prototype.addCSSFont=function(t,e,n,s=9999999){let i=this.starter.bundles["CSS-Font"];void 0===i&&(i=this.starter.bundles["CSS-Font"]={n:0,nLoaded:0,fileSize:0});const r=2e5;i.n++,i.fileSize+=r,this.starter.all.n++,this.starter.all.fileSize+=r;const a=new kx(t,e);this.starter.promises.push((()=>a.load(n,s).then((()=>{i.nLoaded++,this.starter.all.nLoaded++,this.starter.logProgress("CSS-Font",i.nLoaded/i.n)}))))},Od.prototype.loadFromList=function(t){var e;null==(e=this.onPreprocessAssetList)||e.call(this,t),this.list=t,this.starter.all.fileSize+=t.fileSize;const n=(t,e)=>n=>{e.nLoaded++,this.starter.all.nLoaded++,this.starter.logProgress(t,n)},s=(t,e)=>{let s=0;"fileSize"in e&&(s=e.fileSize,delete e.fileSize);const i=Object.keys(e).length;if(0==i)return;this.starter.all.n+=i;const r=this.starter.bundles[t]={n:i,nLoaded:0,fileSize:s};this.addBundle(t,e),this.starter.promises.push((()=>this.loadBundle(t,n(t,r))))};return s("Image",t.img),s("Texture",t.img_atlas),s("Spine",t.spine_json),s("Sound",t.sound),s("Style",t.style.PROD),s("Localization",t.lang.PROD),console.debug("SupportedSoundExts:",JSON.stringify(Rx,void 0,2)),s("Custom",t.custom),Promise.all(this.starter.promises.map((t=>t())))},Od.prototype.get_multipack_textureMap=function(t){const e={};for(const i of Object.keys(t.img)){const t=this.get(i);e[i]=t}const n=t=>{Object.assign(e,t.textures)};for(const i of Object.keys(t.img_atlas)){const t=this.get(i);if(void 0!==t){n(t);for(const e of t.linkedSheets)n(e)}}const s={};for(const i of Object.keys(t.img_atlas)){const t=this.get(i);if(void 0!==t&&void 0!==t.data.animations)for(const n in t.data.animations){const i=t.data.animations[n];s[n]=i.map((t=>e[t]))}}return[e,s]},Od.prototype.get_SpineMap=function(t){const e={};for(const n of Object.keys(t)){const t=this.get(n);e[n]=t}return e},Od.prototype.get_viewStyleMap=function(t){const e={};{const t=this.get("styleBundle");for(const[n,s]of Object.entries(t))e[n]=Fx(n,s)}return e},Od.prototype.get_localeMap=function(t){const e={};{const t=this.get("langBundle");for(const[n,s]of Object.entries(t))e[n]=u({code:n},s)}return e};class Lx extends(Ag(Pu)){constructor(t){super(void 0!==t?globalThis.pgame.getTex(t):void 0)}setTex(t){this.texture=globalThis.pgame.getTex(t)}useViewStyle(t){super.useViewStyle(t),void 0!==t.tex&&this.setTex(t.tex)}}p(Lx,"_debugLineStyle",(()=>{let t=new Jf;return t.visible=!0,t.color=Eg.Yellow,t.alpha=1,t.width=2,t})());class Nx extends(Ag(Up)){constructor(t,e=60,n=!1){super(globalThis.pgame.getSeq(t)),this.FPS=e,this.loop=n}setSeq(t){this.textures=globalThis.pgame.getSeq(t)}get FPS(){return 60*this.animationSpeed}set FPS(t){this.animationSpeed=t/60}update(t){Up.prototype.update.call(this,t)}}p(Nx,"_debugLineStyle",(()=>{let t=new Jf;return t.visible=!0,t.color=Eg.Orange,t.alpha=1,t.width=2,t})());class Bx extends(Ag(Sp)){constructor(t){var e;const n=t.text,s=t.key,i=null!=(e=t.name)?e:"",r=Bx.getStyleFromInitOptions(t,i);let a=!1;void 0===r.fontFamily&&(a=!0,r.fontFamily=globalThis.pgame.currLocale.defaultFont),super(n,r),p(this,"_key",""),p(this,"_args"),p(this,"_useDefaultFont"),p(this,"_fitType","None"),p(this,"fitBox",{width:1/0,height:1/0,scale:1}),this.name=i,this._useDefaultFont=a,void 0!==s&&this.setKey(s)}get text(){return super.text}set text(t){super.text=t,this.dirty&&this._fitScale()}get fitType(){return this._fitType}set fitType(t){if(this._fitType!=t){switch(this._fitType=t,t){case"None":this._fitScale=Bx.prototype._fitScale;break;case"Shrink":this._fitScale=this._shrinkScale}this._fitScale()}}setFitBox(t=1/0,e=1/0,n=1){this.fitBox.width=t,this.fitBox.height=e,this.fitBox.scale=n,this._fitScale()}setTxtStyle(t){Object.assign(this.style,t)}setKey(t){this._key=t,this._args=void 0;const e=globalThis.pgame.currLocale.dict[t];void 0!==e&&(this.text=e)}setKeyFormat(t,...e){this._key=t,this._args=e;const n=globalThis.pgame.currLocale.dict[t];void 0!==n&&(this.text=n.format(...e))}useLocale(t){const e=t.dict[this._key];void 0!==e&&(void 0===this._args?this.text=e:this.text=e.format(...this._args));const n=t.styles[this.name];void 0!==n&&Object.assign(this.style,Bx.getStyleFromItem(this,n))}clear(){this.text=""}_fitScale(){}_shrinkScale(){const t=this.fitBox;if(t.width==1/0&&t.height==1/0)return;const e=this.unscaledBound;let n=t.width/e.width,s=t.height/e.height,i=Math.min(t.scale,n,s);this.scale.set(i)}static getStyleFromInitOptions(t,e){var n;const s=t;delete t.text,delete t.key,delete t.name,Object.rename(t,"font","fontFamily"),Object.rename(t,"size","fontSize"),Object.rename(t,"weight","fontWeight"),Object.rename(t,"style","fontStyle"),s.fill=null!=(n=t.fill)?n:Eg.White,void 0!==t.width&&(s.wordWrap=!0,s.wordWrapWidth=t.width,delete t.width);const i=globalThis.pgame.currLocale.styles[e];return void 0!==i&&(Object.rename(i,"font","fontFamily"),Object.rename(i,"size","fontSize"),Object.assign(s,i)),s}static getStyleFromItem(t,e){const n=e;return void 0!==e.font?(n.fontFamily=e.font,delete e.font):t._useDefaultFont&&(n.fontFamily=globalThis.pgame.currLocale.defaultFont),Object.rename(e,"size","fontSize"),n}static getByKey(t){let e=globalThis.pgame.currLocale.dict[t];return e||""}static getByKeyFormat(t,...e){let n=globalThis.pgame.currLocale.dict[t];return n?n.format(...e):""}}class Vx{constructor(){p(this,"shape"),p(this,"_fillStyle",new Qf),p(this,"_lineStyle",new Jf),p(this,"matrix")}fill(t,e=1){return this._fillStyle.color=t,this._fillStyle.alpha=e,this._fillStyle.visible=!0,this}line(t,e,n=1){return this._lineStyle.width=t,this._lineStyle.color=e,this._lineStyle.alpha=n,this._lineStyle.visible=!0,this}reshape(...t){return this}getGraphicsData(){var t;return new $f(this.shape.clone(),this._fillStyle.clone(),this._lineStyle.clone(),null==(t=this.matrix)?void 0:t.clone())}}class Ux extends Vx{constructor(t,e,n=0,s=0){super(),p(this,"shape"),this.shape=new Zl(n,s,t,e)}reshape(t,e,n=0,s=0){return this.shape.width=t,this.shape.height=e,this.shape.x=n,this.shape.y=s,this}}class Xx extends Vx{constructor(t,e,n,s=0,i=0){super(),p(this,"shape"),this.shape=new eh(s,i,t,e,n)}reshape(t,e,n,s=0,i=0){return this.shape.width=t,this.shape.height=e,this.shape.radius=n,this.shape.x=s,this.shape.y=i,this}}class Yx extends(Ag(np)){constructor(t){t instanceof Zf?super(t):(super(),void 0!==t&&this.appendDraw(t))}appendDraw(t){const e=this.geometry;if(t instanceof Vx)this.geometry.graphicsData.push(t.getGraphicsData()),e.dirty++;else if(Array.isArray(t))for(const n of t)this.geometry.graphicsData.push(n.getGraphicsData()),e.dirty++;else for(const n of t.graphicsData)this.geometry.graphicsData.push(n),e.dirty++}redraw(t){this.clear().appendDraw(t)}}p(Yx,"_debugLineStyle",(()=>{let t=new Jf;return t.visible=!0,t.color=Eg.Green,t.alpha=1,t.width=2,t})());class Wx extends Og{constructor(t){super(),p(this,"bg"),p(this,"txt"),this.bg=t}addCenteredTxt(t,e=0,n=0){console.assert(void 0===this.txt,"Duplicate text objects"),this.txt=new Bx(t),this.centerTxt(e,n),this.name=this.txt.name,this._addBoth()}centerTxt(t=0,e=0){this.txt.pivotRule=_g.Center,this.txt.position.set(this.bg.width/2+t,this.bg.height/2+e)}addTxtObj(t){console.assert(void 0===this.txt,"Duplicate text objects"),this.txt=new Bx(t),this.name=this.txt.name,this._addBoth()}setText(t){this.txt.text=t}txtFitType(t){return this.txt.fitType=t,this}txtFitBox(t=1/0,e=1/0,n=1,s=!1){return s?this.txt.setFitBox(this.bg.height*e,this.bg.width*t,n):this.txt.setFitBox(this.bg.width*t,this.bg.height*e,n),this}txtStyle(t){Object.assign(this.txt.style,t)}txtKey(t){this.txt.setKey(t)}txtKeyFormat(t,...e){this.txt.setKeyFormat(t,...e)}update(t){this.bg.update(t),this.txt.update(t)}useLocale(t){this.txt.useLocale(t)}_addBoth(){this.isInteractive()&&(this.bg.eventMode=this.txt.eventMode="auto"),this.addObj(this.bg,0).addObj(this.txt,1)}}p(Wx,"_debugLineStyle",(()=>{let t=new Jf;return t.visible=!0,t.color=Eg.Magneta,t.alpha=1,t.width=2,t})());class zx extends Wx{constructor(t){super(new Lx(t))}}class Gx extends Wx{constructor(t){super(new Yx(t))}}var Hx=(t=>(t[t.Region=0]="Region",t[t.BoundingBox=1]="BoundingBox",t[t.Mesh=2]="Mesh",t[t.LinkedMesh=3]="LinkedMesh",t[t.Path=4]="Path",t[t.Point=5]="Point",t[t.Clipping=6]="Clipping",t))(Hx||{});class jx{constructor(t,e=new Array,n=0,s=new DataView(t.buffer)){this.strings=e,this.index=n,this.buffer=s}readByte(){return this.buffer.getInt8(this.index++)}readUnsignedByte(){return this.buffer.getUint8(this.index++)}readShort(){const t=this.buffer.getInt16(this.index);return this.index+=2,t}readInt32(){const t=this.buffer.getInt32(this.index);return this.index+=4,t}readInt(t){let e=this.readByte(),n=127&e;return 0!=(128&e)&&(e=this.readByte(),n|=(127&e)<<7,0!=(128&e)&&(e=this.readByte(),n|=(127&e)<<14,0!=(128&e)&&(e=this.readByte(),n|=(127&e)<<21,0!=(128&e)&&(e=this.readByte(),n|=(127&e)<<28)))),t?n:n>>>1^-(1&n)}readStringRef(){const t=this.readInt(!0);return 0==t?null:this.strings[t-1]}readString(){let t=this.readInt(!0);switch(t){case 0:return null;case 1:return""}t--;let e="";for(let n=0;n<t;){const t=this.readUnsignedByte();switch(t>>4){case 12:case 13:e+=String.fromCharCode((31&t)<<6|63&this.readByte()),n+=2;break;case 14:e+=String.fromCharCode((15&t)<<12|(63&this.readByte())<<6|63&this.readByte()),n+=3;break;default:e+=String.fromCharCode(t),n++}}return e}readFloat(){const t=this.buffer.getFloat32(this.index);return this.index+=4,t}readBoolean(){return 0!=this.readByte()}}var $x=(t=>(t[t.setup=0]="setup",t[t.first=1]="first",t[t.replace=2]="replace",t[t.add=3]="add",t))($x||{}),qx=(t=>(t[t.mixIn=0]="mixIn",t[t.mixOut=1]="mixOut",t))(qx||{}),Kx=(t=>(t[t.Fixed=0]="Fixed",t[t.Percent=1]="Percent",t))(Kx||{}),Zx=(t=>(t[t.Tangent=0]="Tangent",t[t.Chain=1]="Chain",t[t.ChainScale=2]="ChainScale",t))(Zx||{}),Qx=(t=>(t[t.Normal=0]="Normal",t[t.OnlyTranslation=1]="OnlyTranslation",t[t.NoRotationOrReflection=2]="NoRotationOrReflection",t[t.NoScale=3]="NoScale",t[t.NoScaleOrReflection=4]="NoScaleOrReflection",t))(Qx||{});function Jx(t){switch(t.toLowerCase()){case"nearest":return ty.Nearest;case"linear":return ty.Linear;case"mipmap":return ty.MipMap;case"mipmapnearestnearest":return ty.MipMapNearestNearest;case"mipmaplinearnearest":return ty.MipMapLinearNearest;case"mipmapnearestlinear":return ty.MipMapNearestLinear;case"mipmaplinearlinear":return ty.MipMapLinearLinear;default:throw new Error(`Unknown texture filter ${t}`)}}var ty=(t=>(t[t.Nearest=9728]="Nearest",t[t.Linear=9729]="Linear",t[t.MipMap=9987]="MipMap",t[t.MipMapNearestNearest=9984]="MipMapNearestNearest",t[t.MipMapLinearNearest=9985]="MipMapLinearNearest",t[t.MipMapNearestLinear=9986]="MipMapNearestLinear",t[t.MipMapLinearLinear=9987]="MipMapLinearLinear",t))(ty||{}),ey=(t=>(t[t.MirroredRepeat=33648]="MirroredRepeat",t[t.ClampToEdge=33071]="ClampToEdge",t[t.Repeat=10497]="Repeat",t))(ey||{});class ny{constructor(){this.size=null,this.names=null,this.values=null,this.renderObject=null}get width(){const t=this.texture;return t.trim?t.trim.width:t.orig.width}get height(){const t=this.texture;return t.trim?t.trim.height:t.orig.height}get u(){return this.texture._uvs.x0}get v(){return this.texture._uvs.y0}get u2(){return this.texture._uvs.x2}get v2(){return this.texture._uvs.y2}get offsetX(){const t=this.texture;return t.trim?t.trim.x:0}get offsetY(){return this.spineOffsetY}get pixiOffsetY(){const t=this.texture;return t.trim?t.trim.y:0}get spineOffsetY(){const t=this.texture;return this.originalHeight-this.height-(t.trim?t.trim.y:0)}get originalWidth(){return this.texture.orig.width}get originalHeight(){return this.texture.orig.height}get x(){return this.texture.frame.x}get y(){return this.texture.frame.y}get rotate(){return 0!==this.texture.rotate}get degrees(){return(360-45*this.texture.rotate)%360}}class sy{constructor(){this.x=0,this.y=0,this.width=0,this.height=0,this.offsetX=0,this.offsetY=0,this.originalWidth=0,this.originalHeight=0,this.rotate=0,this.index=0}}class iy{constructor(t,e,n){this.pages=new Array,this.regions=new Array,t&&this.addSpineAtlas(t,e,n)}addTexture(t,e){const n=this.pages;let s=null;for(let r=0;r<n.length;r++)if(n[r].baseTexture===e.baseTexture){s=n[r];break}if(null===s){s=new ay,s.name="texturePage";const t=e.baseTexture;s.width=t.realWidth,s.height=t.realHeight,s.baseTexture=t,s.minFilter=s.magFilter=ty.Nearest,s.uWrap=ey.ClampToEdge,s.vWrap=ey.ClampToEdge,n.push(s)}const i=new oy;return i.name=t,i.page=s,i.texture=e,i.index=-1,this.regions.push(i),i}addTextureHash(t,e){for(const n in t)t.hasOwnProperty(n)&&this.addTexture(e&&-1!==n.indexOf(".")?n.substr(0,n.lastIndexOf(".")):n,t[n])}addSpineAtlas(t,e,n){return this.load(t,e,n)}load(t,e,n){if(null==e)throw new Error("textureLoader cannot be null.");const s=new ry(t),i=new Array(4);let r=null;const a={};let o=null;a.size=()=>{r.width=parseInt(i[1]),r.height=parseInt(i[2])},a.format=()=>{},a.filter=()=>{r.minFilter=Jx(i[1]),r.magFilter=Jx(i[2])},a.repeat=()=>{-1!=i[1].indexOf("x")&&(r.uWrap=ey.Repeat),-1!=i[1].indexOf("y")&&(r.vWrap=ey.Repeat)},a.pma=()=>{r.pma="true"==i[1]};const l={xy:()=>{o.x=parseInt(i[1]),o.y=parseInt(i[2])},size:()=>{o.width=parseInt(i[1]),o.height=parseInt(i[2])},bounds:()=>{o.x=parseInt(i[1]),o.y=parseInt(i[2]),o.width=parseInt(i[3]),o.height=parseInt(i[4])},offset:()=>{o.offsetX=parseInt(i[1]),o.offsetY=parseInt(i[2])},orig:()=>{o.originalWidth=parseInt(i[1]),o.originalHeight=parseInt(i[2])},offsets:()=>{o.offsetX=parseInt(i[1]),o.offsetY=parseInt(i[2]),o.originalWidth=parseInt(i[3]),o.originalHeight=parseInt(i[4])},rotate:()=>{const t=i[1];let e=0;e="true"==t.toLocaleLowerCase()?6:"false"==t.toLocaleLowerCase()?0:(720-parseFloat(t))%360/45,o.rotate=e},index:()=>{o.index=parseInt(i[1])}};let h=s.readLine();for(;null!=h&&0==h.trim().length;)h=s.readLine();for(;null!=h&&0!=h.trim().length&&0!=s.readEntry(i,h);)h=s.readLine();const c=()=>{for(;;){if(null==h)return n&&n(this);if(0==h.trim().length)r=null,h=s.readLine();else{if(null===r){for(r=new ay,r.name=h.trim();0!=s.readEntry(i,h=s.readLine());){const t=a[i[0]];t&&t()}this.pages.push(r),e(r.name,(t=>{if(null===t)return this.pages.splice(this.pages.indexOf(r),1),n&&n(null);r.baseTexture=t,r.pma&&(t.alphaMode=Nr.PMA),t.valid||t.setSize(r.width,r.height),r.setFilters(),r.width&&r.height||(r.width=t.realWidth,r.height=t.realHeight,r.width&&r.height||console.log(`ERROR spine atlas page ${r.name}: meshes wont work if you dont specify size in atlas (http://www.html5gamedevs.com/topic/18888-pixi-spines-and-meshes/?p=107121)`)),c()}));break}{o=new sy;const t=new oy;t.name=h,t.page=r;let e=null,n=null;for(;;){const t=s.readEntry(i,h=s.readLine());if(0==t)break;const r=l[i[0]];if(r)r();else{null==e&&(e=[],n=[]),e.push(i[0]);const s=[];for(let e=0;e<t;e++)s.push(parseInt(i[e+1]));n.push(s)}}0==o.originalWidth&&0==o.originalHeight&&(o.originalWidth=o.width,o.originalHeight=o.height);const a=r.baseTexture.resolution;o.x/=a,o.y/=a,o.width/=a,o.height/=a,o.originalWidth/=a,o.originalHeight/=a,o.offsetX/=a,o.offsetY/=a;const c=o.rotate%4!=0,u=new Zl(o.x,o.y,c?o.height:o.width,c?o.width:o.height),d=new Zl(0,0,o.originalWidth,o.originalHeight),f=new Zl(o.offsetX,o.originalHeight-o.height-o.offsetY,o.width,o.height);t.texture=new ic(t.page.baseTexture,u,d,f,o.rotate),t.index=o.index,t.texture.updateUvs(),this.regions.push(t)}}}};c()}findRegion(t){for(let e=0;e<this.regions.length;e++)if(this.regions[e].name==t)return this.regions[e];return null}dispose(){for(let t=0;t<this.pages.length;t++)this.pages[t].baseTexture.dispose()}}class ry{constructor(t){this.index=0,this.lines=t.split(/\r\n|\r|\n/)}readLine(){return this.index>=this.lines.length?null:this.lines[this.index++]}readEntry(t,e){if(null==e)return 0;if(0==(e=e.trim()).length)return 0;const n=e.indexOf(":");if(-1==n)return 0;t[0]=e.substr(0,n).trim();for(let s=1,i=n+1;;s++){const n=e.indexOf(",",i);if(-1==n)return t[s]=e.substr(i).trim(),s;if(t[s]=e.substr(i,n-i).trim(),i=n+1,4==s)return 4}}}class ay{constructor(){this.minFilter=ty.Nearest,this.magFilter=ty.Nearest,this.uWrap=ey.ClampToEdge,this.vWrap=ey.ClampToEdge}setFilters(){const t=this.baseTexture,e=this.minFilter;e==ty.Linear?t.scaleMode=Or.LINEAR:this.minFilter==ty.Nearest?t.scaleMode=Or.NEAREST:(t.mipmap=Lr.POW2,e==ty.MipMapNearestNearest?t.scaleMode=Or.NEAREST:t.scaleMode=Or.LINEAR)}}class oy extends ny{}class ly{constructor(){this.array=new Array}add(t){const e=this.contains(t);return this.array[0|t]=0|t,!e}contains(t){return null!=this.array[0|t]}remove(t){this.array[0|t]=void 0}clear(){this.array.length=0}}class hy{constructor(){this.entries={},this.size=0}add(t){const e=this.entries[t];return this.entries[t]=!0,!e&&(this.size++,!0)}addAll(t){const e=this.size;for(let n=0,s=t.length;n<s;n++)this.add(t[n]);return e!=this.size}contains(t){return this.entries[t]}clear(){this.entries={},this.size=0}}const cy=class{constructor(t=0,e=0,n=0,s=0){this.r=t,this.g=e,this.b=n,this.a=s}set(t,e,n,s){return this.r=t,this.g=e,this.b=n,this.a=s,this.clamp()}setFromColor(t){return this.r=t.r,this.g=t.g,this.b=t.b,this.a=t.a,this}setFromString(t){return t="#"==t.charAt(0)?t.substr(1):t,this.r=parseInt(t.substr(0,2),16)/255,this.g=parseInt(t.substr(2,2),16)/255,this.b=parseInt(t.substr(4,2),16)/255,this.a=8!=t.length?1:parseInt(t.substr(6,2),16)/255,this}add(t,e,n,s){return this.r+=t,this.g+=e,this.b+=n,this.a+=s,this.clamp()}clamp(){return this.r<0?this.r=0:this.r>1&&(this.r=1),this.g<0?this.g=0:this.g>1&&(this.g=1),this.b<0?this.b=0:this.b>1&&(this.b=1),this.a<0?this.a=0:this.a>1&&(this.a=1),this}static rgba8888ToColor(t,e){t.r=((4278190080&e)>>>24)/255,t.g=((16711680&e)>>>16)/255,t.b=((65280&e)>>>8)/255,t.a=(255&e)/255}static rgb888ToColor(t,e){t.r=((16711680&e)>>>16)/255,t.g=((65280&e)>>>8)/255,t.b=(255&e)/255}static fromString(t){return(new cy).setFromString(t)}};let uy=cy;uy.WHITE=new cy(1,1,1,1),uy.RED=new cy(1,0,0,1),uy.GREEN=new cy(0,1,0,1),uy.BLUE=new cy(0,0,1,1),uy.MAGENTA=new cy(1,0,1,1);const dy=class{static clamp(t,e,n){return t<e?e:t>n?n:t}static cosDeg(t){return Math.cos(t*dy.degRad)}static sinDeg(t){return Math.sin(t*dy.degRad)}static signum(t){return Math.sign(t)}static toInt(t){return t>0?Math.floor(t):Math.ceil(t)}static cbrt(t){const e=Math.pow(Math.abs(t),1/3);return t<0?-e:e}static randomTriangular(t,e){return dy.randomTriangularWith(t,e,.5*(t+e))}static randomTriangularWith(t,e,n){const s=Math.random(),i=e-t;return s<=(n-t)/i?t+Math.sqrt(s*i*(n-t)):e-Math.sqrt((1-s)*i*(e-n))}static isPowerOfTwo(t){return t&&0==(t&t-1)}};let fy=dy;fy.PI=3.1415927,fy.PI2=2*dy.PI,fy.radiansToDegrees=180/dy.PI,fy.radDeg=dy.radiansToDegrees,fy.degreesToRadians=dy.PI/180,fy.degRad=dy.degreesToRadians;class py{apply(t,e,n){return t+(e-t)*this.applyInternal(n)}}class my extends py{constructor(t){super(),this.power=2,this.power=t}applyInternal(t){return t<=.5?Math.pow(2*t,this.power)/2:Math.pow(2*(t-1),this.power)/(this.power%2==0?-2:2)+1}}class gy extends my{applyInternal(t){return Math.pow(t-1,this.power)*(this.power%2==0?-1:1)+1}}const vy=class{static arrayCopy(t,e,n,s,i){for(let r=e,a=s;r<e+i;r++,a++)n[a]=t[r]}static arrayFill(t,e,n,s){for(let i=e;i<n;i++)t[i]=s}static setArraySize(t,e,n=0){const s=t.length;if(s==e)return t;if(t.length=e,s<e)for(let i=s;i<e;i++)t[i]=n;return t}static ensureArrayCapacity(t,e,n=0){return t.length>=e?t:vy.setArraySize(t,e,n)}static newArray(t,e){const n=new Array(t);for(let s=0;s<t;s++)n[s]=e;return n}static newFloatArray(t){if(vy.SUPPORTS_TYPED_ARRAYS)return new Float32Array(t);const e=new Array(t);for(let n=0;n<e.length;n++)e[n]=0;return e}static newShortArray(t){if(vy.SUPPORTS_TYPED_ARRAYS)return new Int16Array(t);const e=new Array(t);for(let n=0;n<e.length;n++)e[n]=0;return e}static toFloatArray(t){return vy.SUPPORTS_TYPED_ARRAYS?new Float32Array(t):t}static toSinglePrecision(t){return vy.SUPPORTS_TYPED_ARRAYS?Math.fround(t):t}static webkit602BugfixHelper(t,e){}static contains(t,e,n=!0){for(let s=0;s<t.length;s++)if(t[s]==e)return!0;return!1}static enumValue(t,e){return t[e[0].toUpperCase()+e.slice(1)]}};let xy=vy;xy.SUPPORTS_TYPED_ARRAYS="undefined"!=typeof Float32Array;class yy{constructor(t){this.items=new Array,this.instantiator=t}obtain(){return this.items.length>0?this.items.pop():this.instantiator()}free(t){t.reset&&t.reset(),this.items.push(t)}freeAll(t){for(let e=0;e<t.length;e++)this.free(t[e])}clear(){this.items.length=0}}class _y{constructor(t=0,e=0){this.x=t,this.y=e}set(t,e){return this.x=t,this.y=e,this}length(){const t=this.x,e=this.y;return Math.sqrt(t*t+e*e)}normalize(){const t=this.length();return 0!=t&&(this.x/=t,this.y/=t),this}}class by{constructor(){this.minX=0,this.minY=0,this.maxX=0,this.maxY=0,this.boundingBoxes=new Array,this.polygons=new Array,this.polygonPool=new yy((()=>xy.newFloatArray(16)))}update(t,e){if(!t)throw new Error("skeleton cannot be null.");const n=this.boundingBoxes,s=this.polygons,i=this.polygonPool,r=t.slots,a=r.length;n.length=0,i.freeAll(s),s.length=0;for(let o=0;o<a;o++){const t=r[o];if(!t.bone.active)continue;const e=t.getAttachment();if(null!=e&&e.type===Hx.BoundingBox){const r=e;n.push(r);let a=i.obtain();a.length!=r.worldVerticesLength&&(a=xy.newFloatArray(r.worldVerticesLength)),s.push(a),r.computeWorldVertices(t,0,r.worldVerticesLength,a,0,2)}}e?this.aabbCompute():(this.minX=Number.POSITIVE_INFINITY,this.minY=Number.POSITIVE_INFINITY,this.maxX=Number.NEGATIVE_INFINITY,this.maxY=Number.NEGATIVE_INFINITY)}aabbCompute(){let t=Number.POSITIVE_INFINITY,e=Number.POSITIVE_INFINITY,n=Number.NEGATIVE_INFINITY,s=Number.NEGATIVE_INFINITY;const i=this.polygons;for(let r=0,a=i.length;r<a;r++){const a=i[r],o=a;for(let i=0,r=a.length;i<r;i+=2){const r=o[i],a=o[i+1];t=Math.min(t,r),e=Math.min(e,a),n=Math.max(n,r),s=Math.max(s,a)}}this.minX=t,this.minY=e,this.maxX=n,this.maxY=s}aabbContainsPoint(t,e){return t>=this.minX&&t<=this.maxX&&e>=this.minY&&e<=this.maxY}aabbIntersectsSegment(t,e,n,s){const i=this.minX,r=this.minY,a=this.maxX,o=this.maxY;if(t<=i&&n<=i||e<=r&&s<=r||t>=a&&n>=a||e>=o&&s>=o)return!1;const l=(s-e)/(n-t);let h=l*(i-t)+e;if(h>r&&h<o)return!0;if(h=l*(a-t)+e,h>r&&h<o)return!0;let c=(r-e)/l+t;return c>i&&c<a||(c=(o-e)/l+t,c>i&&c<a)}aabbIntersectsSkeleton(t){return this.minX<t.maxX&&this.maxX>t.minX&&this.minY<t.maxY&&this.maxY>t.minY}containsPoint(t,e){const n=this.polygons;for(let s=0,i=n.length;s<i;s++)if(this.containsPointPolygon(n[s],t,e))return this.boundingBoxes[s];return null}containsPointPolygon(t,e,n){const s=t,i=t.length;let r=i-2,a=!1;for(let o=0;o<i;o+=2){const t=s[o+1],i=s[r+1];if(t<n&&i>=n||i<n&&t>=n){const l=s[o];l+(n-t)/(i-t)*(s[r]-l)<e&&(a=!a)}r=o}return a}intersectsSegment(t,e,n,s){const i=this.polygons;for(let r=0,a=i.length;r<a;r++)if(this.intersectsSegmentPolygon(i[r],t,e,n,s))return this.boundingBoxes[r];return null}intersectsSegmentPolygon(t,e,n,s,i){const r=t,a=t.length,o=e-s,l=n-i,h=e*i-n*s;let c=r[a-2],u=r[a-1];for(let d=0;d<a;d+=2){const t=r[d],a=r[d+1],f=c*a-u*t,p=c-t,m=u-a,g=o*m-l*p,v=(h*p-o*f)/g;if((v>=c&&v<=t||v>=t&&v<=c)&&(v>=e&&v<=s||v>=s&&v<=e)){const t=(h*m-l*f)/g;if((t>=u&&t<=a||t>=a&&t<=u)&&(t>=n&&t<=i||t>=i&&t<=n))return!0}c=t,u=a}return!1}getPolygon(t){if(!t)throw new Error("boundingBox cannot be null.");const e=this.boundingBoxes.indexOf(t);return-1==e?null:this.polygons[e]}getWidth(){return this.maxX-this.minX}getHeight(){return this.maxY-this.minY}}const wy=0,Ey=[0,0,0];class Ty extends Pu{constructor(){super(...arguments),this.region=null,this.attachment=null}}class Sy extends cp{constructor(t,e,n,s,i){super(t,e,n,s,i),this.region=null,this.attachment=null}}const Ay=class extends Iu{constructor(t){if(super(),!t)throw new Error("The spineData param is required.");if("string"==typeof t)throw new Error('spineData param cant be string. Please use spine.Spine.fromAtlas("YOUR_RESOURCE_NAME") from now on.');this.spineData=t,this.createSkeleton(t),this.slotContainers=[],this.tempClipContainers=[];for(let e=0,n=this.skeleton.slots.length;e<n;e++){const t=this.skeleton.slots[e],n=t.getAttachment(),s=this.newContainer();if(this.slotContainers.push(s),this.addChild(s),this.tempClipContainers.push(null),n)if(n.type===Hx.Region){const e=n.name,i=this.createSprite(t,n,e);t.currentSprite=i,t.currentSpriteName=e,s.addChild(i)}else if(n.type===Hx.Mesh){const e=this.createMesh(t,n);t.currentMesh=e,t.currentMeshId=n.id,t.currentMeshName=n.name,s.addChild(e)}else n.type===Hx.Clipping&&(this.createGraphics(t,n),s.addChild(t.clippingContainer),s.addChild(t.currentGraphics))}this.tintRgb=new Float32Array([1,1,1]),this.autoUpdate=!0,this.visible=!0}get debug(){return this._debug}set debug(t){var e;t!=this._debug&&(null==(e=this._debug)||e.unregisterSpine(this),null==t||t.registerSpine(this),this._debug=t)}get autoUpdate(){return this._autoUpdate}set autoUpdate(t){t!==this._autoUpdate&&(this._autoUpdate=t,this.updateTransform=t?Ay.prototype.autoUpdateTransform:Iu.prototype.updateTransform)}get tint(){return Zo(this.tintRgb)}set tint(t){this.tintRgb=Ko(t,this.tintRgb)}get delayLimit(){return(void 0!==this.localDelayLimit?this.localDelayLimit:wy)||Number.MAX_VALUE}update(t){var e;const n=this.delayLimit;if(t>n&&(t=n),this.state.update(t),this.state.apply(this.skeleton),!this.skeleton)return;this.skeleton.updateWorldTransform();const s=this.skeleton.slots,i=this.color;let r=null,a=null;i?(r=i.light,a=i.dark):r=this.tintRgb;for(let c=0,u=s.length;c<u;c++){const t=s[c],e=t.getAttachment(),n=this.slotContainers[c];if(!e){n.visible=!1;continue}let i=null;e.sequence&&e.sequence.apply(t,e);let o=e.region;const l=e.color;switch(null!=e&&e.type){case Hx.Region:if(n.transform.setFromMatrix(t.bone.matrix),o=e.region,t.currentMesh&&(t.currentMesh.visible=!1,t.currentMesh=null,t.currentMeshId=void 0,t.currentMeshName=void 0),!o){t.currentSprite&&(t.currentSprite.renderable=!1);break}if(!t.currentSpriteName||t.currentSpriteName!==e.name){const s=e.name;if(t.currentSprite&&(t.currentSprite.visible=!1),t.sprites=t.sprites||{},void 0!==t.sprites[s])t.sprites[s].visible=!0;else{const i=this.createSprite(t,e,s);n.addChild(i)}t.currentSprite=t.sprites[s],t.currentSpriteName=s}t.currentSprite.renderable=!0,t.hackRegion||this.setSpriteRegion(e,t.currentSprite,o),t.currentSprite.color?i=t.currentSprite.color:(Ey[0]=r[0]*t.color.r*l.r,Ey[1]=r[1]*t.color.g*l.g,Ey[2]=r[2]*t.color.b*l.b,t.currentSprite.tint=Zo(Ey)),t.currentSprite.blendMode=t.blendMode;break;case Hx.Mesh:if(t.currentSprite){t.currentSprite.visible=!1,t.currentSprite=null,t.currentSpriteName=void 0;const e=new fh;e._parentID=-1,e._worldID=n.transform._worldID,n.transform=e}if(!o){t.currentMesh&&(t.currentMesh.renderable=!1);break}const s=e.id;if(void 0===t.currentMeshId||t.currentMeshId!==s){const i=s;if(t.currentMesh&&(t.currentMesh.visible=!1),t.meshes=t.meshes||{},void 0!==t.meshes[i])t.meshes[i].visible=!0;else{const s=this.createMesh(t,e);n.addChild(s)}t.currentMesh=t.meshes[i],t.currentMeshName=e.name,t.currentMeshId=i}t.currentMesh.renderable=!0,e.computeWorldVerticesOld(t,t.currentMesh.vertices),t.currentMesh.color?i=t.currentMesh.color:(Ey[0]=r[0]*t.color.r*l.r,Ey[1]=r[1]*t.color.g*l.g,Ey[2]=r[2]*t.color.b*l.b,t.currentMesh.tint=Zo(Ey)),t.currentMesh.blendMode=t.blendMode,t.hackRegion||this.setMeshRegion(e,t.currentMesh,o);break;case Hx.Clipping:t.currentGraphics||(this.createGraphics(t,e),n.addChild(t.clippingContainer),n.addChild(t.currentGraphics)),this.updateGraphics(t,e),n.alpha=1,n.visible=!0;continue;default:n.visible=!1;continue}if(n.visible=!0,i){let e=t.color.r*l.r,n=t.color.g*l.g,s=t.color.b*l.b;i.setLight(r[0]*e+a[0]*(1-e),r[1]*n+a[1]*(1-n),r[2]*s+a[2]*(1-s)),t.darkColor?(e=t.darkColor.r,n=t.darkColor.g,s=t.darkColor.b):(e=0,n=0,s=0),i.setDark(r[0]*e+a[0]*(1-e),r[1]*n+a[1]*(1-n),r[2]*s+a[2]*(1-s))}n.alpha=t.color.a}const o=this.skeleton.drawOrder;let l=null,h=null;for(let c=0,u=o.length;c<u;c++){const t=s[o[c].data.index],e=this.slotContainers[o[c].data.index];if(h||null!==e.parent&&e.parent!==this&&(e.parent.removeChild(e),e.parent=this),t.currentGraphics&&t.getAttachment())h=t.clippingContainer,l=t.getAttachment(),h.children.length=0,this.children[c]=e,l.endSlot===t.data&&(l.endSlot=null);else if(h){let n=this.tempClipContainers[c];n||(n=this.tempClipContainers[c]=this.newContainer(),n.visible=!1),this.children[c]=n,e.parent=null,h.addChild(e),l.endSlot==t.data&&(h.renderable=!0,h=null,l=null)}else this.children[c]=e}null==(e=this._debug)||e.renderDebug(this)}setSpriteRegion(t,e,n){e.attachment===t&&e.region===n||(e.region=n,e.attachment=t,e.texture=n.texture,e.rotation=t.rotation*fy.degRad,e.position.x=t.x,e.position.y=t.y,e.alpha=t.color.a,n.size?(e.scale.x=n.size.width/n.originalWidth,e.scale.y=-n.size.height/n.originalHeight):(e.scale.x=t.scaleX*t.width/n.originalWidth,e.scale.y=-t.scaleY*t.height/n.originalHeight))}setMeshRegion(t,e,n){e.attachment===t&&e.region===n||(e.region=n,e.attachment=t,e.texture=n.texture,n.texture.updateUvs(),e.uvBuffer.update(t.regionUVs))}autoUpdateTransform(){{this.lastTime=this.lastTime||Date.now();const t=.001*(Date.now()-this.lastTime);this.lastTime=Date.now(),this.update(t)}Iu.prototype.updateTransform.call(this)}createSprite(t,e,n){let s=e.region;t.hackAttachment===e&&(s=t.hackRegion);const i=s?s.texture:null,r=this.newSprite(i);return r.anchor.set(.5),s&&this.setSpriteRegion(e,r,e.region),t.sprites=t.sprites||{},t.sprites[n]=r,r}createMesh(t,e){let n=e.region;t.hackAttachment===e&&(n=t.hackRegion,t.hackAttachment=null,t.hackRegion=null);const s=this.newMesh(n?n.texture:null,new Float32Array(e.regionUVs.length),e.regionUVs,new Uint16Array(e.triangles),Mr.TRIANGLES);return void 0!==s._canvasPadding&&(s._canvasPadding=1.5),s.alpha=e.color.a,s.region=e.region,n&&this.setMeshRegion(e,s,n),t.meshes=t.meshes||{},t.meshes[e.id]=s,s}createGraphics(t,e){const n=this.newGraphics(),s=new th([]);return n.clear(),n.beginFill(16777215,1),n.drawPolygon(s),n.renderable=!1,t.currentGraphics=n,t.clippingContainer=this.newContainer(),t.clippingContainer.mask=t.currentGraphics,n}updateGraphics(t,e){const n=t.currentGraphics.geometry,s=n.graphicsData[0].shape.points,i=e.worldVerticesLength;s.length=i,e.computeWorldVertices(t,0,i,s,0,2),n.invalidate()}hackTextureBySlotIndex(t,e=null,n=null){const s=this.skeleton.slots[t];if(!s)return!1;const i=s.getAttachment();let r=i.region;return e?(r=new ny,r.texture=e,r.size=n,s.hackRegion=r,s.hackAttachment=i):(s.hackRegion=null,s.hackAttachment=null),s.currentSprite?this.setSpriteRegion(i,s.currentSprite,r):s.currentMesh&&this.setMeshRegion(i,s.currentMesh,r),!0}hackTextureBySlotName(t,e=null,n=null){const s=this.skeleton.findSlotIndex(t);return-1!=s&&this.hackTextureBySlotIndex(s,e,n)}hackTextureAttachment(t,e,n,s=null){const i=this.skeleton.findSlotIndex(t),r=this.skeleton.getAttachmentByName(t,e);r.region.texture=n;const a=this.skeleton.slots[i];if(!a)return!1;const o=a.getAttachment();if(e===o.name){let t=r.region;return n?(t=new ny,t.texture=n,t.size=s,a.hackRegion=t,a.hackAttachment=o):(a.hackRegion=null,a.hackAttachment=null),a.currentSprite&&a.currentSprite.region!=t?(this.setSpriteRegion(o,a.currentSprite,t),a.currentSprite.region=t):a.currentMesh&&a.currentMesh.region!=t&&this.setMeshRegion(o,a.currentMesh,t),!0}return!1}newContainer(){return new Iu}newSprite(t){return new Ty(t)}newGraphics(){return new np}newMesh(t,e,n,s,i){return new Sy(t,e,n,s,i)}transformHack(){return 1}hackAttachmentGroups(t,e,n){if(!t)return;const s=[],i=[];for(let r=0,a=this.skeleton.slots.length;r<a;r++){const a=this.skeleton.slots[r],o=a.currentSpriteName||a.currentMeshName||"",l=a.currentSprite||a.currentMesh;o.endsWith(t)?(l.parentGroup=e,i.push(l)):n&&l&&(l.parentGroup=n,s.push(l))}return[s,i]}destroy(t){this.debug=null;for(let e=0,n=this.skeleton.slots.length;e<n;e++){const n=this.skeleton.slots[e];for(const e in n.meshes)n.meshes[e].destroy(t);n.meshes=null;for(const e in n.sprites)n.sprites[e].destroy(t);n.sprites=null}for(let e=0,n=this.slotContainers.length;e<n;e++)this.slotContainers[e].destroy(t);this.spineData=null,this.skeleton=null,this.slotContainers=null,this.stateData=null,this.state=null,this.tempClipContainers=null,super.destroy(t)}};let Cy=Ay;Cy.clippingPolygon=[],Object.defineProperty(Cy.prototype,"visible",{get(){return this._visible},set(t){t!==this._visible&&(this._visible=t,t&&(this.lastTime=0))}});class Iy{constructor(){this.registeredSpines=new Map,this.drawDebug=!0,this.drawMeshHull=!0,this.drawMeshTriangles=!0,this.drawBones=!0,this.drawPaths=!0,this.drawBoundingBoxes=!0,this.drawClipping=!0,this.drawRegionAttachments=!0,this.lineWidth=1,this.regionAttachmentsColor=30975,this.meshHullColor=30975,this.meshTrianglesColor=16763904,this.clippingPolygonColor=16711935,this.boundingBoxesRectColor=65280,this.boundingBoxesPolygonColor=65280,this.boundingBoxesCircleColor=65280,this.pathsCurveColor=16711680,this.pathsLineColor=16711935,this.skeletonXYColor=16711680,this.bonesColor=61132}registerSpine(t){this.registeredSpines.has(t)&&console.warn("SpineDebugRenderer.registerSpine() - this spine is already registered!",t);const e={parentDebugContainer:new Iu,bones:new Iu,skeletonXY:new np,regionAttachmentsShape:new np,meshTrianglesLine:new np,meshHullLine:new np,clippingPolygon:new np,boundingBoxesRect:new np,boundingBoxesCircle:new np,boundingBoxesPolygon:new np,pathsCurve:new np,pathsLine:new np};e.parentDebugContainer.addChild(e.bones),e.parentDebugContainer.addChild(e.skeletonXY),e.parentDebugContainer.addChild(e.regionAttachmentsShape),e.parentDebugContainer.addChild(e.meshTrianglesLine),e.parentDebugContainer.addChild(e.meshHullLine),e.parentDebugContainer.addChild(e.clippingPolygon),e.parentDebugContainer.addChild(e.boundingBoxesRect),e.parentDebugContainer.addChild(e.boundingBoxesCircle),e.parentDebugContainer.addChild(e.boundingBoxesPolygon),e.parentDebugContainer.addChild(e.pathsCurve),e.parentDebugContainer.addChild(e.pathsLine),t.addChild(e.parentDebugContainer),this.registeredSpines.set(t,e)}renderDebug(t){this.registeredSpines.has(t)||this.registerSpine(t);const e=this.registeredSpines.get(t);e.skeletonXY.clear(),e.regionAttachmentsShape.clear(),e.meshTrianglesLine.clear(),e.meshHullLine.clear(),e.clippingPolygon.clear(),e.boundingBoxesRect.clear(),e.boundingBoxesCircle.clear(),e.boundingBoxesPolygon.clear(),e.pathsCurve.clear(),e.pathsLine.clear();for(let i=e.bones.children.length;i>0;i--)e.bones.children[i-1].destroy({children:!0,texture:!0,baseTexture:!0});const n=t.scale.x||t.scale.y||1,s=this.lineWidth/n;this.drawBones&&this.drawBonesFunc(t,e,s,n),this.drawPaths&&this.drawPathsFunc(t,e,s),this.drawBoundingBoxes&&this.drawBoundingBoxesFunc(t,e,s),this.drawClipping&&this.drawClippingFunc(t,e,s),(this.drawMeshHull||this.drawMeshTriangles)&&this.drawMeshHullAndMeshTriangles(t,e,s),this.drawRegionAttachments&&this.drawRegionAttachmentsFunc(t,e,s)}drawBonesFunc(t,e,n,s){const i=t.skeleton,r=i.x,a=i.y,o=i.bones;e.skeletonXY.lineStyle(n,this.skeletonXYColor,1);for(let h=0,c=o.length;h<c;h++){const t=o[h],i=t.data.length,l=r+t.matrix.tx,c=a+t.matrix.ty,u=r+i*t.matrix.a+t.matrix.tx,d=a+i*t.matrix.b+t.matrix.ty;if("root"===t.data.name||null===t.data.parent)continue;const f=Math.abs(l-u),p=Math.abs(c-d),m=Math.pow(f,2),g=p,v=Math.pow(p,2),x=Math.sqrt(m+v),y=Math.pow(x,2),_=Math.PI/180,b=Math.acos((y+v-m)/(2*g*x))||0;if(0===x)continue;const w=new np;e.bones.addChild(w);const E=x/50/s;w.beginFill(this.bonesColor,1),w.drawPolygon(0,0,0-E,x-3*E,0,x-E,0+E,x-3*E),w.endFill(),w.x=l,w.y=c,w.pivot.y=x;let T=0;l<u&&c<d?T=180*_-b:l>u&&c<d?T=180*_+b:l>u&&c>d?T=-b:l<u&&c>d?T=b:c===d&&l<u?T=90*_:c===d&&l>u?T=-90*_:l===u&&c<d?T=180*_:l===u&&c>d&&(T=0),w.rotation=T,w.lineStyle(n+E/2.4,this.bonesColor,1),w.beginFill(0,.6),w.drawCircle(0,x,1.2*E),w.endFill()}const l=3*n;e.skeletonXY.moveTo(r-l,a-l),e.skeletonXY.lineTo(r+l,a+l),e.skeletonXY.moveTo(r+l,a-l),e.skeletonXY.lineTo(r-l,a+l)}drawRegionAttachmentsFunc(t,e,n){const s=t.skeleton.slots;e.regionAttachmentsShape.lineStyle(n,this.regionAttachmentsColor,1);for(let i=0,r=s.length;i<r;i++){const t=s[i],n=t.getAttachment();if(null==n||n.type!==Hx.Region)continue;const r=n,a=new Float32Array(8);r.updateOffset&&r.updateOffset(),r.computeWorldVertices(t,a,0,2),e.regionAttachmentsShape.drawPolygon(Array.from(a.slice(0,8)))}}drawMeshHullAndMeshTriangles(t,e,n){const s=t.skeleton.slots;e.meshHullLine.lineStyle(n,this.meshHullColor,1),e.meshTrianglesLine.lineStyle(n,this.meshTrianglesColor,1);for(let i=0,r=s.length;i<r;i++){const t=s[i];if(!t.bone.active)continue;const n=t.getAttachment();if(null==n||n.type!==Hx.Mesh)continue;const r=n,a=new Float32Array(r.worldVerticesLength),o=r.triangles;let l=r.hullLength;if(r.computeWorldVertices(t,0,r.worldVerticesLength,a,0,2),this.drawMeshTriangles)for(let s=0,i=o.length;s<i;s+=3){const t=2*o[s],n=2*o[s+1],i=2*o[s+2];e.meshTrianglesLine.moveTo(a[t],a[t+1]),e.meshTrianglesLine.lineTo(a[n],a[n+1]),e.meshTrianglesLine.lineTo(a[i],a[i+1])}if(this.drawMeshHull&&l>0){l=2*(l>>1);let t=a[l-2],n=a[l-1];for(let s=0,i=l;s<i;s+=2){const i=a[s],r=a[s+1];e.meshHullLine.moveTo(i,r),e.meshHullLine.lineTo(t,n),t=i,n=r}}}}drawClippingFunc(t,e,n){const s=t.skeleton.slots;e.clippingPolygon.lineStyle(n,this.clippingPolygonColor,1);for(let i=0,r=s.length;i<r;i++){const t=s[i];if(!t.bone.active)continue;const n=t.getAttachment();if(null==n||n.type!==Hx.Clipping)continue;const r=n,a=r.worldVerticesLength,o=new Float32Array(a);r.computeWorldVertices(t,0,a,o,0,2),e.clippingPolygon.drawPolygon(Array.from(o))}}drawBoundingBoxesFunc(t,e,n){e.boundingBoxesRect.lineStyle(n,this.boundingBoxesRectColor,5);const s=new by;s.update(t.skeleton,!0),e.boundingBoxesRect.drawRect(s.minX,s.minY,s.getWidth(),s.getHeight());const i=s.polygons,r=(t,s,i)=>{if(e.boundingBoxesPolygon.lineStyle(n,this.boundingBoxesPolygonColor,1),e.boundingBoxesPolygon.beginFill(this.boundingBoxesPolygonColor,.1),i<3)throw new Error("Polygon must contain at least 3 vertices");const r=[],a=2*n;for(let n=0,o=t.length;n<o;n+=2){const s=t[n],i=t[n+1];e.boundingBoxesCircle.lineStyle(0),e.boundingBoxesCircle.beginFill(this.boundingBoxesCircleColor),e.boundingBoxesCircle.drawCircle(s,i,a),e.boundingBoxesCircle.endFill(),r.push(s,i)}e.boundingBoxesPolygon.drawPolygon(r),e.boundingBoxesPolygon.endFill()};for(let a=0,o=i.length;a<o;a++){const t=i[a];r(t,0,t.length)}}drawPathsFunc(t,e,n){const s=t.skeleton.slots;e.pathsCurve.lineStyle(n,this.pathsCurveColor,1),e.pathsLine.lineStyle(n,this.pathsLineColor,1);for(let i=0,r=s.length;i<r;i++){const t=s[i];if(!t.bone.active)continue;const n=t.getAttachment();if(null==n||n.type!==Hx.Path)continue;const r=n;let a=r.worldVerticesLength;const o=new Float32Array(a);r.computeWorldVertices(t,0,a,o,0,2);let l=o[2],h=o[3],c=0,u=0;if(r.closed){const t=o[0],n=o[1],s=o[a-2],i=o[a-1];c=o[a-4],u=o[a-3],e.pathsCurve.moveTo(l,h),e.pathsCurve.bezierCurveTo(t,n,s,i,c,u),e.pathsLine.moveTo(l,h),e.pathsLine.lineTo(t,n),e.pathsLine.moveTo(c,u),e.pathsLine.lineTo(s,i)}a-=4;for(let s=4;s<a;s+=6){const t=o[s],n=o[s+1],i=o[s+2],r=o[s+3];c=o[s+4],u=o[s+5],e.pathsCurve.moveTo(l,h),e.pathsCurve.bezierCurveTo(t,n,i,r,c,u),e.pathsLine.moveTo(l,h),e.pathsLine.lineTo(t,n),e.pathsLine.moveTo(c,u),e.pathsLine.lineTo(i,r),l=c,h=u}}}unregisterSpine(t){this.registeredSpines.has(t)||console.warn("SpineDebugRenderer.unregisterSpine() - spine is not registered, can't unregister!",t);this.registeredSpines.get(t).parentDebugContainer.destroy({baseTexture:!0,children:!0,texture:!0}),this.registeredSpines.delete(t)}}const My={extension:yl.Asset,loader:{extension:{type:yl.LoadParser,priority:pd.Normal},test:t=>ad(t,".atlas"),load(t){return m(this,null,(function*(){const e=yield zr.ADAPTER.fetch(t);return yield e.text()}))},testParse(t,e){const n=ad(e.src,".atlas"),s="string"==typeof t;return Promise.resolve(n&&s)},parse(t,e,n){return m(this,null,(function*(){const s=e.data;let i=mo.dirname(e.src);i&&i.lastIndexOf("/")!==i.length-1&&(i+="/");let r=null,a=null;const o=new Promise(((t,e)=>{r=t,a=e}));let l;const h=t=>{t||a("Something went terribly wrong loading a spine .atlas file\nMost likely your texture failed to load."),r(l)};if(s.image||s.images){const e=Object.assign(s.image?{default:s.image}:{},s.images);l=new iy(t,((t,n)=>{const s=e[t]||e.default;s&&s.baseTexture?n(s.baseTexture):n(s)}),h)}else l=new iy(t,Ry(n,i,s.imageMetadata),h);return yield o}))},unload(t){t.dispose()}}},Ry=(t,e,n)=>(s,i)=>m(void 0,null,(function*(){const r=mo.normalize([...e.split(mo.sep),s].join(mo.sep)),a=yield t.load({src:r,data:n});i(a.baseTexture)}));function Py(t){return t.hasOwnProperty("bones")}wl.add(My);class ky{constructor(){}installLoader(){const t=this,e={extension:yl.Asset,loader:{extension:{type:yl.LoadParser,priority:pd.Normal},test:t=>ad(t,".skel"),load(t){return m(this,null,(function*(){const e=yield zr.ADAPTER.fetch(t);return yield e.arrayBuffer()}))},testParse(t,e){var n;const s=ad(e.src,".json")&&Py(t),i=ad(e.src,".skel")&&t instanceof ArrayBuffer;const r=!1===(null==(n=e.data)?void 0:n.spineAtlas);return Promise.resolve(s&&!r||i)},parse(e,n,s){return m(this,null,(function*(){var i;const r=mo.extname(n.src).toLowerCase(),a=mo.basename(n.src,r);let o=mo.dirname(n.src);o&&o.lastIndexOf("/")!==o.length-1&&(o+="/");const l=ad(n.src,".json")&&Py(e);let h=null,c=e;l?h=t.createJsonParser():(h=t.createBinaryParser(),c=new Uint8Array(e));const u=n.data||{},d=null!=(i=null==u?void 0:u.spineSkeletonScale)?i:null;d&&(h.scale=d);const f=u.spineAtlas;if(f&&f.pages)return t.parseData(h,f,c);const p=u.atlasRawData;if(p){let e=null,n=null;const i=new Promise(((t,s)=>{e=t,n=s})),r=new iy(p,Ry(s,o,u.imageMetadata),(t=>{t||n("Something went terribly wrong loading a spine .atlas file\nMost likely your texture failed to load."),e(r)})),a=yield i;return t.parseData(h,a,c)}let m=u.spineAtlasFile;m||(m=`${o+a}.atlas`);const g=yield s.load({src:m,data:u,alias:u.spineAtlasAlias});return t.parseData(h,g,c)}))}}};return wl.add(e),e}}let Fy=class{constructor(t){if(null==t)throw new Error("name cannot be null.");this.name=t}};const Oy=class extends Fy{constructor(t){super(t),this.id=(65535&Oy.nextID++)<<11,this.worldVerticesLength=0,this.deformAttachment=this}computeWorldVerticesOld(t,e){this.computeWorldVertices(t,0,this.worldVerticesLength,e,0,2)}computeWorldVertices(t,e,n,s,i,r){n=i+(n>>1)*r;const a=t.bone.skeleton,o=t.deform;let l=this.vertices;const h=this.bones;if(null==h){o.length>0&&(l=o);const a=t.bone.matrix,h=a.tx,c=a.ty,u=a.a,d=a.c,f=a.b,p=a.d;for(let t=e,o=i;o<n;t+=2,o+=r){const e=l[t],n=l[t+1];s[o]=e*u+n*d+h,s[o+1]=e*f+n*p+c}return}let c=0,u=0;for(let f=0;f<e;f+=2){const t=h[c];c+=t+1,u+=t}const d=a.bones;if(0==o.length)for(let f=i,p=3*u;f<n;f+=r){let t=0,e=0,n=h[c++];for(n+=c;c<n;c++,p+=3){const n=d[h[c]].matrix,s=l[p],i=l[p+1],r=l[p+2];t+=(s*n.a+i*n.c+n.tx)*r,e+=(s*n.b+i*n.d+n.ty)*r}s[f]=t,s[f+1]=e}else{const t=o;for(let e=i,a=3*u,o=u<<1;e<n;e+=r){let n=0,i=0,r=h[c++];for(r+=c;c<r;c++,a+=3,o+=2){const e=d[h[c]].matrix,s=l[a]+t[o],r=l[a+1]+t[o+1],u=l[a+2];n+=(s*e.a+r*e.c+e.tx)*u,i+=(s*e.b+r*e.d+e.ty)*u}s[e]=n,s[e+1]=i}}}copyTo(t){null!=this.bones?(t.bones=new Array(this.bones.length),xy.arrayCopy(this.bones,0,t.bones,0,this.bones.length)):t.bones=null,null!=this.vertices?(t.vertices=xy.newFloatArray(this.vertices.length),xy.arrayCopy(this.vertices,0,t.vertices,0,this.vertices.length)):t.vertices=null,t.worldVerticesLength=this.worldVerticesLength,t.deformAttachment=this.deformAttachment}};let Dy=Oy;Dy.nextID=0;let Ly=class t extends Dy{constructor(t){super(t),this.type=Hx.BoundingBox,this.color=new uy(1,1,1,1)}copy(){const e=new t(this.name);return this.copyTo(e),e.color.setFromColor(this.color),e}},Ny=class t extends Dy{constructor(t){super(t),this.type=Hx.Clipping,this.color=new uy(.2275,.2275,.8078,1)}copy(){const e=new t(this.name);return this.copyTo(e),e.endSlot=this.endSlot,e.color.setFromColor(this.color),e}},By=class t extends Dy{constructor(t){super(t),this.type=Hx.Mesh,this.color=new uy(1,1,1,1),this.tempColor=new uy(0,0,0,0)}getParentMesh(){return this.parentMesh}setParentMesh(t){this.parentMesh=t,null!=t&&(this.bones=t.bones,this.vertices=t.vertices,this.worldVerticesLength=t.worldVerticesLength,this.regionUVs=t.regionUVs,this.triangles=t.triangles,this.hullLength=t.hullLength,this.worldVerticesLength=t.worldVerticesLength)}copy(){if(null!=this.parentMesh)return this.newLinkedMesh();const e=new t(this.name);return e.region=this.region,e.path=this.path,e.color.setFromColor(this.color),this.copyTo(e),e.regionUVs=new Float32Array(this.regionUVs.length),xy.arrayCopy(this.regionUVs,0,e.regionUVs,0,this.regionUVs.length),e.triangles=new Array(this.triangles.length),xy.arrayCopy(this.triangles,0,e.triangles,0,this.triangles.length),e.hullLength=this.hullLength,null!=this.edges&&(e.edges=new Array(this.edges.length),xy.arrayCopy(this.edges,0,e.edges,0,this.edges.length)),e.width=this.width,e.height=this.height,e}newLinkedMesh(){const e=new t(this.name);return e.region=this.region,e.path=this.path,e.color.setFromColor(this.color),e.deformAttachment=this.deformAttachment,e.setParentMesh(null!=this.parentMesh?this.parentMesh:this),e}},Vy=class t extends Dy{constructor(t){super(t),this.type=Hx.Path,this.closed=!1,this.constantSpeed=!1,this.color=new uy(1,1,1,1)}copy(){const e=new t(this.name);return this.copyTo(e),e.lengths=new Array(this.lengths.length),xy.arrayCopy(this.lengths,0,e.lengths,0,this.lengths.length),e.closed=closed,e.constantSpeed=this.constantSpeed,e.color.setFromColor(this.color),e}},Uy=class t extends Dy{constructor(t){super(t),this.type=Hx.Point,this.color=new uy(.38,.94,0,1)}computeWorldPosition(t,e){const n=t.matrix;return e.x=this.x*n.a+this.y*n.c+t.worldX,e.y=this.x*n.b+this.y*n.d+t.worldY,e}computeWorldRotation(t){const e=t.matrix,n=fy.cosDeg(this.rotation),s=fy.sinDeg(this.rotation),i=n*e.a+s*e.c,r=n*e.b+s*e.d;return Math.atan2(r,i)*fy.radDeg}copy(){const e=new t(this.name);return e.x=this.x,e.y=this.y,e.rotation=this.rotation,e.color.setFromColor(this.color),e}},Xy=class{constructor(t,e){if(this.deform=new Array,null==t)throw new Error("data cannot be null.");if(null==e)throw new Error("bone cannot be null.");this.data=t,this.bone=e,this.color=new uy,this.darkColor=null==t.darkColor?null:new uy,this.setToSetupPose(),this.blendMode=this.data.blendMode}getAttachment(){return this.attachment}setAttachment(t){this.attachment!=t&&(this.attachment=t,this.attachmentTime=this.bone.skeleton.time,this.deform.length=0)}setAttachmentTime(t){this.attachmentTime=this.bone.skeleton.time-t}getAttachmentTime(){return this.bone.skeleton.time-this.attachmentTime}setToSetupPose(){this.color.setFromColor(this.data.color),null!=this.darkColor&&this.darkColor.setFromColor(this.data.darkColor),null==this.data.attachmentName?this.attachment=null:(this.attachment=null,this.setAttachment(this.bone.skeleton.getAttachment(this.data.index,this.data.attachmentName)))}};const Yy=class extends Fy{constructor(t){super(t),this.type=Hx.Region,this.x=0,this.y=0,this.scaleX=1,this.scaleY=1,this.rotation=0,this.width=0,this.height=0,this.color=new uy(1,1,1,1),this.offset=xy.newFloatArray(8),this.uvs=xy.newFloatArray(8),this.tempColor=new uy(1,1,1,1)}updateOffset(){const t=this.width/this.region.originalWidth*this.scaleX,e=this.height/this.region.originalHeight*this.scaleY,n=-this.width/2*this.scaleX+this.region.offsetX*t,s=-this.height/2*this.scaleY+this.region.offsetY*e,i=n+this.region.width*t,r=s+this.region.height*e,a=this.rotation*Math.PI/180,o=Math.cos(a),l=Math.sin(a),h=n*o+this.x,c=n*l,u=s*o+this.y,d=s*l,f=i*o+this.x,p=i*l,m=r*o+this.y,g=r*l,v=this.offset;v[Yy.OX1]=h-d,v[Yy.OY1]=u+c,v[Yy.OX2]=h-g,v[Yy.OY2]=m+c,v[Yy.OX3]=f-g,v[Yy.OY3]=m+p,v[Yy.OX4]=f-d,v[Yy.OY4]=u+p}setRegion(t){this.region=t;const e=this.uvs;t.rotate?(e[2]=t.u,e[3]=t.v2,e[4]=t.u,e[5]=t.v,e[6]=t.u2,e[7]=t.v,e[0]=t.u2,e[1]=t.v2):(e[0]=t.u,e[1]=t.v2,e[2]=t.u,e[3]=t.v,e[4]=t.u2,e[5]=t.v,e[6]=t.u2,e[7]=t.v2)}computeWorldVertices(t,e,n,s){const i=this.offset,r=t instanceof Xy?t.bone.matrix:t.matrix,a=r.tx,o=r.ty,l=r.a,h=r.c,c=r.b,u=r.d;let d=0,f=0;d=i[Yy.OX1],f=i[Yy.OY1],e[n]=d*l+f*h+a,e[n+1]=d*c+f*u+o,n+=s,d=i[Yy.OX2],f=i[Yy.OY2],e[n]=d*l+f*h+a,e[n+1]=d*c+f*u+o,n+=s,d=i[Yy.OX3],f=i[Yy.OY3],e[n]=d*l+f*h+a,e[n+1]=d*c+f*u+o,n+=s,d=i[Yy.OX4],f=i[Yy.OY4],e[n]=d*l+f*h+a,e[n+1]=d*c+f*u+o}copy(){const t=new Yy(this.name);return t.region=this.region,t.rendererObject=this.rendererObject,t.path=this.path,t.x=this.x,t.y=this.y,t.scaleX=this.scaleX,t.scaleY=this.scaleY,t.rotation=this.rotation,t.width=this.width,t.height=this.height,xy.arrayCopy(this.uvs,0,t.uvs,0,8),xy.arrayCopy(this.offset,0,t.offset,0,8),t.color.setFromColor(this.color),t}};let Wy=Yy;Wy.OX1=0,Wy.OY1=1,Wy.OX2=2,Wy.OY2=3,Wy.OX3=4,Wy.OY3=5,Wy.OX4=6,Wy.OY4=7,Wy.X1=0,Wy.Y1=1,Wy.C1R=2,Wy.C1G=3,Wy.C1B=4,Wy.C1A=5,Wy.U1=6,Wy.V1=7,Wy.X2=8,Wy.Y2=9,Wy.C2R=10,Wy.C2G=11,Wy.C2B=12,Wy.C2A=13,Wy.U2=14,Wy.V2=15,Wy.X3=16,Wy.Y3=17,Wy.C3R=18,Wy.C3G=19,Wy.C3B=20,Wy.C3A=21,Wy.U3=22,Wy.V3=23,Wy.X4=24,Wy.Y4=25,Wy.C4R=26,Wy.C4G=27,Wy.C4B=28,Wy.C4A=29,Wy.U4=30,Wy.V4=31;const zy=class{constructor(t){this.centerX=0,this.centerY=0,this.radius=0,this.angle=0,this.worldX=0,this.worldY=0,this.radius=t}begin(t){this.worldX=t.x+this.centerX,this.worldY=t.y+this.centerY}transform(t,e,n,s){const i=this.angle*fy.degreesToRadians,r=t.x-this.worldX,a=t.y-this.worldY,o=Math.sqrt(r*r+a*a);if(o<this.radius){const e=zy.interpolation.apply(0,i,(this.radius-o)/this.radius),n=Math.cos(e),s=Math.sin(e);t.x=n*r-s*a+this.worldX,t.y=s*r+n*a+this.worldY}}end(){}};let Gy=zy;Gy.interpolation=new gy(2);let Hy=class{constructor(t,e,n){if(null==t)throw new Error("name cannot be null.");if(null==e)throw new Error("timelines cannot be null.");this.name=t,this.timelines=e,this.timelineIds=[];for(let s=0;s<e.length;s++)this.timelineIds[e[s].getPropertyId()]=!0;this.duration=n}hasTimeline(t){return 1==this.timelineIds[t]}apply(t,e,n,s,i,r,a,o){if(null==t)throw new Error("skeleton cannot be null.");s&&0!=this.duration&&(n%=this.duration,e>0&&(e%=this.duration));const l=this.timelines;for(let h=0,c=l.length;h<c;h++)l[h].apply(t,e,n,i,r,a,o)}static binarySearch(t,e,n=1){let s=0,i=t.length/n-2;if(0==i)return n;let r=i>>>1;for(;;){if(t[(r+1)*n]<=e?s=r+1:i=r,s==i)return(s+1)*n;r=s+i>>>1}}static linearSearch(t,e,n){for(let s=0,i=t.length-n;s<=i;s+=n)if(t[s]>e)return s;return-1}};var jy=(t=>(t[t.rotate=0]="rotate",t[t.translate=1]="translate",t[t.scale=2]="scale",t[t.shear=3]="shear",t[t.attachment=4]="attachment",t[t.color=5]="color",t[t.deform=6]="deform",t[t.event=7]="event",t[t.drawOrder=8]="drawOrder",t[t.ikConstraint=9]="ikConstraint",t[t.transformConstraint=10]="transformConstraint",t[t.pathConstraintPosition=11]="pathConstraintPosition",t[t.pathConstraintSpacing=12]="pathConstraintSpacing",t[t.pathConstraintMix=13]="pathConstraintMix",t[t.twoColor=14]="twoColor",t))(jy||{});const $y=class{constructor(t){if(t<=0)throw new Error(`frameCount must be > 0: ${t}`);this.curves=xy.newFloatArray((t-1)*$y.BEZIER_SIZE)}getFrameCount(){return this.curves.length/$y.BEZIER_SIZE+1}setLinear(t){this.curves[t*$y.BEZIER_SIZE]=$y.LINEAR}setStepped(t){this.curves[t*$y.BEZIER_SIZE]=$y.STEPPED}getCurveType(t){const e=t*$y.BEZIER_SIZE;if(e==this.curves.length)return $y.LINEAR;const n=this.curves[e];return n==$y.LINEAR?$y.LINEAR:n==$y.STEPPED?$y.STEPPED:$y.BEZIER}setCurve(t,e,n,s,i){const r=.03*(2*-e+s),a=.03*(2*-n+i),o=.006*(3*(e-s)+1),l=.006*(3*(n-i)+1);let h=2*r+o,c=2*a+l,u=.3*e+r+.16666667*o,d=.3*n+a+.16666667*l,f=t*$y.BEZIER_SIZE;const p=this.curves;p[f++]=$y.BEZIER;let m=u,g=d;for(let v=f+$y.BEZIER_SIZE-1;f<v;f+=2)p[f]=m,p[f+1]=g,u+=h,d+=c,h+=o,c+=l,m+=u,g+=d}getCurvePercent(t,e){e=fy.clamp(e,0,1);const n=this.curves;let s=t*$y.BEZIER_SIZE;const i=n[s];if(i==$y.LINEAR)return e;if(i==$y.STEPPED)return 0;s++;let r=0;for(let o=s,l=s+$y.BEZIER_SIZE-1;s<l;s+=2)if(r=n[s],r>=e){let t,i;return s==o?(t=0,i=0):(t=n[s-2],i=n[s-1]),i+(n[s+1]-i)*(e-t)/(r-t)}const a=n[s-1];return a+(1-a)*(e-r)/(1-r)}};let qy=$y;qy.LINEAR=0,qy.STEPPED=1,qy.BEZIER=2,qy.BEZIER_SIZE=19;const Ky=class extends qy{constructor(t){super(t),this.frames=xy.newFloatArray(t<<1)}getPropertyId(){return 0+this.boneIndex}setFrame(t,e,n){t<<=1,this.frames[t]=e,this.frames[t+Ky.ROTATION]=n}apply(t,e,n,s,i,r,a){const o=this.frames,l=t.bones[this.boneIndex];if(!l.active)return;if(n<o[0]){switch(r){case $x.setup:return void(l.rotation=l.data.rotation);case $x.first:const t=l.data.rotation-l.rotation;l.rotation+=(t-360*(16384-(16384.499999999996-t/360|0)))*i}return}if(n>=o[o.length-Ky.ENTRIES]){let t=o[o.length+Ky.PREV_ROTATION];switch(r){case $x.setup:l.rotation=l.data.rotation+t*i;break;case $x.first:case $x.replace:t+=l.data.rotation-l.rotation,t-=360*(16384-(16384.499999999996-t/360|0));case $x.add:l.rotation+=t*i}return}const h=Hy.binarySearch(o,n,Ky.ENTRIES),c=o[h+Ky.PREV_ROTATION],u=o[h],d=this.getCurvePercent((h>>1)-1,1-(n-u)/(o[h+Ky.PREV_TIME]-u));let f=o[h+Ky.ROTATION]-c;switch(f=c+(f-360*(16384-(16384.499999999996-f/360|0)))*d,r){case $x.setup:l.rotation=l.data.rotation+(f-360*(16384-(16384.499999999996-f/360|0)))*i;break;case $x.first:case $x.replace:f+=l.data.rotation-l.rotation;case $x.add:l.rotation+=(f-360*(16384-(16384.499999999996-f/360|0)))*i}}};let Zy=Ky;Zy.ENTRIES=2,Zy.PREV_TIME=-2,Zy.PREV_ROTATION=-1,Zy.ROTATION=1;const Qy=class extends qy{constructor(t){super(t),this.frames=xy.newFloatArray(t*Qy.ENTRIES)}getPropertyId(){return(1<<24)+this.boneIndex}setFrame(t,e,n,s){t*=Qy.ENTRIES,this.frames[t]=e,this.frames[t+Qy.X]=n,this.frames[t+Qy.Y]=s}apply(t,e,n,s,i,r,a){const o=this.frames,l=t.bones[this.boneIndex];if(!l.active)return;if(n<o[0]){switch(r){case $x.setup:return l.x=l.data.x,void(l.y=l.data.y);case $x.first:l.x+=(l.data.x-l.x)*i,l.y+=(l.data.y-l.y)*i}return}let h=0,c=0;if(n>=o[o.length-Qy.ENTRIES])h=o[o.length+Qy.PREV_X],c=o[o.length+Qy.PREV_Y];else{const t=Hy.binarySearch(o,n,Qy.ENTRIES);h=o[t+Qy.PREV_X],c=o[t+Qy.PREV_Y];const e=o[t],s=this.getCurvePercent(t/Qy.ENTRIES-1,1-(n-e)/(o[t+Qy.PREV_TIME]-e));h+=(o[t+Qy.X]-h)*s,c+=(o[t+Qy.Y]-c)*s}switch(r){case $x.setup:l.x=l.data.x+h*i,l.y=l.data.y+c*i;break;case $x.first:case $x.replace:l.x+=(l.data.x+h-l.x)*i,l.y+=(l.data.y+c-l.y)*i;break;case $x.add:l.x+=h*i,l.y+=c*i}}};let Jy=Qy;Jy.ENTRIES=3,Jy.PREV_TIME=-3,Jy.PREV_X=-2,Jy.PREV_Y=-1,Jy.X=1,Jy.Y=2;let t_=class t extends Jy{constructor(t){super(t)}getPropertyId(){return(2<<24)+this.boneIndex}apply(e,n,s,i,r,a,o){const l=this.frames,h=e.bones[this.boneIndex];if(!h.active)return;if(s<l[0]){switch(a){case $x.setup:return h.scaleX=h.data.scaleX,void(h.scaleY=h.data.scaleY);case $x.first:h.scaleX+=(h.data.scaleX-h.scaleX)*r,h.scaleY+=(h.data.scaleY-h.scaleY)*r}return}let c=0,u=0;if(s>=l[l.length-t.ENTRIES])c=l[l.length+t.PREV_X]*h.data.scaleX,u=l[l.length+t.PREV_Y]*h.data.scaleY;else{const e=Hy.binarySearch(l,s,t.ENTRIES);c=l[e+t.PREV_X],u=l[e+t.PREV_Y];const n=l[e],i=this.getCurvePercent(e/t.ENTRIES-1,1-(s-n)/(l[e+t.PREV_TIME]-n));c=(c+(l[e+t.X]-c)*i)*h.data.scaleX,u=(u+(l[e+t.Y]-u)*i)*h.data.scaleY}if(1==r)a==$x.add?(h.scaleX+=c-h.data.scaleX,h.scaleY+=u-h.data.scaleY):(h.scaleX=c,h.scaleY=u);else{let t=0,e=0;if(o==qx.mixOut)switch(a){case $x.setup:t=h.data.scaleX,e=h.data.scaleY,h.scaleX=t+(Math.abs(c)*fy.signum(t)-t)*r,h.scaleY=e+(Math.abs(u)*fy.signum(e)-e)*r;break;case $x.first:case $x.replace:t=h.scaleX,e=h.scaleY,h.scaleX=t+(Math.abs(c)*fy.signum(t)-t)*r,h.scaleY=e+(Math.abs(u)*fy.signum(e)-e)*r;break;case $x.add:t=h.scaleX,e=h.scaleY,h.scaleX=t+(Math.abs(c)*fy.signum(t)-h.data.scaleX)*r,h.scaleY=e+(Math.abs(u)*fy.signum(e)-h.data.scaleY)*r}else switch(a){case $x.setup:t=Math.abs(h.data.scaleX)*fy.signum(c),e=Math.abs(h.data.scaleY)*fy.signum(u),h.scaleX=t+(c-t)*r,h.scaleY=e+(u-e)*r;break;case $x.first:case $x.replace:t=Math.abs(h.scaleX)*fy.signum(c),e=Math.abs(h.scaleY)*fy.signum(u),h.scaleX=t+(c-t)*r,h.scaleY=e+(u-e)*r;break;case $x.add:t=fy.signum(c),e=fy.signum(u),h.scaleX=Math.abs(h.scaleX)*t+(c-Math.abs(h.data.scaleX)*t)*r,h.scaleY=Math.abs(h.scaleY)*e+(u-Math.abs(h.data.scaleY)*e)*r}}}},e_=class t extends Jy{constructor(t){super(t)}getPropertyId(){return(3<<24)+this.boneIndex}apply(e,n,s,i,r,a,o){const l=this.frames,h=e.bones[this.boneIndex];if(!h.active)return;if(s<l[0]){switch(a){case $x.setup:return h.shearX=h.data.shearX,void(h.shearY=h.data.shearY);case $x.first:h.shearX+=(h.data.shearX-h.shearX)*r,h.shearY+=(h.data.shearY-h.shearY)*r}return}let c=0,u=0;if(s>=l[l.length-t.ENTRIES])c=l[l.length+t.PREV_X],u=l[l.length+t.PREV_Y];else{const e=Hy.binarySearch(l,s,t.ENTRIES);c=l[e+t.PREV_X],u=l[e+t.PREV_Y];const n=l[e],i=this.getCurvePercent(e/t.ENTRIES-1,1-(s-n)/(l[e+t.PREV_TIME]-n));c+=(l[e+t.X]-c)*i,u+=(l[e+t.Y]-u)*i}switch(a){case $x.setup:h.shearX=h.data.shearX+c*r,h.shearY=h.data.shearY+u*r;break;case $x.first:case $x.replace:h.shearX+=(h.data.shearX+c-h.shearX)*r,h.shearY+=(h.data.shearY+u-h.shearY)*r;break;case $x.add:h.shearX+=c*r,h.shearY+=u*r}}};const n_=class extends qy{constructor(t){super(t),this.frames=xy.newFloatArray(t*n_.ENTRIES)}getPropertyId(){return(5<<24)+this.slotIndex}setFrame(t,e,n,s,i,r){t*=n_.ENTRIES,this.frames[t]=e,this.frames[t+n_.R]=n,this.frames[t+n_.G]=s,this.frames[t+n_.B]=i,this.frames[t+n_.A]=r}apply(t,e,n,s,i,r,a){const o=t.slots[this.slotIndex];if(!o.bone.active)return;const l=this.frames;if(n<l[0]){switch(r){case $x.setup:return void o.color.setFromColor(o.data.color);case $x.first:const t=o.color,e=o.data.color;t.add((e.r-t.r)*i,(e.g-t.g)*i,(e.b-t.b)*i,(e.a-t.a)*i)}return}let h=0,c=0,u=0,d=0;if(n>=l[l.length-n_.ENTRIES]){const t=l.length;h=l[t+n_.PREV_R],c=l[t+n_.PREV_G],u=l[t+n_.PREV_B],d=l[t+n_.PREV_A]}else{const t=Hy.binarySearch(l,n,n_.ENTRIES);h=l[t+n_.PREV_R],c=l[t+n_.PREV_G],u=l[t+n_.PREV_B],d=l[t+n_.PREV_A];const e=l[t],s=this.getCurvePercent(t/n_.ENTRIES-1,1-(n-e)/(l[t+n_.PREV_TIME]-e));h+=(l[t+n_.R]-h)*s,c+=(l[t+n_.G]-c)*s,u+=(l[t+n_.B]-u)*s,d+=(l[t+n_.A]-d)*s}if(1==i)o.color.set(h,c,u,d);else{const t=o.color;r==$x.setup&&t.setFromColor(o.data.color),t.add((h-t.r)*i,(c-t.g)*i,(u-t.b)*i,(d-t.a)*i)}}};let s_=n_;s_.ENTRIES=5,s_.PREV_TIME=-5,s_.PREV_R=-4,s_.PREV_G=-3,s_.PREV_B=-2,s_.PREV_A=-1,s_.R=1,s_.G=2,s_.B=3,s_.A=4;const i_=class extends qy{constructor(t){super(t),this.frames=xy.newFloatArray(t*i_.ENTRIES)}getPropertyId(){return(14<<24)+this.slotIndex}setFrame(t,e,n,s,i,r,a,o,l){t*=i_.ENTRIES,this.frames[t]=e,this.frames[t+i_.R]=n,this.frames[t+i_.G]=s,this.frames[t+i_.B]=i,this.frames[t+i_.A]=r,this.frames[t+i_.R2]=a,this.frames[t+i_.G2]=o,this.frames[t+i_.B2]=l}apply(t,e,n,s,i,r,a){const o=t.slots[this.slotIndex];if(!o.bone.active)return;const l=this.frames;if(n<l[0]){switch(r){case $x.setup:return o.color.setFromColor(o.data.color),void o.darkColor.setFromColor(o.data.darkColor);case $x.first:const t=o.color,e=o.darkColor,n=o.data.color,s=o.data.darkColor;t.add((n.r-t.r)*i,(n.g-t.g)*i,(n.b-t.b)*i,(n.a-t.a)*i),e.add((s.r-e.r)*i,(s.g-e.g)*i,(s.b-e.b)*i,0)}return}let h=0,c=0,u=0,d=0,f=0,p=0,m=0;if(n>=l[l.length-i_.ENTRIES]){const t=l.length;h=l[t+i_.PREV_R],c=l[t+i_.PREV_G],u=l[t+i_.PREV_B],d=l[t+i_.PREV_A],f=l[t+i_.PREV_R2],p=l[t+i_.PREV_G2],m=l[t+i_.PREV_B2]}else{const t=Hy.binarySearch(l,n,i_.ENTRIES);h=l[t+i_.PREV_R],c=l[t+i_.PREV_G],u=l[t+i_.PREV_B],d=l[t+i_.PREV_A],f=l[t+i_.PREV_R2],p=l[t+i_.PREV_G2],m=l[t+i_.PREV_B2];const e=l[t],s=this.getCurvePercent(t/i_.ENTRIES-1,1-(n-e)/(l[t+i_.PREV_TIME]-e));h+=(l[t+i_.R]-h)*s,c+=(l[t+i_.G]-c)*s,u+=(l[t+i_.B]-u)*s,d+=(l[t+i_.A]-d)*s,f+=(l[t+i_.R2]-f)*s,p+=(l[t+i_.G2]-p)*s,m+=(l[t+i_.B2]-m)*s}if(1==i)o.color.set(h,c,u,d),o.darkColor.set(f,p,m,1);else{const t=o.color,e=o.darkColor;r==$x.setup&&(t.setFromColor(o.data.color),e.setFromColor(o.data.darkColor)),t.add((h-t.r)*i,(c-t.g)*i,(u-t.b)*i,(d-t.a)*i),e.add((f-e.r)*i,(p-e.g)*i,(m-e.b)*i,0)}}};let r_=i_;r_.ENTRIES=8,r_.PREV_TIME=-8,r_.PREV_R=-7,r_.PREV_G=-6,r_.PREV_B=-5,r_.PREV_A=-4,r_.PREV_R2=-3,r_.PREV_G2=-2,r_.PREV_B2=-1,r_.R=1,r_.G=2,r_.B=3,r_.A=4,r_.R2=5,r_.G2=6,r_.B2=7;let a_=class{constructor(t){this.frames=xy.newFloatArray(t),this.attachmentNames=new Array(t)}getPropertyId(){return(4<<24)+this.slotIndex}getFrameCount(){return this.frames.length}setFrame(t,e,n){this.frames[t]=e,this.attachmentNames[t]=n}apply(t,e,n,s,i,r,a){const o=t.slots[this.slotIndex];if(!o.bone.active)return;if(a==qx.mixOut)return void(r==$x.setup&&this.setAttachment(t,o,o.data.attachmentName));const l=this.frames;if(n<l[0])return void(r!=$x.setup&&r!=$x.first||this.setAttachment(t,o,o.data.attachmentName));let h=0;h=n>=l[l.length-1]?l.length-1:Hy.binarySearch(l,n,1)-1;const c=this.attachmentNames[h];t.slots[this.slotIndex].setAttachment(null==c?null:t.getAttachment(this.slotIndex,c))}setAttachment(t,e,n){e.setAttachment(null==n?null:t.getAttachment(this.slotIndex,n))}},o_=null,l_=class extends qy{constructor(t){super(t),this.frames=xy.newFloatArray(t),this.frameVertices=new Array(t),null==o_&&(o_=xy.newFloatArray(64))}getPropertyId(){return(6<<27)+Number(this.attachment.id)+this.slotIndex}setFrame(t,e,n){this.frames[t]=e,this.frameVertices[t]=n}apply(t,e,n,s,i,r,a){const o=t.slots[this.slotIndex];if(!o.bone.active)return;const l=o.getAttachment();if(!(l instanceof Dy)||l.deformAttachment!=this.attachment)return;const h=o.deform;0==h.length&&(r=$x.setup);const c=this.frameVertices,u=c[0].length,d=this.frames;if(n<d[0]){const t=l;switch(r){case $x.setup:return void(h.length=0);case $x.first:if(1==i){h.length=0;break}const e=xy.setArraySize(h,u);if(null==t.bones){const n=t.vertices;for(let t=0;t<u;t++)e[t]+=(n[t]-e[t])*i}else{i=1-i;for(let t=0;t<u;t++)e[t]*=i}}return}const f=xy.setArraySize(h,u);if(n>=d[d.length-1]){const t=c[d.length-1];if(1==i)if(r==$x.add){const e=l;if(null==e.bones){const n=e.vertices;for(let e=0;e<u;e++)f[e]+=t[e]-n[e]}else for(let n=0;n<u;n++)f[n]+=t[n]}else xy.arrayCopy(t,0,f,0,u);else switch(r){case $x.setup:{const e=l;if(null==e.bones){const n=e.vertices;for(let e=0;e<u;e++){const s=n[e];f[e]=s+(t[e]-s)*i}}else for(let n=0;n<u;n++)f[n]=t[n]*i;break}case $x.first:case $x.replace:for(let n=0;n<u;n++)f[n]+=(t[n]-f[n])*i;break;case $x.add:const e=l;if(null==e.bones){const n=e.vertices;for(let e=0;e<u;e++)f[e]+=(t[e]-n[e])*i}else for(let n=0;n<u;n++)f[n]+=t[n]*i}return}const p=Hy.binarySearch(d,n),m=c[p-1],g=c[p],v=d[p],x=this.getCurvePercent(p-1,1-(n-v)/(d[p-1]-v));if(1==i)if(r==$x.add){const t=l;if(null==t.bones){const e=t.vertices;for(let t=0;t<u;t++){const n=m[t];f[t]+=n+(g[t]-n)*x-e[t]}}else for(let e=0;e<u;e++){const t=m[e];f[e]+=t+(g[e]-t)*x}}else for(let y=0;y<u;y++){const t=m[y];f[y]=t+(g[y]-t)*x}else switch(r){case $x.setup:{const t=l;if(null==t.bones){const e=t.vertices;for(let t=0;t<u;t++){const n=m[t],s=e[t];f[t]=s+(n+(g[t]-n)*x-s)*i}}else for(let e=0;e<u;e++){const t=m[e];f[e]=(t+(g[e]-t)*x)*i}break}case $x.first:case $x.replace:for(let e=0;e<u;e++){const t=m[e];f[e]+=(t+(g[e]-t)*x-f[e])*i}break;case $x.add:const t=l;if(null==t.bones){const e=t.vertices;for(let t=0;t<u;t++){const n=m[t];f[t]+=(n+(g[t]-n)*x-e[t])*i}}else for(let e=0;e<u;e++){const t=m[e];f[e]+=(t+(g[e]-t)*x)*i}}}},h_=class{constructor(t){this.frames=xy.newFloatArray(t),this.events=new Array(t)}getPropertyId(){return 7<<24}getFrameCount(){return this.frames.length}setFrame(t,e){this.frames[t]=e.time,this.events[t]=e}apply(t,e,n,s,i,r,a){if(null==s)return;const o=this.frames,l=this.frames.length;if(e>n)this.apply(t,e,Number.MAX_VALUE,s,i,r,a),e=-1;else if(e>=o[l-1])return;if(n<o[0])return;let h=0;if(e<o[0])h=0;else{h=Hy.binarySearch(o,e);const t=o[h];for(;h>0&&o[h-1]==t;)h--}for(;h<l&&n>=o[h];h++)s.push(this.events[h])}},c_=class{constructor(t){this.frames=xy.newFloatArray(t),this.drawOrders=new Array(t)}getPropertyId(){return 8<<24}getFrameCount(){return this.frames.length}setFrame(t,e,n){this.frames[t]=e,this.drawOrders[t]=n}apply(t,e,n,s,i,r,a){const o=t.drawOrder,l=t.slots;if(a==qx.mixOut&&r==$x.setup)return void xy.arrayCopy(t.slots,0,t.drawOrder,0,t.slots.length);const h=this.frames;if(n<h[0])return void(r!=$x.setup&&r!=$x.first||xy.arrayCopy(t.slots,0,t.drawOrder,0,t.slots.length));let c=0;c=n>=h[h.length-1]?h.length-1:Hy.binarySearch(h,n)-1;const u=this.drawOrders[c];if(null==u)xy.arrayCopy(l,0,o,0,l.length);else for(let d=0,f=u.length;d<f;d++)o[d]=l[u[d]]}};const u_=class extends qy{constructor(t){super(t),this.frames=xy.newFloatArray(t*u_.ENTRIES)}getPropertyId(){return(9<<24)+this.ikConstraintIndex}setFrame(t,e,n,s,i,r,a){t*=u_.ENTRIES,this.frames[t]=e,this.frames[t+u_.MIX]=n,this.frames[t+u_.SOFTNESS]=s,this.frames[t+u_.BEND_DIRECTION]=i,this.frames[t+u_.COMPRESS]=r?1:0,this.frames[t+u_.STRETCH]=a?1:0}apply(t,e,n,s,i,r,a){const o=this.frames,l=t.ikConstraints[this.ikConstraintIndex];if(!l.active)return;if(n<o[0]){switch(r){case $x.setup:return l.mix=l.data.mix,l.softness=l.data.softness,l.bendDirection=l.data.bendDirection,l.compress=l.data.compress,void(l.stretch=l.data.stretch);case $x.first:l.mix+=(l.data.mix-l.mix)*i,l.softness+=(l.data.softness-l.softness)*i,l.bendDirection=l.data.bendDirection,l.compress=l.data.compress,l.stretch=l.data.stretch}return}if(n>=o[o.length-u_.ENTRIES])return void(r==$x.setup?(l.mix=l.data.mix+(o[o.length+u_.PREV_MIX]-l.data.mix)*i,l.softness=l.data.softness+(o[o.length+u_.PREV_SOFTNESS]-l.data.softness)*i,a==qx.mixOut?(l.bendDirection=l.data.bendDirection,l.compress=l.data.compress,l.stretch=l.data.stretch):(l.bendDirection=o[o.length+u_.PREV_BEND_DIRECTION],l.compress=0!=o[o.length+u_.PREV_COMPRESS],l.stretch=0!=o[o.length+u_.PREV_STRETCH])):(l.mix+=(o[o.length+u_.PREV_MIX]-l.mix)*i,l.softness+=(o[o.length+u_.PREV_SOFTNESS]-l.softness)*i,a==qx.mixIn&&(l.bendDirection=o[o.length+u_.PREV_BEND_DIRECTION],l.compress=0!=o[o.length+u_.PREV_COMPRESS],l.stretch=0!=o[o.length+u_.PREV_STRETCH])));const h=Hy.binarySearch(o,n,u_.ENTRIES),c=o[h+u_.PREV_MIX],u=o[h+u_.PREV_SOFTNESS],d=o[h],f=this.getCurvePercent(h/u_.ENTRIES-1,1-(n-d)/(o[h+u_.PREV_TIME]-d));r==$x.setup?(l.mix=l.data.mix+(c+(o[h+u_.MIX]-c)*f-l.data.mix)*i,l.softness=l.data.softness+(u+(o[h+u_.SOFTNESS]-u)*f-l.data.softness)*i,a==qx.mixOut?(l.bendDirection=l.data.bendDirection,l.compress=l.data.compress,l.stretch=l.data.stretch):(l.bendDirection=o[h+u_.PREV_BEND_DIRECTION],l.compress=0!=o[h+u_.PREV_COMPRESS],l.stretch=0!=o[h+u_.PREV_STRETCH])):(l.mix+=(c+(o[h+u_.MIX]-c)*f-l.mix)*i,l.softness+=(u+(o[h+u_.SOFTNESS]-u)*f-l.softness)*i,a==qx.mixIn&&(l.bendDirection=o[h+u_.PREV_BEND_DIRECTION],l.compress=0!=o[h+u_.PREV_COMPRESS],l.stretch=0!=o[h+u_.PREV_STRETCH]))}};let d_=u_;d_.ENTRIES=6,d_.PREV_TIME=-6,d_.PREV_MIX=-5,d_.PREV_SOFTNESS=-4,d_.PREV_BEND_DIRECTION=-3,d_.PREV_COMPRESS=-2,d_.PREV_STRETCH=-1,d_.MIX=1,d_.SOFTNESS=2,d_.BEND_DIRECTION=3,d_.COMPRESS=4,d_.STRETCH=5;const f_=class extends qy{constructor(t){super(t),this.frames=xy.newFloatArray(t*f_.ENTRIES)}getPropertyId(){return(10<<24)+this.transformConstraintIndex}setFrame(t,e,n,s,i,r){t*=f_.ENTRIES,this.frames[t]=e,this.frames[t+f_.ROTATE]=n,this.frames[t+f_.TRANSLATE]=s,this.frames[t+f_.SCALE]=i,this.frames[t+f_.SHEAR]=r}apply(t,e,n,s,i,r,a){const o=this.frames,l=t.transformConstraints[this.transformConstraintIndex];if(!l.active)return;if(n<o[0]){const t=l.data;switch(r){case $x.setup:return l.rotateMix=t.rotateMix,l.translateMix=t.translateMix,l.scaleMix=t.scaleMix,void(l.shearMix=t.shearMix);case $x.first:l.rotateMix+=(t.rotateMix-l.rotateMix)*i,l.translateMix+=(t.translateMix-l.translateMix)*i,l.scaleMix+=(t.scaleMix-l.scaleMix)*i,l.shearMix+=(t.shearMix-l.shearMix)*i}return}let h=0,c=0,u=0,d=0;if(n>=o[o.length-f_.ENTRIES]){const t=o.length;h=o[t+f_.PREV_ROTATE],c=o[t+f_.PREV_TRANSLATE],u=o[t+f_.PREV_SCALE],d=o[t+f_.PREV_SHEAR]}else{const t=Hy.binarySearch(o,n,f_.ENTRIES);h=o[t+f_.PREV_ROTATE],c=o[t+f_.PREV_TRANSLATE],u=o[t+f_.PREV_SCALE],d=o[t+f_.PREV_SHEAR];const e=o[t],s=this.getCurvePercent(t/f_.ENTRIES-1,1-(n-e)/(o[t+f_.PREV_TIME]-e));h+=(o[t+f_.ROTATE]-h)*s,c+=(o[t+f_.TRANSLATE]-c)*s,u+=(o[t+f_.SCALE]-u)*s,d+=(o[t+f_.SHEAR]-d)*s}if(r==$x.setup){const t=l.data;l.rotateMix=t.rotateMix+(h-t.rotateMix)*i,l.translateMix=t.translateMix+(c-t.translateMix)*i,l.scaleMix=t.scaleMix+(u-t.scaleMix)*i,l.shearMix=t.shearMix+(d-t.shearMix)*i}else l.rotateMix+=(h-l.rotateMix)*i,l.translateMix+=(c-l.translateMix)*i,l.scaleMix+=(u-l.scaleMix)*i,l.shearMix+=(d-l.shearMix)*i}};let p_=f_;p_.ENTRIES=5,p_.PREV_TIME=-5,p_.PREV_ROTATE=-4,p_.PREV_TRANSLATE=-3,p_.PREV_SCALE=-2,p_.PREV_SHEAR=-1,p_.ROTATE=1,p_.TRANSLATE=2,p_.SCALE=3,p_.SHEAR=4;const m_=class extends qy{constructor(t){super(t),this.frames=xy.newFloatArray(t*m_.ENTRIES)}getPropertyId(){return(11<<24)+this.pathConstraintIndex}setFrame(t,e,n){t*=m_.ENTRIES,this.frames[t]=e,this.frames[t+m_.VALUE]=n}apply(t,e,n,s,i,r,a){const o=this.frames,l=t.pathConstraints[this.pathConstraintIndex];if(!l.active)return;if(n<o[0]){switch(r){case $x.setup:return void(l.position=l.data.position);case $x.first:l.position+=(l.data.position-l.position)*i}return}let h=0;if(n>=o[o.length-m_.ENTRIES])h=o[o.length+m_.PREV_VALUE];else{const t=Hy.binarySearch(o,n,m_.ENTRIES);h=o[t+m_.PREV_VALUE];const e=o[t],s=this.getCurvePercent(t/m_.ENTRIES-1,1-(n-e)/(o[t+m_.PREV_TIME]-e));h+=(o[t+m_.VALUE]-h)*s}r==$x.setup?l.position=l.data.position+(h-l.data.position)*i:l.position+=(h-l.position)*i}};let g_=m_;g_.ENTRIES=2,g_.PREV_TIME=-2,g_.PREV_VALUE=-1,g_.VALUE=1;let v_=class t extends g_{constructor(t){super(t)}getPropertyId(){return(12<<24)+this.pathConstraintIndex}apply(e,n,s,i,r,a,o){const l=this.frames,h=e.pathConstraints[this.pathConstraintIndex];if(!h.active)return;if(s<l[0]){switch(a){case $x.setup:return void(h.spacing=h.data.spacing);case $x.first:h.spacing+=(h.data.spacing-h.spacing)*r}return}let c=0;if(s>=l[l.length-t.ENTRIES])c=l[l.length+t.PREV_VALUE];else{const e=Hy.binarySearch(l,s,t.ENTRIES);c=l[e+t.PREV_VALUE];const n=l[e],i=this.getCurvePercent(e/t.ENTRIES-1,1-(s-n)/(l[e+t.PREV_TIME]-n));c+=(l[e+t.VALUE]-c)*i}a==$x.setup?h.spacing=h.data.spacing+(c-h.data.spacing)*r:h.spacing+=(c-h.spacing)*r}};const x_=class extends qy{constructor(t){super(t),this.frames=xy.newFloatArray(t*x_.ENTRIES)}getPropertyId(){return(13<<24)+this.pathConstraintIndex}setFrame(t,e,n,s){t*=x_.ENTRIES,this.frames[t]=e,this.frames[t+x_.ROTATE]=n,this.frames[t+x_.TRANSLATE]=s}apply(t,e,n,s,i,r,a){const o=this.frames,l=t.pathConstraints[this.pathConstraintIndex];if(!l.active)return;if(n<o[0]){switch(r){case $x.setup:return l.rotateMix=l.data.rotateMix,void(l.translateMix=l.data.translateMix);case $x.first:l.rotateMix+=(l.data.rotateMix-l.rotateMix)*i,l.translateMix+=(l.data.translateMix-l.translateMix)*i}return}let h=0,c=0;if(n>=o[o.length-x_.ENTRIES])h=o[o.length+x_.PREV_ROTATE],c=o[o.length+x_.PREV_TRANSLATE];else{const t=Hy.binarySearch(o,n,x_.ENTRIES);h=o[t+x_.PREV_ROTATE],c=o[t+x_.PREV_TRANSLATE];const e=o[t],s=this.getCurvePercent(t/x_.ENTRIES-1,1-(n-e)/(o[t+x_.PREV_TIME]-e));h+=(o[t+x_.ROTATE]-h)*s,c+=(o[t+x_.TRANSLATE]-c)*s}r==$x.setup?(l.rotateMix=l.data.rotateMix+(h-l.data.rotateMix)*i,l.translateMix=l.data.translateMix+(c-l.data.translateMix)*i):(l.rotateMix+=(h-l.rotateMix)*i,l.translateMix+=(c-l.translateMix)*i)}};let y_=x_;y_.ENTRIES=3,y_.PREV_TIME=-3,y_.PREV_ROTATE=-2,y_.PREV_TRANSLATE=-1,y_.ROTATE=1,y_.TRANSLATE=2;const __=class{constructor(t){this.tracks=new Array,this.timeScale=1,this.unkeyedState=0,this.events=new Array,this.listeners=new Array,this.queue=new S_(this),this.propertyIDs=new ly,this.animationsChanged=!1,this.trackEntryPool=new yy((()=>new E_)),this.data=t}update(t){t*=this.timeScale;const e=this.tracks;for(let n=0,s=e.length;n<s;n++){const s=e[n];if(null==s)continue;s.animationLast=s.nextAnimationLast,s.trackLast=s.nextTrackLast;let i=t*s.timeScale;if(s.delay>0){if(s.delay-=i,s.delay>0)continue;i=-s.delay,s.delay=0}let r=s.next;if(null!=r){const e=s.trackLast-r.delay;if(e>=0){for(r.delay=0,r.trackTime+=0==s.timeScale?0:(e/s.timeScale+t)*r.timeScale,s.trackTime+=i,this.setCurrent(n,r,!0);null!=r.mixingFrom;)r.mixTime+=t,r=r.mixingFrom;continue}}else if(s.trackLast>=s.trackEnd&&null==s.mixingFrom){e[n]=null,this.queue.end(s),this.disposeNext(s);continue}if(null!=s.mixingFrom&&this.updateMixingFrom(s,t)){let t=s.mixingFrom;for(s.mixingFrom=null,null!=t&&(t.mixingTo=null);null!=t;)this.queue.end(t),t=t.mixingFrom}s.trackTime+=i}this.queue.drain()}updateMixingFrom(t,e){const n=t.mixingFrom;if(null==n)return!0;const s=this.updateMixingFrom(n,e);return n.animationLast=n.nextAnimationLast,n.trackLast=n.nextTrackLast,t.mixTime>0&&t.mixTime>=t.mixDuration?(0!=n.totalAlpha&&0!=t.mixDuration||(t.mixingFrom=n.mixingFrom,null!=n.mixingFrom&&(n.mixingFrom.mixingTo=t),t.interruptAlpha=n.interruptAlpha,this.queue.end(n)),s):(n.trackTime+=e*n.timeScale,t.mixTime+=e,!1)}apply(t){if(null==t)throw new Error("skeleton cannot be null.");this.animationsChanged&&this._animationsChanged();const e=this.events,n=this.tracks;let s=!1;for(let a=0,o=n.length;a<o;a++){const i=n[a];if(null==i||i.delay>0)continue;s=!0;const r=0==a?$x.first:i.mixBlend;let o=i.alpha;null!=i.mixingFrom?o*=this.applyMixingFrom(i,t,r):i.trackTime>=i.trackEnd&&null==i.next&&(o=0);const l=i.animationLast,h=i.getAnimationTime(),c=i.animation.timelines.length,u=i.animation.timelines;if(0==a&&1==o||r==$x.add)for(let n=0;n<c;n++){const s=u[n];s instanceof a_?this.applyAttachmentTimeline(s,t,h,r,!0):s.apply(t,l,h,e,o,r,qx.mixIn)}else{const n=i.timelineMode,s=0==i.timelinesRotation.length;s&&xy.setArraySize(i.timelinesRotation,c<<1,null);const a=i.timelinesRotation;for(let i=0;i<c;i++){const c=u[i],d=n[i]==__.SUBSEQUENT?r:$x.setup;c instanceof Zy?this.applyRotateTimeline(c,t,h,o,d,a,i<<1,s):c instanceof a_?this.applyAttachmentTimeline(c,t,h,r,!0):c.apply(t,l,h,e,o,d,qx.mixIn)}}this.queueEvents(i,h),e.length=0,i.nextAnimationLast=h,i.nextTrackLast=i.trackTime}const i=this.unkeyedState+__.SETUP,r=t.slots;for(let a=0,o=t.slots.length;a<o;a++){const e=r[a];if(e.attachmentState==i){const n=e.data.attachmentName;e.setAttachment(null==n?null:t.getAttachment(e.data.index,n))}}return this.unkeyedState+=2,this.queue.drain(),s}applyMixingFrom(t,e,n){const s=t.mixingFrom;null!=s.mixingFrom&&this.applyMixingFrom(s,e,n);let i=0;0==t.mixDuration?(i=1,n==$x.first&&(n=$x.setup)):(i=t.mixTime/t.mixDuration,i>1&&(i=1),n!=$x.first&&(n=s.mixBlend));const r=i<s.eventThreshold?this.events:null,a=i<s.attachmentThreshold,o=i<s.drawOrderThreshold,l=s.animationLast,h=s.getAnimationTime(),c=s.animation.timelines.length,u=s.animation.timelines,d=s.alpha*t.interruptAlpha,f=d*(1-i);if(n==$x.add)for(let p=0;p<c;p++)u[p].apply(e,l,h,r,f,n,qx.mixOut);else{const t=s.timelineMode,i=s.timelineHoldMix,p=0==s.timelinesRotation.length;p&&xy.setArraySize(s.timelinesRotation,c<<1,null);const m=s.timelinesRotation;s.totalAlpha=0;for(let g=0;g<c;g++){const c=u[g];let v,x=qx.mixOut,y=0;switch(t[g]){case __.SUBSEQUENT:if(!o&&c instanceof c_)continue;v=n,y=f;break;case __.FIRST:v=$x.setup,y=f;break;case __.HOLD_SUBSEQUENT:v=n,y=d;break;case __.HOLD_FIRST:v=$x.setup,y=d;break;default:v=$x.setup;const t=i[g];y=d*Math.max(0,1-t.mixTime/t.mixDuration)}s.totalAlpha+=y,c instanceof Zy?this.applyRotateTimeline(c,e,h,y,v,m,g<<1,p):c instanceof a_?this.applyAttachmentTimeline(c,e,h,v,a):(o&&c instanceof c_&&v==$x.setup&&(x=qx.mixIn),c.apply(e,l,h,r,y,v,x))}}return t.mixDuration>0&&this.queueEvents(s,h),this.events.length=0,s.nextAnimationLast=h,s.nextTrackLast=s.trackTime,i}applyAttachmentTimeline(t,e,n,s,i){const r=e.slots[t.slotIndex];if(!r.bone.active)return;const a=t.frames;if(n<a[0])s!=$x.setup&&s!=$x.first||this.setAttachment(e,r,r.data.attachmentName,i);else{let s;s=n>=a[a.length-1]?a.length-1:Hy.binarySearch(a,n)-1,this.setAttachment(e,r,t.attachmentNames[s],i)}r.attachmentState<=this.unkeyedState&&(r.attachmentState=this.unkeyedState+__.SETUP)}setAttachment(t,e,n,s){e.setAttachment(null==n?null:t.getAttachment(e.data.index,n)),s&&(e.attachmentState=this.unkeyedState+__.CURRENT)}applyRotateTimeline(t,e,n,s,i,r,a,o){if(o&&(r[a]=0),1==s)return void t.apply(e,0,n,null,1,i,qx.mixIn);const l=t,h=l.frames,c=e.bones[l.boneIndex];if(!c.active)return;let u=0,d=0;if(n<h[0])switch(i){case $x.setup:c.rotation=c.data.rotation;default:return;case $x.first:u=c.rotation,d=c.data.rotation}else if(u=i==$x.setup?c.data.rotation:c.rotation,n>=h[h.length-Zy.ENTRIES])d=c.data.rotation+h[h.length+Zy.PREV_ROTATION];else{const t=Hy.binarySearch(h,n,Zy.ENTRIES),e=h[t+Zy.PREV_ROTATION],s=h[t],i=l.getCurvePercent((t>>1)-1,1-(n-s)/(h[t+Zy.PREV_TIME]-s));d=h[t+Zy.ROTATION]-e,d-=360*(16384-(16384.499999999996-d/360|0)),d=e+d*i+c.data.rotation,d-=360*(16384-(16384.499999999996-d/360|0))}let f=0,p=d-u;if(p-=360*(16384-(16384.499999999996-p/360|0)),0==p)f=r[a];else{let t=0,e=0;o?(t=0,e=p):(t=r[a],e=r[a+1]);const n=p>0;let s=t>=0;fy.signum(e)!=fy.signum(p)&&Math.abs(e)<=90&&(Math.abs(t)>180&&(t+=360*fy.signum(t)),s=n),f=p+t-t%360,s!=n&&(f+=360*fy.signum(t)),r[a]=f}r[a+1]=p,u+=f*s,c.rotation=u-360*(16384-(16384.499999999996-u/360|0))}queueEvents(t,e){const n=t.animationStart,s=t.animationEnd,i=s-n,r=t.trackLast%i,a=this.events;let o=0;const l=a.length;for(;o<l;o++){const e=a[o];if(e.time<r)break;e.time>s||this.queue.event(t,e)}let h=!1;for(h=t.loop?0==i||r>t.trackTime%i:e>=s&&t.animationLast<s,h&&this.queue.complete(t);o<l;o++){a[o].time<n||this.queue.event(t,a[o])}}clearTracks(){const t=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(let e=0,n=this.tracks.length;e<n;e++)this.clearTrack(e);this.tracks.length=0,this.queue.drainDisabled=t,this.queue.drain()}clearTrack(t){if(t>=this.tracks.length)return;const e=this.tracks[t];if(null==e)return;this.queue.end(e),this.disposeNext(e);let n=e;for(;;){const t=n.mixingFrom;if(null==t)break;this.queue.end(t),n.mixingFrom=null,n.mixingTo=null,n=t}this.tracks[e.trackIndex]=null,this.queue.drain()}setCurrent(t,e,n){const s=this.expandToIndex(t);this.tracks[t]=e,null!=s&&(n&&this.queue.interrupt(s),e.mixingFrom=s,s.mixingTo=e,e.mixTime=0,null!=s.mixingFrom&&s.mixDuration>0&&(e.interruptAlpha*=Math.min(1,s.mixTime/s.mixDuration)),s.timelinesRotation.length=0),this.queue.start(e)}setAnimation(t,e,n){const s=this.data.skeletonData.findAnimation(e);if(null==s)throw new Error(`Animation not found: ${e}`);return this.setAnimationWith(t,s,n)}setAnimationWith(t,e,n){if(null==e)throw new Error("animation cannot be null.");let s=!0,i=this.expandToIndex(t);null!=i&&(-1==i.nextTrackLast?(this.tracks[t]=i.mixingFrom,this.queue.interrupt(i),this.queue.end(i),this.disposeNext(i),i=i.mixingFrom,s=!1):this.disposeNext(i));const r=this.trackEntry(t,e,n,i);return this.setCurrent(t,r,s),this.queue.drain(),r}addAnimation(t,e,n,s){const i=this.data.skeletonData.findAnimation(e);if(null==i)throw new Error(`Animation not found: ${e}`);return this.addAnimationWith(t,i,n,s)}addAnimationWith(t,e,n,s){if(null==e)throw new Error("animation cannot be null.");let i=this.expandToIndex(t);if(null!=i)for(;null!=i.next;)i=i.next;const r=this.trackEntry(t,e,n,i);if(null==i)this.setCurrent(t,r,!0),this.queue.drain();else if(i.next=r,s<=0){const t=i.animationEnd-i.animationStart;0!=t?(i.loop?s+=t*(1+(i.trackTime/t|0)):s+=Math.max(t,i.trackTime),s-=this.data.getMix(i.animation,e)):s=i.trackTime}return r.delay=s,r}setEmptyAnimation(t,e){const n=this.setAnimationWith(t,__.emptyAnimation,!1);return n.mixDuration=e,n.trackEnd=e,n}addEmptyAnimation(t,e,n){n<=0&&(n-=e);const s=this.addAnimationWith(t,__.emptyAnimation,!1,n);return s.mixDuration=e,s.trackEnd=e,s}setEmptyAnimations(t){const e=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(let n=0,s=this.tracks.length;n<s;n++){const e=this.tracks[n];null!=e&&this.setEmptyAnimation(e.trackIndex,t)}this.queue.drainDisabled=e,this.queue.drain()}expandToIndex(t){return t<this.tracks.length?this.tracks[t]:(xy.ensureArrayCapacity(this.tracks,t+1,null),this.tracks.length=t+1,null)}trackEntry(t,e,n,s){const i=this.trackEntryPool.obtain();return i.trackIndex=t,i.animation=e,i.loop=n,i.holdPrevious=!1,i.eventThreshold=0,i.attachmentThreshold=0,i.drawOrderThreshold=0,i.animationStart=0,i.animationEnd=e.duration,i.animationLast=-1,i.nextAnimationLast=-1,i.delay=0,i.trackTime=0,i.trackLast=-1,i.nextTrackLast=-1,i.trackEnd=Number.MAX_VALUE,i.timeScale=1,i.alpha=1,i.interruptAlpha=1,i.mixTime=0,i.mixDuration=null==s?0:this.data.getMix(s.animation,e),i.mixBlend=$x.replace,i}disposeNext(t){let e=t.next;for(;null!=e;)this.queue.dispose(e),e=e.next;t.next=null}_animationsChanged(){this.animationsChanged=!1,this.propertyIDs.clear();for(let t=0,e=this.tracks.length;t<e;t++){let e=this.tracks[t];if(null!=e){for(;null!=e.mixingFrom;)e=e.mixingFrom;do{null!=e.mixingFrom&&e.mixBlend==$x.add||this.computeHold(e),e=e.mixingTo}while(null!=e)}}}computeHold(t){const e=t.mixingTo,n=t.animation.timelines,s=t.animation.timelines.length,i=xy.setArraySize(t.timelineMode,s);t.timelineHoldMix.length=0;const r=xy.setArraySize(t.timelineHoldMix,s),a=this.propertyIDs;if(null!=e&&e.holdPrevious)for(let o=0;o<s;o++)i[o]=a.add(n[o].getPropertyId())?__.HOLD_FIRST:__.HOLD_SUBSEQUENT;else t:for(let o=0;o<s;o++){const s=n[o],l=s.getPropertyId();if(a.add(l))if(null==e||s instanceof a_||s instanceof c_||s instanceof h_||!e.animation.hasTimeline(l))i[o]=__.FIRST;else{for(let n=e.mixingTo;null!=n;n=n.mixingTo)if(!n.animation.hasTimeline(l)){if(t.mixDuration>0){i[o]=__.HOLD_MIX,r[o]=n;continue t}break}i[o]=__.HOLD_FIRST}else i[o]=__.SUBSEQUENT}}getCurrent(t){return t>=this.tracks.length?null:this.tracks[t]}addListener(t){if(null==t)throw new Error("listener cannot be null.");this.listeners.push(t)}removeListener(t){const e=this.listeners.indexOf(t);e>=0&&this.listeners.splice(e,1)}clearListeners(){this.listeners.length=0}clearListenerNotifications(){this.queue.clear()}setAnimationByName(t,e,n){__.deprecatedWarning1||(__.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: AnimationState.setAnimationByName is deprecated, please use setAnimation from now on.")),this.setAnimation(t,e,n)}addAnimationByName(t,e,n,s){__.deprecatedWarning2||(__.deprecatedWarning2=!0,console.warn("Spine Deprecation Warning: AnimationState.addAnimationByName is deprecated, please use addAnimation from now on.")),this.addAnimation(t,e,n,s)}hasAnimation(t){return null!==this.data.skeletonData.findAnimation(t)}hasAnimationByName(t){return __.deprecatedWarning3||(__.deprecatedWarning3=!0,console.warn("Spine Deprecation Warning: AnimationState.hasAnimationByName is deprecated, please use hasAnimation from now on.")),this.hasAnimation(t)}};let b_=__;b_.emptyAnimation=new Hy("<empty>",[],0),b_.SUBSEQUENT=0,b_.FIRST=1,b_.HOLD_SUBSEQUENT=2,b_.HOLD_FIRST=3,b_.HOLD_MIX=4,b_.SETUP=1,b_.CURRENT=2,b_.deprecatedWarning1=!1,b_.deprecatedWarning2=!1,b_.deprecatedWarning3=!1;const w_=class{constructor(){this.mixBlend=$x.replace,this.timelineMode=new Array,this.timelineHoldMix=new Array,this.timelinesRotation=new Array}reset(){this.next=null,this.mixingFrom=null,this.mixingTo=null,this.animation=null,this.listener=null,this.timelineMode.length=0,this.timelineHoldMix.length=0,this.timelinesRotation.length=0}getAnimationTime(){if(this.loop){const t=this.animationEnd-this.animationStart;return 0==t?this.animationStart:this.trackTime%t+this.animationStart}return Math.min(this.trackTime+this.animationStart,this.animationEnd)}setAnimationLast(t){this.animationLast=t,this.nextAnimationLast=t}isComplete(){return this.trackTime>=this.animationEnd-this.animationStart}resetRotationDirections(){this.timelinesRotation.length=0}get time(){return w_.deprecatedWarning1||(w_.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: TrackEntry.time is deprecated, please use trackTime from now on.")),this.trackTime}set time(t){w_.deprecatedWarning1||(w_.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: TrackEntry.time is deprecated, please use trackTime from now on.")),this.trackTime=t}get endTime(){return w_.deprecatedWarning2||(w_.deprecatedWarning2=!0,console.warn("Spine Deprecation Warning: TrackEntry.endTime is deprecated, please use trackEnd from now on.")),this.trackTime}set endTime(t){w_.deprecatedWarning2||(w_.deprecatedWarning2=!0,console.warn("Spine Deprecation Warning: TrackEntry.endTime is deprecated, please use trackEnd from now on.")),this.trackTime=t}loopsCount(){return Math.floor(this.trackTime/this.trackEnd)}};let E_=w_;E_.deprecatedWarning1=!1,E_.deprecatedWarning2=!1;const T_=class{constructor(t){this.objects=[],this.drainDisabled=!1,this.animState=t}start(t){this.objects.push(A_.start),this.objects.push(t),this.animState.animationsChanged=!0}interrupt(t){this.objects.push(A_.interrupt),this.objects.push(t)}end(t){this.objects.push(A_.end),this.objects.push(t),this.animState.animationsChanged=!0}dispose(t){this.objects.push(A_.dispose),this.objects.push(t)}complete(t){this.objects.push(A_.complete),this.objects.push(t)}event(t,e){this.objects.push(A_.event),this.objects.push(t),this.objects.push(e)}deprecateStuff(){return T_.deprecatedWarning1||(T_.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: onComplete, onStart, onEnd, onEvent art deprecated, please use listeners from now on. 'state.addListener({ complete: function(track, event) { } })'")),!0}drain(){if(this.drainDisabled)return;this.drainDisabled=!0;const t=this.objects,e=this.animState.listeners;for(let n=0;n<t.length;n+=2){const s=t[n],i=t[n+1];switch(s){case A_.start:null!=i.listener&&i.listener.start&&i.listener.start(i);for(let t=0;t<e.length;t++)e[t].start&&e[t].start(i);i.onStart&&this.deprecateStuff()&&i.onStart(i.trackIndex),this.animState.onStart&&this.deprecateStuff()&&this.deprecateStuff&&this.animState.onStart(i.trackIndex);break;case A_.interrupt:null!=i.listener&&i.listener.interrupt&&i.listener.interrupt(i);for(let t=0;t<e.length;t++)e[t].interrupt&&e[t].interrupt(i);break;case A_.end:null!=i.listener&&i.listener.end&&i.listener.end(i);for(let t=0;t<e.length;t++)e[t].end&&e[t].end(i);i.onEnd&&this.deprecateStuff()&&i.onEnd(i.trackIndex),this.animState.onEnd&&this.deprecateStuff()&&this.animState.onEnd(i.trackIndex);case A_.dispose:null!=i.listener&&i.listener.dispose&&i.listener.dispose(i);for(let t=0;t<e.length;t++)e[t].dispose&&e[t].dispose(i);this.animState.trackEntryPool.free(i);break;case A_.complete:null!=i.listener&&i.listener.complete&&i.listener.complete(i);for(let t=0;t<e.length;t++)e[t].complete&&e[t].complete(i);const s=fy.toInt(i.loopsCount());i.onComplete&&this.deprecateStuff()&&i.onComplete(i.trackIndex,s),this.animState.onComplete&&this.deprecateStuff()&&this.animState.onComplete(i.trackIndex,s);break;case A_.event:const r=t[2+n++];null!=i.listener&&i.listener.event&&i.listener.event(i,r);for(let t=0;t<e.length;t++)e[t].event&&e[t].event(i,r);i.onEvent&&this.deprecateStuff()&&i.onEvent(i.trackIndex,r),this.animState.onEvent&&this.deprecateStuff()&&this.animState.onEvent(i.trackIndex,r)}}this.clear(),this.drainDisabled=!1}clear(){this.objects.length=0}};let S_=T_;S_.deprecatedWarning1=!1;var A_=(t=>(t[t.start=0]="start",t[t.interrupt=1]="interrupt",t[t.end=2]="end",t[t.dispose=3]="dispose",t[t.complete=4]="complete",t[t.event=5]="event",t))(A_||{});const C_=class{constructor(t){if(this.animationToMixTime={},this.defaultMix=0,null==t)throw new Error("skeletonData cannot be null.");this.skeletonData=t}setMix(t,e,n){const s=this.skeletonData.findAnimation(t);if(null==s)throw new Error(`Animation not found: ${t}`);const i=this.skeletonData.findAnimation(e);if(null==i)throw new Error(`Animation not found: ${e}`);this.setMixWith(s,i,n)}setMixByName(t,e,n){C_.deprecatedWarning1||(C_.deprecatedWarning1=!0,console.warn("Deprecation Warning: AnimationStateData.setMixByName is deprecated, please use setMix from now on.")),this.setMix(t,e,n)}setMixWith(t,e,n){if(null==t)throw new Error("from cannot be null.");if(null==e)throw new Error("to cannot be null.");const s=`${t.name}.${e.name}`;this.animationToMixTime[s]=n}getMix(t,e){const n=`${t.name}.${e.name}`,s=this.animationToMixTime[n];return void 0===s?this.defaultMix:s}};let I_=C_;I_.deprecatedWarning1=!1;let M_=class{constructor(t){this.atlas=t}newRegionAttachment(t,e,n){const s=this.atlas.findRegion(n);if(null==s)throw new Error(`Region not found in atlas: ${n} (region attachment: ${e})`);const i=new Wy(e);return i.region=s,i}newMeshAttachment(t,e,n){const s=this.atlas.findRegion(n);if(null==s)throw new Error(`Region not found in atlas: ${n} (mesh attachment: ${e})`);const i=new By(e);return i.region=s,i}newBoundingBoxAttachment(t,e){return new Ly(e)}newPathAttachment(t,e){return new Vy(e)}newPointAttachment(t,e){return new Uy(e)}newClippingAttachment(t,e){return new Ny(e)}},R_=class{constructor(t,e,n){if(this.matrix=new nh,this.children=new Array,this.x=0,this.y=0,this.rotation=0,this.scaleX=0,this.scaleY=0,this.shearX=0,this.shearY=0,this.ax=0,this.ay=0,this.arotation=0,this.ascaleX=0,this.ascaleY=0,this.ashearX=0,this.ashearY=0,this.appliedValid=!1,this.sorted=!1,this.active=!1,null==t)throw new Error("data cannot be null.");if(null==e)throw new Error("skeleton cannot be null.");this.data=t,this.skeleton=e,this.parent=n,this.setToSetupPose()}get worldX(){return this.matrix.tx}get worldY(){return this.matrix.ty}isActive(){return this.active}update(){this.updateWorldTransformWith(this.x,this.y,this.rotation,this.scaleX,this.scaleY,this.shearX,this.shearY)}updateWorldTransform(){this.updateWorldTransformWith(this.x,this.y,this.rotation,this.scaleX,this.scaleY,this.shearX,this.shearY)}updateWorldTransformWith(t,e,n,s,i,r,a){this.ax=t,this.ay=e,this.arotation=n,this.ascaleX=s,this.ascaleY=i,this.ashearX=r,this.ashearY=a,this.appliedValid=!0;const o=this.parent,l=this.matrix,h=this.skeleton.scaleX,c=-this.skeleton.scaleY;if(null==o){const o=this.skeleton,u=n+90+a;return l.a=fy.cosDeg(n+r)*s*h,l.c=fy.cosDeg(u)*i*h,l.b=fy.sinDeg(n+r)*s*c,l.d=fy.sinDeg(u)*i*c,l.tx=t*h+o.x,void(l.ty=e*c+o.y)}let u=o.matrix.a,d=o.matrix.c,f=o.matrix.b,p=o.matrix.d;switch(l.tx=u*t+d*e+o.matrix.tx,l.ty=f*t+p*e+o.matrix.ty,this.data.transformMode){case Qx.Normal:{const t=n+90+a,e=fy.cosDeg(n+r)*s,o=fy.cosDeg(t)*i,h=fy.sinDeg(n+r)*s,c=fy.sinDeg(t)*i;return l.a=u*e+d*h,l.c=u*o+d*c,l.b=f*e+p*h,void(l.d=f*o+p*c)}case Qx.OnlyTranslation:{const t=n+90+a;l.a=fy.cosDeg(n+r)*s,l.c=fy.cosDeg(t)*i,l.b=fy.sinDeg(n+r)*s,l.d=fy.sinDeg(t)*i;break}case Qx.NoRotationOrReflection:{let t=u*u+f*f,e=0;t>1e-4?(t=Math.abs(u*p-d*f)/t,u/=this.skeleton.scaleX,f/=this.skeleton.scaleY,d=f*t,p=u*t,e=Math.atan2(f,u)*fy.radDeg):(u=0,f=0,e=90-Math.atan2(p,d)*fy.radDeg);const o=n+r-e,h=n+a-e+90,c=fy.cosDeg(o)*s,m=fy.cosDeg(h)*i,g=fy.sinDeg(o)*s,v=fy.sinDeg(h)*i;l.a=u*c-d*g,l.c=u*m-d*v,l.b=f*c+p*g,l.d=f*m+p*v;break}case Qx.NoScale:case Qx.NoScaleOrReflection:{const t=fy.cosDeg(n),e=fy.sinDeg(n);let o=(u*t+d*e)/h,m=(f*t+p*e)/c,g=Math.sqrt(o*o+m*m);g>1e-5&&(g=1/g),o*=g,m*=g,g=Math.sqrt(o*o+m*m),this.data.transformMode==Qx.NoScale&&u*p-d*f<0!=(this.skeleton.scaleX<0!=this.skeleton.scaleY>0)&&(g=-g);const v=Math.PI/2+Math.atan2(m,o),x=Math.cos(v)*g,y=Math.sin(v)*g,_=fy.cosDeg(r)*s,b=fy.cosDeg(90+a)*i,w=fy.sinDeg(r)*s,E=fy.sinDeg(90+a)*i;l.a=o*_+x*w,l.c=o*b+x*E,l.b=m*_+y*w,l.d=m*b+y*E;break}}l.a*=h,l.c*=h,l.b*=c,l.d*=c}setToSetupPose(){const t=this.data;this.x=t.x,this.y=t.y,this.rotation=t.rotation,this.scaleX=t.scaleX,this.scaleY=t.scaleY,this.shearX=t.shearX,this.shearY=t.shearY}getWorldRotationX(){return Math.atan2(this.matrix.b,this.matrix.a)*fy.radDeg}getWorldRotationY(){return Math.atan2(this.matrix.d,this.matrix.c)*fy.radDeg}getWorldScaleX(){const t=this.matrix;return Math.sqrt(t.a*t.a+t.c*t.c)}getWorldScaleY(){const t=this.matrix;return Math.sqrt(t.b*t.b+t.d*t.d)}updateAppliedTransform(){this.appliedValid=!0;const t=this.parent,e=this.matrix;if(null==t)return this.ax=e.tx,this.ay=e.ty,this.arotation=Math.atan2(e.b,e.a)*fy.radDeg,this.ascaleX=Math.sqrt(e.a*e.a+e.b*e.b),this.ascaleY=Math.sqrt(e.c*e.c+e.d*e.d),this.ashearX=0,void(this.ashearY=Math.atan2(e.a*e.c+e.b*e.d,e.a*e.d-e.b*e.c)*fy.radDeg);const n=t.matrix,s=1/(n.a*n.d-n.b*n.c),i=e.tx-n.tx,r=e.ty-n.ty;this.ax=i*n.d*s-r*n.c*s,this.ay=r*n.a*s-i*n.b*s;const a=s*n.d,o=s*n.a,l=s*n.c,h=s*n.b,c=a*e.a-l*e.b,u=a*e.c-l*e.d,d=o*e.b-h*e.a,f=o*e.d-h*e.c;if(this.ashearX=0,this.ascaleX=Math.sqrt(c*c+d*d),this.ascaleX>1e-4){const t=c*f-u*d;this.ascaleY=t/this.ascaleX,this.ashearY=Math.atan2(c*u+d*f,t)*fy.radDeg,this.arotation=Math.atan2(d,c)*fy.radDeg}else this.ascaleX=0,this.ascaleY=Math.sqrt(u*u+f*f),this.ashearY=0,this.arotation=90-Math.atan2(f,u)*fy.radDeg}worldToLocal(t){const e=this.matrix,n=e.a,s=e.c,i=e.b,r=e.d,a=1/(n*r-s*i),o=t.x-e.tx,l=t.y-e.ty;return t.x=o*r*a-l*s*a,t.y=l*n*a-o*i*a,t}localToWorld(t){const e=this.matrix,n=t.x,s=t.y;return t.x=n*e.a+s*e.c+e.tx,t.y=n*e.b+s*e.d+e.ty,t}worldToLocalRotation(t){const e=fy.sinDeg(t),n=fy.cosDeg(t),s=this.matrix;return Math.atan2(s.a*e-s.b*n,s.d*n-s.c*e)*fy.radDeg}localToWorldRotation(t){const e=fy.sinDeg(t),n=fy.cosDeg(t),s=this.matrix;return Math.atan2(n*s.b+e*s.d,n*s.a+e*s.c)*fy.radDeg}rotateWorld(t){const e=this.matrix,n=e.a,s=e.c,i=e.b,r=e.d,a=fy.cosDeg(t),o=fy.sinDeg(t);e.a=a*n-o*i,e.c=a*s-o*r,e.b=o*n+a*i,e.d=o*s+a*r,this.appliedValid=!1}},P_=class{constructor(t,e,n){if(this.x=0,this.y=0,this.rotation=0,this.scaleX=1,this.scaleY=1,this.shearX=0,this.shearY=0,this.transformMode=Qx.Normal,this.skinRequired=!1,this.color=new uy,t<0)throw new Error("index must be >= 0.");if(null==e)throw new Error("name cannot be null.");this.index=t,this.name=e,this.parent=n}},k_=class{constructor(t,e,n){this.name=t,this.order=e,this.skinRequired=n}},F_=class{constructor(t,e){if(null==e)throw new Error("data cannot be null.");this.time=t,this.data=e}},O_=class{constructor(t){this.name=t}},D_=class{constructor(t,e){if(this.bendDirection=0,this.compress=!1,this.stretch=!1,this.mix=1,this.softness=0,this.active=!1,null==t)throw new Error("data cannot be null.");if(null==e)throw new Error("skeleton cannot be null.");this.data=t,this.mix=t.mix,this.softness=t.softness,this.bendDirection=t.bendDirection,this.compress=t.compress,this.stretch=t.stretch,this.bones=new Array;for(let n=0;n<t.bones.length;n++)this.bones.push(e.findBone(t.bones[n].name));this.target=e.findBone(t.target.name)}isActive(){return this.active}apply(){this.update()}update(){const t=this.target,e=this.bones;switch(e.length){case 1:this.apply1(e[0],t.worldX,t.worldY,this.compress,this.stretch,this.data.uniform,this.mix);break;case 2:this.apply2(e[0],e[1],t.worldX,t.worldY,this.bendDirection,this.stretch,this.softness,this.mix)}}apply1(t,e,n,s,i,r,a){t.appliedValid||t.updateAppliedTransform();const o=t.parent.matrix,l=o.a;let h=o.c;const c=o.b;let u=o.d,d=-t.ashearX-t.arotation,f=0,p=0;switch(t.data.transformMode){case Qx.OnlyTranslation:f=e-t.worldX,p=n-t.worldY;break;case Qx.NoRotationOrReflection:const s=Math.abs(l*u-h*c)/(l*l+c*c),i=l/t.skeleton.scaleX,r=c/t.skeleton.scaleY;h=-r*s*t.skeleton.scaleX,u=i*s*t.skeleton.scaleY,d+=Math.atan2(r,i)*fy.radDeg;default:const a=e-o.tx,m=n-o.ty,g=l*u-h*c;f=(a*u-m*h)/g-t.ax,p=(m*l-a*c)/g-t.ay}d+=Math.atan2(p,f)*fy.radDeg,t.ascaleX<0&&(d+=180),d>180?d-=360:d<-180&&(d+=360);let m=t.ascaleX,g=t.ascaleY;if(s||i){switch(t.data.transformMode){case Qx.NoScale:case Qx.NoScaleOrReflection:f=e-t.worldX,p=n-t.worldY}const o=t.data.length*m,l=Math.sqrt(f*f+p*p);if(s&&l<o||i&&l>o&&o>1e-4){const t=(l/o-1)*a+1;m*=t,r&&(g*=t)}}t.updateWorldTransformWith(t.ax,t.ay,t.arotation+d*a,m,g,t.ashearX,t.ashearY)}apply2(t,e,n,s,i,r,a,o){if(0==o)return void e.updateWorldTransform();t.appliedValid||t.updateAppliedTransform(),e.appliedValid||e.updateAppliedTransform();const l=t.ax,h=t.ay;let c=t.ascaleX,u=c,d=t.ascaleY,f=e.ascaleX;const p=t.matrix;let m=0,g=0,v=0;c<0?(c=-c,m=180,v=-1):(m=0,v=1),d<0&&(d=-d,v=-v),f<0?(f=-f,g=180):g=0;const x=e.ax;let y=0,_=0,b=0,w=p.a,E=p.c,T=p.b,S=p.d;const A=Math.abs(c-d)<=1e-4;A?(y=e.ay,_=w*x+E*y+p.tx,b=T*x+S*y+p.ty):(y=0,_=w*x+p.tx,b=T*x+p.ty);const C=t.parent.matrix;w=C.a,E=C.c,T=C.b,S=C.d;const I=1/(w*S-E*T);let M=_-C.tx,R=b-C.ty;const P=(M*S-R*E)*I-l,k=(R*w-M*T)*I-h,F=Math.sqrt(P*P+k*k);let O,D,L=e.data.length*f;if(F<1e-4)return this.apply1(t,n,s,!1,r,!1,o),void e.updateWorldTransformWith(x,y,0,e.ascaleX,e.ascaleY,e.ashearX,e.ashearY);M=n-C.tx,R=s-C.ty;let N=(M*S-R*E)*I-l,B=(R*w-M*T)*I-h,V=N*N+B*B;if(0!=a){a*=c*(f+1)/2;const t=Math.sqrt(V),e=t-F-L*c+a;if(e>0){let n=Math.min(1,e/(2*a))-1;n=(e-a*(1-n*n))/t,N-=n*N,B-=n*B,V=N*N+B*B}}t:if(A){L*=c;let t=(V-F*F-L*L)/(2*F*L);t<-1?t=-1:t>1&&(t=1,r&&(u*=(Math.sqrt(V)/(F+L)-1)*o+1)),D=Math.acos(t)*i,w=F+L*t,E=L*Math.sin(D),O=Math.atan2(B*w-N*E,N*w+B*E)}else{w=c*L,E=d*L;const t=w*w,e=E*E,n=Math.atan2(B,N);T=e*F*F+t*V-t*e;const s=-2*e*F,r=e-t;if(S=s*s-4*r*T,S>=0){let t=Math.sqrt(S);s<0&&(t=-t),t=-(s+t)/2;const e=t/r,a=T/t,o=Math.abs(e)<Math.abs(a)?e:a;if(o*o<=V){R=Math.sqrt(V-o*o)*i,O=n-Math.atan2(R,o),D=Math.atan2(R/d,(o-F)/c);break t}}let a=fy.PI,o=F-w,l=o*o,h=0,u=0,f=F+w,p=f*f,m=0;T=-w*F/(t-e),T>=-1&&T<=1&&(T=Math.acos(T),M=w*Math.cos(T)+F,R=E*Math.sin(T),S=M*M+R*R,S<l&&(a=T,l=S,o=M,h=R),S>p&&(u=T,p=S,f=M,m=R)),V<=(l+p)/2?(O=n-Math.atan2(h*i,o),D=a*i):(O=n-Math.atan2(m*i,f),D=u*i)}const U=Math.atan2(y,x)*v;let X=t.arotation;O=(O-U)*fy.radDeg+m-X,O>180?O-=360:O<-180&&(O+=360),t.updateWorldTransformWith(l,h,X+O*o,u,t.ascaleY,0,0),X=e.arotation,D=((D+U)*fy.radDeg-e.ashearX)*v+g-X,D>180?D-=360:D<-180&&(D+=360),e.updateWorldTransformWith(x,y,X+D*o,e.ascaleX,e.ascaleY,e.ashearX,e.ashearY)}},L_=class extends k_{constructor(t){super(t,0,!1),this.bones=new Array,this.bendDirection=1,this.compress=!1,this.stretch=!1,this.uniform=!1,this.mix=1,this.softness=0}},N_=class extends k_{constructor(t){super(t,0,!1),this.bones=new Array}};var B_=(t=>(t[t.Length=0]="Length",t[t.Fixed=1]="Fixed",t[t.Percent=2]="Percent",t))(B_||{});const V_=class{constructor(t,e){if(this.position=0,this.spacing=0,this.rotateMix=0,this.translateMix=0,this.spaces=new Array,this.positions=new Array,this.world=new Array,this.curves=new Array,this.lengths=new Array,this.segments=new Array,this.active=!1,null==t)throw new Error("data cannot be null.");if(null==e)throw new Error("skeleton cannot be null.");this.data=t,this.bones=new Array;for(let n=0,s=t.bones.length;n<s;n++)this.bones.push(e.findBone(t.bones[n].name));this.target=e.findSlot(t.target.name),this.position=t.position,this.spacing=t.spacing,this.rotateMix=t.rotateMix,this.translateMix=t.translateMix}isActive(){return this.active}apply(){this.update()}update(){const t=this.target.getAttachment();if(!(t instanceof Vy))return;const e=this.rotateMix,n=this.translateMix,s=e>0;if(!(n>0)&&!s)return;const i=this.data,r=i.spacingMode,a=r==B_.Length,o=i.rotateMode,l=o==Zx.Tangent,h=o==Zx.ChainScale,c=this.bones.length,u=l?c:c+1,d=this.bones,f=xy.setArraySize(this.spaces,u);let p=null;const m=this.spacing;if(h||a){h&&(p=xy.setArraySize(this.lengths,c));for(let t=0,e=u-1;t<e;){const e=d[t],n=e.data.length;if(n<V_.epsilon)h&&(p[t]=0),f[++t]=0;else{const s=n*e.matrix.a,i=n*e.matrix.b,r=Math.sqrt(s*s+i*i);h&&(p[t]=r),f[++t]=(a?n+m:m)*r/n}}}else for(let b=1;b<u;b++)f[b]=m;const g=this.computeWorldPositions(t,u,l,i.positionMode==Kx.Percent,r==B_.Percent);let v=g[0],x=g[1],y=i.offsetRotation,_=!1;if(0==y)_=o==Zx.Chain;else{_=!1;const t=this.target.bone.matrix;y*=t.a*t.d-t.b*t.c>0?fy.degRad:-fy.degRad}for(let b=0,w=3;b<c;b++,w+=3){const t=d[b],i=t.matrix;i.tx+=(v-i.tx)*n,i.ty+=(x-i.ty)*n;const r=g[w],a=g[w+1],o=r-v,c=a-x;if(h){const t=p[b];if(0!=t){const n=(Math.sqrt(o*o+c*c)/t-1)*e+1;i.a*=n,i.b*=n}}if(v=r,x=a,s){const n=i.a,s=i.c,r=i.b,a=i.d;let h=0,u=0,d=0;if(l&&(h=l?g[w-1]:0==f[b+1]?g[w+2]:Math.atan2(c,o)),h-=Math.atan2(r,n),_){u=Math.cos(h),d=Math.sin(h);const s=t.data.length;v+=(s*(u*n-d*r)-o)*e,x+=(s*(d*n+u*r)-c)*e}else h+=y;h>fy.PI?h-=fy.PI2:h<-fy.PI&&(h+=fy.PI2),h*=e,u=Math.cos(h),d=Math.sin(h),i.a=u*n-d*r,i.c=u*s-d*a,i.b=d*n+u*r,i.d=d*s+u*a}t.appliedValid=!1}}computeWorldPositions(t,e,n,s,i){const r=this.target;let a=this.position;const o=this.spaces,l=xy.setArraySize(this.positions,3*e+2);let h=null;const c=t.closed;let u=t.worldVerticesLength,d=u/6,f=V_.NONE;if(!t.constantSpeed){const p=t.lengths;d-=c?1:2;const m=p[d];if(s&&(a*=m),i)for(let t=0;t<e;t++)o[t]*=m;h=xy.setArraySize(this.world,8);for(let s=0,i=0,g=0;s<e;s++,i+=3){const e=o[s];a+=e;let v=a;if(c)v%=m,v<0&&(v+=m),g=0;else{if(v<0){f!=V_.BEFORE&&(f=V_.BEFORE,t.computeWorldVertices(r,2,4,h,0,2)),this.addBeforePosition(v,h,0,l,i);continue}if(v>m){f!=V_.AFTER&&(f=V_.AFTER,t.computeWorldVertices(r,u-6,4,h,0,2)),this.addAfterPosition(v-m,h,0,l,i);continue}}for(;;g++){const t=p[g];if(!(v>t)){if(0==g)v/=t;else{const e=p[g-1];v=(v-e)/(t-e)}break}}g!=f&&(f=g,c&&g==d?(t.computeWorldVertices(r,u-4,4,h,0,2),t.computeWorldVertices(r,0,4,h,4,2)):t.computeWorldVertices(r,6*g+2,8,h,0,2)),this.addCurvePosition(v,h[0],h[1],h[2],h[3],h[4],h[5],h[6],h[7],l,i,n||s>0&&0==e)}return l}c?(u+=2,h=xy.setArraySize(this.world,u),t.computeWorldVertices(r,2,u-4,h,0,2),t.computeWorldVertices(r,0,2,h,u-4,2),h[u-2]=h[0],h[u-1]=h[1]):(d--,u-=4,h=xy.setArraySize(this.world,u),t.computeWorldVertices(r,2,u,h,0,2));const p=xy.setArraySize(this.curves,d);let m=0,g=h[0],v=h[1],x=0,y=0,_=0,b=0,w=0,E=0,T=0,S=0,A=0,C=0,I=0,M=0,R=0,P=0;for(let O=0,D=2;O<d;O++,D+=6)x=h[D],y=h[D+1],_=h[D+2],b=h[D+3],w=h[D+4],E=h[D+5],T=.1875*(g-2*x+_),S=.1875*(v-2*y+b),A=.09375*(3*(x-_)-g+w),C=.09375*(3*(y-b)-v+E),I=2*T+A,M=2*S+C,R=.75*(x-g)+T+.16666667*A,P=.75*(y-v)+S+.16666667*C,m+=Math.sqrt(R*R+P*P),R+=I,P+=M,I+=A,M+=C,m+=Math.sqrt(R*R+P*P),R+=I,P+=M,m+=Math.sqrt(R*R+P*P),R+=I+A,P+=M+C,m+=Math.sqrt(R*R+P*P),p[O]=m,g=w,v=E;if(s&&(a*=m),i)for(let O=0;O<e;O++)o[O]*=m;const k=this.segments;let F=0;for(let O=0,D=0,L=0,N=0;O<e;O++,D+=3){const t=o[O];a+=t;let e=a;if(c)e%=m,e<0&&(e+=m),L=0;else{if(e<0){this.addBeforePosition(e,h,0,l,D);continue}if(e>m){this.addAfterPosition(e-m,h,u-4,l,D);continue}}for(;;L++){const t=p[L];if(!(e>t)){if(0==L)e/=t;else{const n=p[L-1];e=(e-n)/(t-n)}break}}if(L!=f){f=L;let t=6*L;for(g=h[t],v=h[t+1],x=h[t+2],y=h[t+3],_=h[t+4],b=h[t+5],w=h[t+6],E=h[t+7],T=.03*(g-2*x+_),S=.03*(v-2*y+b),A=.006*(3*(x-_)-g+w),C=.006*(3*(y-b)-v+E),I=2*T+A,M=2*S+C,R=.3*(x-g)+T+.16666667*A,P=.3*(y-v)+S+.16666667*C,F=Math.sqrt(R*R+P*P),k[0]=F,t=1;t<8;t++)R+=I,P+=M,I+=A,M+=C,F+=Math.sqrt(R*R+P*P),k[t]=F;R+=I,P+=M,F+=Math.sqrt(R*R+P*P),k[8]=F,R+=I+A,P+=M+C,F+=Math.sqrt(R*R+P*P),k[9]=F,N=0}for(e*=F;;N++){const t=k[N];if(!(e>t)){if(0==N)e/=t;else{const n=k[N-1];e=N+(e-n)/(t-n)}break}}this.addCurvePosition(.1*e,g,v,x,y,_,b,w,E,l,D,n||O>0&&0==t)}return l}addBeforePosition(t,e,n,s,i){const r=e[n],a=e[n+1],o=e[n+2]-r,l=e[n+3]-a,h=Math.atan2(l,o);s[i]=r+t*Math.cos(h),s[i+1]=a+t*Math.sin(h),s[i+2]=h}addAfterPosition(t,e,n,s,i){const r=e[n+2],a=e[n+3],o=r-e[n],l=a-e[n+1],h=Math.atan2(l,o);s[i]=r+t*Math.cos(h),s[i+1]=a+t*Math.sin(h),s[i+2]=h}addCurvePosition(t,e,n,s,i,r,a,o,l,h,c,u){(0==t||isNaN(t))&&(t=1e-4);const d=t*t,f=d*t,p=1-t,m=p*p,g=m*p,v=p*t,x=3*v,y=p*x,_=x*t,b=e*g+s*y+r*_+o*f,w=n*g+i*y+a*_+l*f;h[c]=b,h[c+1]=w,u&&(h[c+2]=Math.atan2(w-(n*m+i*v*2+a*d),b-(e*m+s*v*2+r*d)))}};let U_=V_;U_.NONE=-1,U_.BEFORE=-2,U_.AFTER=-3,U_.epsilon=1e-5;let X_=class{constructor(t,e){if(this.rotateMix=0,this.translateMix=0,this.scaleMix=0,this.shearMix=0,this.temp=new _y,this.active=!1,null==t)throw new Error("data cannot be null.");if(null==e)throw new Error("skeleton cannot be null.");this.data=t,this.rotateMix=t.rotateMix,this.translateMix=t.translateMix,this.scaleMix=t.scaleMix,this.shearMix=t.shearMix,this.bones=new Array;for(let n=0;n<t.bones.length;n++)this.bones.push(e.findBone(t.bones[n].name));this.target=e.findBone(t.target.name)}isActive(){return this.active}apply(){this.update()}update(){this.data.local?this.data.relative?this.applyRelativeLocal():this.applyAbsoluteLocal():this.data.relative?this.applyRelativeWorld():this.applyAbsoluteWorld()}applyAbsoluteWorld(){const t=this.rotateMix,e=this.translateMix,n=this.scaleMix,s=this.shearMix,i=this.target,r=i.matrix,a=r.a,o=r.c,l=r.b,h=r.d,c=a*h-o*l>0?fy.degRad:-fy.degRad,u=this.data.offsetRotation*c,d=this.data.offsetShearY*c,f=this.bones;for(let p=0,m=f.length;p<m;p++){const r=f[p];let c=!1;const m=r.matrix;if(0!=t){const e=m.a,n=m.c,s=m.b,i=m.d;let r=Math.atan2(l,a)-Math.atan2(s,e)+u;r>fy.PI?r-=fy.PI2:r<-fy.PI&&(r+=fy.PI2),r*=t;const o=Math.cos(r),h=Math.sin(r);m.a=o*e-h*s,m.c=o*n-h*i,m.b=h*e+o*s,m.d=h*n+o*i,c=!0}if(0!=e){const t=this.temp;i.localToWorld(t.set(this.data.offsetX,this.data.offsetY)),m.tx+=(t.x-m.tx)*e,m.ty+=(t.y-m.ty)*e,c=!0}if(n>0){let t=Math.sqrt(m.a*m.a+m.b*m.b),e=Math.sqrt(a*a+l*l);t>1e-5&&(t=(t+(e-t+this.data.offsetScaleX)*n)/t),m.a*=t,m.b*=t,t=Math.sqrt(m.c*m.c+m.d*m.d),e=Math.sqrt(o*o+h*h),t>1e-5&&(t=(t+(e-t+this.data.offsetScaleY)*n)/t),m.c*=t,m.d*=t,c=!0}if(s>0){const t=m.c,e=m.d,n=Math.atan2(e,t);let i=Math.atan2(h,o)-Math.atan2(l,a)-(n-Math.atan2(m.b,m.a));i>fy.PI?i-=fy.PI2:i<-fy.PI&&(i+=fy.PI2),i=n+(i+d)*s;const r=Math.sqrt(t*t+e*e);m.c=Math.cos(i)*r,m.d=Math.sin(i)*r,c=!0}c&&(r.appliedValid=!1)}}applyRelativeWorld(){const t=this.rotateMix,e=this.translateMix,n=this.scaleMix,s=this.shearMix,i=this.target,r=i.matrix,a=r.a,o=r.c,l=r.b,h=r.d,c=a*h-o*l>0?fy.degRad:-fy.degRad,u=this.data.offsetRotation*c,d=this.data.offsetShearY*c,f=this.bones;for(let p=0,m=f.length;p<m;p++){const r=f[p];let c=!1;const m=r.matrix;if(0!=t){const e=m.a,n=m.c,s=m.b,i=m.d;let r=Math.atan2(l,a)+u;r>fy.PI?r-=fy.PI2:r<-fy.PI&&(r+=fy.PI2),r*=t;const o=Math.cos(r),h=Math.sin(r);m.a=o*e-h*s,m.c=o*n-h*i,m.b=h*e+o*s,m.d=h*n+o*i,c=!0}if(0!=e){const t=this.temp;i.localToWorld(t.set(this.data.offsetX,this.data.offsetY)),m.tx+=t.x*e,m.ty+=t.y*e,c=!0}if(n>0){let t=(Math.sqrt(a*a+l*l)-1+this.data.offsetScaleX)*n+1;m.a*=t,m.b*=t,t=(Math.sqrt(o*o+h*h)-1+this.data.offsetScaleY)*n+1,m.c*=t,m.d*=t,c=!0}if(s>0){let t=Math.atan2(h,o)-Math.atan2(l,a);t>fy.PI?t-=fy.PI2:t<-fy.PI&&(t+=fy.PI2);const e=m.c,n=m.d;t=Math.atan2(n,e)+(t-fy.PI/2+d)*s;const i=Math.sqrt(e*e+n*n);m.c=Math.cos(t)*i,m.d=Math.sin(t)*i,c=!0}c&&(r.appliedValid=!1)}}applyAbsoluteLocal(){const t=this.rotateMix,e=this.translateMix,n=this.scaleMix,s=this.shearMix,i=this.target;i.appliedValid||i.updateAppliedTransform();const r=this.bones;for(let a=0,o=r.length;a<o;a++){const o=r[a];o.appliedValid||o.updateAppliedTransform();let l=o.arotation;if(0!=t){let e=i.arotation-l+this.data.offsetRotation;e-=360*(16384-(16384.499999999996-e/360|0)),l+=e*t}let h=o.ax,c=o.ay;0!=e&&(h+=(i.ax-h+this.data.offsetX)*e,c+=(i.ay-c+this.data.offsetY)*e);let u=o.ascaleX,d=o.ascaleY;n>0&&(u>1e-5&&(u=(u+(i.ascaleX-u+this.data.offsetScaleX)*n)/u),d>1e-5&&(d=(d+(i.ascaleY-d+this.data.offsetScaleY)*n)/d));const f=o.ashearY;if(s>0){let t=i.ashearY-f+this.data.offsetShearY;t-=360*(16384-(16384.499999999996-t/360|0)),o.shearY+=t*s}o.updateWorldTransformWith(h,c,l,u,d,o.ashearX,f)}}applyRelativeLocal(){const t=this.rotateMix,e=this.translateMix,n=this.scaleMix,s=this.shearMix,i=this.target;i.appliedValid||i.updateAppliedTransform();const r=this.bones;for(let a=0,o=r.length;a<o;a++){const o=r[a];o.appliedValid||o.updateAppliedTransform();let l=o.arotation;0!=t&&(l+=(i.arotation+this.data.offsetRotation)*t);let h=o.ax,c=o.ay;0!=e&&(h+=(i.ax+this.data.offsetX)*e,c+=(i.ay+this.data.offsetY)*e);let u=o.ascaleX,d=o.ascaleY;n>0&&(u>1e-5&&(u*=(i.ascaleX-1+this.data.offsetScaleX)*n+1),d>1e-5&&(d*=(i.ascaleY-1+this.data.offsetScaleY)*n+1));let f=o.ashearY;s>0&&(f+=(i.ashearY+this.data.offsetShearY)*s),o.updateWorldTransformWith(h,c,l,u,d,o.ashearX,f)}}};const Y_=class{constructor(t){if(this._updateCache=new Array,this.updateCacheReset=new Array,this.time=0,this.scaleX=1,this.scaleY=1,this.x=0,this.y=0,null==t)throw new Error("data cannot be null.");this.data=t,this.bones=new Array;for(let e=0;e<t.bones.length;e++){const n=t.bones[e];let s;if(null==n.parent)s=new R_(n,this,null);else{const t=this.bones[n.parent.index];s=new R_(n,this,t),t.children.push(s)}this.bones.push(s)}this.slots=new Array,this.drawOrder=new Array;for(let e=0;e<t.slots.length;e++){const n=t.slots[e],s=this.bones[n.boneData.index],i=new Xy(n,s);this.slots.push(i),this.drawOrder.push(i)}this.ikConstraints=new Array;for(let e=0;e<t.ikConstraints.length;e++){const n=t.ikConstraints[e];this.ikConstraints.push(new D_(n,this))}this.transformConstraints=new Array;for(let e=0;e<t.transformConstraints.length;e++){const n=t.transformConstraints[e];this.transformConstraints.push(new X_(n,this))}this.pathConstraints=new Array;for(let e=0;e<t.pathConstraints.length;e++){const n=t.pathConstraints[e];this.pathConstraints.push(new U_(n,this))}this.color=new uy(1,1,1,1),this.updateCache()}updateCache(){this._updateCache.length=0,this.updateCacheReset.length=0;const t=this.bones;for(let l=0,h=t.length;l<h;l++){const e=t[l];e.sorted=e.data.skinRequired,e.active=!e.sorted}if(null!=this.skin){const t=this.skin.bones;for(let e=0,n=this.skin.bones.length;e<n;e++){let n=this.bones[t[e].index];do{n.sorted=!1,n.active=!0,n=n.parent}while(null!=n)}}const e=this.ikConstraints,n=this.transformConstraints,s=this.pathConstraints,i=e.length,r=n.length,a=s.length,o=i+r+a;t:for(let l=0;l<o;l++){for(let t=0;t<i;t++){const n=e[t];if(n.data.order==l){this.sortIkConstraint(n);continue t}}for(let t=0;t<r;t++){const e=n[t];if(e.data.order==l){this.sortTransformConstraint(e);continue t}}for(let t=0;t<a;t++){const e=s[t];if(e.data.order==l){this.sortPathConstraint(e);continue t}}}for(let l=0,h=t.length;l<h;l++)this.sortBone(t[l])}sortIkConstraint(t){if(t.active=t.target.isActive()&&(!t.data.skinRequired||null!=this.skin&&xy.contains(this.skin.constraints,t.data,!0)),!t.active)return;const e=t.target;this.sortBone(e);const n=t.bones,s=n[0];if(this.sortBone(s),n.length>1){const t=n[n.length-1];this._updateCache.indexOf(t)>-1||this.updateCacheReset.push(t)}this._updateCache.push(t),this.sortReset(s.children),n[n.length-1].sorted=!0}sortPathConstraint(t){if(t.active=t.target.bone.isActive()&&(!t.data.skinRequired||null!=this.skin&&xy.contains(this.skin.constraints,t.data,!0)),!t.active)return;const e=t.target,n=e.data.index,s=e.bone;null!=this.skin&&this.sortPathConstraintAttachment(this.skin,n,s),null!=this.data.defaultSkin&&this.data.defaultSkin!=this.skin&&this.sortPathConstraintAttachment(this.data.defaultSkin,n,s);for(let o=0,l=this.data.skins.length;o<l;o++)this.sortPathConstraintAttachment(this.data.skins[o],n,s);const i=e.getAttachment();i instanceof Vy&&this.sortPathConstraintAttachmentWith(i,s);const r=t.bones,a=r.length;for(let o=0;o<a;o++)this.sortBone(r[o]);this._updateCache.push(t);for(let o=0;o<a;o++)this.sortReset(r[o].children);for(let o=0;o<a;o++)r[o].sorted=!0}sortTransformConstraint(t){if(t.active=t.target.isActive()&&(!t.data.skinRequired||null!=this.skin&&xy.contains(this.skin.constraints,t.data,!0)),!t.active)return;this.sortBone(t.target);const e=t.bones,n=e.length;if(t.data.local)for(let s=0;s<n;s++){const t=e[s];this.sortBone(t.parent),this._updateCache.indexOf(t)>-1||this.updateCacheReset.push(t)}else for(let s=0;s<n;s++)this.sortBone(e[s]);this._updateCache.push(t);for(let s=0;s<n;s++)this.sortReset(e[s].children);for(let s=0;s<n;s++)e[s].sorted=!0}sortPathConstraintAttachment(t,e,n){const s=t.attachments[e];if(s)for(const i in s)this.sortPathConstraintAttachmentWith(s[i],n)}sortPathConstraintAttachmentWith(t,e){if(!(t instanceof Vy))return;const n=t.bones;if(null==n)this.sortBone(e);else{const t=this.bones;let e=0;for(;e<n.length;){const s=n[e++];for(let i=e+s;e<i;e++){const s=n[e];this.sortBone(t[s])}}}}sortBone(t){if(t.sorted)return;const e=t.parent;null!=e&&this.sortBone(e),t.sorted=!0,this._updateCache.push(t)}sortReset(t){for(let e=0,n=t.length;e<n;e++){const n=t[e];n.active&&(n.sorted&&this.sortReset(n.children),n.sorted=!1)}}updateWorldTransform(){const t=this.updateCacheReset;for(let n=0,s=t.length;n<s;n++){const e=t[n];e.ax=e.x,e.ay=e.y,e.arotation=e.rotation,e.ascaleX=e.scaleX,e.ascaleY=e.scaleY,e.ashearX=e.shearX,e.ashearY=e.shearY,e.appliedValid=!0}const e=this._updateCache;for(let n=0,s=e.length;n<s;n++)e[n].update()}setToSetupPose(){this.setBonesToSetupPose(),this.setSlotsToSetupPose()}setBonesToSetupPose(){const t=this.bones;for(let i=0,r=t.length;i<r;i++)t[i].setToSetupPose();const e=this.ikConstraints;for(let i=0,r=e.length;i<r;i++){const t=e[i];t.mix=t.data.mix,t.softness=t.data.softness,t.bendDirection=t.data.bendDirection,t.compress=t.data.compress,t.stretch=t.data.stretch}const n=this.transformConstraints;for(let i=0,r=n.length;i<r;i++){const t=n[i],e=t.data;t.rotateMix=e.rotateMix,t.translateMix=e.translateMix,t.scaleMix=e.scaleMix,t.shearMix=e.shearMix}const s=this.pathConstraints;for(let i=0,r=s.length;i<r;i++){const t=s[i],e=t.data;t.position=e.position,t.spacing=e.spacing,t.rotateMix=e.rotateMix,t.translateMix=e.translateMix}}setSlotsToSetupPose(){const t=this.slots;xy.arrayCopy(t,0,this.drawOrder,0,t.length);for(let e=0,n=t.length;e<n;e++)t[e].setToSetupPose()}getRootBone(){return 0==this.bones.length?null:this.bones[0]}findBone(t){if(null==t)throw new Error("boneName cannot be null.");const e=this.bones;for(let n=0,s=e.length;n<s;n++){const s=e[n];if(s.data.name==t)return s}return null}findBoneIndex(t){if(null==t)throw new Error("boneName cannot be null.");const e=this.bones;for(let n=0,s=e.length;n<s;n++)if(e[n].data.name==t)return n;return-1}findSlot(t){if(null==t)throw new Error("slotName cannot be null.");const e=this.slots;for(let n=0,s=e.length;n<s;n++){const s=e[n];if(s.data.name==t)return s}return null}findSlotIndex(t){if(null==t)throw new Error("slotName cannot be null.");const e=this.slots;for(let n=0,s=e.length;n<s;n++)if(e[n].data.name==t)return n;return-1}setSkinByName(t){const e=this.data.findSkin(t);if(null==e)throw new Error(`Skin not found: ${t}`);this.setSkin(e)}setSkin(t){if(t!=this.skin){if(null!=t)if(null!=this.skin)t.attachAll(this,this.skin);else{const e=this.slots;for(let n=0,s=e.length;n<s;n++){const s=e[n],i=s.data.attachmentName;if(null!=i){const e=t.getAttachment(n,i);null!=e&&s.setAttachment(e)}}}this.skin=t,this.updateCache()}}getAttachmentByName(t,e){return this.getAttachment(this.data.findSlotIndex(t),e)}getAttachment(t,e){if(null==e)throw new Error("attachmentName cannot be null.");if(null!=this.skin){const n=this.skin.getAttachment(t,e);if(null!=n)return n}return null!=this.data.defaultSkin?this.data.defaultSkin.getAttachment(t,e):null}setAttachment(t,e){if(null==t)throw new Error("slotName cannot be null.");const n=this.slots;for(let s=0,i=n.length;s<i;s++){const i=n[s];if(i.data.name==t){let n=null;if(null!=e&&(n=this.getAttachment(s,e),null==n))throw new Error(`Attachment not found: ${e}, for slot: ${t}`);return void i.setAttachment(n)}}throw new Error(`Slot not found: ${t}`)}findIkConstraint(t){if(null==t)throw new Error("constraintName cannot be null.");const e=this.ikConstraints;for(let n=0,s=e.length;n<s;n++){const s=e[n];if(s.data.name==t)return s}return null}findTransformConstraint(t){if(null==t)throw new Error("constraintName cannot be null.");const e=this.transformConstraints;for(let n=0,s=e.length;n<s;n++){const s=e[n];if(s.data.name==t)return s}return null}findPathConstraint(t){if(null==t)throw new Error("constraintName cannot be null.");const e=this.pathConstraints;for(let n=0,s=e.length;n<s;n++){const s=e[n];if(s.data.name==t)return s}return null}getBounds(t,e,n=new Array(2)){if(null==t)throw new Error("offset cannot be null.");if(null==e)throw new Error("size cannot be null.");const s=this.drawOrder;let i=Number.POSITIVE_INFINITY,r=Number.POSITIVE_INFINITY,a=Number.NEGATIVE_INFINITY,o=Number.NEGATIVE_INFINITY;for(let l=0,h=s.length;l<h;l++){const t=s[l];if(!t.bone.active)continue;let e=0,h=null;const c=t.getAttachment();if(c instanceof Wy)e=8,h=xy.setArraySize(n,e,0),c.computeWorldVertices(t.bone,h,0,2);else if(c instanceof By){const s=c;e=s.worldVerticesLength,h=xy.setArraySize(n,e,0),s.computeWorldVertices(t,0,e,h,0,2)}if(null!=h)for(let n=0,s=h.length;n<s;n+=2){const t=h[n],e=h[n+1];i=Math.min(i,t),r=Math.min(r,e),a=Math.max(a,t),o=Math.max(o,e)}}t.set(i,r),e.set(a-i,o-r)}update(t){this.time+=t}get flipX(){return-1==this.scaleX}set flipX(t){Y_.deprecatedWarning1||(Y_.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: `Skeleton.flipX/flipY` was deprecated, please use scaleX/scaleY")),this.scaleX=t?1:-1}get flipY(){return-1==this.scaleY}set flipY(t){Y_.deprecatedWarning1||(Y_.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: `Skeleton.flipX/flipY` was deprecated, please use scaleX/scaleY")),this.scaleY=t?1:-1}};let W_=Y_;W_.deprecatedWarning1=!1;let z_=class{constructor(){this.bones=new Array,this.slots=new Array,this.skins=new Array,this.events=new Array,this.animations=new Array,this.ikConstraints=new Array,this.transformConstraints=new Array,this.pathConstraints=new Array,this.fps=0}findBone(t){if(null==t)throw new Error("boneName cannot be null.");const e=this.bones;for(let n=0,s=e.length;n<s;n++){const s=e[n];if(s.name==t)return s}return null}findBoneIndex(t){if(null==t)throw new Error("boneName cannot be null.");const e=this.bones;for(let n=0,s=e.length;n<s;n++)if(e[n].name==t)return n;return-1}findSlot(t){if(null==t)throw new Error("slotName cannot be null.");const e=this.slots;for(let n=0,s=e.length;n<s;n++){const s=e[n];if(s.name==t)return s}return null}findSlotIndex(t){if(null==t)throw new Error("slotName cannot be null.");const e=this.slots;for(let n=0,s=e.length;n<s;n++)if(e[n].name==t)return n;return-1}findSkin(t){if(null==t)throw new Error("skinName cannot be null.");const e=this.skins;for(let n=0,s=e.length;n<s;n++){const s=e[n];if(s.name==t)return s}return null}findEvent(t){if(null==t)throw new Error("eventDataName cannot be null.");const e=this.events;for(let n=0,s=e.length;n<s;n++){const s=e[n];if(s.name==t)return s}return null}findAnimation(t){if(null==t)throw new Error("animationName cannot be null.");const e=this.animations;for(let n=0,s=e.length;n<s;n++){const s=e[n];if(s.name==t)return s}return null}findIkConstraint(t){if(null==t)throw new Error("constraintName cannot be null.");const e=this.ikConstraints;for(let n=0,s=e.length;n<s;n++){const s=e[n];if(s.name==t)return s}return null}findTransformConstraint(t){if(null==t)throw new Error("constraintName cannot be null.");const e=this.transformConstraints;for(let n=0,s=e.length;n<s;n++){const s=e[n];if(s.name==t)return s}return null}findPathConstraint(t){if(null==t)throw new Error("constraintName cannot be null.");const e=this.pathConstraints;for(let n=0,s=e.length;n<s;n++){const s=e[n];if(s.name==t)return s}return null}findPathConstraintIndex(t){if(null==t)throw new Error("pathConstraintName cannot be null.");const e=this.pathConstraints;for(let n=0,s=e.length;n<s;n++)if(e[n].name==t)return n;return-1}},G_=class{constructor(t,e,n){if(this.color=new uy(1,1,1,1),t<0)throw new Error("index must be >= 0.");if(null==e)throw new Error("name cannot be null.");if(null==n)throw new Error("boneData cannot be null.");this.index=t,this.name=e,this.boneData=n}},H_=class extends k_{constructor(t){super(t,0,!1),this.bones=new Array,this.rotateMix=0,this.translateMix=0,this.scaleMix=0,this.shearMix=0,this.offsetRotation=0,this.offsetX=0,this.offsetY=0,this.offsetScaleX=0,this.offsetScaleY=0,this.offsetShearY=0,this.relative=!1,this.local=!1}},j_=class{constructor(t,e,n){this.slotIndex=t,this.name=e,this.attachment=n}},$_=class{constructor(t){if(this.attachments=new Array,this.bones=Array(),this.constraints=new Array,null==t)throw new Error("name cannot be null.");this.name=t}setAttachment(t,e,n){if(null==n)throw new Error("attachment cannot be null.");const s=this.attachments;t>=s.length&&(s.length=t+1),s[t]||(s[t]={}),s[t][e]=n}addSkin(t){for(let n=0;n<t.bones.length;n++){const e=t.bones[n];let s=!1;for(let t=0;t<this.bones.length;t++)if(this.bones[t]==e){s=!0;break}s||this.bones.push(e)}for(let n=0;n<t.constraints.length;n++){const e=t.constraints[n];let s=!1;for(let t=0;t<this.constraints.length;t++)if(this.constraints[t]==e){s=!0;break}s||this.constraints.push(e)}const e=t.getAttachments();for(let n=0;n<e.length;n++){const t=e[n];this.setAttachment(t.slotIndex,t.name,t.attachment)}}copySkin(t){for(let n=0;n<t.bones.length;n++){const e=t.bones[n];let s=!1;for(let t=0;t<this.bones.length;t++)if(this.bones[t]==e){s=!0;break}s||this.bones.push(e)}for(let n=0;n<t.constraints.length;n++){const e=t.constraints[n];let s=!1;for(let t=0;t<this.constraints.length;t++)if(this.constraints[t]==e){s=!0;break}s||this.constraints.push(e)}const e=t.getAttachments();for(let n=0;n<e.length;n++){const t=e[n];null!=t.attachment&&(t.attachment instanceof By?(t.attachment=t.attachment.newLinkedMesh(),this.setAttachment(t.slotIndex,t.name,t.attachment)):(t.attachment=t.attachment.copy(),this.setAttachment(t.slotIndex,t.name,t.attachment)))}}getAttachment(t,e){const n=this.attachments[t];return n?n[e]:null}removeAttachment(t,e){const n=this.attachments[t];n&&(n[e]=null)}getAttachments(){const t=new Array;for(let e=0;e<this.attachments.length;e++){const n=this.attachments[e];if(n)for(const s in n){const i=n[s];i&&t.push(new j_(e,s,i))}}return t}getAttachmentsForSlot(t,e){const n=this.attachments[t];if(n)for(const s in n){const i=n[s];i&&e.push(new j_(t,s,i))}}clear(){this.attachments.length=0,this.bones.length=0,this.constraints.length=0}attachAll(t,e){let n=0;for(let s=0;s<t.slots.length;s++){const i=t.slots[s],r=i.getAttachment();if(r&&n<e.attachments.length){const t=e.attachments[n];for(const e in t){if(r==t[e]){const t=this.getAttachment(n,e);null!=t&&i.setAttachment(t);break}}}n++}}};const q_=class{constructor(t){this.scale=1,this.linkedMeshes=new Array,this.attachmentLoader=t}readSkeletonData(t){const e=this.scale,n=new z_;n.name="";const s=new jx(t);if(n.hash=s.readString(),n.version=s.readString(),"3.8.75"===n.version){const t="Unsupported skeleton data, 3.8.75 is deprecated, please export with a newer version of Spine.";console.error(t)}n.x=s.readFloat(),n.y=s.readFloat(),n.width=s.readFloat(),n.height=s.readFloat();const i=s.readBoolean();i&&(n.fps=s.readFloat(),n.imagesPath=s.readString(),n.audioPath=s.readString());let r=0;r=s.readInt(!0);for(let o=0;o<r;o++)s.strings.push(s.readString());r=s.readInt(!0);for(let o=0;o<r;o++){const t=s.readString(),r=0==o?null:n.bones[s.readInt(!0)],a=new P_(o,t,r);a.rotation=s.readFloat(),a.x=s.readFloat()*e,a.y=s.readFloat()*e,a.scaleX=s.readFloat(),a.scaleY=s.readFloat(),a.shearX=s.readFloat(),a.shearY=s.readFloat(),a.length=s.readFloat()*e,a.transformMode=q_.TransformModeValues[s.readInt(!0)],a.skinRequired=s.readBoolean(),i&&uy.rgba8888ToColor(a.color,s.readInt32()),n.bones.push(a)}r=s.readInt(!0);for(let o=0;o<r;o++){const t=s.readString(),e=n.bones[s.readInt(!0)],i=new G_(o,t,e);uy.rgba8888ToColor(i.color,s.readInt32());const r=s.readInt32();-1!=r&&uy.rgb888ToColor(i.darkColor=new uy,r),i.attachmentName=s.readStringRef(),i.blendMode=q_.BlendModeValues[s.readInt(!0)],n.slots.push(i)}r=s.readInt(!0);for(let o,l=0;l<r;l++){const t=new L_(s.readString());t.order=s.readInt(!0),t.skinRequired=s.readBoolean(),o=s.readInt(!0);for(let e=0;e<o;e++)t.bones.push(n.bones[s.readInt(!0)]);t.target=n.bones[s.readInt(!0)],t.mix=s.readFloat(),t.softness=s.readFloat()*e,t.bendDirection=s.readByte(),t.compress=s.readBoolean(),t.stretch=s.readBoolean(),t.uniform=s.readBoolean(),n.ikConstraints.push(t)}r=s.readInt(!0);for(let o,l=0;l<r;l++){const t=new H_(s.readString());t.order=s.readInt(!0),t.skinRequired=s.readBoolean(),o=s.readInt(!0);for(let e=0;e<o;e++)t.bones.push(n.bones[s.readInt(!0)]);t.target=n.bones[s.readInt(!0)],t.local=s.readBoolean(),t.relative=s.readBoolean(),t.offsetRotation=s.readFloat(),t.offsetX=s.readFloat()*e,t.offsetY=s.readFloat()*e,t.offsetScaleX=s.readFloat(),t.offsetScaleY=s.readFloat(),t.offsetShearY=s.readFloat(),t.rotateMix=s.readFloat(),t.translateMix=s.readFloat(),t.scaleMix=s.readFloat(),t.shearMix=s.readFloat(),n.transformConstraints.push(t)}r=s.readInt(!0);for(let o,l=0;l<r;l++){const t=new N_(s.readString());t.order=s.readInt(!0),t.skinRequired=s.readBoolean(),o=s.readInt(!0);for(let e=0;e<o;e++)t.bones.push(n.bones[s.readInt(!0)]);t.target=n.slots[s.readInt(!0)],t.positionMode=q_.PositionModeValues[s.readInt(!0)],t.spacingMode=q_.SpacingModeValues[s.readInt(!0)],t.rotateMode=q_.RotateModeValues[s.readInt(!0)],t.offsetRotation=s.readFloat(),t.position=s.readFloat(),t.positionMode==Kx.Fixed&&(t.position*=e),t.spacing=s.readFloat(),t.spacingMode!=B_.Length&&t.spacingMode!=B_.Fixed||(t.spacing*=e),t.rotateMix=s.readFloat(),t.translateMix=s.readFloat(),n.pathConstraints.push(t)}const a=this.readSkin(s,n,!0,i);null!=a&&(n.defaultSkin=a,n.skins.push(a));{let t=n.skins.length;for(xy.setArraySize(n.skins,r=t+s.readInt(!0));t<r;t++)n.skins[t]=this.readSkin(s,n,!1,i)}r=this.linkedMeshes.length;for(let o=0;o<r;o++){const t=this.linkedMeshes[o],e=null==t.skin?n.defaultSkin:n.findSkin(t.skin);if(null==e)throw new Error(`Skin not found: ${t.skin}`);const s=e.getAttachment(t.slotIndex,t.parent);if(null==s)throw new Error(`Parent mesh not found: ${t.parent}`);t.mesh.deformAttachment=t.inheritDeform?s:t.mesh,t.mesh.setParentMesh(s)}this.linkedMeshes.length=0,r=s.readInt(!0);for(let o=0;o<r;o++){const t=new O_(s.readStringRef());t.intValue=s.readInt(!1),t.floatValue=s.readFloat(),t.stringValue=s.readString(),t.audioPath=s.readString(),null!=t.audioPath&&(t.volume=s.readFloat(),t.balance=s.readFloat()),n.events.push(t)}r=s.readInt(!0);for(let o=0;o<r;o++)n.animations.push(this.readAnimation(s,s.readString(),n));return n}readSkin(t,e,n,s){let i=null,r=0;if(n){if(r=t.readInt(!0),0==r)return null;i=new $_("default")}else{i=new $_(t.readStringRef()),i.bones.length=t.readInt(!0);for(let n=0,s=i.bones.length;n<s;n++)i.bones[n]=e.bones[t.readInt(!0)];for(let n=0,s=t.readInt(!0);n<s;n++)i.constraints.push(e.ikConstraints[t.readInt(!0)]);for(let n=0,s=t.readInt(!0);n<s;n++)i.constraints.push(e.transformConstraints[t.readInt(!0)]);for(let n=0,s=t.readInt(!0);n<s;n++)i.constraints.push(e.pathConstraints[t.readInt(!0)]);r=t.readInt(!0)}for(let a=0;a<r;a++){const n=t.readInt(!0);for(let r=0,a=t.readInt(!0);r<a;r++){const r=t.readStringRef(),a=this.readAttachment(t,e,i,n,r,s);null!=a&&i.setAttachment(n,r,a)}}return i}readAttachment(t,e,n,s,i,r){const a=this.scale;let o=t.readStringRef();null==o&&(o=i);const l=t.readByte();switch(q_.AttachmentTypeValues[l]){case Hx.Region:{let e=t.readStringRef();const s=t.readFloat(),i=t.readFloat(),r=t.readFloat(),l=t.readFloat(),h=t.readFloat(),c=t.readFloat(),u=t.readFloat(),d=t.readInt32();null==e&&(e=o);const f=this.attachmentLoader.newRegionAttachment(n,o,e);return null==f?null:(f.path=e,f.x=i*a,f.y=r*a,f.scaleX=l,f.scaleY=h,f.rotation=s,f.width=c*a,f.height=u*a,uy.rgba8888ToColor(f.color,d),f)}case Hx.BoundingBox:{const e=t.readInt(!0),s=this.readVertices(t,e),i=r?t.readInt32():0,a=this.attachmentLoader.newBoundingBoxAttachment(n,o);return null==a?null:(a.worldVerticesLength=e<<1,a.vertices=s.vertices,a.bones=s.bones,r&&uy.rgba8888ToColor(a.color,i),a)}case Hx.Mesh:{let e=t.readStringRef();const s=t.readInt32(),i=t.readInt(!0),l=this.readFloatArray(t,i<<1,1),h=this.readShortArray(t),c=this.readVertices(t,i),u=t.readInt(!0);let d=null,f=0,p=0;r&&(d=this.readShortArray(t),f=t.readFloat(),p=t.readFloat()),null==e&&(e=o);const m=this.attachmentLoader.newMeshAttachment(n,o,e);return null==m?null:(m.path=e,uy.rgba8888ToColor(m.color,s),m.bones=c.bones,m.vertices=c.vertices,m.worldVerticesLength=i<<1,m.triangles=h,m.regionUVs=new Float32Array(l),m.hullLength=u<<1,r&&(m.edges=d,m.width=f*a,m.height=p*a),m)}case Hx.LinkedMesh:{let e=t.readStringRef();const i=t.readInt32(),l=t.readStringRef(),h=t.readStringRef(),c=t.readBoolean();let u=0,d=0;r&&(u=t.readFloat(),d=t.readFloat()),null==e&&(e=o);const f=this.attachmentLoader.newMeshAttachment(n,o,e);return null==f?null:(f.path=e,uy.rgba8888ToColor(f.color,i),r&&(f.width=u*a,f.height=d*a),this.linkedMeshes.push(new Z_(f,l,s,h,c)),f)}case Hx.Path:{const e=t.readBoolean(),s=t.readBoolean(),i=t.readInt(!0),l=this.readVertices(t,i),h=xy.newArray(i/3,0);for(let n=0,r=h.length;n<r;n++)h[n]=t.readFloat()*a;const c=r?t.readInt32():0,u=this.attachmentLoader.newPathAttachment(n,o);return null==u?null:(u.closed=e,u.constantSpeed=s,u.worldVerticesLength=i<<1,u.vertices=l.vertices,u.bones=l.bones,u.lengths=h,r&&uy.rgba8888ToColor(u.color,c),u)}case Hx.Point:{const e=t.readFloat(),s=t.readFloat(),i=t.readFloat(),l=r?t.readInt32():0,h=this.attachmentLoader.newPointAttachment(n,o);return null==h?null:(h.x=s*a,h.y=i*a,h.rotation=e,r&&uy.rgba8888ToColor(h.color,l),h)}case Hx.Clipping:{const s=t.readInt(!0),i=t.readInt(!0),a=this.readVertices(t,i),l=r?t.readInt32():0,h=this.attachmentLoader.newClippingAttachment(n,o);return null==h?null:(h.endSlot=e.slots[s],h.worldVerticesLength=i<<1,h.vertices=a.vertices,h.bones=a.bones,r&&uy.rgba8888ToColor(h.color,l),h)}}return null}readVertices(t,e){const n=e<<1,s=new Q_,i=this.scale;if(!t.readBoolean())return s.vertices=this.readFloatArray(t,n,i),s;const r=new Array,a=new Array;for(let o=0;o<e;o++){const e=t.readInt(!0);a.push(e);for(let n=0;n<e;n++)a.push(t.readInt(!0)),r.push(t.readFloat()*i),r.push(t.readFloat()*i),r.push(t.readFloat())}return s.vertices=xy.toFloatArray(r),s.bones=a,s}readFloatArray(t,e,n){const s=new Array(e);if(1==n)for(let i=0;i<e;i++)s[i]=t.readFloat();else for(let i=0;i<e;i++)s[i]=t.readFloat()*n;return s}readShortArray(t){const e=t.readInt(!0),n=new Array(e);for(let s=0;s<e;s++)n[s]=t.readShort();return n}readAnimation(t,e,n){const s=new Array,i=this.scale;let r=0;const a=new uy,o=new uy;for(let c=0,u=t.readInt(!0);c<u;c++){const e=t.readInt(!0);for(let n=0,i=t.readInt(!0);n<i;n++){const n=t.readByte(),i=t.readInt(!0);switch(n){case q_.SLOT_ATTACHMENT:{const n=new a_(i);n.slotIndex=e;for(let e=0;e<i;e++)n.setFrame(e,t.readFloat(),t.readStringRef());s.push(n),r=Math.max(r,n.frames[i-1]);break}case q_.SLOT_COLOR:{const n=new s_(i);n.slotIndex=e;for(let e=0;e<i;e++){const s=t.readFloat();uy.rgba8888ToColor(a,t.readInt32()),n.setFrame(e,s,a.r,a.g,a.b,a.a),e<i-1&&this.readCurve(t,e,n)}s.push(n),r=Math.max(r,n.frames[(i-1)*s_.ENTRIES]);break}case q_.SLOT_TWO_COLOR:{const n=new r_(i);n.slotIndex=e;for(let e=0;e<i;e++){const s=t.readFloat();uy.rgba8888ToColor(a,t.readInt32()),uy.rgb888ToColor(o,t.readInt32()),n.setFrame(e,s,a.r,a.g,a.b,a.a,o.r,o.g,o.b),e<i-1&&this.readCurve(t,e,n)}s.push(n),r=Math.max(r,n.frames[(i-1)*r_.ENTRIES]);break}}}}for(let c=0,u=t.readInt(!0);c<u;c++){const e=t.readInt(!0);for(let n=0,a=t.readInt(!0);n<a;n++){const n=t.readByte(),a=t.readInt(!0);switch(n){case q_.BONE_ROTATE:{const n=new Zy(a);n.boneIndex=e;for(let e=0;e<a;e++)n.setFrame(e,t.readFloat(),t.readFloat()),e<a-1&&this.readCurve(t,e,n);s.push(n),r=Math.max(r,n.frames[(a-1)*Zy.ENTRIES]);break}case q_.BONE_TRANSLATE:case q_.BONE_SCALE:case q_.BONE_SHEAR:{let o,l=1;n==q_.BONE_SCALE?o=new t_(a):n==q_.BONE_SHEAR?o=new e_(a):(o=new Jy(a),l=i),o.boneIndex=e;for(let e=0;e<a;e++)o.setFrame(e,t.readFloat(),t.readFloat()*l,t.readFloat()*l),e<a-1&&this.readCurve(t,e,o);s.push(o),r=Math.max(r,o.frames[(a-1)*Jy.ENTRIES]);break}}}}for(let c=0,u=t.readInt(!0);c<u;c++){const e=t.readInt(!0),n=t.readInt(!0),a=new d_(n);a.ikConstraintIndex=e;for(let s=0;s<n;s++)a.setFrame(s,t.readFloat(),t.readFloat(),t.readFloat()*i,t.readByte(),t.readBoolean(),t.readBoolean()),s<n-1&&this.readCurve(t,s,a);s.push(a),r=Math.max(r,a.frames[(n-1)*d_.ENTRIES])}for(let c=0,u=t.readInt(!0);c<u;c++){const e=t.readInt(!0),n=t.readInt(!0),i=new p_(n);i.transformConstraintIndex=e;for(let s=0;s<n;s++)i.setFrame(s,t.readFloat(),t.readFloat(),t.readFloat(),t.readFloat(),t.readFloat()),s<n-1&&this.readCurve(t,s,i);s.push(i),r=Math.max(r,i.frames[(n-1)*p_.ENTRIES])}for(let c=0,u=t.readInt(!0);c<u;c++){const e=t.readInt(!0),a=n.pathConstraints[e];for(let n=0,o=t.readInt(!0);n<o;n++){const n=t.readByte(),o=t.readInt(!0);switch(n){case q_.PATH_POSITION:case q_.PATH_SPACING:{let l,h=1;n==q_.PATH_SPACING?(l=new v_(o),a.spacingMode!=B_.Length&&a.spacingMode!=B_.Fixed||(h=i)):(l=new g_(o),a.positionMode==Kx.Fixed&&(h=i)),l.pathConstraintIndex=e;for(let e=0;e<o;e++)l.setFrame(e,t.readFloat(),t.readFloat()*h),e<o-1&&this.readCurve(t,e,l);s.push(l),r=Math.max(r,l.frames[(o-1)*g_.ENTRIES]);break}case q_.PATH_MIX:{const n=new y_(o);n.pathConstraintIndex=e;for(let e=0;e<o;e++)n.setFrame(e,t.readFloat(),t.readFloat(),t.readFloat()),e<o-1&&this.readCurve(t,e,n);s.push(n),r=Math.max(r,n.frames[(o-1)*y_.ENTRIES]);break}}}}for(let c=0,u=t.readInt(!0);c<u;c++){const e=n.skins[t.readInt(!0)];for(let n=0,a=t.readInt(!0);n<a;n++){const n=t.readInt(!0);for(let a=0,o=t.readInt(!0);a<o;a++){const a=e.getAttachment(n,t.readStringRef()),o=null!=a.bones,l=a.vertices,h=o?l.length/3*2:l.length,c=t.readInt(!0),u=new l_(c);u.slotIndex=n,u.attachment=a;for(let e=0;e<c;e++){const n=t.readFloat();let s,r=t.readInt(!0);if(0==r)s=o?xy.newFloatArray(h):l;else{s=xy.newFloatArray(h);const e=t.readInt(!0);if(r+=e,1==i)for(let n=e;n<r;n++)s[n]=t.readFloat();else for(let n=e;n<r;n++)s[n]=t.readFloat()*i;if(!o)for(let t=0,n=s.length;t<n;t++)s[t]+=l[t]}u.setFrame(e,n,s),e<c-1&&this.readCurve(t,e,u)}s.push(u),r=Math.max(r,u.frames[c-1])}}}const l=t.readInt(!0);if(l>0){const e=new c_(l),i=n.slots.length;for(let n=0;n<l;n++){const s=t.readFloat(),r=t.readInt(!0),a=xy.newArray(i,0);for(let t=i-1;t>=0;t--)a[t]=-1;const o=xy.newArray(i-r,0);let l=0,h=0;for(let e=0;e<r;e++){const e=t.readInt(!0);for(;l!=e;)o[h++]=l++;a[l+t.readInt(!0)]=l++}for(;l<i;)o[h++]=l++;for(let t=i-1;t>=0;t--)-1==a[t]&&(a[t]=o[--h]);e.setFrame(n,s,a)}s.push(e),r=Math.max(r,e.frames[l-1])}const h=t.readInt(!0);if(h>0){const e=new h_(h);for(let s=0;s<h;s++){const i=t.readFloat(),r=n.events[t.readInt(!0)],a=new F_(i,r);a.intValue=t.readInt(!1),a.floatValue=t.readFloat(),a.stringValue=t.readBoolean()?t.readString():r.stringValue,null!=a.data.audioPath&&(a.volume=t.readFloat(),a.balance=t.readFloat()),e.setFrame(s,a)}s.push(e),r=Math.max(r,e.frames[h-1])}return new Hy(e,s,r)}readCurve(t,e,n){switch(t.readByte()){case q_.CURVE_STEPPED:n.setStepped(e);break;case q_.CURVE_BEZIER:this.setCurve(n,e,t.readFloat(),t.readFloat(),t.readFloat(),t.readFloat())}}setCurve(t,e,n,s,i,r){t.setCurve(e,n,s,i,r)}};let K_=q_;K_.AttachmentTypeValues=[0,1,2,3,4,5,6],K_.TransformModeValues=[Qx.Normal,Qx.OnlyTranslation,Qx.NoRotationOrReflection,Qx.NoScale,Qx.NoScaleOrReflection],K_.PositionModeValues=[Kx.Fixed,Kx.Percent],K_.SpacingModeValues=[B_.Length,B_.Fixed,B_.Percent],K_.RotateModeValues=[Zx.Tangent,Zx.Chain,Zx.ChainScale],K_.BlendModeValues=[Ir.NORMAL,Ir.ADD,Ir.MULTIPLY,Ir.SCREEN],K_.BONE_ROTATE=0,K_.BONE_TRANSLATE=1,K_.BONE_SCALE=2,K_.BONE_SHEAR=3,K_.SLOT_ATTACHMENT=0,K_.SLOT_COLOR=1,K_.SLOT_TWO_COLOR=2,K_.PATH_POSITION=0,K_.PATH_SPACING=1,K_.PATH_MIX=2,K_.CURVE_LINEAR=0,K_.CURVE_STEPPED=1,K_.CURVE_BEZIER=2;let Z_=class{constructor(t,e,n,s,i){this.mesh=t,this.skin=e,this.slotIndex=n,this.parent=s,this.inheritDeform=i}},Q_=class{constructor(t=null,e=null){this.bones=t,this.vertices=e}},J_=class t{constructor(t){this.scale=1,this.linkedMeshes=new Array,this.attachmentLoader=t}readSkeletonData(e){const n=this.scale,s=new z_,i="string"==typeof e?JSON.parse(e):e,r=i.skeleton;if(null!=r){if(s.hash=r.hash,s.version=r.spine,"3.8"!==s.version.substr(0,3)){const t=`Spine 3.8 loader cant load version ${r.spine}. Please configure your pixi-spine bundle`;console.error(t)}if("3.8.75"===s.version){const t="Unsupported skeleton data, 3.8.75 is deprecated, please export with a newer version of Spine.";console.error(t)}s.x=r.x,s.y=r.y,s.width=r.width,s.height=r.height,s.fps=r.fps,s.imagesPath=r.images}if(i.bones)for(let a=0;a<i.bones.length;a++){const e=i.bones[a];let r=null;const o=this.getValue(e,"parent",null);if(null!=o&&(r=s.findBone(o),null==r))throw new Error(`Parent bone not found: ${o}`);const l=new P_(s.bones.length,e.name,r);l.length=this.getValue(e,"length",0)*n,l.x=this.getValue(e,"x",0)*n,l.y=this.getValue(e,"y",0)*n,l.rotation=this.getValue(e,"rotation",0),l.scaleX=this.getValue(e,"scaleX",1),l.scaleY=this.getValue(e,"scaleY",1),l.shearX=this.getValue(e,"shearX",0),l.shearY=this.getValue(e,"shearY",0),l.transformMode=t.transformModeFromString(this.getValue(e,"transform","normal")),l.skinRequired=this.getValue(e,"skin",!1),s.bones.push(l)}if(i.slots)for(let a=0;a<i.slots.length;a++){const e=i.slots[a],n=e.name,r=e.bone,o=s.findBone(r);if(null==o)throw new Error(`Slot bone not found: ${r}`);const l=new G_(s.slots.length,n,o),h=this.getValue(e,"color",null);null!=h&&l.color.setFromString(h);const c=this.getValue(e,"dark",null);null!=c&&(l.darkColor=new uy(1,1,1,1),l.darkColor.setFromString(c)),l.attachmentName=this.getValue(e,"attachment",null),l.blendMode=t.blendModeFromString(this.getValue(e,"blend","normal")),s.slots.push(l)}if(i.ik)for(let t=0;t<i.ik.length;t++){const e=i.ik[t],r=new L_(e.name);r.order=this.getValue(e,"order",0),r.skinRequired=this.getValue(e,"skin",!1);for(let t=0;t<e.bones.length;t++){const n=e.bones[t],i=s.findBone(n);if(null==i)throw new Error(`IK bone not found: ${n}`);r.bones.push(i)}const a=e.target;if(r.target=s.findBone(a),null==r.target)throw new Error(`IK target bone not found: ${a}`);r.mix=this.getValue(e,"mix",1),r.softness=this.getValue(e,"softness",0)*n,r.bendDirection=this.getValue(e,"bendPositive",!0)?1:-1,r.compress=this.getValue(e,"compress",!1),r.stretch=this.getValue(e,"stretch",!1),r.uniform=this.getValue(e,"uniform",!1),s.ikConstraints.push(r)}if(i.transform)for(let t=0;t<i.transform.length;t++){const e=i.transform[t],r=new H_(e.name);r.order=this.getValue(e,"order",0),r.skinRequired=this.getValue(e,"skin",!1);for(let t=0;t<e.bones.length;t++){const n=e.bones[t],i=s.findBone(n);if(null==i)throw new Error(`Transform constraint bone not found: ${n}`);r.bones.push(i)}const a=e.target;if(r.target=s.findBone(a),null==r.target)throw new Error(`Transform constraint target bone not found: ${a}`);r.local=this.getValue(e,"local",!1),r.relative=this.getValue(e,"relative",!1),r.offsetRotation=this.getValue(e,"rotation",0),r.offsetX=this.getValue(e,"x",0)*n,r.offsetY=this.getValue(e,"y",0)*n,r.offsetScaleX=this.getValue(e,"scaleX",0),r.offsetScaleY=this.getValue(e,"scaleY",0),r.offsetShearY=this.getValue(e,"shearY",0),r.rotateMix=this.getValue(e,"rotateMix",1),r.translateMix=this.getValue(e,"translateMix",1),r.scaleMix=this.getValue(e,"scaleMix",1),r.shearMix=this.getValue(e,"shearMix",1),s.transformConstraints.push(r)}if(i.path)for(let a=0;a<i.path.length;a++){const e=i.path[a],r=new N_(e.name);r.order=this.getValue(e,"order",0),r.skinRequired=this.getValue(e,"skin",!1);for(let t=0;t<e.bones.length;t++){const n=e.bones[t],i=s.findBone(n);if(null==i)throw new Error(`Transform constraint bone not found: ${n}`);r.bones.push(i)}const o=e.target;if(r.target=s.findSlot(o),null==r.target)throw new Error(`Path target slot not found: ${o}`);r.positionMode=t.positionModeFromString(this.getValue(e,"positionMode","percent")),r.spacingMode=t.spacingModeFromString(this.getValue(e,"spacingMode","length")),r.rotateMode=t.rotateModeFromString(this.getValue(e,"rotateMode","tangent")),r.offsetRotation=this.getValue(e,"rotation",0),r.position=this.getValue(e,"position",0),r.positionMode==Kx.Fixed&&(r.position*=n),r.spacing=this.getValue(e,"spacing",0),r.spacingMode!=B_.Length&&r.spacingMode!=B_.Fixed||(r.spacing*=n),r.rotateMix=this.getValue(e,"rotateMix",1),r.translateMix=this.getValue(e,"translateMix",1),s.pathConstraints.push(r)}if(i.skins)for(let t=0;t<i.skins.length;t++){const e=i.skins[t],n=new $_(e.name);if(e.bones)for(let i=0;i<e.bones.length;i++){const r=s.findBone(e.bones[i]);if(null==r)throw new Error(`Skin bone not found: ${e.bones[t]}`);n.bones.push(r)}if(e.ik)for(let i=0;i<e.ik.length;i++){const r=s.findIkConstraint(e.ik[i]);if(null==r)throw new Error(`Skin IK constraint not found: ${e.ik[t]}`);n.constraints.push(r)}if(e.transform)for(let i=0;i<e.transform.length;i++){const r=s.findTransformConstraint(e.transform[i]);if(null==r)throw new Error(`Skin transform constraint not found: ${e.transform[t]}`);n.constraints.push(r)}if(e.path)for(let i=0;i<e.path.length;i++){const r=s.findPathConstraint(e.path[i]);if(null==r)throw new Error(`Skin path constraint not found: ${e.path[t]}`);n.constraints.push(r)}for(const t in e.attachments){const i=s.findSlot(t);if(null==i)throw new Error(`Slot not found: ${t}`);const r=e.attachments[t];for(const t in r){const e=this.readAttachment(r[t],n,i.index,t,s);null!=e&&n.setAttachment(i.index,t,e)}}s.skins.push(n),"default"==n.name&&(s.defaultSkin=n)}for(let t=0,a=this.linkedMeshes.length;t<a;t++){const e=this.linkedMeshes[t],n=null==e.skin?s.defaultSkin:s.findSkin(e.skin);if(null==n)throw new Error(`Skin not found: ${e.skin}`);const i=n.getAttachment(e.slotIndex,e.parent);if(null==i)throw new Error(`Parent mesh not found: ${e.parent}`);e.mesh.deformAttachment=e.inheritDeform?i:e.mesh,e.mesh.setParentMesh(i)}if(this.linkedMeshes.length=0,i.events)for(const t in i.events){const e=i.events[t],n=new O_(t);n.intValue=this.getValue(e,"int",0),n.floatValue=this.getValue(e,"float",0),n.stringValue=this.getValue(e,"string",""),n.audioPath=this.getValue(e,"audio",null),null!=n.audioPath&&(n.volume=this.getValue(e,"volume",1),n.balance=this.getValue(e,"balance",0)),s.events.push(n)}if(i.animations)for(const t in i.animations){const e=i.animations[t];this.readAnimation(e,t,s)}return s}readAttachment(t,e,n,s,i){const r=this.scale;s=this.getValue(t,"name",s);switch(this.getValue(t,"type","region")){case"region":{const n=this.getValue(t,"path",s),i=this.attachmentLoader.newRegionAttachment(e,s,n);if(null==i)return null;i.path=n,i.x=this.getValue(t,"x",0)*r,i.y=this.getValue(t,"y",0)*r,i.scaleX=this.getValue(t,"scaleX",1),i.scaleY=this.getValue(t,"scaleY",1),i.rotation=this.getValue(t,"rotation",0),i.width=t.width*r,i.height=t.height*r;const a=this.getValue(t,"color",null);return null!=a&&i.color.setFromString(a),i}case"boundingbox":{const n=this.attachmentLoader.newBoundingBoxAttachment(e,s);if(null==n)return null;this.readVertices(t,n,t.vertexCount<<1);const i=this.getValue(t,"color",null);return null!=i&&n.color.setFromString(i),n}case"mesh":case"linkedmesh":{const i=this.getValue(t,"path",s),a=this.attachmentLoader.newMeshAttachment(e,s,i);if(null==a)return null;a.path=i;const o=this.getValue(t,"color",null);null!=o&&a.color.setFromString(o),a.width=this.getValue(t,"width",0)*r,a.height=this.getValue(t,"height",0)*r;const l=this.getValue(t,"parent",null);if(null!=l)return this.linkedMeshes.push(new tb(a,this.getValue(t,"skin",null),n,l,this.getValue(t,"deform",!0))),a;const h=t.uvs;return this.readVertices(t,a,h.length),a.triangles=t.triangles,a.regionUVs=new Float32Array(h),a.edges=this.getValue(t,"edges",null),a.hullLength=2*this.getValue(t,"hull",0),a}case"path":{const n=this.attachmentLoader.newPathAttachment(e,s);if(null==n)return null;n.closed=this.getValue(t,"closed",!1),n.constantSpeed=this.getValue(t,"constantSpeed",!0);const i=t.vertexCount;this.readVertices(t,n,i<<1);const a=xy.newArray(i/3,0);for(let e=0;e<t.lengths.length;e++)a[e]=t.lengths[e]*r;n.lengths=a;const o=this.getValue(t,"color",null);return null!=o&&n.color.setFromString(o),n}case"point":{const n=this.attachmentLoader.newPointAttachment(e,s);if(null==n)return null;n.x=this.getValue(t,"x",0)*r,n.y=this.getValue(t,"y",0)*r,n.rotation=this.getValue(t,"rotation",0);const i=this.getValue(t,"color",null);return null!=i&&n.color.setFromString(i),n}case"clipping":{const n=this.attachmentLoader.newClippingAttachment(e,s);if(null==n)return null;const r=this.getValue(t,"end",null);if(null!=r){const t=i.findSlot(r);if(null==t)throw new Error(`Clipping end slot not found: ${r}`);n.endSlot=t}const a=t.vertexCount;this.readVertices(t,n,a<<1);const o=this.getValue(t,"color",null);return null!=o&&n.color.setFromString(o),n}}return null}readVertices(t,e,n){const s=this.scale;e.worldVerticesLength=n;const i=t.vertices;if(n==i.length){const t=xy.toFloatArray(i);if(1!=s)for(let e=0,n=i.length;e<n;e++)t[e]*=s;return void(e.vertices=t)}const r=new Array,a=new Array;for(let o=0,l=i.length;o<l;){const t=i[o++];a.push(t);for(let e=o+4*t;o<e;o+=4)a.push(i[o]),r.push(i[o+1]*s),r.push(i[o+2]*s),r.push(i[o+3])}e.bones=a,e.vertices=xy.toFloatArray(r)}readAnimation(t,e,n){const s=this.scale,i=new Array;let r=0;if(t.slots)for(const o in t.slots){const e=t.slots[o],s=n.findSlotIndex(o);if(-1==s)throw new Error(`Slot not found: ${o}`);for(const t in e){const n=e[t];if("attachment"==t){const t=new a_(n.length);t.slotIndex=s;let e=0;for(let s=0;s<n.length;s++){const i=n[s];t.setFrame(e++,this.getValue(i,"time",0),i.name)}i.push(t),r=Math.max(r,t.frames[t.getFrameCount()-1])}else if("color"==t){const t=new s_(n.length);t.slotIndex=s;let e=0;for(let s=0;s<n.length;s++){const i=n[s],r=new uy;r.setFromString(i.color||"ffffffff"),t.setFrame(e,this.getValue(i,"time",0),r.r,r.g,r.b,r.a),this.readCurve(i,t,e),e++}i.push(t),r=Math.max(r,t.frames[(t.getFrameCount()-1)*s_.ENTRIES])}else{if("twoColor"!=t)throw new Error(`Invalid timeline type for a slot: ${t} (${o})`);{const t=new r_(n.length);t.slotIndex=s;let e=0;for(let s=0;s<n.length;s++){const i=n[s],r=new uy,a=new uy;r.setFromString(i.light),a.setFromString(i.dark),t.setFrame(e,this.getValue(i,"time",0),r.r,r.g,r.b,r.a,a.r,a.g,a.b),this.readCurve(i,t,e),e++}i.push(t),r=Math.max(r,t.frames[(t.getFrameCount()-1)*r_.ENTRIES])}}}}if(t.bones)for(const o in t.bones){const e=t.bones[o],a=n.findBoneIndex(o);if(-1==a)throw new Error(`Bone not found: ${o}`);for(const t in e){const n=e[t];if("rotate"===t){const t=new Zy(n.length);t.boneIndex=a;let e=0;for(let s=0;s<n.length;s++){const i=n[s];t.setFrame(e,this.getValue(i,"time",0),this.getValue(i,"angle",0)),this.readCurve(i,t,e),e++}i.push(t),r=Math.max(r,t.frames[(t.getFrameCount()-1)*Zy.ENTRIES])}else{if("translate"!==t&&"scale"!==t&&"shear"!==t)throw new Error(`Invalid timeline type for a bone: ${t} (${o})`);{let e=null,o=1,l=0;"scale"===t?(e=new t_(n.length),l=1):"shear"===t?e=new e_(n.length):(e=new Jy(n.length),o=s),e.boneIndex=a;let h=0;for(let t=0;t<n.length;t++){const s=n[t],i=this.getValue(s,"x",l),r=this.getValue(s,"y",l);e.setFrame(h,this.getValue(s,"time",0),i*o,r*o),this.readCurve(s,e,h),h++}i.push(e),r=Math.max(r,e.frames[(e.getFrameCount()-1)*Jy.ENTRIES])}}}}if(t.ik)for(const o in t.ik){const e=t.ik[o],a=n.findIkConstraint(o),l=new d_(e.length);l.ikConstraintIndex=n.ikConstraints.indexOf(a);let h=0;for(let t=0;t<e.length;t++){const n=e[t];l.setFrame(h,this.getValue(n,"time",0),this.getValue(n,"mix",1),this.getValue(n,"softness",0)*s,this.getValue(n,"bendPositive",!0)?1:-1,this.getValue(n,"compress",!1),this.getValue(n,"stretch",!1)),this.readCurve(n,l,h),h++}i.push(l),r=Math.max(r,l.frames[(l.getFrameCount()-1)*d_.ENTRIES])}if(t.transform)for(const o in t.transform){const e=t.transform[o],s=n.findTransformConstraint(o),a=new p_(e.length);a.transformConstraintIndex=n.transformConstraints.indexOf(s);let l=0;for(let t=0;t<e.length;t++){const n=e[t];a.setFrame(l,this.getValue(n,"time",0),this.getValue(n,"rotateMix",1),this.getValue(n,"translateMix",1),this.getValue(n,"scaleMix",1),this.getValue(n,"shearMix",1)),this.readCurve(n,a,l),l++}i.push(a),r=Math.max(r,a.frames[(a.getFrameCount()-1)*p_.ENTRIES])}if(t.path)for(const o in t.path){const e=t.path[o],a=n.findPathConstraintIndex(o);if(-1==a)throw new Error(`Path constraint not found: ${o}`);const l=n.pathConstraints[a];for(const t in e){const n=e[t];if("position"===t||"spacing"===t){let e=null,o=1;"spacing"===t?(e=new v_(n.length),l.spacingMode!=B_.Length&&l.spacingMode!=B_.Fixed||(o=s)):(e=new g_(n.length),l.positionMode==Kx.Fixed&&(o=s)),e.pathConstraintIndex=a;let h=0;for(let s=0;s<n.length;s++){const i=n[s];e.setFrame(h,this.getValue(i,"time",0),this.getValue(i,t,0)*o),this.readCurve(i,e,h),h++}i.push(e),r=Math.max(r,e.frames[(e.getFrameCount()-1)*g_.ENTRIES])}else if("mix"===t){const t=new y_(n.length);t.pathConstraintIndex=a;let e=0;for(let s=0;s<n.length;s++){const i=n[s];t.setFrame(e,this.getValue(i,"time",0),this.getValue(i,"rotateMix",1),this.getValue(i,"translateMix",1)),this.readCurve(i,t,e),e++}i.push(t),r=Math.max(r,t.frames[(t.getFrameCount()-1)*y_.ENTRIES])}}}if(t.deform)for(const o in t.deform){const e=t.deform[o],a=n.findSkin(o);if(null!=a)for(const t in e){const o=e[t],l=n.findSlotIndex(t);if(-1==l)throw new Error(`Slot not found: ${o.name}`);for(const t in o){const e=o[t],n=a.getAttachment(l,t);if(null==n)throw new Error(`Deform attachment not found: ${e.name}`);const h=null!=n.bones,c=n.vertices,u=h?c.length/3*2:c.length,d=new l_(e.length);d.slotIndex=l,d.attachment=n;let f=0;for(let t=0;t<e.length;t++){const n=e[t];let i;const r=this.getValue(n,"vertices",null);if(null==r)i=h?xy.newFloatArray(u):c;else{i=xy.newFloatArray(u);const t=this.getValue(n,"offset",0);if(xy.arrayCopy(r,0,i,t,r.length),1!=s)for(let e=t,n=e+r.length;e<n;e++)i[e]*=s;if(!h)for(let e=0;e<u;e++)i[e]+=c[e]}d.setFrame(f,this.getValue(n,"time",0),i),this.readCurve(n,d,f),f++}i.push(d),r=Math.max(r,d.frames[d.getFrameCount()-1])}}}let a=t.drawOrder;if(null==a&&(a=t.draworder),null!=a){const t=new c_(a.length),e=n.slots.length;let s=0;for(let i=0;i<a.length;i++){const r=a[i];let o=null;const l=this.getValue(r,"offsets",null);if(null!=l){o=xy.newArray(e,-1);const t=xy.newArray(e-l.length,0);let s=0,i=0;for(let e=0;e<l.length;e++){const r=l[e],a=n.findSlotIndex(r.slot);if(-1==a)throw new Error(`Slot not found: ${r.slot}`);for(;s!=a;)t[i++]=s++;o[s+r.offset]=s++}for(;s<e;)t[i++]=s++;for(let n=e-1;n>=0;n--)-1==o[n]&&(o[n]=t[--i])}t.setFrame(s++,this.getValue(r,"time",0),o)}i.push(t),r=Math.max(r,t.frames[t.getFrameCount()-1])}if(t.events){const e=new h_(t.events.length);let s=0;for(let i=0;i<t.events.length;i++){const r=t.events[i],a=n.findEvent(r.name);if(null==a)throw new Error(`Event not found: ${r.name}`);const o=new F_(xy.toSinglePrecision(this.getValue(r,"time",0)),a);o.intValue=this.getValue(r,"int",a.intValue),o.floatValue=this.getValue(r,"float",a.floatValue),o.stringValue=this.getValue(r,"string",a.stringValue),null!=o.data.audioPath&&(o.volume=this.getValue(r,"volume",1),o.balance=this.getValue(r,"balance",0)),e.setFrame(s++,o)}i.push(e),r=Math.max(r,e.frames[e.getFrameCount()-1])}if(isNaN(r))throw new Error("Error while parsing animation, duration is NaN");n.animations.push(new Hy(e,i,r))}readCurve(t,e,n){if(t.hasOwnProperty("curve"))if("stepped"===t.curve)e.setStepped(n);else{const s=t.curve;e.setCurve(n,s,this.getValue(t,"c2",0),this.getValue(t,"c3",1),this.getValue(t,"c4",1))}}getValue(t,e,n){return void 0!==t[e]?t[e]:n}static blendModeFromString(t){if("normal"==(t=t.toLowerCase()))return Ir.NORMAL;if("additive"==t)return Ir.ADD;if("multiply"==t)return Ir.MULTIPLY;if("screen"==t)return Ir.SCREEN;throw new Error(`Unknown blend mode: ${t}`)}static positionModeFromString(t){if("fixed"==(t=t.toLowerCase()))return Kx.Fixed;if("percent"==t)return Kx.Percent;throw new Error(`Unknown position mode: ${t}`)}static spacingModeFromString(t){if("length"==(t=t.toLowerCase()))return B_.Length;if("fixed"==t)return B_.Fixed;if("percent"==t)return B_.Percent;throw new Error(`Unknown position mode: ${t}`)}static rotateModeFromString(t){if("tangent"==(t=t.toLowerCase()))return Zx.Tangent;if("chain"==t)return Zx.Chain;if("chainscale"==t)return Zx.ChainScale;throw new Error(`Unknown rotate mode: ${t}`)}static transformModeFromString(t){if("normal"==(t=t.toLowerCase()))return Qx.Normal;if("onlytranslation"==t)return Qx.OnlyTranslation;if("norotationorreflection"==t)return Qx.NoRotationOrReflection;if("noscale"==t)return Qx.NoScale;if("noscaleorreflection"==t)return Qx.NoScaleOrReflection;throw new Error(`Unknown transform mode: ${t}`)}},tb=class{constructor(t,e,n,s,i){this.mesh=t,this.skin=e,this.slotIndex=n,this.parent=s,this.inheritDeform=i}};const eb=Object.freeze(Object.defineProperty({__proto__:null,Animation:Hy,AnimationState:b_,AnimationStateAdapter:class{start(t){}interrupt(t){}end(t){}dispose(t){}complete(t){}event(t,e){}},AnimationStateData:I_,AtlasAttachmentLoader:M_,Attachment:Fy,AttachmentTimeline:a_,Bone:R_,BoneData:P_,BoundingBoxAttachment:Ly,ClippingAttachment:Ny,ColorTimeline:s_,ConstraintData:k_,CurveTimeline:qy,DeformTimeline:l_,DrawOrderTimeline:c_,Event:F_,EventData:O_,EventQueue:S_,EventTimeline:h_,EventType:A_,IkConstraint:D_,IkConstraintData:L_,IkConstraintTimeline:d_,JitterEffect:class{constructor(t,e){this.jitterX=0,this.jitterY=0,this.jitterX=t,this.jitterY=e}begin(t){}transform(t,e,n,s){t.x+=fy.randomTriangular(-this.jitterX,this.jitterY),t.y+=fy.randomTriangular(-this.jitterX,this.jitterY)}end(){}},MeshAttachment:By,PathAttachment:Vy,PathConstraint:U_,PathConstraintData:N_,PathConstraintMixTimeline:y_,PathConstraintPositionTimeline:g_,PathConstraintSpacingTimeline:v_,PointAttachment:Uy,RegionAttachment:Wy,RotateTimeline:Zy,ScaleTimeline:t_,ShearTimeline:e_,Skeleton:W_,SkeletonBinary:K_,SkeletonBounds:class extends by{},SkeletonData:z_,SkeletonJson:J_,Skin:$_,SkinEntry:j_,Slot:Xy,SlotData:G_,SpacingMode:B_,Spine:class extends Cy{createSkeleton(t){this.skeleton=new W_(t),this.skeleton.updateWorldTransform(),this.stateData=new I_(t),this.state=new b_(this.stateData)}},SwirlEffect:Gy,TimelineType:jy,TrackEntry:E_,TransformConstraint:X_,TransformConstraintData:H_,TransformConstraintTimeline:p_,TranslateTimeline:Jy,TwoColorTimeline:r_,VertexAttachment:Dy},Symbol.toStringTag,{value:"Module"}));let nb=class{constructor(t){if(null==t)throw new Error("name cannot be null.");this.name=t}};const sb=class extends nb{constructor(t){super(t),this.id=(65535&sb.nextID++)<<11,this.worldVerticesLength=0}computeWorldVerticesOld(t,e){this.computeWorldVertices(t,0,this.worldVerticesLength,e,0,2)}computeWorldVertices(t,e,n,s,i,r){n=i+(n>>1)*r;const a=t.bone.skeleton,o=t.attachmentVertices;let l=this.vertices;const h=this.bones;if(null==h){o.length>0&&(l=o);const a=t.bone.matrix,h=a.tx,c=a.ty,u=a.a,d=a.c,f=a.b,p=a.d;for(let t=e,o=i;o<n;t+=2,o+=r){const e=l[t],n=l[t+1];s[o]=e*u+n*d+h,s[o+1]=e*f+n*p+c}return}let c=0,u=0;for(let f=0;f<e;f+=2){const t=h[c];c+=t+1,u+=t}const d=a.bones;if(0==o.length)for(let f=i,p=3*u;f<n;f+=r){let t=0,e=0,n=h[c++];for(n+=c;c<n;c++,p+=3){const n=d[h[c]].matrix,s=l[p],i=l[p+1],r=l[p+2];t+=(s*n.a+i*n.c+n.tx)*r,e+=(s*n.b+i*n.d+n.ty)*r}s[f]=t,s[f+1]=e}else{const t=o;for(let e=i,a=3*u,o=u<<1;e<n;e+=r){let n=0,i=0,r=h[c++];for(r+=c;c<r;c++,a+=3,o+=2){const e=d[h[c]].matrix,s=l[a]+t[o],r=l[a+1]+t[o+1],u=l[a+2];n+=(s*e.a+r*e.c+e.tx)*u,i+=(s*e.b+r*e.d+e.ty)*u}s[e]=n,s[e+1]=i}}}applyDeform(t){return this==t}};let ib=sb;ib.nextID=0;let rb=class extends ib{constructor(t){super(t),this.type=Hx.BoundingBox,this.color=new uy(1,1,1,1)}},ab=class extends ib{constructor(t){super(t),this.type=Hx.Clipping,this.color=new uy(.2275,.2275,.8078,1)}},ob=class extends ib{constructor(t){super(t),this.type=Hx.Mesh,this.color=new uy(1,1,1,1),this.inheritDeform=!1,this.tempColor=new uy(0,0,0,0)}applyDeform(t){return this==t||this.inheritDeform&&this.parentMesh==t}getParentMesh(){return this.parentMesh}setParentMesh(t){this.parentMesh=t,null!=t&&(this.bones=t.bones,this.vertices=t.vertices,this.worldVerticesLength=t.worldVerticesLength,this.regionUVs=t.regionUVs,this.triangles=t.triangles,this.hullLength=t.hullLength,this.worldVerticesLength=t.worldVerticesLength)}},lb=class extends ib{constructor(t){super(t),this.type=Hx.Path,this.closed=!1,this.constantSpeed=!1,this.color=new uy(1,1,1,1)}},hb=class extends ib{constructor(t){super(t),this.type=Hx.Point,this.color=new uy(.38,.94,0,1)}computeWorldPosition(t,e){const n=t.matrix;return e.x=this.x*n.a+this.y*n.c+t.worldX,e.y=this.x*n.b+this.y*n.d+t.worldY,e}computeWorldRotation(t){const e=t.matrix,n=fy.cosDeg(this.rotation),s=fy.sinDeg(this.rotation),i=n*e.a+s*e.c,r=n*e.b+s*e.d;return Math.atan2(r,i)*fy.radDeg}},cb=class{constructor(t,e){if(this.attachmentVertices=new Array,null==t)throw new Error("data cannot be null.");if(null==e)throw new Error("bone cannot be null.");this.data=t,this.bone=e,this.color=new uy,this.darkColor=null==t.darkColor?null:new uy,this.setToSetupPose(),this.blendMode=this.data.blendMode}getAttachment(){return this.attachment}setAttachment(t){this.attachment!=t&&(this.attachment=t,this.attachmentTime=this.bone.skeleton.time,this.attachmentVertices.length=0)}setAttachmentTime(t){this.attachmentTime=this.bone.skeleton.time-t}getAttachmentTime(){return this.bone.skeleton.time-this.attachmentTime}setToSetupPose(){this.color.setFromColor(this.data.color),null!=this.darkColor&&this.darkColor.setFromColor(this.data.darkColor),null==this.data.attachmentName?this.attachment=null:(this.attachment=null,this.setAttachment(this.bone.skeleton.getAttachment(this.data.index,this.data.attachmentName)))}};const ub=class extends nb{constructor(t){super(t),this.type=Hx.Region,this.x=0,this.y=0,this.scaleX=1,this.scaleY=1,this.rotation=0,this.width=0,this.height=0,this.color=new uy(1,1,1,1),this.offset=xy.newFloatArray(8),this.uvs=xy.newFloatArray(8),this.tempColor=new uy(1,1,1,1)}updateOffset(){const t=this.width/this.region.originalWidth*this.scaleX,e=this.height/this.region.originalHeight*this.scaleY,n=-this.width/2*this.scaleX+this.region.offsetX*t,s=-this.height/2*this.scaleY+this.region.offsetY*e,i=n+this.region.width*t,r=s+this.region.height*e,a=this.rotation*Math.PI/180,o=Math.cos(a),l=Math.sin(a),h=n*o+this.x,c=n*l,u=s*o+this.y,d=s*l,f=i*o+this.x,p=i*l,m=r*o+this.y,g=r*l,v=this.offset;v[ub.OX1]=h-d,v[ub.OY1]=u+c,v[ub.OX2]=h-g,v[ub.OY2]=m+c,v[ub.OX3]=f-g,v[ub.OY3]=m+p,v[ub.OX4]=f-d,v[ub.OY4]=u+p}setRegion(t){this.region=t;const e=this.uvs;t.rotate?(e[2]=t.u,e[3]=t.v2,e[4]=t.u,e[5]=t.v,e[6]=t.u2,e[7]=t.v,e[0]=t.u2,e[1]=t.v2):(e[0]=t.u,e[1]=t.v2,e[2]=t.u,e[3]=t.v,e[4]=t.u2,e[5]=t.v,e[6]=t.u2,e[7]=t.v2)}computeWorldVertices(t,e,n,s){const i=this.offset,r=t instanceof cb?t.bone.matrix:t.matrix,a=r.tx,o=r.ty,l=r.a,h=r.c,c=r.b,u=r.d;let d=0,f=0;d=i[ub.OX1],f=i[ub.OY1],e[n]=d*l+f*h+a,e[n+1]=d*c+f*u+o,n+=s,d=i[ub.OX2],f=i[ub.OY2],e[n]=d*l+f*h+a,e[n+1]=d*c+f*u+o,n+=s,d=i[ub.OX3],f=i[ub.OY3],e[n]=d*l+f*h+a,e[n+1]=d*c+f*u+o,n+=s,d=i[ub.OX4],f=i[ub.OY4],e[n]=d*l+f*h+a,e[n+1]=d*c+f*u+o}};let db=ub;db.OX1=0,db.OY1=1,db.OX2=2,db.OY2=3,db.OX3=4,db.OY3=5,db.OX4=6,db.OY4=7,db.X1=0,db.Y1=1,db.C1R=2,db.C1G=3,db.C1B=4,db.C1A=5,db.U1=6,db.V1=7,db.X2=8,db.Y2=9,db.C2R=10,db.C2G=11,db.C2B=12,db.C2A=13,db.U2=14,db.V2=15,db.X3=16,db.Y3=17,db.C3R=18,db.C3G=19,db.C3B=20,db.C3A=21,db.U3=22,db.V3=23,db.X4=24,db.Y4=25,db.C4R=26,db.C4G=27,db.C4B=28,db.C4A=29,db.U4=30,db.V4=31;const fb=class{constructor(t){this.centerX=0,this.centerY=0,this.radius=0,this.angle=0,this.worldX=0,this.worldY=0,this.radius=t}begin(t){this.worldX=t.x+this.centerX,this.worldY=t.y+this.centerY}transform(t,e,n,s){const i=this.angle*fy.degreesToRadians,r=t.x-this.worldX,a=t.y-this.worldY,o=Math.sqrt(r*r+a*a);if(o<this.radius){const e=fb.interpolation.apply(0,i,(this.radius-o)/this.radius),n=Math.cos(e),s=Math.sin(e);t.x=n*r-s*a+this.worldX,t.y=s*r+n*a+this.worldY}}end(){}};let pb=fb;pb.interpolation=new gy(2);let mb=class{constructor(t,e,n){if(null==t)throw new Error("name cannot be null.");if(null==e)throw new Error("timelines cannot be null.");this.name=t,this.timelines=e,this.duration=n}apply(t,e,n,s,i,r,a,o){if(null==t)throw new Error("skeleton cannot be null.");s&&0!=this.duration&&(n%=this.duration,e>0&&(e%=this.duration));const l=this.timelines;for(let h=0,c=l.length;h<c;h++)l[h].apply(t,e,n,i,r,a,o)}static binarySearch(t,e,n=1){let s=0,i=t.length/n-2;if(0==i)return n;let r=i>>>1;for(;;){if(t[(r+1)*n]<=e?s=r+1:i=r,s==i)return(s+1)*n;r=s+i>>>1}}static linearSearch(t,e,n){for(let s=0,i=t.length-n;s<=i;s+=n)if(t[s]>e)return s;return-1}};var gb=(t=>(t[t.rotate=0]="rotate",t[t.translate=1]="translate",t[t.scale=2]="scale",t[t.shear=3]="shear",t[t.attachment=4]="attachment",t[t.color=5]="color",t[t.deform=6]="deform",t[t.event=7]="event",t[t.drawOrder=8]="drawOrder",t[t.ikConstraint=9]="ikConstraint",t[t.transformConstraint=10]="transformConstraint",t[t.pathConstraintPosition=11]="pathConstraintPosition",t[t.pathConstraintSpacing=12]="pathConstraintSpacing",t[t.pathConstraintMix=13]="pathConstraintMix",t[t.twoColor=14]="twoColor",t))(gb||{});const vb=class{constructor(t){if(t<=0)throw new Error(`frameCount must be > 0: ${t}`);this.curves=xy.newFloatArray((t-1)*vb.BEZIER_SIZE)}getFrameCount(){return this.curves.length/vb.BEZIER_SIZE+1}setLinear(t){this.curves[t*vb.BEZIER_SIZE]=vb.LINEAR}setStepped(t){this.curves[t*vb.BEZIER_SIZE]=vb.STEPPED}getCurveType(t){const e=t*vb.BEZIER_SIZE;if(e==this.curves.length)return vb.LINEAR;const n=this.curves[e];return n==vb.LINEAR?vb.LINEAR:n==vb.STEPPED?vb.STEPPED:vb.BEZIER}setCurve(t,e,n,s,i){const r=.03*(2*-e+s),a=.03*(2*-n+i),o=.006*(3*(e-s)+1),l=.006*(3*(n-i)+1);let h=2*r+o,c=2*a+l,u=.3*e+r+.16666667*o,d=.3*n+a+.16666667*l,f=t*vb.BEZIER_SIZE;const p=this.curves;p[f++]=vb.BEZIER;let m=u,g=d;for(let v=f+vb.BEZIER_SIZE-1;f<v;f+=2)p[f]=m,p[f+1]=g,u+=h,d+=c,h+=o,c+=l,m+=u,g+=d}getCurvePercent(t,e){e=fy.clamp(e,0,1);const n=this.curves;let s=t*vb.BEZIER_SIZE;const i=n[s];if(i==vb.LINEAR)return e;if(i==vb.STEPPED)return 0;s++;let r=0;for(let o=s,l=s+vb.BEZIER_SIZE-1;s<l;s+=2)if(r=n[s],r>=e){let t,i;return s==o?(t=0,i=0):(t=n[s-2],i=n[s-1]),i+(n[s+1]-i)*(e-t)/(r-t)}const a=n[s-1];return a+(1-a)*(e-r)/(1-r)}};let xb=vb;xb.LINEAR=0,xb.STEPPED=1,xb.BEZIER=2,xb.BEZIER_SIZE=19;const yb=class extends xb{constructor(t){super(t),this.frames=xy.newFloatArray(t<<1)}getPropertyId(){return 0+this.boneIndex}setFrame(t,e,n){t<<=1,this.frames[t]=e,this.frames[t+yb.ROTATION]=n}apply(t,e,n,s,i,r,a){const o=this.frames,l=t.bones[this.boneIndex];if(n<o[0]){switch(r){case $x.setup:return void(l.rotation=l.data.rotation);case $x.first:const t=l.data.rotation-l.rotation;l.rotation+=(t-360*(16384-(16384.499999999996-t/360|0)))*i}return}if(n>=o[o.length-yb.ENTRIES]){let t=o[o.length+yb.PREV_ROTATION];switch(r){case $x.setup:l.rotation=l.data.rotation+t*i;break;case $x.first:case $x.replace:t+=l.data.rotation-l.rotation,t-=360*(16384-(16384.499999999996-t/360|0));case $x.add:l.rotation+=t*i}return}const h=mb.binarySearch(o,n,yb.ENTRIES),c=o[h+yb.PREV_ROTATION],u=o[h],d=this.getCurvePercent((h>>1)-1,1-(n-u)/(o[h+yb.PREV_TIME]-u));let f=o[h+yb.ROTATION]-c;switch(f=c+(f-360*(16384-(16384.499999999996-f/360|0)))*d,r){case $x.setup:l.rotation=l.data.rotation+(f-360*(16384-(16384.499999999996-f/360|0)))*i;break;case $x.first:case $x.replace:f+=l.data.rotation-l.rotation;case $x.add:l.rotation+=(f-360*(16384-(16384.499999999996-f/360|0)))*i}}};let _b=yb;_b.ENTRIES=2,_b.PREV_TIME=-2,_b.PREV_ROTATION=-1,_b.ROTATION=1;const bb=class extends xb{constructor(t){super(t),this.frames=xy.newFloatArray(t*bb.ENTRIES)}getPropertyId(){return(1<<24)+this.boneIndex}setFrame(t,e,n,s){t*=bb.ENTRIES,this.frames[t]=e,this.frames[t+bb.X]=n,this.frames[t+bb.Y]=s}apply(t,e,n,s,i,r,a){const o=this.frames,l=t.bones[this.boneIndex];if(n<o[0]){switch(r){case $x.setup:return l.x=l.data.x,void(l.y=l.data.y);case $x.first:l.x+=(l.data.x-l.x)*i,l.y+=(l.data.y-l.y)*i}return}let h=0,c=0;if(n>=o[o.length-bb.ENTRIES])h=o[o.length+bb.PREV_X],c=o[o.length+bb.PREV_Y];else{const t=mb.binarySearch(o,n,bb.ENTRIES);h=o[t+bb.PREV_X],c=o[t+bb.PREV_Y];const e=o[t],s=this.getCurvePercent(t/bb.ENTRIES-1,1-(n-e)/(o[t+bb.PREV_TIME]-e));h+=(o[t+bb.X]-h)*s,c+=(o[t+bb.Y]-c)*s}switch(r){case $x.setup:l.x=l.data.x+h*i,l.y=l.data.y+c*i;break;case $x.first:case $x.replace:l.x+=(l.data.x+h-l.x)*i,l.y+=(l.data.y+c-l.y)*i;break;case $x.add:l.x+=h*i,l.y+=c*i}}};let wb=bb;wb.ENTRIES=3,wb.PREV_TIME=-3,wb.PREV_X=-2,wb.PREV_Y=-1,wb.X=1,wb.Y=2;let Eb=class t extends wb{constructor(t){super(t)}getPropertyId(){return(2<<24)+this.boneIndex}apply(e,n,s,i,r,a,o){const l=this.frames,h=e.bones[this.boneIndex];if(s<l[0]){switch(a){case $x.setup:return h.scaleX=h.data.scaleX,void(h.scaleY=h.data.scaleY);case $x.first:h.scaleX+=(h.data.scaleX-h.scaleX)*r,h.scaleY+=(h.data.scaleY-h.scaleY)*r}return}let c=0,u=0;if(s>=l[l.length-t.ENTRIES])c=l[l.length+t.PREV_X]*h.data.scaleX,u=l[l.length+t.PREV_Y]*h.data.scaleY;else{const e=mb.binarySearch(l,s,t.ENTRIES);c=l[e+t.PREV_X],u=l[e+t.PREV_Y];const n=l[e],i=this.getCurvePercent(e/t.ENTRIES-1,1-(s-n)/(l[e+t.PREV_TIME]-n));c=(c+(l[e+t.X]-c)*i)*h.data.scaleX,u=(u+(l[e+t.Y]-u)*i)*h.data.scaleY}if(1==r)a==$x.add?(h.scaleX+=c-h.data.scaleX,h.scaleY+=u-h.data.scaleY):(h.scaleX=c,h.scaleY=u);else{let t=0,e=0;if(o==qx.mixOut)switch(a){case $x.setup:t=h.data.scaleX,e=h.data.scaleY,h.scaleX=t+(Math.abs(c)*fy.signum(t)-t)*r,h.scaleY=e+(Math.abs(u)*fy.signum(e)-e)*r;break;case $x.first:case $x.replace:t=h.scaleX,e=h.scaleY,h.scaleX=t+(Math.abs(c)*fy.signum(t)-t)*r,h.scaleY=e+(Math.abs(u)*fy.signum(e)-e)*r;break;case $x.add:t=h.scaleX,e=h.scaleY,h.scaleX=t+(Math.abs(c)*fy.signum(t)-h.data.scaleX)*r,h.scaleY=e+(Math.abs(u)*fy.signum(e)-h.data.scaleY)*r}else switch(a){case $x.setup:t=Math.abs(h.data.scaleX)*fy.signum(c),e=Math.abs(h.data.scaleY)*fy.signum(u),h.scaleX=t+(c-t)*r,h.scaleY=e+(u-e)*r;break;case $x.first:case $x.replace:t=Math.abs(h.scaleX)*fy.signum(c),e=Math.abs(h.scaleY)*fy.signum(u),h.scaleX=t+(c-t)*r,h.scaleY=e+(u-e)*r;break;case $x.add:t=fy.signum(c),e=fy.signum(u),h.scaleX=Math.abs(h.scaleX)*t+(c-Math.abs(h.data.scaleX)*t)*r,h.scaleY=Math.abs(h.scaleY)*e+(u-Math.abs(h.data.scaleY)*e)*r}}}},Tb=class t extends wb{constructor(t){super(t)}getPropertyId(){return(3<<24)+this.boneIndex}apply(e,n,s,i,r,a,o){const l=this.frames,h=e.bones[this.boneIndex];if(s<l[0]){switch(a){case $x.setup:return h.shearX=h.data.shearX,void(h.shearY=h.data.shearY);case $x.first:h.shearX+=(h.data.shearX-h.shearX)*r,h.shearY+=(h.data.shearY-h.shearY)*r}return}let c=0,u=0;if(s>=l[l.length-t.ENTRIES])c=l[l.length+t.PREV_X],u=l[l.length+t.PREV_Y];else{const e=mb.binarySearch(l,s,t.ENTRIES);c=l[e+t.PREV_X],u=l[e+t.PREV_Y];const n=l[e],i=this.getCurvePercent(e/t.ENTRIES-1,1-(s-n)/(l[e+t.PREV_TIME]-n));c+=(l[e+t.X]-c)*i,u+=(l[e+t.Y]-u)*i}switch(a){case $x.setup:h.shearX=h.data.shearX+c*r,h.shearY=h.data.shearY+u*r;break;case $x.first:case $x.replace:h.shearX+=(h.data.shearX+c-h.shearX)*r,h.shearY+=(h.data.shearY+u-h.shearY)*r;break;case $x.add:h.shearX+=c*r,h.shearY+=u*r}}};const Sb=class extends xb{constructor(t){super(t),this.frames=xy.newFloatArray(t*Sb.ENTRIES)}getPropertyId(){return(5<<24)+this.slotIndex}setFrame(t,e,n,s,i,r){t*=Sb.ENTRIES,this.frames[t]=e,this.frames[t+Sb.R]=n,this.frames[t+Sb.G]=s,this.frames[t+Sb.B]=i,this.frames[t+Sb.A]=r}apply(t,e,n,s,i,r,a){const o=t.slots[this.slotIndex],l=this.frames;if(n<l[0]){switch(r){case $x.setup:return void o.color.setFromColor(o.data.color);case $x.first:const t=o.color,e=o.data.color;t.add((e.r-t.r)*i,(e.g-t.g)*i,(e.b-t.b)*i,(e.a-t.a)*i)}return}let h=0,c=0,u=0,d=0;if(n>=l[l.length-Sb.ENTRIES]){const t=l.length;h=l[t+Sb.PREV_R],c=l[t+Sb.PREV_G],u=l[t+Sb.PREV_B],d=l[t+Sb.PREV_A]}else{const t=mb.binarySearch(l,n,Sb.ENTRIES);h=l[t+Sb.PREV_R],c=l[t+Sb.PREV_G],u=l[t+Sb.PREV_B],d=l[t+Sb.PREV_A];const e=l[t],s=this.getCurvePercent(t/Sb.ENTRIES-1,1-(n-e)/(l[t+Sb.PREV_TIME]-e));h+=(l[t+Sb.R]-h)*s,c+=(l[t+Sb.G]-c)*s,u+=(l[t+Sb.B]-u)*s,d+=(l[t+Sb.A]-d)*s}if(1==i)o.color.set(h,c,u,d);else{const t=o.color;r==$x.setup&&t.setFromColor(o.data.color),t.add((h-t.r)*i,(c-t.g)*i,(u-t.b)*i,(d-t.a)*i)}}};let Ab=Sb;Ab.ENTRIES=5,Ab.PREV_TIME=-5,Ab.PREV_R=-4,Ab.PREV_G=-3,Ab.PREV_B=-2,Ab.PREV_A=-1,Ab.R=1,Ab.G=2,Ab.B=3,Ab.A=4;const Cb=class extends xb{constructor(t){super(t),this.frames=xy.newFloatArray(t*Cb.ENTRIES)}getPropertyId(){return(14<<24)+this.slotIndex}setFrame(t,e,n,s,i,r,a,o,l){t*=Cb.ENTRIES,this.frames[t]=e,this.frames[t+Cb.R]=n,this.frames[t+Cb.G]=s,this.frames[t+Cb.B]=i,this.frames[t+Cb.A]=r,this.frames[t+Cb.R2]=a,this.frames[t+Cb.G2]=o,this.frames[t+Cb.B2]=l}apply(t,e,n,s,i,r,a){const o=t.slots[this.slotIndex],l=this.frames;if(n<l[0]){switch(r){case $x.setup:return o.color.setFromColor(o.data.color),void o.darkColor.setFromColor(o.data.darkColor);case $x.first:const t=o.color,e=o.darkColor,n=o.data.color,s=o.data.darkColor;t.add((n.r-t.r)*i,(n.g-t.g)*i,(n.b-t.b)*i,(n.a-t.a)*i),e.add((s.r-e.r)*i,(s.g-e.g)*i,(s.b-e.b)*i,0)}return}let h=0,c=0,u=0,d=0,f=0,p=0,m=0;if(n>=l[l.length-Cb.ENTRIES]){const t=l.length;h=l[t+Cb.PREV_R],c=l[t+Cb.PREV_G],u=l[t+Cb.PREV_B],d=l[t+Cb.PREV_A],f=l[t+Cb.PREV_R2],p=l[t+Cb.PREV_G2],m=l[t+Cb.PREV_B2]}else{const t=mb.binarySearch(l,n,Cb.ENTRIES);h=l[t+Cb.PREV_R],c=l[t+Cb.PREV_G],u=l[t+Cb.PREV_B],d=l[t+Cb.PREV_A],f=l[t+Cb.PREV_R2],p=l[t+Cb.PREV_G2],m=l[t+Cb.PREV_B2];const e=l[t],s=this.getCurvePercent(t/Cb.ENTRIES-1,1-(n-e)/(l[t+Cb.PREV_TIME]-e));h+=(l[t+Cb.R]-h)*s,c+=(l[t+Cb.G]-c)*s,u+=(l[t+Cb.B]-u)*s,d+=(l[t+Cb.A]-d)*s,f+=(l[t+Cb.R2]-f)*s,p+=(l[t+Cb.G2]-p)*s,m+=(l[t+Cb.B2]-m)*s}if(1==i)o.color.set(h,c,u,d),o.darkColor.set(f,p,m,1);else{const t=o.color,e=o.darkColor;r==$x.setup&&(t.setFromColor(o.data.color),e.setFromColor(o.data.darkColor)),t.add((h-t.r)*i,(c-t.g)*i,(u-t.b)*i,(d-t.a)*i),e.add((f-e.r)*i,(p-e.g)*i,(m-e.b)*i,0)}}};let Ib=Cb;Ib.ENTRIES=8,Ib.PREV_TIME=-8,Ib.PREV_R=-7,Ib.PREV_G=-6,Ib.PREV_B=-5,Ib.PREV_A=-4,Ib.PREV_R2=-3,Ib.PREV_G2=-2,Ib.PREV_B2=-1,Ib.R=1,Ib.G=2,Ib.B=3,Ib.A=4,Ib.R2=5,Ib.G2=6,Ib.B2=7;let Mb=class{constructor(t){this.frames=xy.newFloatArray(t),this.attachmentNames=new Array(t)}getPropertyId(){return(4<<24)+this.slotIndex}getFrameCount(){return this.frames.length}setFrame(t,e,n){this.frames[t]=e,this.attachmentNames[t]=n}apply(t,e,n,s,i,r,a){const o=t.slots[this.slotIndex];if(a==qx.mixOut&&r==$x.setup){const e=o.data.attachmentName;return void o.setAttachment(null==e?null:t.getAttachment(this.slotIndex,e))}const l=this.frames;if(n<l[0]){if(r==$x.setup||r==$x.first){const e=o.data.attachmentName;o.setAttachment(null==e?null:t.getAttachment(this.slotIndex,e))}return}let h=0;h=n>=l[l.length-1]?l.length-1:mb.binarySearch(l,n,1)-1;const c=this.attachmentNames[h];t.slots[this.slotIndex].setAttachment(null==c?null:t.getAttachment(this.slotIndex,c))}},Rb=null,Pb=class extends xb{constructor(t){super(t),this.frames=xy.newFloatArray(t),this.frameVertices=new Array(t),null==Rb&&(Rb=xy.newFloatArray(64))}getPropertyId(){return(6<<27)+Number(this.attachment.id)+this.slotIndex}setFrame(t,e,n){this.frames[t]=e,this.frameVertices[t]=n}apply(t,e,n,s,i,r,a){const o=t.slots[this.slotIndex],l=o.getAttachment();if(!(l instanceof ib&&l.applyDeform(this.attachment)))return;const h=o.attachmentVertices;0==h.length&&(r=$x.setup);const c=this.frameVertices,u=c[0].length,d=this.frames;if(n<d[0]){const t=l;switch(r){case $x.setup:return void(h.length=0);case $x.first:if(1==i){h.length=0;break}const e=xy.setArraySize(h,u);if(null==t.bones){const n=t.vertices;for(let t=0;t<u;t++)e[t]+=(n[t]-e[t])*i}else{i=1-i;for(let t=0;t<u;t++)e[t]*=i}}return}const f=xy.setArraySize(h,u);if(n>=d[d.length-1]){const t=c[d.length-1];if(1==i)if(r==$x.add){const e=l;if(null==e.bones){const n=e.vertices;for(let e=0;e<u;e++)f[e]+=t[e]-n[e]}else for(let n=0;n<u;n++)f[n]+=t[n]}else xy.arrayCopy(t,0,f,0,u);else switch(r){case $x.setup:{const e=l;if(null==e.bones){const n=e.vertices;for(let e=0;e<u;e++){const s=n[e];f[e]=s+(t[e]-s)*i}}else for(let n=0;n<u;n++)f[n]=t[n]*i;break}case $x.first:case $x.replace:for(let n=0;n<u;n++)f[n]+=(t[n]-f[n])*i;case $x.add:const e=l;if(null==e.bones){const n=e.vertices;for(let e=0;e<u;e++)f[e]+=(t[e]-n[e])*i}else for(let n=0;n<u;n++)f[n]+=t[n]*i}return}const p=mb.binarySearch(d,n),m=c[p-1],g=c[p],v=d[p],x=this.getCurvePercent(p-1,1-(n-v)/(d[p-1]-v));if(1==i)if(r==$x.add){const t=l;if(null==t.bones){const e=t.vertices;for(let t=0;t<u;t++){const n=m[t];f[t]+=n+(g[t]-n)*x-e[t]}}else for(let e=0;e<u;e++){const t=m[e];f[e]+=t+(g[e]-t)*x}}else for(let y=0;y<u;y++){const t=m[y];f[y]=t+(g[y]-t)*x}else switch(r){case $x.setup:{const t=l;if(null==t.bones){const e=t.vertices;for(let t=0;t<u;t++){const n=m[t],s=e[t];f[t]=s+(n+(g[t]-n)*x-s)*i}}else for(let e=0;e<u;e++){const t=m[e];f[e]=(t+(g[e]-t)*x)*i}break}case $x.first:case $x.replace:for(let e=0;e<u;e++){const t=m[e];f[e]+=(t+(g[e]-t)*x-f[e])*i}break;case $x.add:const t=l;if(null==t.bones){const e=t.vertices;for(let t=0;t<u;t++){const n=m[t];f[t]+=(n+(g[t]-n)*x-e[t])*i}}else for(let e=0;e<u;e++){const t=m[e];f[e]+=(t+(g[e]-t)*x)*i}}}},kb=class{constructor(t){this.frames=xy.newFloatArray(t),this.events=new Array(t)}getPropertyId(){return 7<<24}getFrameCount(){return this.frames.length}setFrame(t,e){this.frames[t]=e.time,this.events[t]=e}apply(t,e,n,s,i,r,a){if(null==s)return;const o=this.frames,l=this.frames.length;if(e>n)this.apply(t,e,Number.MAX_VALUE,s,i,r,a),e=-1;else if(e>=o[l-1])return;if(n<o[0])return;let h=0;if(e<o[0])h=0;else{h=mb.binarySearch(o,e);const t=o[h];for(;h>0&&o[h-1]==t;)h--}for(;h<l&&n>=o[h];h++)s.push(this.events[h])}},Fb=class{constructor(t){this.frames=xy.newFloatArray(t),this.drawOrders=new Array(t)}getPropertyId(){return 8<<24}getFrameCount(){return this.frames.length}setFrame(t,e,n){this.frames[t]=e,this.drawOrders[t]=n}apply(t,e,n,s,i,r,a){const o=t.drawOrder,l=t.slots;if(a==qx.mixOut&&r==$x.setup)return void xy.arrayCopy(t.slots,0,t.drawOrder,0,t.slots.length);const h=this.frames;if(n<h[0])return void(r!=$x.setup&&r!=$x.first||xy.arrayCopy(t.slots,0,t.drawOrder,0,t.slots.length));let c=0;c=n>=h[h.length-1]?h.length-1:mb.binarySearch(h,n)-1;const u=this.drawOrders[c];if(null==u)xy.arrayCopy(l,0,o,0,l.length);else for(let d=0,f=u.length;d<f;d++)o[d]=l[u[d]]}};const Ob=class extends xb{constructor(t){super(t),this.frames=xy.newFloatArray(t*Ob.ENTRIES)}getPropertyId(){return(9<<24)+this.ikConstraintIndex}setFrame(t,e,n,s,i,r){t*=Ob.ENTRIES,this.frames[t]=e,this.frames[t+Ob.MIX]=n,this.frames[t+Ob.BEND_DIRECTION]=s,this.frames[t+Ob.COMPRESS]=i?1:0,this.frames[t+Ob.STRETCH]=r?1:0}apply(t,e,n,s,i,r,a){const o=this.frames,l=t.ikConstraints[this.ikConstraintIndex];if(n<o[0]){switch(r){case $x.setup:return l.mix=l.data.mix,l.bendDirection=l.data.bendDirection,l.compress=l.data.compress,void(l.stretch=l.data.stretch);case $x.first:l.mix+=(l.data.mix-l.mix)*i,l.bendDirection=l.data.bendDirection,l.compress=l.data.compress,l.stretch=l.data.stretch}return}if(n>=o[o.length-Ob.ENTRIES])return void(r==$x.setup?(l.mix=l.data.mix+(o[o.length+Ob.PREV_MIX]-l.data.mix)*i,a==qx.mixOut?(l.bendDirection=l.data.bendDirection,l.compress=l.data.compress,l.stretch=l.data.stretch):(l.bendDirection=o[o.length+Ob.PREV_BEND_DIRECTION],l.compress=0!=o[o.length+Ob.PREV_COMPRESS],l.stretch=0!=o[o.length+Ob.PREV_STRETCH])):(l.mix+=(o[o.length+Ob.PREV_MIX]-l.mix)*i,a==qx.mixIn&&(l.bendDirection=o[o.length+Ob.PREV_BEND_DIRECTION],l.compress=0!=o[o.length+Ob.PREV_COMPRESS],l.stretch=0!=o[o.length+Ob.PREV_STRETCH])));const h=mb.binarySearch(o,n,Ob.ENTRIES),c=o[h+Ob.PREV_MIX],u=o[h],d=this.getCurvePercent(h/Ob.ENTRIES-1,1-(n-u)/(o[h+Ob.PREV_TIME]-u));r==$x.setup?(l.mix=l.data.mix+(c+(o[h+Ob.MIX]-c)*d-l.data.mix)*i,a==qx.mixOut?(l.bendDirection=l.data.bendDirection,l.compress=l.data.compress,l.stretch=l.data.stretch):(l.bendDirection=o[h+Ob.PREV_BEND_DIRECTION],l.compress=0!=o[h+Ob.PREV_COMPRESS],l.stretch=0!=o[h+Ob.PREV_STRETCH])):(l.mix+=(c+(o[h+Ob.MIX]-c)*d-l.mix)*i,a==qx.mixIn&&(l.bendDirection=o[h+Ob.PREV_BEND_DIRECTION],l.compress=0!=o[h+Ob.PREV_COMPRESS],l.stretch=0!=o[h+Ob.PREV_STRETCH]))}};let Db=Ob;Db.ENTRIES=5,Db.PREV_TIME=-5,Db.PREV_MIX=-4,Db.PREV_BEND_DIRECTION=-3,Db.PREV_COMPRESS=-2,Db.PREV_STRETCH=-1,Db.MIX=1,Db.BEND_DIRECTION=2,Db.COMPRESS=3,Db.STRETCH=4;const Lb=class extends xb{constructor(t){super(t),this.frames=xy.newFloatArray(t*Lb.ENTRIES)}getPropertyId(){return(10<<24)+this.transformConstraintIndex}setFrame(t,e,n,s,i,r){t*=Lb.ENTRIES,this.frames[t]=e,this.frames[t+Lb.ROTATE]=n,this.frames[t+Lb.TRANSLATE]=s,this.frames[t+Lb.SCALE]=i,this.frames[t+Lb.SHEAR]=r}apply(t,e,n,s,i,r,a){const o=this.frames,l=t.transformConstraints[this.transformConstraintIndex];if(n<o[0]){const t=l.data;switch(r){case $x.setup:return l.rotateMix=t.rotateMix,l.translateMix=t.translateMix,l.scaleMix=t.scaleMix,void(l.shearMix=t.shearMix);case $x.first:l.rotateMix+=(t.rotateMix-l.rotateMix)*i,l.translateMix+=(t.translateMix-l.translateMix)*i,l.scaleMix+=(t.scaleMix-l.scaleMix)*i,l.shearMix+=(t.shearMix-l.shearMix)*i}return}let h=0,c=0,u=0,d=0;if(n>=o[o.length-Lb.ENTRIES]){const t=o.length;h=o[t+Lb.PREV_ROTATE],c=o[t+Lb.PREV_TRANSLATE],u=o[t+Lb.PREV_SCALE],d=o[t+Lb.PREV_SHEAR]}else{const t=mb.binarySearch(o,n,Lb.ENTRIES);h=o[t+Lb.PREV_ROTATE],c=o[t+Lb.PREV_TRANSLATE],u=o[t+Lb.PREV_SCALE],d=o[t+Lb.PREV_SHEAR];const e=o[t],s=this.getCurvePercent(t/Lb.ENTRIES-1,1-(n-e)/(o[t+Lb.PREV_TIME]-e));h+=(o[t+Lb.ROTATE]-h)*s,c+=(o[t+Lb.TRANSLATE]-c)*s,u+=(o[t+Lb.SCALE]-u)*s,d+=(o[t+Lb.SHEAR]-d)*s}if(r==$x.setup){const t=l.data;l.rotateMix=t.rotateMix+(h-t.rotateMix)*i,l.translateMix=t.translateMix+(c-t.translateMix)*i,l.scaleMix=t.scaleMix+(u-t.scaleMix)*i,l.shearMix=t.shearMix+(d-t.shearMix)*i}else l.rotateMix+=(h-l.rotateMix)*i,l.translateMix+=(c-l.translateMix)*i,l.scaleMix+=(u-l.scaleMix)*i,l.shearMix+=(d-l.shearMix)*i}};let Nb=Lb;Nb.ENTRIES=5,Nb.PREV_TIME=-5,Nb.PREV_ROTATE=-4,Nb.PREV_TRANSLATE=-3,Nb.PREV_SCALE=-2,Nb.PREV_SHEAR=-1,Nb.ROTATE=1,Nb.TRANSLATE=2,Nb.SCALE=3,Nb.SHEAR=4;const Bb=class extends xb{constructor(t){super(t),this.frames=xy.newFloatArray(t*Bb.ENTRIES)}getPropertyId(){return(11<<24)+this.pathConstraintIndex}setFrame(t,e,n){t*=Bb.ENTRIES,this.frames[t]=e,this.frames[t+Bb.VALUE]=n}apply(t,e,n,s,i,r,a){const o=this.frames,l=t.pathConstraints[this.pathConstraintIndex];if(n<o[0]){switch(r){case $x.setup:return void(l.position=l.data.position);case $x.first:l.position+=(l.data.position-l.position)*i}return}let h=0;if(n>=o[o.length-Bb.ENTRIES])h=o[o.length+Bb.PREV_VALUE];else{const t=mb.binarySearch(o,n,Bb.ENTRIES);h=o[t+Bb.PREV_VALUE];const e=o[t],s=this.getCurvePercent(t/Bb.ENTRIES-1,1-(n-e)/(o[t+Bb.PREV_TIME]-e));h+=(o[t+Bb.VALUE]-h)*s}r==$x.setup?l.position=l.data.position+(h-l.data.position)*i:l.position+=(h-l.position)*i}};let Vb=Bb;Vb.ENTRIES=2,Vb.PREV_TIME=-2,Vb.PREV_VALUE=-1,Vb.VALUE=1;let Ub=class t extends Vb{constructor(t){super(t)}getPropertyId(){return(12<<24)+this.pathConstraintIndex}apply(e,n,s,i,r,a,o){const l=this.frames,h=e.pathConstraints[this.pathConstraintIndex];if(s<l[0]){switch(a){case $x.setup:return void(h.spacing=h.data.spacing);case $x.first:h.spacing+=(h.data.spacing-h.spacing)*r}return}let c=0;if(s>=l[l.length-t.ENTRIES])c=l[l.length+t.PREV_VALUE];else{const e=mb.binarySearch(l,s,t.ENTRIES);c=l[e+t.PREV_VALUE];const n=l[e],i=this.getCurvePercent(e/t.ENTRIES-1,1-(s-n)/(l[e+t.PREV_TIME]-n));c+=(l[e+t.VALUE]-c)*i}a==$x.setup?h.spacing=h.data.spacing+(c-h.data.spacing)*r:h.spacing+=(c-h.spacing)*r}};const Xb=class extends xb{constructor(t){super(t),this.frames=xy.newFloatArray(t*Xb.ENTRIES)}getPropertyId(){return(13<<24)+this.pathConstraintIndex}setFrame(t,e,n,s){t*=Xb.ENTRIES,this.frames[t]=e,this.frames[t+Xb.ROTATE]=n,this.frames[t+Xb.TRANSLATE]=s}apply(t,e,n,s,i,r,a){const o=this.frames,l=t.pathConstraints[this.pathConstraintIndex];if(n<o[0]){switch(r){case $x.setup:return l.rotateMix=l.data.rotateMix,void(l.translateMix=l.data.translateMix);case $x.first:l.rotateMix+=(l.data.rotateMix-l.rotateMix)*i,l.translateMix+=(l.data.translateMix-l.translateMix)*i}return}let h=0,c=0;if(n>=o[o.length-Xb.ENTRIES])h=o[o.length+Xb.PREV_ROTATE],c=o[o.length+Xb.PREV_TRANSLATE];else{const t=mb.binarySearch(o,n,Xb.ENTRIES);h=o[t+Xb.PREV_ROTATE],c=o[t+Xb.PREV_TRANSLATE];const e=o[t],s=this.getCurvePercent(t/Xb.ENTRIES-1,1-(n-e)/(o[t+Xb.PREV_TIME]-e));h+=(o[t+Xb.ROTATE]-h)*s,c+=(o[t+Xb.TRANSLATE]-c)*s}r==$x.setup?(l.rotateMix=l.data.rotateMix+(h-l.data.rotateMix)*i,l.translateMix=l.data.translateMix+(c-l.data.translateMix)*i):(l.rotateMix+=(h-l.rotateMix)*i,l.translateMix+=(c-l.translateMix)*i)}};let Yb=Xb;Yb.ENTRIES=3,Yb.PREV_TIME=-3,Yb.PREV_ROTATE=-2,Yb.PREV_TRANSLATE=-1,Yb.ROTATE=1,Yb.TRANSLATE=2;const Wb=class{constructor(t){this.tracks=new Array,this.events=new Array,this.listeners=new Array,this.queue=new $b(this),this.propertyIDs=new ly,this.animationsChanged=!1,this.timeScale=1,this.trackEntryPool=new yy((()=>new Hb)),this.data=t}update(t){t*=this.timeScale;const e=this.tracks;for(let n=0,s=e.length;n<s;n++){const s=e[n];if(null==s)continue;s.animationLast=s.nextAnimationLast,s.trackLast=s.nextTrackLast;let i=t*s.timeScale;if(s.delay>0){if(s.delay-=i,s.delay>0)continue;i=-s.delay,s.delay=0}let r=s.next;if(null!=r){const e=s.trackLast-r.delay;if(e>=0){for(r.delay=0,r.trackTime=0==s.timeScale?0:(e/s.timeScale+t)*r.timeScale,s.trackTime+=i,this.setCurrent(n,r,!0);null!=r.mixingFrom;)r.mixTime+=t,r=r.mixingFrom;continue}}else if(s.trackLast>=s.trackEnd&&null==s.mixingFrom){e[n]=null,this.queue.end(s),this.disposeNext(s);continue}if(null!=s.mixingFrom&&this.updateMixingFrom(s,t)){let t=s.mixingFrom;for(s.mixingFrom=null,null!=t&&(t.mixingTo=null);null!=t;)this.queue.end(t),t=t.mixingFrom}s.trackTime+=i}this.queue.drain()}updateMixingFrom(t,e){const n=t.mixingFrom;if(null==n)return!0;const s=this.updateMixingFrom(n,e);return n.animationLast=n.nextAnimationLast,n.trackLast=n.nextTrackLast,t.mixTime>0&&t.mixTime>=t.mixDuration?(0!=n.totalAlpha&&0!=t.mixDuration||(t.mixingFrom=n.mixingFrom,null!=n.mixingFrom&&(n.mixingFrom.mixingTo=t),t.interruptAlpha=n.interruptAlpha,this.queue.end(n)),s):(n.trackTime+=e*n.timeScale,t.mixTime+=e,!1)}apply(t){if(null==t)throw new Error("skeleton cannot be null.");this.animationsChanged&&this._animationsChanged();const e=this.events,n=this.tracks;let s=!1;for(let i=0,r=n.length;i<r;i++){const r=n[i];if(null==r||r.delay>0)continue;s=!0;const a=0==i?$x.first:r.mixBlend;let o=r.alpha;null!=r.mixingFrom?o*=this.applyMixingFrom(r,t,a):r.trackTime>=r.trackEnd&&null==r.next&&(o=0);const l=r.animationLast,h=r.getAnimationTime(),c=r.animation.timelines.length,u=r.animation.timelines;if(0==i&&1==o||a==$x.add)for(let n=0;n<c;n++)u[n].apply(t,l,h,e,o,a,qx.mixIn);else{const n=r.timelineMode,s=0==r.timelinesRotation.length;s&&xy.setArraySize(r.timelinesRotation,c<<1,null);const i=r.timelinesRotation;for(let r=0;r<c;r++){const c=u[r],d=n[r]==Wb.SUBSEQUENT?a:$x.setup;c instanceof _b?this.applyRotateTimeline(c,t,h,o,d,i,r<<1,s):c.apply(t,l,h,e,o,d,qx.mixIn)}}this.queueEvents(r,h),e.length=0,r.nextAnimationLast=h,r.nextTrackLast=r.trackTime}return this.queue.drain(),s}applyMixingFrom(t,e,n){const s=t.mixingFrom;null!=s.mixingFrom&&this.applyMixingFrom(s,e,n);let i=0;0==t.mixDuration?(i=1,n==$x.first&&(n=$x.setup)):(i=t.mixTime/t.mixDuration,i>1&&(i=1),n!=$x.first&&(n=s.mixBlend));const r=i<s.eventThreshold?this.events:null,a=i<s.attachmentThreshold,o=i<s.drawOrderThreshold,l=s.animationLast,h=s.getAnimationTime(),c=s.animation.timelines.length,u=s.animation.timelines,d=s.alpha*t.interruptAlpha,f=d*(1-i);if(n==$x.add)for(let p=0;p<c;p++)u[p].apply(e,l,h,r,f,n,qx.mixOut);else{const t=s.timelineMode,i=s.timelineHoldMix,p=0==s.timelinesRotation.length;p&&xy.setArraySize(s.timelinesRotation,c<<1,null);const m=s.timelinesRotation;s.totalAlpha=0;for(let g=0;g<c;g++){const c=u[g];let v,x=qx.mixOut,y=0;switch(t[g]){case Wb.SUBSEQUENT:if(!a&&c instanceof Mb)continue;if(!o&&c instanceof Fb)continue;v=n,y=f;break;case Wb.FIRST:v=$x.setup,y=f;break;case Wb.HOLD:v=$x.setup,y=d;break;default:v=$x.setup;const t=i[g];y=d*Math.max(0,1-t.mixTime/t.mixDuration)}s.totalAlpha+=y,c instanceof _b?this.applyRotateTimeline(c,e,h,y,v,m,g<<1,p):(v==$x.setup&&(c instanceof Mb?a&&(x=qx.mixOut):c instanceof Fb&&o&&(x=qx.mixOut)),c.apply(e,l,h,r,y,v,x))}}return t.mixDuration>0&&this.queueEvents(s,h),this.events.length=0,s.nextAnimationLast=h,s.nextTrackLast=s.trackTime,i}applyRotateTimeline(t,e,n,s,i,r,a,o){if(o&&(r[a]=0),1==s)return void t.apply(e,0,n,null,1,i,qx.mixIn);const l=t,h=l.frames,c=e.bones[l.boneIndex];let u=0,d=0;if(n<h[0])switch(i){case $x.setup:c.rotation=c.data.rotation;default:return;case $x.first:u=c.rotation,d=c.data.rotation}else if(u=i==$x.setup?c.data.rotation:c.rotation,n>=h[h.length-_b.ENTRIES])d=c.data.rotation+h[h.length+_b.PREV_ROTATION];else{const t=mb.binarySearch(h,n,_b.ENTRIES),e=h[t+_b.PREV_ROTATION],s=h[t],i=l.getCurvePercent((t>>1)-1,1-(n-s)/(h[t+_b.PREV_TIME]-s));d=h[t+_b.ROTATION]-e,d-=360*(16384-(16384.499999999996-d/360|0)),d=e+d*i+c.data.rotation,d-=360*(16384-(16384.499999999996-d/360|0))}let f=0,p=d-u;if(p-=360*(16384-(16384.499999999996-p/360|0)),0==p)f=r[a];else{let t=0,e=0;o?(t=0,e=p):(t=r[a],e=r[a+1]);const n=p>0;let s=t>=0;fy.signum(e)!=fy.signum(p)&&Math.abs(e)<=90&&(Math.abs(t)>180&&(t+=360*fy.signum(t)),s=n),f=p+t-t%360,s!=n&&(f+=360*fy.signum(t)),r[a]=f}r[a+1]=p,u+=f*s,c.rotation=u-360*(16384-(16384.499999999996-u/360|0))}queueEvents(t,e){const n=t.animationStart,s=t.animationEnd,i=s-n,r=t.trackLast%i,a=this.events;let o=0;const l=a.length;for(;o<l;o++){const e=a[o];if(e.time<r)break;e.time>s||this.queue.event(t,e)}let h=!1;for(h=t.loop?0==i||r>t.trackTime%i:e>=s&&t.animationLast<s,h&&this.queue.complete(t);o<l;o++){a[o].time<n||this.queue.event(t,a[o])}}clearTracks(){const t=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(let e=0,n=this.tracks.length;e<n;e++)this.clearTrack(e);this.tracks.length=0,this.queue.drainDisabled=t,this.queue.drain()}clearTrack(t){if(t>=this.tracks.length)return;const e=this.tracks[t];if(null==e)return;this.queue.end(e),this.disposeNext(e);let n=e;for(;;){const t=n.mixingFrom;if(null==t)break;this.queue.end(t),n.mixingFrom=null,n.mixingTo=null,n=t}this.tracks[e.trackIndex]=null,this.queue.drain()}setCurrent(t,e,n){const s=this.expandToIndex(t);this.tracks[t]=e,null!=s&&(n&&this.queue.interrupt(s),e.mixingFrom=s,s.mixingTo=e,e.mixTime=0,null!=s.mixingFrom&&s.mixDuration>0&&(e.interruptAlpha*=Math.min(1,s.mixTime/s.mixDuration)),s.timelinesRotation.length=0),this.queue.start(e)}setAnimation(t,e,n){const s=this.data.skeletonData.findAnimation(e);if(null==s)throw new Error(`Animation not found: ${e}`);return this.setAnimationWith(t,s,n)}setAnimationWith(t,e,n){if(null==e)throw new Error("animation cannot be null.");let s=!0,i=this.expandToIndex(t);null!=i&&(-1==i.nextTrackLast?(this.tracks[t]=i.mixingFrom,this.queue.interrupt(i),this.queue.end(i),this.disposeNext(i),i=i.mixingFrom,s=!1):this.disposeNext(i));const r=this.trackEntry(t,e,n,i);return this.setCurrent(t,r,s),this.queue.drain(),r}addAnimation(t,e,n,s){const i=this.data.skeletonData.findAnimation(e);if(null==i)throw new Error(`Animation not found: ${e}`);return this.addAnimationWith(t,i,n,s)}addAnimationWith(t,e,n,s){if(null==e)throw new Error("animation cannot be null.");let i=this.expandToIndex(t);if(null!=i)for(;null!=i.next;)i=i.next;const r=this.trackEntry(t,e,n,i);if(null==i)this.setCurrent(t,r,!0),this.queue.drain();else if(i.next=r,s<=0){const t=i.animationEnd-i.animationStart;0!=t?(i.loop?s+=t*(1+(i.trackTime/t|0)):s+=Math.max(t,i.trackTime),s-=this.data.getMix(i.animation,e)):s=i.trackTime}return r.delay=s,r}setEmptyAnimation(t,e){const n=this.setAnimationWith(t,Wb.emptyAnimation,!1);return n.mixDuration=e,n.trackEnd=e,n}addEmptyAnimation(t,e,n){n<=0&&(n-=e);const s=this.addAnimationWith(t,Wb.emptyAnimation,!1,n);return s.mixDuration=e,s.trackEnd=e,s}setEmptyAnimations(t){const e=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(let n=0,s=this.tracks.length;n<s;n++){const e=this.tracks[n];null!=e&&this.setEmptyAnimation(e.trackIndex,t)}this.queue.drainDisabled=e,this.queue.drain()}expandToIndex(t){return t<this.tracks.length?this.tracks[t]:(xy.ensureArrayCapacity(this.tracks,t-this.tracks.length+1,null),this.tracks.length=t+1,null)}trackEntry(t,e,n,s){const i=this.trackEntryPool.obtain();return i.trackIndex=t,i.animation=e,i.loop=n,i.holdPrevious=!1,i.eventThreshold=0,i.attachmentThreshold=0,i.drawOrderThreshold=0,i.animationStart=0,i.animationEnd=e.duration,i.animationLast=-1,i.nextAnimationLast=-1,i.delay=0,i.trackTime=0,i.trackLast=-1,i.nextTrackLast=-1,i.trackEnd=Number.MAX_VALUE,i.timeScale=1,i.alpha=1,i.interruptAlpha=1,i.mixTime=0,i.mixDuration=null==s?0:this.data.getMix(s.animation,e),i}disposeNext(t){let e=t.next;for(;null!=e;)this.queue.dispose(e),e=e.next;t.next=null}_animationsChanged(){this.animationsChanged=!1,this.propertyIDs.clear();for(let t=0,e=this.tracks.length;t<e;t++){let e=this.tracks[t];if(null!=e){for(;null!=e.mixingFrom;)e=e.mixingFrom;do{null!=e.mixingFrom&&e.mixBlend==$x.add||this.setTimelineModes(e),e=e.mixingTo}while(null!=e)}}}setTimelineModes(t){const e=t.mixingTo,n=t.animation.timelines,s=t.animation.timelines.length,i=xy.setArraySize(t.timelineMode,s);t.timelineHoldMix.length=0;const r=xy.setArraySize(t.timelineHoldMix,s),a=this.propertyIDs;if(null!=e&&e.holdPrevious)for(let o=0;o<s;o++)a.add(n[o].getPropertyId()),i[o]=Wb.HOLD;else t:for(let o=0;o<s;o++){const s=n[o].getPropertyId();if(a.add(s))if(null!=e&&this.hasTimeline(e,s)){for(let n=e.mixingTo;null!=n;n=n.mixingTo)if(!this.hasTimeline(n,s)){if(t.mixDuration>0){i[o]=Wb.HOLD_MIX,r[o]=n;continue t}break}i[o]=Wb.HOLD}else i[o]=Wb.FIRST;else i[o]=Wb.SUBSEQUENT}}hasTimeline(t,e){const n=t.animation.timelines;for(let s=0,i=n.length;s<i;s++)if(n[s].getPropertyId()==e)return!0;return!1}getCurrent(t){return t>=this.tracks.length?null:this.tracks[t]}addListener(t){if(null==t)throw new Error("listener cannot be null.");this.listeners.push(t)}removeListener(t){const e=this.listeners.indexOf(t);e>=0&&this.listeners.splice(e,1)}clearListeners(){this.listeners.length=0}clearListenerNotifications(){this.queue.clear()}setAnimationByName(t,e,n){Wb.deprecatedWarning1||(Wb.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: AnimationState.setAnimationByName is deprecated, please use setAnimation from now on.")),this.setAnimation(t,e,n)}addAnimationByName(t,e,n,s){Wb.deprecatedWarning2||(Wb.deprecatedWarning2=!0,console.warn("Spine Deprecation Warning: AnimationState.addAnimationByName is deprecated, please use addAnimation from now on.")),this.addAnimation(t,e,n,s)}hasAnimation(t){return null!==this.data.skeletonData.findAnimation(t)}hasAnimationByName(t){return Wb.deprecatedWarning3||(Wb.deprecatedWarning3=!0,console.warn("Spine Deprecation Warning: AnimationState.hasAnimationByName is deprecated, please use hasAnimation from now on.")),this.hasAnimation(t)}};let zb=Wb;zb.emptyAnimation=new mb("<empty>",[],0),zb.SUBSEQUENT=0,zb.FIRST=1,zb.HOLD=2,zb.HOLD_MIX=3,zb.deprecatedWarning1=!1,zb.deprecatedWarning2=!1,zb.deprecatedWarning3=!1;const Gb=class{constructor(){this.mixBlend=$x.replace,this.timelineMode=new Array,this.timelineHoldMix=new Array,this.timelinesRotation=new Array}reset(){this.next=null,this.mixingFrom=null,this.mixingTo=null,this.animation=null,this.listener=null,this.timelineMode.length=0,this.timelineHoldMix.length=0,this.timelinesRotation.length=0}getAnimationTime(){if(this.loop){const t=this.animationEnd-this.animationStart;return 0==t?this.animationStart:this.trackTime%t+this.animationStart}return Math.min(this.trackTime+this.animationStart,this.animationEnd)}setAnimationLast(t){this.animationLast=t,this.nextAnimationLast=t}isComplete(){return this.trackTime>=this.animationEnd-this.animationStart}resetRotationDirections(){this.timelinesRotation.length=0}get time(){return Gb.deprecatedWarning1||(Gb.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: TrackEntry.time is deprecated, please use trackTime from now on.")),this.trackTime}set time(t){Gb.deprecatedWarning1||(Gb.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: TrackEntry.time is deprecated, please use trackTime from now on.")),this.trackTime=t}get endTime(){return Gb.deprecatedWarning2||(Gb.deprecatedWarning2=!0,console.warn("Spine Deprecation Warning: TrackEntry.endTime is deprecated, please use trackEnd from now on.")),this.trackTime}set endTime(t){Gb.deprecatedWarning2||(Gb.deprecatedWarning2=!0,console.warn("Spine Deprecation Warning: TrackEntry.endTime is deprecated, please use trackEnd from now on.")),this.trackTime=t}loopsCount(){return Math.floor(this.trackTime/this.trackEnd)}};let Hb=Gb;Hb.deprecatedWarning1=!1,Hb.deprecatedWarning2=!1;const jb=class{constructor(t){this.objects=[],this.drainDisabled=!1,this.animState=t}start(t){this.objects.push(qb.start),this.objects.push(t),this.animState.animationsChanged=!0}interrupt(t){this.objects.push(qb.interrupt),this.objects.push(t)}end(t){this.objects.push(qb.end),this.objects.push(t),this.animState.animationsChanged=!0}dispose(t){this.objects.push(qb.dispose),this.objects.push(t)}complete(t){this.objects.push(qb.complete),this.objects.push(t)}event(t,e){this.objects.push(qb.event),this.objects.push(t),this.objects.push(e)}deprecateStuff(){return jb.deprecatedWarning1||(jb.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: onComplete, onStart, onEnd, onEvent art deprecated, please use listeners from now on. 'state.addListener({ complete: function(track, event) { } })'")),!0}drain(){if(this.drainDisabled)return;this.drainDisabled=!0;const t=this.objects,e=this.animState.listeners;for(let n=0;n<t.length;n+=2){const s=t[n],i=t[n+1];switch(s){case qb.start:null!=i.listener&&i.listener.start&&i.listener.start(i);for(let t=0;t<e.length;t++)e[t].start&&e[t].start(i);i.onStart&&this.deprecateStuff()&&i.onStart(i.trackIndex),this.animState.onStart&&this.deprecateStuff()&&this.deprecateStuff&&this.animState.onStart(i.trackIndex);break;case qb.interrupt:null!=i.listener&&i.listener.interrupt&&i.listener.interrupt(i);for(let t=0;t<e.length;t++)e[t].interrupt&&e[t].interrupt(i);break;case qb.end:null!=i.listener&&i.listener.end&&i.listener.end(i);for(let t=0;t<e.length;t++)e[t].end&&e[t].end(i);i.onEnd&&this.deprecateStuff()&&i.onEnd(i.trackIndex),this.animState.onEnd&&this.deprecateStuff()&&this.animState.onEnd(i.trackIndex);case qb.dispose:null!=i.listener&&i.listener.dispose&&i.listener.dispose(i);for(let t=0;t<e.length;t++)e[t].dispose&&e[t].dispose(i);this.animState.trackEntryPool.free(i);break;case qb.complete:null!=i.listener&&i.listener.complete&&i.listener.complete(i);for(let t=0;t<e.length;t++)e[t].complete&&e[t].complete(i);const s=fy.toInt(i.loopsCount());i.onComplete&&this.deprecateStuff()&&i.onComplete(i.trackIndex,s),this.animState.onComplete&&this.deprecateStuff()&&this.animState.onComplete(i.trackIndex,s);break;case qb.event:const r=t[2+n++];null!=i.listener&&i.listener.event&&i.listener.event(i,r);for(let t=0;t<e.length;t++)e[t].event&&e[t].event(i,r);i.onEvent&&this.deprecateStuff()&&i.onEvent(i.trackIndex,r),this.animState.onEvent&&this.deprecateStuff()&&this.animState.onEvent(i.trackIndex,r)}}this.clear(),this.drainDisabled=!1}clear(){this.objects.length=0}};let $b=jb;$b.deprecatedWarning1=!1;var qb=(t=>(t[t.start=0]="start",t[t.interrupt=1]="interrupt",t[t.end=2]="end",t[t.dispose=3]="dispose",t[t.complete=4]="complete",t[t.event=5]="event",t))(qb||{});const Kb=class{constructor(t){if(this.animationToMixTime={},this.defaultMix=0,null==t)throw new Error("skeletonData cannot be null.");this.skeletonData=t}setMix(t,e,n){const s=this.skeletonData.findAnimation(t);if(null==s)throw new Error(`Animation not found: ${t}`);const i=this.skeletonData.findAnimation(e);if(null==i)throw new Error(`Animation not found: ${e}`);this.setMixWith(s,i,n)}setMixByName(t,e,n){Kb.deprecatedWarning1||(Kb.deprecatedWarning1=!0,console.warn("Deprecation Warning: AnimationStateData.setMixByName is deprecated, please use setMix from now on.")),this.setMix(t,e,n)}setMixWith(t,e,n){if(null==t)throw new Error("from cannot be null.");if(null==e)throw new Error("to cannot be null.");const s=`${t.name}.${e.name}`;this.animationToMixTime[s]=n}getMix(t,e){const n=`${t.name}.${e.name}`,s=this.animationToMixTime[n];return void 0===s?this.defaultMix:s}};let Zb=Kb;Zb.deprecatedWarning1=!1;let Qb=class{constructor(t){this.atlas=t}newRegionAttachment(t,e,n){const s=this.atlas.findRegion(n);if(null==s)throw new Error(`Region not found in atlas: ${n} (region attachment: ${e})`);const i=new db(e);return i.region=s,i}newMeshAttachment(t,e,n){const s=this.atlas.findRegion(n);if(null==s)throw new Error(`Region not found in atlas: ${n} (mesh attachment: ${e})`);const i=new ob(e);return i.region=s,i}newBoundingBoxAttachment(t,e){return new rb(e)}newPathAttachment(t,e){return new lb(e)}newPointAttachment(t,e){return new hb(e)}newClippingAttachment(t,e){return new ab(e)}},Jb=class{constructor(t,e,n){if(this.matrix=new nh,this.children=new Array,this.x=0,this.y=0,this.rotation=0,this.scaleX=0,this.scaleY=0,this.shearX=0,this.shearY=0,this.ax=0,this.ay=0,this.arotation=0,this.ascaleX=0,this.ascaleY=0,this.ashearX=0,this.ashearY=0,this.appliedValid=!1,this.sorted=!1,this.active=!0,null==t)throw new Error("data cannot be null.");if(null==e)throw new Error("skeleton cannot be null.");this.data=t,this.skeleton=e,this.parent=n,this.setToSetupPose()}get worldX(){return this.matrix.tx}get worldY(){return this.matrix.ty}update(){this.updateWorldTransformWith(this.x,this.y,this.rotation,this.scaleX,this.scaleY,this.shearX,this.shearY)}updateWorldTransform(){this.updateWorldTransformWith(this.x,this.y,this.rotation,this.scaleX,this.scaleY,this.shearX,this.shearY)}updateWorldTransformWith(t,e,n,s,i,r,a){this.ax=t,this.ay=e,this.arotation=n,this.ascaleX=s,this.ascaleY=i,this.ashearX=r,this.ashearY=a,this.appliedValid=!0;const o=this.parent,l=this.matrix,h=this.skeleton.scaleX,c=-this.skeleton.scaleY;if(null==o){const o=this.skeleton,u=n+90+a;return l.a=fy.cosDeg(n+r)*s*h,l.c=fy.cosDeg(u)*i*h,l.b=fy.sinDeg(n+r)*s*c,l.d=fy.sinDeg(u)*i*c,l.tx=t*h+o.x,void(l.ty=e*c+o.y)}let u=o.matrix.a,d=o.matrix.c,f=o.matrix.b,p=o.matrix.d;switch(l.tx=u*t+d*e+o.matrix.tx,l.ty=f*t+p*e+o.matrix.ty,this.data.transformMode){case Qx.Normal:{const t=n+90+a,e=fy.cosDeg(n+r)*s,o=fy.cosDeg(t)*i,h=fy.sinDeg(n+r)*s,c=fy.sinDeg(t)*i;return l.a=u*e+d*h,l.c=u*o+d*c,l.b=f*e+p*h,void(l.d=f*o+p*c)}case Qx.OnlyTranslation:{const t=n+90+a;l.a=fy.cosDeg(n+r)*s,l.c=fy.cosDeg(t)*i,l.b=fy.sinDeg(n+r)*s,l.d=fy.sinDeg(t)*i;break}case Qx.NoRotationOrReflection:{let t=u*u+f*f,e=0;t>1e-4?(t=Math.abs(u*p-d*f)/t,d=f*t,p=u*t,e=Math.atan2(f,u)*fy.radDeg):(u=0,f=0,e=90-Math.atan2(p,d)*fy.radDeg);const o=n+r-e,h=n+a-e+90,c=fy.cosDeg(o)*s,m=fy.cosDeg(h)*i,g=fy.sinDeg(o)*s,v=fy.sinDeg(h)*i;l.a=u*c-d*g,l.c=u*m-d*v,l.b=f*c+p*g,l.d=f*m+p*v;break}case Qx.NoScale:case Qx.NoScaleOrReflection:{const t=fy.cosDeg(n),e=fy.sinDeg(n);let o=(u*t+d*e)/h,m=(f*t+p*e)/c,g=Math.sqrt(o*o+m*m);g>1e-5&&(g=1/g),o*=g,m*=g,g=Math.sqrt(o*o+m*m),this.data.transformMode==Qx.NoScale&&u*p-d*f<0!=(this.skeleton.scaleX<0!=this.skeleton.scaleY>0)&&(g=-g);const v=Math.PI/2+Math.atan2(m,o),x=Math.cos(v)*g,y=Math.sin(v)*g,_=fy.cosDeg(r)*s,b=fy.cosDeg(90+a)*i,w=fy.sinDeg(r)*s,E=fy.sinDeg(90+a)*i;l.a=o*_+x*w,l.c=o*b+x*E,l.b=m*_+y*w,l.d=m*b+y*E;break}}l.a*=h,l.c*=h,l.b*=c,l.d*=c}setToSetupPose(){const t=this.data;this.x=t.x,this.y=t.y,this.rotation=t.rotation,this.scaleX=t.scaleX,this.scaleY=t.scaleY,this.shearX=t.shearX,this.shearY=t.shearY}getWorldRotationX(){return Math.atan2(this.matrix.b,this.matrix.a)*fy.radDeg}getWorldRotationY(){return Math.atan2(this.matrix.d,this.matrix.c)*fy.radDeg}getWorldScaleX(){const t=this.matrix;return Math.sqrt(t.a*t.a+t.c*t.c)}getWorldScaleY(){const t=this.matrix;return Math.sqrt(t.b*t.b+t.d*t.d)}updateAppliedTransform(){this.appliedValid=!0;const t=this.parent,e=this.matrix;if(null==t)return this.ax=e.tx,this.ay=e.ty,this.arotation=Math.atan2(e.b,e.a)*fy.radDeg,this.ascaleX=Math.sqrt(e.a*e.a+e.b*e.b),this.ascaleY=Math.sqrt(e.c*e.c+e.d*e.d),this.ashearX=0,void(this.ashearY=Math.atan2(e.a*e.c+e.b*e.d,e.a*e.d-e.b*e.c)*fy.radDeg);const n=t.matrix,s=1/(n.a*n.d-n.b*n.c),i=e.tx-n.tx,r=e.ty-n.ty;this.ax=i*n.d*s-r*n.c*s,this.ay=r*n.a*s-i*n.b*s;const a=s*n.d,o=s*n.a,l=s*n.c,h=s*n.b,c=a*e.a-l*e.b,u=a*e.c-l*e.d,d=o*e.b-h*e.a,f=o*e.d-h*e.c;if(this.ashearX=0,this.ascaleX=Math.sqrt(c*c+d*d),this.ascaleX>1e-4){const t=c*f-u*d;this.ascaleY=t/this.ascaleX,this.ashearY=Math.atan2(c*u+d*f,t)*fy.radDeg,this.arotation=Math.atan2(d,c)*fy.radDeg}else this.ascaleX=0,this.ascaleY=Math.sqrt(u*u+f*f),this.ashearY=0,this.arotation=90-Math.atan2(f,u)*fy.radDeg}worldToLocal(t){const e=this.matrix,n=e.a,s=e.c,i=e.b,r=e.d,a=1/(n*r-s*i),o=t.x-e.tx,l=t.y-e.ty;return t.x=o*r*a-l*s*a,t.y=l*n*a-o*i*a,t}localToWorld(t){const e=this.matrix,n=t.x,s=t.y;return t.x=n*e.a+s*e.c+e.tx,t.y=n*e.b+s*e.d+e.ty,t}worldToLocalRotation(t){const e=fy.sinDeg(t),n=fy.cosDeg(t),s=this.matrix;return Math.atan2(s.a*e-s.b*n,s.d*n-s.c*e)*fy.radDeg}localToWorldRotation(t){const e=fy.sinDeg(t),n=fy.cosDeg(t),s=this.matrix;return Math.atan2(n*s.b+e*s.d,n*s.a+e*s.c)*fy.radDeg}rotateWorld(t){const e=this.matrix,n=e.a,s=e.c,i=e.b,r=e.d,a=fy.cosDeg(t),o=fy.sinDeg(t);e.a=a*n-o*i,e.c=a*s-o*r,e.b=o*n+a*i,e.d=o*s+a*r,this.appliedValid=!1}},tw=class{constructor(t,e,n){if(this.x=0,this.y=0,this.rotation=0,this.scaleX=1,this.scaleY=1,this.shearX=0,this.shearY=0,this.transformMode=Qx.Normal,t<0)throw new Error("index must be >= 0.");if(null==e)throw new Error("name cannot be null.");this.index=t,this.name=e,this.parent=n}},ew=class{constructor(t,e){if(null==e)throw new Error("data cannot be null.");this.time=t,this.data=e}},nw=class{constructor(t){this.name=t}},sw=class{constructor(t,e){if(this.bendDirection=0,this.compress=!1,this.stretch=!1,this.mix=1,null==t)throw new Error("data cannot be null.");if(null==e)throw new Error("skeleton cannot be null.");this.data=t,this.mix=t.mix,this.bendDirection=t.bendDirection,this.compress=t.compress,this.stretch=t.stretch,this.bones=new Array;for(let n=0;n<t.bones.length;n++)this.bones.push(e.findBone(t.bones[n].name));this.target=e.findBone(t.target.name)}getOrder(){return this.data.order}apply(){this.update()}update(){const t=this.target,e=this.bones;switch(e.length){case 1:this.apply1(e[0],t.worldX,t.worldY,this.compress,this.stretch,this.data.uniform,this.mix);break;case 2:this.apply2(e[0],e[1],t.worldX,t.worldY,this.bendDirection,this.stretch,this.mix)}}apply1(t,e,n,s,i,r,a){t.appliedValid||t.updateAppliedTransform();const o=t.parent.matrix,l=1/(o.a*o.d-o.b*o.c),h=e-o.tx,c=n-o.ty,u=(h*o.d-c*o.c)*l-t.ax,d=(c*o.a-h*o.b)*l-t.ay;let f=Math.atan2(d,u)*fy.radDeg-t.ashearX-t.arotation;t.ascaleX<0&&(f+=180),f>180?f-=360:f<-180&&(f+=360);let p=t.ascaleX,m=t.ascaleY;if(s||i){const e=t.data.length*p,n=Math.sqrt(u*u+d*d);if(s&&n<e||i&&n>e&&e>1e-4){const t=(n/e-1)*a+1;p*=t,r&&(m*=t)}}t.updateWorldTransformWith(t.ax,t.ay,t.arotation+f*a,p,m,t.ashearX,t.ashearY)}apply2(t,e,n,s,i,r,a){if(0==a)return void e.updateWorldTransform();t.appliedValid||t.updateAppliedTransform(),e.appliedValid||e.updateAppliedTransform();const o=t.ax,l=t.ay;let h=t.ascaleX,c=h,u=t.ascaleY,d=e.ascaleX;const f=t.matrix;let p=0,m=0,g=0;h<0?(h=-h,p=180,g=-1):(p=0,g=1),u<0&&(u=-u,g=-g),d<0?(d=-d,m=180):m=0;const v=e.ax;let x=0,y=0,_=0,b=f.a,w=f.c,E=f.b,T=f.d;const S=Math.abs(h-u)<=1e-4;S?(x=e.ay,y=b*v+w*x+f.tx,_=E*v+T*x+f.ty):(x=0,y=b*v+f.tx,_=E*v+f.ty);const A=t.parent.matrix;b=A.a,w=A.c,E=A.b,T=A.d;const C=1/(b*T-w*E);let I=n-A.tx,M=s-A.ty;const R=(I*T-M*w)*C-o,P=(M*b-I*E)*C-l,k=R*R+P*P;I=y-A.tx,M=_-A.ty;const F=(I*T-M*w)*C-o,O=(M*b-I*E)*C-l,D=Math.sqrt(F*F+O*O);let L=e.data.length*d,N=0,B=0;t:if(S){L*=h;let t=(k-D*D-L*L)/(2*D*L);t<-1?t=-1:t>1&&(t=1,r&&D+L>1e-4&&(c*=(Math.sqrt(k)/(D+L)-1)*a+1)),B=Math.acos(t)*i,b=D+L*t,w=L*Math.sin(B),N=Math.atan2(P*b-R*w,R*b+P*w)}else{b=h*L,w=u*L;const t=b*b,e=w*w,n=Math.atan2(P,R);E=e*D*D+t*k-t*e;const s=-2*e*D,r=e-t;if(T=s*s-4*r*E,T>=0){let t=Math.sqrt(T);s<0&&(t=-t),t=-(s+t)/2;const e=t/r,a=E/t,o=Math.abs(e)<Math.abs(a)?e:a;if(o*o<=k){M=Math.sqrt(k-o*o)*i,N=n-Math.atan2(M,o),B=Math.atan2(M/u,(o-D)/h);break t}}let a=fy.PI,o=D-b,l=o*o,c=0,d=0,f=D+b,p=f*f,m=0;E=-b*D/(t-e),E>=-1&&E<=1&&(E=Math.acos(E),I=b*Math.cos(E)+D,M=w*Math.sin(E),T=I*I+M*M,T<l&&(a=E,l=T,o=I,c=M),T>p&&(d=E,p=T,f=I,m=M)),k<=(l+p)/2?(N=n-Math.atan2(c*i,o),B=a*i):(N=n-Math.atan2(m*i,f),B=d*i)}const V=Math.atan2(x,v)*g;let U=t.arotation;N=(N-V)*fy.radDeg+p-U,N>180?N-=360:N<-180&&(N+=360),t.updateWorldTransformWith(o,l,U+N*a,c,t.ascaleY,0,0),U=e.arotation,B=((B+V)*fy.radDeg-e.ashearX)*g+m-U,B>180?B-=360:B<-180&&(B+=360),e.updateWorldTransformWith(v,x,U+B*a,e.ascaleX,e.ascaleY,e.ashearX,e.ashearY)}},iw=class{constructor(t){this.order=0,this.bones=new Array,this.bendDirection=1,this.compress=!1,this.stretch=!1,this.uniform=!1,this.mix=1,this.name=t}},rw=class{constructor(t){this.order=0,this.bones=new Array,this.name=t}};var aw=(t=>(t[t.Length=0]="Length",t[t.Fixed=1]="Fixed",t[t.Percent=2]="Percent",t))(aw||{});const ow=class{constructor(t,e){if(this.position=0,this.spacing=0,this.rotateMix=0,this.translateMix=0,this.spaces=new Array,this.positions=new Array,this.world=new Array,this.curves=new Array,this.lengths=new Array,this.segments=new Array,null==t)throw new Error("data cannot be null.");if(null==e)throw new Error("skeleton cannot be null.");this.data=t,this.bones=new Array;for(let n=0,s=t.bones.length;n<s;n++)this.bones.push(e.findBone(t.bones[n].name));this.target=e.findSlot(t.target.name),this.position=t.position,this.spacing=t.spacing,this.rotateMix=t.rotateMix,this.translateMix=t.translateMix}apply(){this.update()}update(){const t=this.target.getAttachment();if(!(t instanceof lb))return;const e=this.rotateMix,n=this.translateMix,s=e>0;if(!(n>0)&&!s)return;const i=this.data,r=i.spacingMode,a=r==aw.Length,o=i.rotateMode,l=o==Zx.Tangent,h=o==Zx.ChainScale,c=this.bones.length,u=l?c:c+1,d=this.bones,f=xy.setArraySize(this.spaces,u);let p=null;const m=this.spacing;if(h||a){h&&(p=xy.setArraySize(this.lengths,c));for(let t=0,e=u-1;t<e;){const e=d[t],n=e.data.length;if(n<ow.epsilon)h&&(p[t]=0),f[++t]=0;else{const s=n*e.matrix.a,i=n*e.matrix.b,r=Math.sqrt(s*s+i*i);h&&(p[t]=r),f[++t]=(a?n+m:m)*r/n}}}else for(let b=1;b<u;b++)f[b]=m;const g=this.computeWorldPositions(t,u,l,i.positionMode==Kx.Percent,r==aw.Percent);let v=g[0],x=g[1],y=i.offsetRotation,_=!1;if(0==y)_=o==Zx.Chain;else{_=!1;const t=this.target.bone.matrix;y*=t.a*t.d-t.b*t.c>0?fy.degRad:-fy.degRad}for(let b=0,w=3;b<c;b++,w+=3){const t=d[b],i=t.matrix;i.tx+=(v-i.tx)*n,i.ty+=(x-i.ty)*n;const r=g[w],a=g[w+1],o=r-v,c=a-x;if(h){const t=p[b];if(0!=t){const n=(Math.sqrt(o*o+c*c)/t-1)*e+1;i.a*=n,i.b*=n}}if(v=r,x=a,s){const n=i.a,s=i.c,r=i.b,a=i.d;let h=0,u=0,d=0;if(l&&(h=l?g[w-1]:0==f[b+1]?g[w+2]:Math.atan2(c,o)),h-=Math.atan2(r,n),_){u=Math.cos(h),d=Math.sin(h);const s=t.data.length;v+=(s*(u*n-d*r)-o)*e,x+=(s*(d*n+u*r)-c)*e}else h+=y;h>fy.PI?h-=fy.PI2:h<-fy.PI&&(h+=fy.PI2),h*=e,u=Math.cos(h),d=Math.sin(h),i.a=u*n-d*r,i.c=u*s-d*a,i.b=d*n+u*r,i.d=d*s+u*a}t.appliedValid=!1}}computeWorldPositions(t,e,n,s,i){const r=this.target;let a=this.position;const o=this.spaces,l=xy.setArraySize(this.positions,3*e+2);let h=null;const c=t.closed;let u=t.worldVerticesLength,d=u/6,f=ow.NONE;if(!t.constantSpeed){const p=t.lengths;d-=c?1:2;const m=p[d];if(s&&(a*=m),i)for(let t=0;t<e;t++)o[t]*=m;h=xy.setArraySize(this.world,8);for(let s=0,i=0,g=0;s<e;s++,i+=3){const e=o[s];a+=e;let v=a;if(c)v%=m,v<0&&(v+=m),g=0;else{if(v<0){f!=ow.BEFORE&&(f=ow.BEFORE,t.computeWorldVertices(r,2,4,h,0,2)),this.addBeforePosition(v,h,0,l,i);continue}if(v>m){f!=ow.AFTER&&(f=ow.AFTER,t.computeWorldVertices(r,u-6,4,h,0,2)),this.addAfterPosition(v-m,h,0,l,i);continue}}for(;;g++){const t=p[g];if(!(v>t)){if(0==g)v/=t;else{const e=p[g-1];v=(v-e)/(t-e)}break}}g!=f&&(f=g,c&&g==d?(t.computeWorldVertices(r,u-4,4,h,0,2),t.computeWorldVertices(r,0,4,h,4,2)):t.computeWorldVertices(r,6*g+2,8,h,0,2)),this.addCurvePosition(v,h[0],h[1],h[2],h[3],h[4],h[5],h[6],h[7],l,i,n||s>0&&0==e)}return l}c?(u+=2,h=xy.setArraySize(this.world,u),t.computeWorldVertices(r,2,u-4,h,0,2),t.computeWorldVertices(r,0,2,h,u-4,2),h[u-2]=h[0],h[u-1]=h[1]):(d--,u-=4,h=xy.setArraySize(this.world,u),t.computeWorldVertices(r,2,u,h,0,2));const p=xy.setArraySize(this.curves,d);let m=0,g=h[0],v=h[1],x=0,y=0,_=0,b=0,w=0,E=0,T=0,S=0,A=0,C=0,I=0,M=0,R=0,P=0;for(let O=0,D=2;O<d;O++,D+=6)x=h[D],y=h[D+1],_=h[D+2],b=h[D+3],w=h[D+4],E=h[D+5],T=.1875*(g-2*x+_),S=.1875*(v-2*y+b),A=.09375*(3*(x-_)-g+w),C=.09375*(3*(y-b)-v+E),I=2*T+A,M=2*S+C,R=.75*(x-g)+T+.16666667*A,P=.75*(y-v)+S+.16666667*C,m+=Math.sqrt(R*R+P*P),R+=I,P+=M,I+=A,M+=C,m+=Math.sqrt(R*R+P*P),R+=I,P+=M,m+=Math.sqrt(R*R+P*P),R+=I+A,P+=M+C,m+=Math.sqrt(R*R+P*P),p[O]=m,g=w,v=E;if(s&&(a*=m),i)for(let O=0;O<e;O++)o[O]*=m;const k=this.segments;let F=0;for(let O=0,D=0,L=0,N=0;O<e;O++,D+=3){const t=o[O];a+=t;let e=a;if(c)e%=m,e<0&&(e+=m),L=0;else{if(e<0){this.addBeforePosition(e,h,0,l,D);continue}if(e>m){this.addAfterPosition(e-m,h,u-4,l,D);continue}}for(;;L++){const t=p[L];if(!(e>t)){if(0==L)e/=t;else{const n=p[L-1];e=(e-n)/(t-n)}break}}if(L!=f){f=L;let t=6*L;for(g=h[t],v=h[t+1],x=h[t+2],y=h[t+3],_=h[t+4],b=h[t+5],w=h[t+6],E=h[t+7],T=.03*(g-2*x+_),S=.03*(v-2*y+b),A=.006*(3*(x-_)-g+w),C=.006*(3*(y-b)-v+E),I=2*T+A,M=2*S+C,R=.3*(x-g)+T+.16666667*A,P=.3*(y-v)+S+.16666667*C,F=Math.sqrt(R*R+P*P),k[0]=F,t=1;t<8;t++)R+=I,P+=M,I+=A,M+=C,F+=Math.sqrt(R*R+P*P),k[t]=F;R+=I,P+=M,F+=Math.sqrt(R*R+P*P),k[8]=F,R+=I+A,P+=M+C,F+=Math.sqrt(R*R+P*P),k[9]=F,N=0}for(e*=F;;N++){const t=k[N];if(!(e>t)){if(0==N)e/=t;else{const n=k[N-1];e=N+(e-n)/(t-n)}break}}this.addCurvePosition(.1*e,g,v,x,y,_,b,w,E,l,D,n||O>0&&0==t)}return l}addBeforePosition(t,e,n,s,i){const r=e[n],a=e[n+1],o=e[n+2]-r,l=e[n+3]-a,h=Math.atan2(l,o);s[i]=r+t*Math.cos(h),s[i+1]=a+t*Math.sin(h),s[i+2]=h}addAfterPosition(t,e,n,s,i){const r=e[n+2],a=e[n+3],o=r-e[n],l=a-e[n+1],h=Math.atan2(l,o);s[i]=r+t*Math.cos(h),s[i+1]=a+t*Math.sin(h),s[i+2]=h}addCurvePosition(t,e,n,s,i,r,a,o,l,h,c,u){(0==t||isNaN(t))&&(t=1e-4);const d=t*t,f=d*t,p=1-t,m=p*p,g=m*p,v=p*t,x=3*v,y=p*x,_=x*t,b=e*g+s*y+r*_+o*f,w=n*g+i*y+a*_+l*f;h[c]=b,h[c+1]=w,u&&(h[c+2]=Math.atan2(w-(n*m+i*v*2+a*d),b-(e*m+s*v*2+r*d)))}getOrder(){return this.data.order}};let lw=ow;lw.NONE=-1,lw.BEFORE=-2,lw.AFTER=-3,lw.epsilon=1e-5;let hw=class{constructor(t,e){if(this.rotateMix=0,this.translateMix=0,this.scaleMix=0,this.shearMix=0,this.temp=new _y,null==t)throw new Error("data cannot be null.");if(null==e)throw new Error("skeleton cannot be null.");this.data=t,this.rotateMix=t.rotateMix,this.translateMix=t.translateMix,this.scaleMix=t.scaleMix,this.shearMix=t.shearMix,this.bones=new Array;for(let n=0;n<t.bones.length;n++)this.bones.push(e.findBone(t.bones[n].name));this.target=e.findBone(t.target.name)}apply(){this.update()}update(){this.data.local?this.data.relative?this.applyRelativeLocal():this.applyAbsoluteLocal():this.data.relative?this.applyRelativeWorld():this.applyAbsoluteWorld()}applyAbsoluteWorld(){const t=this.rotateMix,e=this.translateMix,n=this.scaleMix,s=this.shearMix,i=this.target,r=i.matrix,a=r.a,o=r.c,l=r.b,h=r.d,c=a*h-o*l>0?fy.degRad:-fy.degRad,u=this.data.offsetRotation*c,d=this.data.offsetShearY*c,f=this.bones;for(let p=0,m=f.length;p<m;p++){const r=f[p];let c=!1;const m=r.matrix;if(0!=t){const e=m.a,n=m.c,s=m.b,i=m.d;let r=Math.atan2(l,a)-Math.atan2(s,e)+u;r>fy.PI?r-=fy.PI2:r<-fy.PI&&(r+=fy.PI2),r*=t;const o=Math.cos(r),h=Math.sin(r);m.a=o*e-h*s,m.c=o*n-h*i,m.b=h*e+o*s,m.d=h*n+o*i,c=!0}if(0!=e){const t=this.temp;i.localToWorld(t.set(this.data.offsetX,this.data.offsetY)),m.tx+=(t.x-m.tx)*e,m.ty+=(t.y-m.ty)*e,c=!0}if(n>0){let t=Math.sqrt(m.a*m.a+m.b*m.b),e=Math.sqrt(a*a+l*l);t>1e-5&&(t=(t+(e-t+this.data.offsetScaleX)*n)/t),m.a*=t,m.b*=t,t=Math.sqrt(m.c*m.c+m.d*m.d),e=Math.sqrt(o*o+h*h),t>1e-5&&(t=(t+(e-t+this.data.offsetScaleY)*n)/t),m.c*=t,m.d*=t,c=!0}if(s>0){const t=m.c,e=m.d,n=Math.atan2(e,t);let i=Math.atan2(h,o)-Math.atan2(l,a)-(n-Math.atan2(m.b,m.a));i>fy.PI?i-=fy.PI2:i<-fy.PI&&(i+=fy.PI2),i=n+(i+d)*s;const r=Math.sqrt(t*t+e*e);m.c=Math.cos(i)*r,m.d=Math.sin(i)*r,c=!0}c&&(r.appliedValid=!1)}}applyRelativeWorld(){const t=this.rotateMix,e=this.translateMix,n=this.scaleMix,s=this.shearMix,i=this.target,r=i.matrix,a=r.a,o=r.c,l=r.b,h=r.d,c=a*h-o*l>0?fy.degRad:-fy.degRad,u=this.data.offsetRotation*c,d=this.data.offsetShearY*c,f=this.bones;for(let p=0,m=f.length;p<m;p++){const r=f[p];let c=!1;const m=r.matrix;if(0!=t){const e=m.a,n=m.c,s=m.b,i=m.d;let r=Math.atan2(l,a)+u;r>fy.PI?r-=fy.PI2:r<-fy.PI&&(r+=fy.PI2),r*=t;const o=Math.cos(r),h=Math.sin(r);m.a=o*e-h*s,m.c=o*n-h*i,m.b=h*e+o*s,m.d=h*n+o*i,c=!0}if(0!=e){const t=this.temp;i.localToWorld(t.set(this.data.offsetX,this.data.offsetY)),m.tx+=t.x*e,m.ty+=t.y*e,c=!0}if(n>0){let t=(Math.sqrt(a*a+l*l)-1+this.data.offsetScaleX)*n+1;m.a*=t,m.b*=t,t=(Math.sqrt(o*o+h*h)-1+this.data.offsetScaleY)*n+1,m.c*=t,m.d*=t,c=!0}if(s>0){let t=Math.atan2(h,o)-Math.atan2(l,a);t>fy.PI?t-=fy.PI2:t<-fy.PI&&(t+=fy.PI2);const e=m.c,n=m.d;t=Math.atan2(n,e)+(t-fy.PI/2+d)*s;const i=Math.sqrt(e*e+n*n);m.c=Math.cos(t)*i,m.d=Math.sin(t)*i,c=!0}c&&(r.appliedValid=!1)}}applyAbsoluteLocal(){const t=this.rotateMix,e=this.translateMix,n=this.scaleMix,s=this.shearMix,i=this.target;i.appliedValid||i.updateAppliedTransform();const r=this.bones;for(let a=0,o=r.length;a<o;a++){const o=r[a];o.appliedValid||o.updateAppliedTransform();let l=o.arotation;if(0!=t){let e=i.arotation-l+this.data.offsetRotation;e-=360*(16384-(16384.499999999996-e/360|0)),l+=e*t}let h=o.ax,c=o.ay;0!=e&&(h+=(i.ax-h+this.data.offsetX)*e,c+=(i.ay-c+this.data.offsetY)*e);let u=o.ascaleX,d=o.ascaleY;n>0&&(u>1e-5&&(u=(u+(i.ascaleX-u+this.data.offsetScaleX)*n)/u),d>1e-5&&(d=(d+(i.ascaleY-d+this.data.offsetScaleY)*n)/d));const f=o.ashearY;if(s>0){let t=i.ashearY-f+this.data.offsetShearY;t-=360*(16384-(16384.499999999996-t/360|0)),o.shearY+=t*s}o.updateWorldTransformWith(h,c,l,u,d,o.ashearX,f)}}applyRelativeLocal(){const t=this.rotateMix,e=this.translateMix,n=this.scaleMix,s=this.shearMix,i=this.target;i.appliedValid||i.updateAppliedTransform();const r=this.bones;for(let a=0,o=r.length;a<o;a++){const o=r[a];o.appliedValid||o.updateAppliedTransform();let l=o.arotation;0!=t&&(l+=(i.arotation+this.data.offsetRotation)*t);let h=o.ax,c=o.ay;0!=e&&(h+=(i.ax+this.data.offsetX)*e,c+=(i.ay+this.data.offsetY)*e);let u=o.ascaleX,d=o.ascaleY;n>0&&(u>1e-5&&(u*=(i.ascaleX-1+this.data.offsetScaleX)*n+1),d>1e-5&&(d*=(i.ascaleY-1+this.data.offsetScaleY)*n+1));let f=o.ashearY;s>0&&(f+=(i.ashearY+this.data.offsetShearY)*s),o.updateWorldTransformWith(h,c,l,u,d,o.ashearX,f)}}getOrder(){return this.data.order}};const cw=class{constructor(t){if(this._updateCache=new Array,this.updateCacheReset=new Array,this.time=0,this.scaleX=1,this.scaleY=1,this.x=0,this.y=0,null==t)throw new Error("data cannot be null.");this.data=t,this.bones=new Array;for(let e=0;e<t.bones.length;e++){const n=t.bones[e];let s;if(null==n.parent)s=new Jb(n,this,null);else{const t=this.bones[n.parent.index];s=new Jb(n,this,t),t.children.push(s)}this.bones.push(s)}this.slots=new Array,this.drawOrder=new Array;for(let e=0;e<t.slots.length;e++){const n=t.slots[e],s=this.bones[n.boneData.index],i=new cb(n,s);this.slots.push(i),this.drawOrder.push(i)}this.ikConstraints=new Array;for(let e=0;e<t.ikConstraints.length;e++){const n=t.ikConstraints[e];this.ikConstraints.push(new sw(n,this))}this.transformConstraints=new Array;for(let e=0;e<t.transformConstraints.length;e++){const n=t.transformConstraints[e];this.transformConstraints.push(new hw(n,this))}this.pathConstraints=new Array;for(let e=0;e<t.pathConstraints.length;e++){const n=t.pathConstraints[e];this.pathConstraints.push(new lw(n,this))}this.color=new uy(1,1,1,1),this.updateCache()}updateCache(){this._updateCache.length=0,this.updateCacheReset.length=0;const t=this.bones;for(let l=0,h=t.length;l<h;l++)t[l].sorted=!1;const e=this.ikConstraints,n=this.transformConstraints,s=this.pathConstraints,i=e.length,r=n.length,a=s.length,o=i+r+a;t:for(let l=0;l<o;l++){for(let t=0;t<i;t++){const n=e[t];if(n.data.order==l){this.sortIkConstraint(n);continue t}}for(let t=0;t<r;t++){const e=n[t];if(e.data.order==l){this.sortTransformConstraint(e);continue t}}for(let t=0;t<a;t++){const e=s[t];if(e.data.order==l){this.sortPathConstraint(e);continue t}}}for(let l=0,h=t.length;l<h;l++)this.sortBone(t[l])}sortIkConstraint(t){const e=t.target;this.sortBone(e);const n=t.bones,s=n[0];if(this.sortBone(s),n.length>1){const t=n[n.length-1];this._updateCache.indexOf(t)>-1||this.updateCacheReset.push(t)}this._updateCache.push(t),this.sortReset(s.children),n[n.length-1].sorted=!0}sortPathConstraint(t){const e=t.target,n=e.data.index,s=e.bone;null!=this.skin&&this.sortPathConstraintAttachment(this.skin,n,s),null!=this.data.defaultSkin&&this.data.defaultSkin!=this.skin&&this.sortPathConstraintAttachment(this.data.defaultSkin,n,s);for(let o=0,l=this.data.skins.length;o<l;o++)this.sortPathConstraintAttachment(this.data.skins[o],n,s);const i=e.getAttachment();i instanceof lb&&this.sortPathConstraintAttachmentWith(i,s);const r=t.bones,a=r.length;for(let o=0;o<a;o++)this.sortBone(r[o]);this._updateCache.push(t);for(let o=0;o<a;o++)this.sortReset(r[o].children);for(let o=0;o<a;o++)r[o].sorted=!0}sortTransformConstraint(t){this.sortBone(t.target);const e=t.bones,n=e.length;if(t.data.local)for(let s=0;s<n;s++){const t=e[s];this.sortBone(t.parent),this._updateCache.indexOf(t)>-1||this.updateCacheReset.push(t)}else for(let s=0;s<n;s++)this.sortBone(e[s]);this._updateCache.push(t);for(let s=0;s<n;s++)this.sortReset(e[s].children);for(let s=0;s<n;s++)e[s].sorted=!0}sortPathConstraintAttachment(t,e,n){const s=t.attachments[e];if(s)for(const i in s)this.sortPathConstraintAttachmentWith(s[i],n)}sortPathConstraintAttachmentWith(t,e){if(!(t instanceof lb))return;const n=t.bones;if(null==n)this.sortBone(e);else{const t=this.bones;let e=0;for(;e<n.length;){const s=n[e++];for(let i=e+s;e<i;e++){const s=n[e];this.sortBone(t[s])}}}}sortBone(t){if(t.sorted)return;const e=t.parent;null!=e&&this.sortBone(e),t.sorted=!0,this._updateCache.push(t)}sortReset(t){for(let e=0,n=t.length;e<n;e++){const n=t[e];n.sorted&&this.sortReset(n.children),n.sorted=!1}}updateWorldTransform(){const t=this.updateCacheReset;for(let n=0,s=t.length;n<s;n++){const e=t[n];e.ax=e.x,e.ay=e.y,e.arotation=e.rotation,e.ascaleX=e.scaleX,e.ascaleY=e.scaleY,e.ashearX=e.shearX,e.ashearY=e.shearY,e.appliedValid=!0}const e=this._updateCache;for(let n=0,s=e.length;n<s;n++)e[n].update()}setToSetupPose(){this.setBonesToSetupPose(),this.setSlotsToSetupPose()}setBonesToSetupPose(){const t=this.bones;for(let i=0,r=t.length;i<r;i++)t[i].setToSetupPose();const e=this.ikConstraints;for(let i=0,r=e.length;i<r;i++){const t=e[i];t.bendDirection=t.data.bendDirection,t.mix=t.data.mix}const n=this.transformConstraints;for(let i=0,r=n.length;i<r;i++){const t=n[i],e=t.data;t.rotateMix=e.rotateMix,t.translateMix=e.translateMix,t.scaleMix=e.scaleMix,t.shearMix=e.shearMix}const s=this.pathConstraints;for(let i=0,r=s.length;i<r;i++){const t=s[i],e=t.data;t.position=e.position,t.spacing=e.spacing,t.rotateMix=e.rotateMix,t.translateMix=e.translateMix}}setSlotsToSetupPose(){const t=this.slots;xy.arrayCopy(t,0,this.drawOrder,0,t.length);for(let e=0,n=t.length;e<n;e++)t[e].setToSetupPose()}getRootBone(){return 0==this.bones.length?null:this.bones[0]}findBone(t){if(null==t)throw new Error("boneName cannot be null.");const e=this.bones;for(let n=0,s=e.length;n<s;n++){const s=e[n];if(s.data.name==t)return s}return null}findBoneIndex(t){if(null==t)throw new Error("boneName cannot be null.");const e=this.bones;for(let n=0,s=e.length;n<s;n++)if(e[n].data.name==t)return n;return-1}findSlot(t){if(null==t)throw new Error("slotName cannot be null.");const e=this.slots;for(let n=0,s=e.length;n<s;n++){const s=e[n];if(s.data.name==t)return s}return null}findSlotIndex(t){if(null==t)throw new Error("slotName cannot be null.");const e=this.slots;for(let n=0,s=e.length;n<s;n++)if(e[n].data.name==t)return n;return-1}setSkinByName(t){const e=this.data.findSkin(t);if(null==e)throw new Error(`Skin not found: ${t}`);this.setSkin(e)}setSkin(t){if(null!=t)if(null!=this.skin)t.attachAll(this,this.skin);else{const e=this.slots;for(let n=0,s=e.length;n<s;n++){const s=e[n],i=s.data.attachmentName;if(null!=i){const e=t.getAttachment(n,i);null!=e&&s.setAttachment(e)}}}this.skin=t}getAttachmentByName(t,e){return this.getAttachment(this.data.findSlotIndex(t),e)}getAttachment(t,e){if(null==e)throw new Error("attachmentName cannot be null.");if(null!=this.skin){const n=this.skin.getAttachment(t,e);if(null!=n)return n}return null!=this.data.defaultSkin?this.data.defaultSkin.getAttachment(t,e):null}setAttachment(t,e){if(null==t)throw new Error("slotName cannot be null.");const n=this.slots;for(let s=0,i=n.length;s<i;s++){const i=n[s];if(i.data.name==t){let n=null;if(null!=e&&(n=this.getAttachment(s,e),null==n))throw new Error(`Attachment not found: ${e}, for slot: ${t}`);return void i.setAttachment(n)}}throw new Error(`Slot not found: ${t}`)}findIkConstraint(t){if(null==t)throw new Error("constraintName cannot be null.");const e=this.ikConstraints;for(let n=0,s=e.length;n<s;n++){const s=e[n];if(s.data.name==t)return s}return null}findTransformConstraint(t){if(null==t)throw new Error("constraintName cannot be null.");const e=this.transformConstraints;for(let n=0,s=e.length;n<s;n++){const s=e[n];if(s.data.name==t)return s}return null}findPathConstraint(t){if(null==t)throw new Error("constraintName cannot be null.");const e=this.pathConstraints;for(let n=0,s=e.length;n<s;n++){const s=e[n];if(s.data.name==t)return s}return null}getBounds(t,e,n){if(null==t)throw new Error("offset cannot be null.");if(null==e)throw new Error("size cannot be null.");const s=this.drawOrder;let i=Number.POSITIVE_INFINITY,r=Number.POSITIVE_INFINITY,a=Number.NEGATIVE_INFINITY,o=Number.NEGATIVE_INFINITY;for(let l=0,h=s.length;l<h;l++){const t=s[l];let e=0,h=null;const c=t.getAttachment();if(c instanceof db)e=8,h=xy.setArraySize(n,e,0),c.computeWorldVertices(t.bone,h,0,2);else if(c instanceof ob){const s=c;e=s.worldVerticesLength,h=xy.setArraySize(n,e,0),s.computeWorldVertices(t,0,e,h,0,2)}if(null!=h)for(let n=0,s=h.length;n<s;n+=2){const t=h[n],e=h[n+1];i=Math.min(i,t),r=Math.min(r,e),a=Math.max(a,t),o=Math.max(o,e)}}t.set(i,r),e.set(a-i,o-r)}update(t){this.time+=t}get flipX(){return-1==this.scaleX}set flipX(t){cw.deprecatedWarning1||(cw.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: `Skeleton.flipX/flipY` was deprecated, please use scaleX/scaleY")),this.scaleX=t?1:-1}get flipY(){return-1==this.scaleY}set flipY(t){cw.deprecatedWarning1||(cw.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: `Skeleton.flipX/flipY` was deprecated, please use scaleX/scaleY")),this.scaleY=t?1:-1}};let uw=cw;uw.deprecatedWarning1=!1;let dw=class{constructor(){this.bones=new Array,this.slots=new Array,this.skins=new Array,this.events=new Array,this.animations=new Array,this.ikConstraints=new Array,this.transformConstraints=new Array,this.pathConstraints=new Array,this.fps=0}findBone(t){if(null==t)throw new Error("boneName cannot be null.");const e=this.bones;for(let n=0,s=e.length;n<s;n++){const s=e[n];if(s.name==t)return s}return null}findBoneIndex(t){if(null==t)throw new Error("boneName cannot be null.");const e=this.bones;for(let n=0,s=e.length;n<s;n++)if(e[n].name==t)return n;return-1}findSlot(t){if(null==t)throw new Error("slotName cannot be null.");const e=this.slots;for(let n=0,s=e.length;n<s;n++){const s=e[n];if(s.name==t)return s}return null}findSlotIndex(t){if(null==t)throw new Error("slotName cannot be null.");const e=this.slots;for(let n=0,s=e.length;n<s;n++)if(e[n].name==t)return n;return-1}findSkin(t){if(null==t)throw new Error("skinName cannot be null.");const e=this.skins;for(let n=0,s=e.length;n<s;n++){const s=e[n];if(s.name==t)return s}return null}findEvent(t){if(null==t)throw new Error("eventDataName cannot be null.");const e=this.events;for(let n=0,s=e.length;n<s;n++){const s=e[n];if(s.name==t)return s}return null}findAnimation(t){if(null==t)throw new Error("animationName cannot be null.");const e=this.animations;for(let n=0,s=e.length;n<s;n++){const s=e[n];if(s.name==t)return s}return null}findIkConstraint(t){if(null==t)throw new Error("constraintName cannot be null.");const e=this.ikConstraints;for(let n=0,s=e.length;n<s;n++){const s=e[n];if(s.name==t)return s}return null}findTransformConstraint(t){if(null==t)throw new Error("constraintName cannot be null.");const e=this.transformConstraints;for(let n=0,s=e.length;n<s;n++){const s=e[n];if(s.name==t)return s}return null}findPathConstraint(t){if(null==t)throw new Error("constraintName cannot be null.");const e=this.pathConstraints;for(let n=0,s=e.length;n<s;n++){const s=e[n];if(s.name==t)return s}return null}findPathConstraintIndex(t){if(null==t)throw new Error("pathConstraintName cannot be null.");const e=this.pathConstraints;for(let n=0,s=e.length;n<s;n++)if(e[n].name==t)return n;return-1}},fw=class{constructor(t,e,n){if(this.color=new uy(1,1,1,1),t<0)throw new Error("index must be >= 0.");if(null==e)throw new Error("name cannot be null.");if(null==n)throw new Error("boneData cannot be null.");this.index=t,this.name=e,this.boneData=n}},pw=class{constructor(t){if(this.order=0,this.bones=new Array,this.rotateMix=0,this.translateMix=0,this.scaleMix=0,this.shearMix=0,this.offsetRotation=0,this.offsetX=0,this.offsetY=0,this.offsetScaleX=0,this.offsetScaleY=0,this.offsetShearY=0,this.relative=!1,this.local=!1,null==t)throw new Error("name cannot be null.");this.name=t}},mw=class{constructor(t){if(this.attachments=new Array,null==t)throw new Error("name cannot be null.");this.name=t}addAttachment(t,e,n){if(null==n)throw new Error("attachment cannot be null.");const s=this.attachments;t>=s.length&&(s.length=t+1),s[t]||(s[t]={}),s[t][e]=n}getAttachment(t,e){const n=this.attachments[t];return n?n[e]:null}attachAll(t,e){let n=0;for(let s=0;s<t.slots.length;s++){const i=t.slots[s],r=i.getAttachment();if(r&&n<e.attachments.length){const t=e.attachments[n];for(const e in t){if(r==t[e]){const t=this.getAttachment(n,e);null!=t&&i.setAttachment(t);break}}}n++}}},gw=class t{constructor(t){this.scale=1,this.linkedMeshes=new Array,this.attachmentLoader=t}readSkeletonData(e){const n=this.scale,s=new dw,i="string"==typeof e?JSON.parse(e):e,r=i.skeleton;if(null!=r&&(s.hash=r.hash,s.version=r.spine,s.width=r.width,s.height=r.height,s.fps=r.fps,s.imagesPath=r.images),i.bones)for(let a=0;a<i.bones.length;a++){const e=i.bones[a];let r=null;const o=this.getValue(e,"parent",null);if(null!=o&&(r=s.findBone(o),null==r))throw new Error(`Parent bone not found: ${o}`);const l=new tw(s.bones.length,e.name,r);l.length=this.getValue(e,"length",0)*n,l.x=this.getValue(e,"x",0)*n,l.y=this.getValue(e,"y",0)*n,l.rotation=this.getValue(e,"rotation",0),l.scaleX=this.getValue(e,"scaleX",1),l.scaleY=this.getValue(e,"scaleY",1),l.shearX=this.getValue(e,"shearX",0),l.shearY=this.getValue(e,"shearY",0),l.transformMode=t.transformModeFromString(this.getValue(e,"transform","normal")),s.bones.push(l)}if(i.slots)for(let a=0;a<i.slots.length;a++){const e=i.slots[a],n=e.name,r=e.bone,o=s.findBone(r);if(null==o)throw new Error(`Slot bone not found: ${r}`);const l=new fw(s.slots.length,n,o),h=this.getValue(e,"color",null);null!=h&&l.color.setFromString(h);const c=this.getValue(e,"dark",null);null!=c&&(l.darkColor=new uy(1,1,1,1),l.darkColor.setFromString(c)),l.attachmentName=this.getValue(e,"attachment",null),l.blendMode=t.blendModeFromString(this.getValue(e,"blend","normal")),s.slots.push(l)}if(i.ik)for(let t=0;t<i.ik.length;t++){const e=i.ik[t],n=new iw(e.name);n.order=this.getValue(e,"order",0);for(let t=0;t<e.bones.length;t++){const i=e.bones[t],r=s.findBone(i);if(null==r)throw new Error(`IK bone not found: ${i}`);n.bones.push(r)}const r=e.target;if(n.target=s.findBone(r),null==n.target)throw new Error(`IK target bone not found: ${r}`);n.bendDirection=this.getValue(e,"bendPositive",!0)?1:-1,n.mix=this.getValue(e,"mix",1),s.ikConstraints.push(n)}if(i.transform)for(let t=0;t<i.transform.length;t++){const e=i.transform[t],r=new pw(e.name);r.order=this.getValue(e,"order",0);for(let t=0;t<e.bones.length;t++){const n=e.bones[t],i=s.findBone(n);if(null==i)throw new Error(`Transform constraint bone not found: ${n}`);r.bones.push(i)}const a=e.target;if(r.target=s.findBone(a),null==r.target)throw new Error(`Transform constraint target bone not found: ${a}`);r.local=this.getValue(e,"local",!1),r.relative=this.getValue(e,"relative",!1),r.offsetRotation=this.getValue(e,"rotation",0),r.offsetX=this.getValue(e,"x",0)*n,r.offsetY=this.getValue(e,"y",0)*n,r.offsetScaleX=this.getValue(e,"scaleX",0),r.offsetScaleY=this.getValue(e,"scaleY",0),r.offsetShearY=this.getValue(e,"shearY",0),r.rotateMix=this.getValue(e,"rotateMix",1),r.translateMix=this.getValue(e,"translateMix",1),r.scaleMix=this.getValue(e,"scaleMix",1),r.shearMix=this.getValue(e,"shearMix",1),s.transformConstraints.push(r)}if(i.path)for(let a=0;a<i.path.length;a++){const e=i.path[a],r=new rw(e.name);r.order=this.getValue(e,"order",0);for(let t=0;t<e.bones.length;t++){const n=e.bones[t],i=s.findBone(n);if(null==i)throw new Error(`Transform constraint bone not found: ${n}`);r.bones.push(i)}const o=e.target;if(r.target=s.findSlot(o),null==r.target)throw new Error(`Path target slot not found: ${o}`);r.positionMode=t.positionModeFromString(this.getValue(e,"positionMode","percent")),r.spacingMode=t.spacingModeFromString(this.getValue(e,"spacingMode","length")),r.rotateMode=t.rotateModeFromString(this.getValue(e,"rotateMode","tangent")),r.offsetRotation=this.getValue(e,"rotation",0),r.position=this.getValue(e,"position",0),r.positionMode==Kx.Fixed&&(r.position*=n),r.spacing=this.getValue(e,"spacing",0),r.spacingMode!=aw.Length&&r.spacingMode!=aw.Fixed||(r.spacing*=n),r.rotateMix=this.getValue(e,"rotateMix",1),r.translateMix=this.getValue(e,"translateMix",1),s.pathConstraints.push(r)}if(i.skins)for(const t in i.skins){const e=i.skins[t],n=new mw(t);for(const t in e){const i=s.findSlotIndex(t);if(-1==i)throw new Error(`Slot not found: ${t}`);const r=e[t];for(const t in r){const e=this.readAttachment(r[t],n,i,t,s);null!=e&&n.addAttachment(i,t,e)}}s.skins.push(n),"default"==n.name&&(s.defaultSkin=n)}for(let t=0,a=this.linkedMeshes.length;t<a;t++){const e=this.linkedMeshes[t],n=null==e.skin?s.defaultSkin:s.findSkin(e.skin);if(null==n)throw new Error(`Skin not found: ${e.skin}`);const i=n.getAttachment(e.slotIndex,e.parent);if(null==i)throw new Error(`Parent mesh not found: ${e.parent}`);e.mesh.setParentMesh(i)}if(this.linkedMeshes.length=0,i.events)for(const t in i.events){const e=i.events[t],n=new nw(t);n.intValue=this.getValue(e,"int",0),n.floatValue=this.getValue(e,"float",0),n.stringValue=this.getValue(e,"string",""),n.audioPath=this.getValue(e,"audio",null),null!=n.audioPath&&(n.volume=this.getValue(e,"volume",1),n.balance=this.getValue(e,"balance",0)),s.events.push(n)}if(i.animations)for(const t in i.animations){const e=i.animations[t];this.readAnimation(e,t,s)}return s}readAttachment(t,e,n,s,i){const r=this.scale;s=this.getValue(t,"name",s);switch(this.getValue(t,"type","region")){case"region":{const n=this.getValue(t,"path",s),i=this.attachmentLoader.newRegionAttachment(e,s,n);if(null==i)return null;i.path=n,i.x=this.getValue(t,"x",0)*r,i.y=this.getValue(t,"y",0)*r,i.scaleX=this.getValue(t,"scaleX",1),i.scaleY=this.getValue(t,"scaleY",1),i.rotation=this.getValue(t,"rotation",0),i.width=t.width*r,i.height=t.height*r;const a=this.getValue(t,"color",null);return null!=a&&i.color.setFromString(a),i}case"boundingbox":{const n=this.attachmentLoader.newBoundingBoxAttachment(e,s);if(null==n)return null;this.readVertices(t,n,t.vertexCount<<1);const i=this.getValue(t,"color",null);return null!=i&&n.color.setFromString(i),n}case"mesh":case"linkedmesh":{const i=this.getValue(t,"path",s),r=this.attachmentLoader.newMeshAttachment(e,s,i);if(null==r)return null;r.path=i;const a=this.getValue(t,"color",null);null!=a&&r.color.setFromString(a);const o=this.getValue(t,"parent",null);if(null!=o)return r.inheritDeform=this.getValue(t,"deform",!0),this.linkedMeshes.push(new vw(r,this.getValue(t,"skin",null),n,o)),r;const l=t.uvs;return this.readVertices(t,r,l.length),r.triangles=t.triangles,r.regionUVs=new Float32Array(l),r.hullLength=2*this.getValue(t,"hull",0),r}case"path":{const n=this.attachmentLoader.newPathAttachment(e,s);if(null==n)return null;n.closed=this.getValue(t,"closed",!1),n.constantSpeed=this.getValue(t,"constantSpeed",!0);const i=t.vertexCount;this.readVertices(t,n,i<<1);const a=xy.newArray(i/3,0);for(let e=0;e<t.lengths.length;e++)a[e]=t.lengths[e]*r;n.lengths=a;const o=this.getValue(t,"color",null);return null!=o&&n.color.setFromString(o),n}case"point":{const n=this.attachmentLoader.newPointAttachment(e,s);if(null==n)return null;n.x=this.getValue(t,"x",0)*r,n.y=this.getValue(t,"y",0)*r,n.rotation=this.getValue(t,"rotation",0);const i=this.getValue(t,"color",null);return null!=i&&n.color.setFromString(i),n}case"clipping":{const n=this.attachmentLoader.newClippingAttachment(e,s);if(null==n)return null;const r=this.getValue(t,"end",null);if(null!=r){const t=i.findSlot(r);if(null==t)throw new Error(`Clipping end slot not found: ${r}`);n.endSlot=t}const a=t.vertexCount;this.readVertices(t,n,a<<1);const o=this.getValue(t,"color",null);return null!=o&&n.color.setFromString(o),n}}return null}readVertices(t,e,n){const s=this.scale;e.worldVerticesLength=n;const i=t.vertices;if(n==i.length){const t=xy.toFloatArray(i);if(1!=s)for(let e=0,n=i.length;e<n;e++)t[e]*=s;return void(e.vertices=t)}const r=new Array,a=new Array;for(let o=0,l=i.length;o<l;){const t=i[o++];a.push(t);for(let e=o+4*t;o<e;o+=4)a.push(i[o]),r.push(i[o+1]*s),r.push(i[o+2]*s),r.push(i[o+3])}e.bones=a,e.vertices=xy.toFloatArray(r)}readAnimation(t,e,n){const s=this.scale,i=new Array;let r=0;if(t.slots)for(const o in t.slots){const e=t.slots[o],s=n.findSlotIndex(o);if(-1==s)throw new Error(`Slot not found: ${o}`);for(const t in e){const n=e[t];if("attachment"==t){const t=new Mb(n.length);t.slotIndex=s;let e=0;for(let s=0;s<n.length;s++){const i=n[s];t.setFrame(e++,i.time,i.name)}i.push(t),r=Math.max(r,t.frames[t.getFrameCount()-1])}else if("color"==t){const t=new Ab(n.length);t.slotIndex=s;let e=0;for(let s=0;s<n.length;s++){const i=n[s],r=new uy;r.setFromString(i.color||"ffffffff"),t.setFrame(e,i.time,r.r,r.g,r.b,r.a),this.readCurve(i,t,e),e++}i.push(t),r=Math.max(r,t.frames[(t.getFrameCount()-1)*Ab.ENTRIES])}else{if("twoColor"!=t)throw new Error(`Invalid timeline type for a slot: ${t} (${o})`);{const t=new Ib(n.length);t.slotIndex=s;let e=0;for(let s=0;s<n.length;s++){const i=n[s],r=new uy,a=new uy;r.setFromString(i.light),a.setFromString(i.dark),t.setFrame(e,i.time,r.r,r.g,r.b,r.a,a.r,a.g,a.b),this.readCurve(i,t,e),e++}i.push(t),r=Math.max(r,t.frames[(t.getFrameCount()-1)*Ib.ENTRIES])}}}}if(t.bones)for(const o in t.bones){const e=t.bones[o],a=n.findBoneIndex(o);if(-1==a)throw new Error(`Bone not found: ${o}`);for(const t in e){const n=e[t];if("rotate"===t){const t=new _b(n.length);t.boneIndex=a;let e=0;for(let s=0;s<n.length;s++){const i=n[s];t.setFrame(e,i.time,i.angle),this.readCurve(i,t,e),e++}i.push(t),r=Math.max(r,t.frames[(t.getFrameCount()-1)*_b.ENTRIES])}else{if("translate"!==t&&"scale"!==t&&"shear"!==t)throw new Error(`Invalid timeline type for a bone: ${t} (${o})`);{let e=null,o=1;"scale"===t?e=new Eb(n.length):"shear"===t?e=new Tb(n.length):(e=new wb(n.length),o=s),e.boneIndex=a;let l=0;for(let t=0;t<n.length;t++){const s=n[t],i=this.getValue(s,"x",0),r=this.getValue(s,"y",0);e.setFrame(l,s.time,i*o,r*o),this.readCurve(s,e,l),l++}i.push(e),r=Math.max(r,e.frames[(e.getFrameCount()-1)*wb.ENTRIES])}}}}if(t.ik)for(const o in t.ik){const e=t.ik[o],s=n.findIkConstraint(o),a=new Db(e.length);a.ikConstraintIndex=n.ikConstraints.indexOf(s);let l=0;for(let t=0;t<e.length;t++){const n=e[t];a.setFrame(l,n.time,this.getValue(n,"mix",1),this.getValue(n,"bendPositive",!0)?1:-1,this.getValue(n,"compress",!1),this.getValue(n,"stretch",!1)),this.readCurve(n,a,l),l++}i.push(a),r=Math.max(r,a.frames[(a.getFrameCount()-1)*Db.ENTRIES])}if(t.transform)for(const o in t.transform){const e=t.transform[o],s=n.findTransformConstraint(o),a=new Nb(e.length);a.transformConstraintIndex=n.transformConstraints.indexOf(s);let l=0;for(let t=0;t<e.length;t++){const n=e[t];a.setFrame(l,n.time,this.getValue(n,"rotateMix",1),this.getValue(n,"translateMix",1),this.getValue(n,"scaleMix",1),this.getValue(n,"shearMix",1)),this.readCurve(n,a,l),l++}i.push(a),r=Math.max(r,a.frames[(a.getFrameCount()-1)*Nb.ENTRIES])}if(t.paths)for(const o in t.paths){const e=t.paths[o],a=n.findPathConstraintIndex(o);if(-1==a)throw new Error(`Path constraint not found: ${o}`);const l=n.pathConstraints[a];for(const t in e){const n=e[t];if("position"===t||"spacing"===t){let e=null,o=1;"spacing"===t?(e=new Ub(n.length),l.spacingMode!=aw.Length&&l.spacingMode!=aw.Fixed||(o=s)):(e=new Vb(n.length),l.positionMode==Kx.Fixed&&(o=s)),e.pathConstraintIndex=a;let h=0;for(let s=0;s<n.length;s++){const i=n[s];e.setFrame(h,i.time,this.getValue(i,t,0)*o),this.readCurve(i,e,h),h++}i.push(e),r=Math.max(r,e.frames[(e.getFrameCount()-1)*Vb.ENTRIES])}else if("mix"===t){const t=new Yb(n.length);t.pathConstraintIndex=a;let e=0;for(let s=0;s<n.length;s++){const i=n[s];t.setFrame(e,i.time,this.getValue(i,"rotateMix",1),this.getValue(i,"translateMix",1)),this.readCurve(i,t,e),e++}i.push(t),r=Math.max(r,t.frames[(t.getFrameCount()-1)*Yb.ENTRIES])}}}if(t.deform)for(const o in t.deform){const e=t.deform[o],a=n.findSkin(o);if(null!=a)for(const t in e){const o=e[t],l=n.findSlotIndex(t);if(-1==l)throw new Error(`Slot not found: ${o.name}`);for(const t in o){const e=o[t],n=a.getAttachment(l,t);if(null==n)throw new Error(`Deform attachment not found: ${e.name}`);const h=null!=n.bones,c=n.vertices,u=h?c.length/3*2:c.length,d=new Pb(e.length);d.slotIndex=l,d.attachment=n;let f=0;for(let t=0;t<e.length;t++){const n=e[t];let i;const r=this.getValue(n,"vertices",null);if(null==r)i=h?xy.newFloatArray(u):c;else{i=xy.newFloatArray(u);const t=this.getValue(n,"offset",0);if(xy.arrayCopy(r,0,i,t,r.length),1!=s)for(let e=t,n=e+r.length;e<n;e++)i[e]*=s;if(!h)for(let e=0;e<u;e++)i[e]+=c[e]}d.setFrame(f,n.time,i),this.readCurve(n,d,f),f++}i.push(d),r=Math.max(r,d.frames[d.getFrameCount()-1])}}}let a=t.drawOrder;if(null==a&&(a=t.draworder),null!=a){const t=new Fb(a.length),e=n.slots.length;let s=0;for(let i=0;i<a.length;i++){const r=a[i];let o=null;const l=this.getValue(r,"offsets",null);if(null!=l){o=xy.newArray(e,-1);const t=xy.newArray(e-l.length,0);let s=0,i=0;for(let e=0;e<l.length;e++){const r=l[e],a=n.findSlotIndex(r.slot);if(-1==a)throw new Error(`Slot not found: ${r.slot}`);for(;s!=a;)t[i++]=s++;o[s+r.offset]=s++}for(;s<e;)t[i++]=s++;for(let n=e-1;n>=0;n--)-1==o[n]&&(o[n]=t[--i])}t.setFrame(s++,r.time,o)}i.push(t),r=Math.max(r,t.frames[t.getFrameCount()-1])}if(t.events){const e=new kb(t.events.length);let s=0;for(let i=0;i<t.events.length;i++){const r=t.events[i],a=n.findEvent(r.name);if(null==a)throw new Error(`Event not found: ${r.name}`);const o=new ew(xy.toSinglePrecision(r.time),a);o.intValue=this.getValue(r,"int",a.intValue),o.floatValue=this.getValue(r,"float",a.floatValue),o.stringValue=this.getValue(r,"string",a.stringValue),null!=o.data.audioPath&&(o.volume=this.getValue(r,"volume",1),o.balance=this.getValue(r,"balance",0)),e.setFrame(s++,o)}i.push(e),r=Math.max(r,e.frames[e.getFrameCount()-1])}if(isNaN(r))throw new Error("Error while parsing animation, duration is NaN");n.animations.push(new mb(e,i,r))}readCurve(t,e,n){if(t.curve)if("stepped"===t.curve)e.setStepped(n);else if("[object Array]"===Object.prototype.toString.call(t.curve)){const s=t.curve;e.setCurve(n,s[0],s[1],s[2],s[3])}}getValue(t,e,n){return void 0!==t[e]?t[e]:n}static blendModeFromString(t){if("normal"==(t=t.toLowerCase()))return Ir.NORMAL;if("additive"==t)return Ir.ADD;if("multiply"==t)return Ir.MULTIPLY;if("screen"==t)return Ir.SCREEN;throw new Error(`Unknown blend mode: ${t}`)}static positionModeFromString(t){if("fixed"==(t=t.toLowerCase()))return Kx.Fixed;if("percent"==t)return Kx.Percent;throw new Error(`Unknown position mode: ${t}`)}static spacingModeFromString(t){if("length"==(t=t.toLowerCase()))return aw.Length;if("fixed"==t)return aw.Fixed;if("percent"==t)return aw.Percent;throw new Error(`Unknown position mode: ${t}`)}static rotateModeFromString(t){if("tangent"==(t=t.toLowerCase()))return Zx.Tangent;if("chain"==t)return Zx.Chain;if("chainscale"==t)return Zx.ChainScale;throw new Error(`Unknown rotate mode: ${t}`)}static transformModeFromString(t){if("normal"==(t=t.toLowerCase()))return Qx.Normal;if("onlytranslation"==t)return Qx.OnlyTranslation;if("norotationorreflection"==t)return Qx.NoRotationOrReflection;if("noscale"==t)return Qx.NoScale;if("noscaleorreflection"==t)return Qx.NoScaleOrReflection;throw new Error(`Unknown transform mode: ${t}`)}},vw=class{constructor(t,e,n,s){this.mesh=t,this.skin=e,this.slotIndex=n,this.parent=s}};const xw=Object.freeze(Object.defineProperty({__proto__:null,Animation:mb,AnimationState:zb,AnimationStateAdapter2:class{start(t){}interrupt(t){}end(t){}dispose(t){}complete(t){}event(t,e){}},AnimationStateData:Zb,AtlasAttachmentLoader:Qb,Attachment:nb,AttachmentTimeline:Mb,Bone:Jb,BoneData:tw,BoundingBoxAttachment:rb,ClippingAttachment:ab,ColorTimeline:Ab,CurveTimeline:xb,DeformTimeline:Pb,DrawOrderTimeline:Fb,Event:ew,EventData:nw,EventQueue:$b,EventTimeline:kb,EventType:qb,IkConstraint:sw,IkConstraintData:iw,IkConstraintTimeline:Db,JitterEffect:class{constructor(t,e){this.jitterX=0,this.jitterY=0,this.jitterX=t,this.jitterY=e}begin(t){}transform(t,e,n,s){t.x+=fy.randomTriangular(-this.jitterX,this.jitterY),t.y+=fy.randomTriangular(-this.jitterX,this.jitterY)}end(){}},MeshAttachment:ob,PathAttachment:lb,PathConstraint:lw,PathConstraintData:rw,PathConstraintMixTimeline:Yb,PathConstraintPositionTimeline:Vb,PathConstraintSpacingTimeline:Ub,PointAttachment:hb,RegionAttachment:db,RotateTimeline:_b,ScaleTimeline:Eb,ShearTimeline:Tb,Skeleton:uw,SkeletonBounds:class extends by{},SkeletonData:dw,SkeletonJson:gw,Skin:mw,Slot:cb,SlotData:fw,SpacingMode:aw,Spine:class extends Cy{createSkeleton(t){this.skeleton=new uw(t),this.skeleton.updateWorldTransform(),this.stateData=new Zb(t),this.state=new zb(this.stateData)}},SwirlEffect:pb,TimelineType:gb,TrackEntry:Hb,TransformConstraint:hw,TransformConstraintData:pw,TransformConstraintTimeline:Nb,TranslateTimeline:wb,TwoColorTimeline:Ib,VertexAttachment:ib},Symbol.toStringTag,{value:"Module"}));class yw{constructor(t){if(!t)throw new Error("name cannot be null.");this.name=t}}const _w=class extends yw{constructor(t){super(t),this.id=_w.nextID++,this.bones=null,this.vertices=[],this.worldVerticesLength=0,this.timelineAttachment=this}computeWorldVerticesOld(t,e){this.computeWorldVertices(t,0,this.worldVerticesLength,e,0,2)}computeWorldVertices(t,e,n,s,i,r){n=i+(n>>1)*r;const a=t.bone.skeleton,o=t.deform;let l=this.vertices;const h=this.bones;if(!h){o.length>0&&(l=o);const a=t.bone.matrix,h=a.tx,c=a.ty,u=a.a,d=a.c,f=a.b,p=a.d;for(let t=e,o=i;o<n;t+=2,o+=r){const e=l[t],n=l[t+1];s[o]=e*u+n*d+h,s[o+1]=e*f+n*p+c}return}let c=0,u=0;for(let f=0;f<e;f+=2){const t=h[c];c+=t+1,u+=t}const d=a.bones;if(0==o.length)for(let f=i,p=3*u;f<n;f+=r){let t=0,e=0,n=h[c++];for(n+=c;c<n;c++,p+=3){const n=d[h[c]].matrix,s=l[p],i=l[p+1],r=l[p+2];t+=(s*n.a+i*n.c+n.tx)*r,e+=(s*n.b+i*n.d+n.ty)*r}s[f]=t,s[f+1]=e}else{const t=o;for(let e=i,a=3*u,o=u<<1;e<n;e+=r){let n=0,i=0,r=h[c++];for(r+=c;c<r;c++,a+=3,o+=2){const e=d[h[c]].matrix,s=l[a]+t[o],r=l[a+1]+t[o+1],u=l[a+2];n+=(s*e.a+r*e.c+e.tx)*u,i+=(s*e.b+r*e.d+e.ty)*u}s[e]=n,s[e+1]=i}}}copyTo(t){this.bones?(t.bones=new Array(this.bones.length),xy.arrayCopy(this.bones,0,t.bones,0,this.bones.length)):t.bones=null,this.vertices&&(t.vertices=xy.newFloatArray(this.vertices.length),xy.arrayCopy(this.vertices,0,t.vertices,0,this.vertices.length)),t.worldVerticesLength=this.worldVerticesLength,t.timelineAttachment=this.timelineAttachment}};let bw=_w;bw.nextID=0;class ww extends bw{constructor(t){super(t),this.type=Hx.BoundingBox,this.color=new uy(1,1,1,1)}copy(){const t=new ww(this.name);return this.copyTo(t),t.color.setFromColor(this.color),t}}class Ew extends bw{constructor(t){super(t),this.type=Hx.Clipping,this.endSlot=null,this.color=new uy(.2275,.2275,.8078,1)}copy(){const t=new Ew(this.name);return this.copyTo(t),t.endSlot=this.endSlot,t.color.setFromColor(this.color),t}}class Tw extends bw{constructor(t,e){super(t),this.type=Hx.Mesh,this.region=null,this.triangles=[],this.color=new uy(1,1,1,1),this.width=0,this.height=0,this.hullLength=0,this.edges=[],this.parentMesh=null,this.sequence=null,this.tempColor=new uy(0,0,0,0),this.path=e}getParentMesh(){return this.parentMesh}setParentMesh(t){this.parentMesh=t,t&&(this.bones=t.bones,this.vertices=t.vertices,this.worldVerticesLength=t.worldVerticesLength,this.regionUVs=t.regionUVs,this.triangles=t.triangles,this.hullLength=t.hullLength,this.worldVerticesLength=t.worldVerticesLength)}copy(){if(this.parentMesh)return this.newLinkedMesh();const t=new Tw(this.name,this.path);return t.region=this.region,t.color.setFromColor(this.color),this.copyTo(t),t.regionUVs=new Float32Array(this.regionUVs.length),xy.arrayCopy(this.regionUVs,0,t.regionUVs,0,this.regionUVs.length),t.triangles=new Array(this.triangles.length),xy.arrayCopy(this.triangles,0,t.triangles,0,this.triangles.length),t.hullLength=this.hullLength,t.sequence=null!=this.sequence?this.sequence.copy():null,this.edges&&(t.edges=new Array(this.edges.length),xy.arrayCopy(this.edges,0,t.edges,0,this.edges.length)),t.width=this.width,t.height=this.height,t}computeWorldVertices(t,e,n,s,i,r){null!=this.sequence&&this.sequence.apply(t,this),super.computeWorldVertices(t,e,n,s,i,r)}newLinkedMesh(){const t=new Tw(this.name,this.path);return t.region=this.region,t.color.setFromColor(this.color),t.timelineAttachment=this.timelineAttachment,t.setParentMesh(this.parentMesh?this.parentMesh:this),t}}class Sw extends bw{constructor(t){super(t),this.type=Hx.Path,this.lengths=[],this.closed=!1,this.constantSpeed=!1,this.color=new uy(1,1,1,1)}copy(){const t=new Sw(this.name);return this.copyTo(t),t.lengths=new Array(this.lengths.length),xy.arrayCopy(this.lengths,0,t.lengths,0,this.lengths.length),t.closed=closed,t.constantSpeed=this.constantSpeed,t.color.setFromColor(this.color),t}}class Aw extends bw{constructor(t){super(t),this.type=Hx.Point,this.x=0,this.y=0,this.rotation=0,this.color=new uy(.38,.94,0,1)}computeWorldPosition(t,e){const n=t.matrix;return e.x=this.x*n.a+this.y*n.c+t.worldX,e.y=this.x*n.b+this.y*n.d+t.worldY,e}computeWorldRotation(t){const e=t.matrix,n=fy.cosDeg(this.rotation),s=fy.sinDeg(this.rotation),i=n*e.a+s*e.c,r=n*e.b+s*e.d;return Math.atan2(r,i)*fy.radDeg}copy(){const t=new Aw(this.name);return t.x=this.x,t.y=this.y,t.rotation=this.rotation,t.color.setFromColor(this.color),t}}const Cw=class extends yw{constructor(t,e){super(t),this.type=Hx.Region,this.x=0,this.y=0,this.scaleX=1,this.scaleY=1,this.rotation=0,this.width=0,this.height=0,this.color=new uy(1,1,1,1),this.rendererObject=null,this.region=null,this.sequence=null,this.offset=xy.newFloatArray(8),this.uvs=xy.newFloatArray(8),this.tempColor=new uy(1,1,1,1),this.path=e}updateRegion(){if(!this.region)throw new Error("Region not set.");const t=this.region,e=this.width/this.region.originalWidth*this.scaleX,n=this.height/this.region.originalHeight*this.scaleY,s=-this.width/2*this.scaleX+this.region.offsetX*e,i=-this.height/2*this.scaleY+this.region.offsetY*n,r=s+this.region.width*e,a=i+this.region.height*n,o=this.rotation*Math.PI/180,l=Math.cos(o),h=Math.sin(o),c=this.x,u=this.y,d=s*l+c,f=s*h,p=i*l+u,m=i*h,g=r*l+c,v=r*h,x=a*l+u,y=a*h,_=this.offset;_[0]=d-m,_[1]=p+f,_[2]=d-y,_[3]=x+f,_[4]=g-y,_[5]=x+v,_[6]=g-m,_[7]=p+v;const b=this.uvs;90==t.degrees?(b[2]=t.u,b[3]=t.v2,b[4]=t.u,b[5]=t.v,b[6]=t.u2,b[7]=t.v,b[0]=t.u2,b[1]=t.v2):(b[0]=t.u,b[1]=t.v2,b[2]=t.u,b[3]=t.v,b[4]=t.u2,b[5]=t.v,b[6]=t.u2,b[7]=t.v2)}computeWorldVertices(t,e,n,s){null!=this.sequence&&this.sequence.apply(t,this);const i=t.bone,r=this.offset,a=i.matrix,o=a.tx,l=a.ty,h=a.a,c=a.c,u=a.b,d=a.d;let f=0,p=0;f=r[0],p=r[1],e[n]=f*h+p*c+o,e[n+1]=f*u+p*d+l,n+=s,f=r[2],p=r[3],e[n]=f*h+p*c+o,e[n+1]=f*u+p*d+l,n+=s,f=r[4],p=r[5],e[n]=f*h+p*c+o,e[n+1]=f*u+p*d+l,n+=s,f=r[6],p=r[7],e[n]=f*h+p*c+o,e[n+1]=f*u+p*d+l}copy(){const t=new Cw(this.name,this.path);return t.region=this.region,t.rendererObject=this.rendererObject,t.x=this.x,t.y=this.y,t.scaleX=this.scaleX,t.scaleY=this.scaleY,t.rotation=this.rotation,t.width=this.width,t.height=this.height,xy.arrayCopy(this.uvs,0,t.uvs,0,8),xy.arrayCopy(this.offset,0,t.offset,0,8),t.color.setFromColor(this.color),t.sequence=null!=this.sequence?this.sequence.copy():null,t}};let Iw=Cw;Iw.X1=0,Iw.Y1=1,Iw.C1R=2,Iw.C1G=3,Iw.C1B=4,Iw.C1A=5,Iw.U1=6,Iw.V1=7,Iw.X2=8,Iw.Y2=9,Iw.C2R=10,Iw.C2G=11,Iw.C2B=12,Iw.C2A=13,Iw.U2=14,Iw.V2=15,Iw.X3=16,Iw.Y3=17,Iw.C3R=18,Iw.C3G=19,Iw.C3B=20,Iw.C3A=21,Iw.U3=22,Iw.V3=23,Iw.X4=24,Iw.Y4=25,Iw.C4R=26,Iw.C4G=27,Iw.C4B=28,Iw.C4A=29,Iw.U4=30,Iw.V4=31;const Mw=class{constructor(t){this.id=Mw.nextID(),this.start=0,this.digits=0,this.setupIndex=0,this.regions=new Array(t)}copy(){const t=new Mw(this.regions.length);return xy.arrayCopy(this.regions,0,t.regions,0,this.regions.length),t.start=this.start,t.digits=this.digits,t.setupIndex=this.setupIndex,t}apply(t,e){let n=t.sequenceIndex;-1==n&&(n=this.setupIndex),n>=this.regions.length&&(n=this.regions.length-1);const s=this.regions[n];e.region!=s&&(e.region=s)}getPath(t,e){let n=t;const s=(this.start+e).toString();for(let i=this.digits-s.length;i>0;i--)n+="0";return n+=s,n}static nextID(){return Mw._nextID++}};let Rw=Mw;Rw._nextID=0;var Pw=(t=>(t[t.hold=0]="hold",t[t.once=1]="once",t[t.loop=2]="loop",t[t.pingpong=3]="pingpong",t[t.onceReverse=4]="onceReverse",t[t.loopReverse=5]="loopReverse",t[t.pingpongReverse=6]="pingpongReverse",t))(Pw||{});const kw=[0,1,2,3,4,5,6];class Fw{constructor(t,e,n){if(this.timelines=[],this.timelineIds=new hy,!t)throw new Error("name cannot be null.");this.name=t,this.setTimelines(e),this.duration=n}setTimelines(t){if(!t)throw new Error("timelines cannot be null.");this.timelines=t,this.timelineIds.clear();for(let e=0;e<t.length;e++)this.timelineIds.addAll(t[e].getPropertyIds())}hasTimeline(t){for(let e=0;e<t.length;e++)if(this.timelineIds.contains(t[e]))return!0;return!1}apply(t,e,n,s,i,r,a,o){if(!t)throw new Error("skeleton cannot be null.");s&&0!=this.duration&&(n%=this.duration,e>0&&(e%=this.duration));const l=this.timelines;for(let h=0,c=l.length;h<c;h++)l[h].apply(t,e,n,i,r,a,o)}}const Ow=0,Dw=1,Lw=2,Nw=3,Bw=4,Vw=5,Uw=6,Xw=7,Yw=8,Ww=9,zw=10,Gw=11,Hw=12,jw=13,$w=14,qw=15,Kw=16,Zw=17,Qw=18,Jw=19;class tE{constructor(t,e){this.propertyIds=e,this.frames=xy.newFloatArray(t*this.getFrameEntries())}getPropertyIds(){return this.propertyIds}getFrameEntries(){return 1}getFrameCount(){return this.frames.length/this.getFrameEntries()}getDuration(){return this.frames[this.frames.length-this.getFrameEntries()]}static search1(t,e){const n=t.length;for(let s=1;s<n;s++)if(t[s]>e)return s-1;return n-1}static search(t,e,n){const s=t.length;for(let i=n;i<s;i+=n)if(t[i]>e)return i-n;return s-n}}class eE extends tE{constructor(t,e,n){super(t,n),this.curves=xy.newFloatArray(t+18*e),this.curves[t-1]=1}setLinear(t){this.curves[t]=0}setStepped(t){this.curves[t]=1}shrink(t){const e=this.getFrameCount()+18*t;if(this.curves.length>e){const t=xy.newFloatArray(e);xy.arrayCopy(this.curves,0,t,0,e),this.curves=t}}setBezier(t,e,n,s,i,r,a,o,l,h,c){const u=this.curves;let d=this.getFrameCount()+18*t;0==n&&(u[e]=2+d);const f=.03*(s-2*r+o),p=.03*(i-2*a+l),m=.006*(3*(r-o)-s+h),g=.006*(3*(a-l)-i+c);let v=2*f+m,x=2*p+g,y=.3*(r-s)+f+.16666667*m,_=.3*(a-i)+p+.16666667*g,b=s+y,w=i+_;for(let E=d+18;d<E;d+=2)u[d]=b,u[d+1]=w,y+=v,_+=x,v+=m,x+=g,b+=y,w+=_}getBezierValue(t,e,n,s){const i=this.curves;if(i[s]>t){const r=this.frames[e],a=this.frames[e+n];return a+(t-r)/(i[s]-r)*(i[s+1]-a)}const r=s+18;for(s+=2;s<r;s+=2)if(i[s]>=t){const e=i[s-2],n=i[s-1];return n+(t-e)/(i[s]-e)*(i[s+1]-n)}e+=this.getFrameEntries();const a=i[r-2],o=i[r-1];return o+(t-a)/(this.frames[e]-a)*(this.frames[e+n]-o)}}class nE extends eE{constructor(t,e,n){super(t,e,[n])}getFrameEntries(){return 2}setFrame(t,e,n){t<<=1,this.frames[t]=e,this.frames[t+1]=n}getCurveValue(t){const e=this.frames;let n=e.length-2;for(let i=2;i<=n;i+=2)if(e[i]>t){n=i-2;break}const s=this.curves[n>>1];switch(s){case 0:const s=e[n],i=e[n+1];return i+(t-s)/(e[n+2]-s)*(e[n+2+1]-i);case 1:return e[n+1]}return this.getBezierValue(t,n,1,s-2)}}class sE extends eE{constructor(t,e,n,s){super(t,e,[n,s])}getFrameEntries(){return 3}setFrame(t,e,n,s){t*=3,this.frames[t]=e,this.frames[t+1]=n,this.frames[t+2]=s}}class iE extends nE{constructor(t,e,n){super(t,e,`${Ow}|${n}`),this.boneIndex=0,this.boneIndex=n}apply(t,e,n,s,i,r,a){const o=t.bones[this.boneIndex];if(!o.active)return;if(n<this.frames[0]){switch(r){case $x.setup:return void(o.rotation=o.data.rotation);case $x.first:o.rotation+=(o.data.rotation-o.rotation)*i}return}let l=this.getCurveValue(n);switch(r){case $x.setup:o.rotation=o.data.rotation+l*i;break;case $x.first:case $x.replace:l+=o.data.rotation-o.rotation;case $x.add:o.rotation+=l*i}}}class rE extends sE{constructor(t,e,n){super(t,e,`${Dw}|${n}`,`${Lw}|${n}`),this.boneIndex=0,this.boneIndex=n}apply(t,e,n,s,i,r,a){const o=t.bones[this.boneIndex];if(!o.active)return;const l=this.frames;if(n<l[0]){switch(r){case $x.setup:return o.x=o.data.x,void(o.y=o.data.y);case $x.first:o.x+=(o.data.x-o.x)*i,o.y+=(o.data.y-o.y)*i}return}let h=0,c=0;const u=tE.search(l,n,3),d=this.curves[u/3];switch(d){case 0:const t=l[u];h=l[u+1],c=l[u+2];const e=(n-t)/(l[u+3]-t);h+=(l[u+3+1]-h)*e,c+=(l[u+3+2]-c)*e;break;case 1:h=l[u+1],c=l[u+2];break;default:h=this.getBezierValue(n,u,1,d-2),c=this.getBezierValue(n,u,2,d+18-2)}switch(r){case $x.setup:o.x=o.data.x+h*i,o.y=o.data.y+c*i;break;case $x.first:case $x.replace:o.x+=(o.data.x+h-o.x)*i,o.y+=(o.data.y+c-o.y)*i;break;case $x.add:o.x+=h*i,o.y+=c*i}}}class aE extends nE{constructor(t,e,n){super(t,e,`${Dw}|${n}`),this.boneIndex=0,this.boneIndex=n}apply(t,e,n,s,i,r,a){const o=t.bones[this.boneIndex];if(!o.active)return;if(n<this.frames[0]){switch(r){case $x.setup:return void(o.x=o.data.x);case $x.first:o.x+=(o.data.x-o.x)*i}return}const l=this.getCurveValue(n);switch(r){case $x.setup:o.x=o.data.x+l*i;break;case $x.first:case $x.replace:o.x+=(o.data.x+l-o.x)*i;break;case $x.add:o.x+=l*i}}}class oE extends nE{constructor(t,e,n){super(t,e,`${Lw}|${n}`),this.boneIndex=0,this.boneIndex=n}apply(t,e,n,s,i,r,a){const o=t.bones[this.boneIndex];if(!o.active)return;if(n<this.frames[0]){switch(r){case $x.setup:return void(o.y=o.data.y);case $x.first:o.y+=(o.data.y-o.y)*i}return}const l=this.getCurveValue(n);switch(r){case $x.setup:o.y=o.data.y+l*i;break;case $x.first:case $x.replace:o.y+=(o.data.y+l-o.y)*i;break;case $x.add:o.y+=l*i}}}class lE extends sE{constructor(t,e,n){super(t,e,`${Nw}|${n}`,`${Bw}|${n}`),this.boneIndex=0,this.boneIndex=n}apply(t,e,n,s,i,r,a){const o=t.bones[this.boneIndex];if(!o.active)return;const l=this.frames;if(n<l[0]){switch(r){case $x.setup:return o.scaleX=o.data.scaleX,void(o.scaleY=o.data.scaleY);case $x.first:o.scaleX+=(o.data.scaleX-o.scaleX)*i,o.scaleY+=(o.data.scaleY-o.scaleY)*i}return}let h,c;const u=tE.search(l,n,3),d=this.curves[u/3];switch(d){case 0:const t=l[u];h=l[u+1],c=l[u+2];const e=(n-t)/(l[u+3]-t);h+=(l[u+3+1]-h)*e,c+=(l[u+3+2]-c)*e;break;case 1:h=l[u+1],c=l[u+2];break;default:h=this.getBezierValue(n,u,1,d-2),c=this.getBezierValue(n,u,2,d+18-2)}if(h*=o.data.scaleX,c*=o.data.scaleY,1==i)r==$x.add?(o.scaleX+=h-o.data.scaleX,o.scaleY+=c-o.data.scaleY):(o.scaleX=h,o.scaleY=c);else{let t=0,e=0;if(a==qx.mixOut)switch(r){case $x.setup:t=o.data.scaleX,e=o.data.scaleY,o.scaleX=t+(Math.abs(h)*fy.signum(t)-t)*i,o.scaleY=e+(Math.abs(c)*fy.signum(e)-e)*i;break;case $x.first:case $x.replace:t=o.scaleX,e=o.scaleY,o.scaleX=t+(Math.abs(h)*fy.signum(t)-t)*i,o.scaleY=e+(Math.abs(c)*fy.signum(e)-e)*i;break;case $x.add:o.scaleX+=(h-o.data.scaleX)*i,o.scaleY+=(c-o.data.scaleY)*i}else switch(r){case $x.setup:t=Math.abs(o.data.scaleX)*fy.signum(h),e=Math.abs(o.data.scaleY)*fy.signum(c),o.scaleX=t+(h-t)*i,o.scaleY=e+(c-e)*i;break;case $x.first:case $x.replace:t=Math.abs(o.scaleX)*fy.signum(h),e=Math.abs(o.scaleY)*fy.signum(c),o.scaleX=t+(h-t)*i,o.scaleY=e+(c-e)*i;break;case $x.add:o.scaleX+=(h-o.data.scaleX)*i,o.scaleY+=(c-o.data.scaleY)*i}}}}class hE extends nE{constructor(t,e,n){super(t,e,`${Nw}|${n}`),this.boneIndex=0,this.boneIndex=n}apply(t,e,n,s,i,r,a){const o=t.bones[this.boneIndex];if(!o.active)return;if(n<this.frames[0]){switch(r){case $x.setup:return void(o.scaleX=o.data.scaleX);case $x.first:o.scaleX+=(o.data.scaleX-o.scaleX)*i}return}const l=this.getCurveValue(n)*o.data.scaleX;if(1==i)r==$x.add?o.scaleX+=l-o.data.scaleX:o.scaleX=l;else{let t=0;if(a==qx.mixOut)switch(r){case $x.setup:t=o.data.scaleX,o.scaleX=t+(Math.abs(l)*fy.signum(t)-t)*i;break;case $x.first:case $x.replace:t=o.scaleX,o.scaleX=t+(Math.abs(l)*fy.signum(t)-t)*i;break;case $x.add:o.scaleX+=(l-o.data.scaleX)*i}else switch(r){case $x.setup:t=Math.abs(o.data.scaleX)*fy.signum(l),o.scaleX=t+(l-t)*i;break;case $x.first:case $x.replace:t=Math.abs(o.scaleX)*fy.signum(l),o.scaleX=t+(l-t)*i;break;case $x.add:o.scaleX+=(l-o.data.scaleX)*i}}}}class cE extends nE{constructor(t,e,n){super(t,e,`${Bw}|${n}`),this.boneIndex=0,this.boneIndex=n}apply(t,e,n,s,i,r,a){const o=t.bones[this.boneIndex];if(!o.active)return;if(n<this.frames[0]){switch(r){case $x.setup:return void(o.scaleY=o.data.scaleY);case $x.first:o.scaleY+=(o.data.scaleY-o.scaleY)*i}return}const l=this.getCurveValue(n)*o.data.scaleY;if(1==i)r==$x.add?o.scaleY+=l-o.data.scaleY:o.scaleY=l;else{let t=0;if(a==qx.mixOut)switch(r){case $x.setup:t=o.data.scaleY,o.scaleY=t+(Math.abs(l)*fy.signum(t)-t)*i;break;case $x.first:case $x.replace:t=o.scaleY,o.scaleY=t+(Math.abs(l)*fy.signum(t)-t)*i;break;case $x.add:o.scaleY+=(l-o.data.scaleY)*i}else switch(r){case $x.setup:t=Math.abs(o.data.scaleY)*fy.signum(l),o.scaleY=t+(l-t)*i;break;case $x.first:case $x.replace:t=Math.abs(o.scaleY)*fy.signum(l),o.scaleY=t+(l-t)*i;break;case $x.add:o.scaleY+=(l-o.data.scaleY)*i}}}}class uE extends sE{constructor(t,e,n){super(t,e,`${Vw}|${n}`,`${Uw}|${n}`),this.boneIndex=0,this.boneIndex=n}apply(t,e,n,s,i,r,a){const o=t.bones[this.boneIndex];if(!o.active)return;const l=this.frames;if(n<l[0]){switch(r){case $x.setup:return o.shearX=o.data.shearX,void(o.shearY=o.data.shearY);case $x.first:o.shearX+=(o.data.shearX-o.shearX)*i,o.shearY+=(o.data.shearY-o.shearY)*i}return}let h=0,c=0;const u=tE.search(l,n,3),d=this.curves[u/3];switch(d){case 0:const t=l[u];h=l[u+1],c=l[u+2];const e=(n-t)/(l[u+3]-t);h+=(l[u+3+1]-h)*e,c+=(l[u+3+2]-c)*e;break;case 1:h=l[u+1],c=l[u+2];break;default:h=this.getBezierValue(n,u,1,d-2),c=this.getBezierValue(n,u,2,d+18-2)}switch(r){case $x.setup:o.shearX=o.data.shearX+h*i,o.shearY=o.data.shearY+c*i;break;case $x.first:case $x.replace:o.shearX+=(o.data.shearX+h-o.shearX)*i,o.shearY+=(o.data.shearY+c-o.shearY)*i;break;case $x.add:o.shearX+=h*i,o.shearY+=c*i}}}class dE extends nE{constructor(t,e,n){super(t,e,`${Vw}|${n}`),this.boneIndex=0,this.boneIndex=n}apply(t,e,n,s,i,r,a){const o=t.bones[this.boneIndex];if(!o.active)return;if(n<this.frames[0]){switch(r){case $x.setup:return void(o.shearX=o.data.shearX);case $x.first:o.shearX+=(o.data.shearX-o.shearX)*i}return}const l=this.getCurveValue(n);switch(r){case $x.setup:o.shearX=o.data.shearX+l*i;break;case $x.first:case $x.replace:o.shearX+=(o.data.shearX+l-o.shearX)*i;break;case $x.add:o.shearX+=l*i}}}class fE extends nE{constructor(t,e,n){super(t,e,`${Uw}|${n}`),this.boneIndex=0,this.boneIndex=n}apply(t,e,n,s,i,r,a){const o=t.bones[this.boneIndex];if(!o.active)return;if(n<this.frames[0]){switch(r){case $x.setup:return void(o.shearY=o.data.shearY);case $x.first:o.shearY+=(o.data.shearY-o.shearY)*i}return}const l=this.getCurveValue(n);switch(r){case $x.setup:o.shearY=o.data.shearY+l*i;break;case $x.first:case $x.replace:o.shearY+=(o.data.shearY+l-o.shearY)*i;break;case $x.add:o.shearY+=l*i}}}class pE extends eE{constructor(t,e,n){super(t,e,[`${Xw}|${n}`,`${Yw}|${n}`]),this.slotIndex=0,this.slotIndex=n}getFrameEntries(){return 5}setFrame(t,e,n,s,i,r){t*=5,this.frames[t]=e,this.frames[t+1]=n,this.frames[t+2]=s,this.frames[t+3]=i,this.frames[t+4]=r}apply(t,e,n,s,i,r,a){const o=t.slots[this.slotIndex];if(!o.bone.active)return;const l=this.frames,h=o.color;if(n<l[0]){const t=o.data.color;switch(r){case $x.setup:return void h.setFromColor(t);case $x.first:h.add((t.r-h.r)*i,(t.g-h.g)*i,(t.b-h.b)*i,(t.a-h.a)*i)}return}let c=0,u=0,d=0,f=0;const p=tE.search(l,n,5),m=this.curves[p/5];switch(m){case 0:const t=l[p];c=l[p+1],u=l[p+2],d=l[p+3],f=l[p+4];const e=(n-t)/(l[p+5]-t);c+=(l[p+5+1]-c)*e,u+=(l[p+5+2]-u)*e,d+=(l[p+5+3]-d)*e,f+=(l[p+5+4]-f)*e;break;case 1:c=l[p+1],u=l[p+2],d=l[p+3],f=l[p+4];break;default:c=this.getBezierValue(n,p,1,m-2),u=this.getBezierValue(n,p,2,m+18-2),d=this.getBezierValue(n,p,3,m+36-2),f=this.getBezierValue(n,p,4,m+54-2)}1==i?h.set(c,u,d,f):(r==$x.setup&&h.setFromColor(o.data.color),h.add((c-h.r)*i,(u-h.g)*i,(d-h.b)*i,(f-h.a)*i))}}class mE extends eE{constructor(t,e,n){super(t,e,[`${Xw}|${n}`]),this.slotIndex=0,this.slotIndex=n}getFrameEntries(){return 4}setFrame(t,e,n,s,i){t<<=2,this.frames[t]=e,this.frames[t+1]=n,this.frames[t+2]=s,this.frames[t+3]=i}apply(t,e,n,s,i,r,a){const o=t.slots[this.slotIndex];if(!o.bone.active)return;const l=this.frames,h=o.color;if(n<l[0]){const t=o.data.color;switch(r){case $x.setup:return h.r=t.r,h.g=t.g,void(h.b=t.b);case $x.first:h.r+=(t.r-h.r)*i,h.g+=(t.g-h.g)*i,h.b+=(t.b-h.b)*i}return}let c=0,u=0,d=0;const f=tE.search(l,n,4),p=this.curves[f>>2];switch(p){case 0:const t=l[f];c=l[f+1],u=l[f+2],d=l[f+3];const e=(n-t)/(l[f+4]-t);c+=(l[f+4+1]-c)*e,u+=(l[f+4+2]-u)*e,d+=(l[f+4+3]-d)*e;break;case 1:c=l[f+1],u=l[f+2],d=l[f+3];break;default:c=this.getBezierValue(n,f,1,p-2),u=this.getBezierValue(n,f,2,p+18-2),d=this.getBezierValue(n,f,3,p+36-2)}if(1==i)h.r=c,h.g=u,h.b=d;else{if(r==$x.setup){const t=o.data.color;h.r=t.r,h.g=t.g,h.b=t.b}h.r+=(c-h.r)*i,h.g+=(u-h.g)*i,h.b+=(d-h.b)*i}}}class gE extends nE{constructor(t,e,n){super(t,e,`${Yw}|${n}`),this.slotIndex=0,this.slotIndex=n}apply(t,e,n,s,i,r,a){const o=t.slots[this.slotIndex];if(!o.bone.active)return;const l=o.color;if(n<this.frames[0]){const t=o.data.color;switch(r){case $x.setup:return void(l.a=t.a);case $x.first:l.a+=(t.a-l.a)*i}return}const h=this.getCurveValue(n);1==i?l.a=h:(r==$x.setup&&(l.a=o.data.color.a),l.a+=(h-l.a)*i)}}class vE extends eE{constructor(t,e,n){super(t,e,[`${Xw}|${n}`,`${Yw}|${n}`,`${Ww}|${n}`]),this.slotIndex=0,this.slotIndex=n}getFrameEntries(){return 8}setFrame(t,e,n,s,i,r,a,o,l){t<<=3,this.frames[t]=e,this.frames[t+1]=n,this.frames[t+2]=s,this.frames[t+3]=i,this.frames[t+4]=r,this.frames[t+5]=a,this.frames[t+6]=o,this.frames[t+7]=l}apply(t,e,n,s,i,r,a){const o=t.slots[this.slotIndex];if(!o.bone.active)return;const l=this.frames,h=o.color,c=o.darkColor;if(n<l[0]){const t=o.data.color,e=o.data.darkColor;switch(r){case $x.setup:return h.setFromColor(t),c.r=e.r,c.g=e.g,void(c.b=e.b);case $x.first:h.add((t.r-h.r)*i,(t.g-h.g)*i,(t.b-h.b)*i,(t.a-h.a)*i),c.r+=(e.r-c.r)*i,c.g+=(e.g-c.g)*i,c.b+=(e.b-c.b)*i}return}let u=0,d=0,f=0,p=0,m=0,g=0,v=0;const x=tE.search(l,n,8),y=this.curves[x>>3];switch(y){case 0:const t=l[x];u=l[x+1],d=l[x+2],f=l[x+3],p=l[x+4],m=l[x+5],g=l[x+6],v=l[x+7];const e=(n-t)/(l[x+8]-t);u+=(l[x+8+1]-u)*e,d+=(l[x+8+2]-d)*e,f+=(l[x+8+3]-f)*e,p+=(l[x+8+4]-p)*e,m+=(l[x+8+5]-m)*e,g+=(l[x+8+6]-g)*e,v+=(l[x+8+7]-v)*e;break;case 1:u=l[x+1],d=l[x+2],f=l[x+3],p=l[x+4],m=l[x+5],g=l[x+6],v=l[x+7];break;default:u=this.getBezierValue(n,x,1,y-2),d=this.getBezierValue(n,x,2,y+18-2),f=this.getBezierValue(n,x,3,y+36-2),p=this.getBezierValue(n,x,4,y+54-2),m=this.getBezierValue(n,x,5,y+72-2),g=this.getBezierValue(n,x,6,y+90-2),v=this.getBezierValue(n,x,7,y+108-2)}if(1==i)h.set(u,d,f,p),c.r=m,c.g=g,c.b=v;else{if(r==$x.setup){h.setFromColor(o.data.color);const t=o.data.darkColor;c.r=t.r,c.g=t.g,c.b=t.b}h.add((u-h.r)*i,(d-h.g)*i,(f-h.b)*i,(p-h.a)*i),c.r+=(m-c.r)*i,c.g+=(g-c.g)*i,c.b+=(v-c.b)*i}}}class xE extends eE{constructor(t,e,n){super(t,e,[`${Xw}|${n}`,`${Ww}|${n}`]),this.slotIndex=0,this.slotIndex=n}getFrameEntries(){return 7}setFrame(t,e,n,s,i,r,a,o){t*=7,this.frames[t]=e,this.frames[t+1]=n,this.frames[t+2]=s,this.frames[t+3]=i,this.frames[t+4]=r,this.frames[t+5]=a,this.frames[t+6]=o}apply(t,e,n,s,i,r,a){const o=t.slots[this.slotIndex];if(!o.bone.active)return;const l=this.frames,h=o.color,c=o.darkColor;if(n<l[0]){const t=o.data.color,e=o.data.darkColor;switch(r){case $x.setup:return h.r=t.r,h.g=t.g,h.b=t.b,c.r=e.r,c.g=e.g,void(c.b=e.b);case $x.first:h.r+=(t.r-h.r)*i,h.g+=(t.g-h.g)*i,h.b+=(t.b-h.b)*i,c.r+=(e.r-c.r)*i,c.g+=(e.g-c.g)*i,c.b+=(e.b-c.b)*i}return}let u=0,d=0,f=0,p=0,m=0,g=0;const v=tE.search(l,n,7),x=this.curves[v/7];switch(x){case 0:const t=l[v];u=l[v+1],d=l[v+2],f=l[v+3],p=l[v+4],m=l[v+5],g=l[v+6];const e=(n-t)/(l[v+7]-t);u+=(l[v+7+1]-u)*e,d+=(l[v+7+2]-d)*e,f+=(l[v+7+3]-f)*e,p+=(l[v+7+4]-p)*e,m+=(l[v+7+5]-m)*e,g+=(l[v+7+6]-g)*e;break;case 1:u=l[v+1],d=l[v+2],f=l[v+3],p=l[v+4],m=l[v+5],g=l[v+6];break;default:u=this.getBezierValue(n,v,1,x-2),d=this.getBezierValue(n,v,2,x+18-2),f=this.getBezierValue(n,v,3,x+36-2),p=this.getBezierValue(n,v,4,x+54-2),m=this.getBezierValue(n,v,5,x+72-2),g=this.getBezierValue(n,v,6,x+90-2)}if(1==i)h.r=u,h.g=d,h.b=f,c.r=p,c.g=m,c.b=g;else{if(r==$x.setup){const t=o.data.color,e=o.data.darkColor;h.r=t.r,h.g=t.g,h.b=t.b,c.r=e.r,c.g=e.g,c.b=e.b}h.r+=(u-h.r)*i,h.g+=(d-h.g)*i,h.b+=(f-h.b)*i,c.r+=(p-c.r)*i,c.g+=(m-c.g)*i,c.b+=(g-c.b)*i}}}class yE extends tE{constructor(t,e){super(t,[`${zw}|${e}`]),this.slotIndex=0,this.slotIndex=e,this.attachmentNames=new Array(t)}getFrameCount(){return this.frames.length}setFrame(t,e,n){this.frames[t]=e,this.attachmentNames[t]=n}apply(t,e,n,s,i,r,a){const o=t.slots[this.slotIndex];o.bone.active&&(a!=qx.mixOut?n<this.frames[0]?r!=$x.setup&&r!=$x.first||this.setAttachment(t,o,o.data.attachmentName):this.setAttachment(t,o,this.attachmentNames[tE.search1(this.frames,n)]):r==$x.setup&&this.setAttachment(t,o,o.data.attachmentName))}setAttachment(t,e,n){e.setAttachment(n?t.getAttachment(this.slotIndex,n):null)}}class _E extends eE{constructor(t,e,n,s){super(t,e,[`${Gw}|${n}|${s.id}`]),this.slotIndex=0,this.slotIndex=n,this.attachment=s,this.vertices=new Array(t)}getFrameCount(){return this.frames.length}setFrame(t,e,n){this.frames[t]=e,this.vertices[t]=n}setBezier(t,e,n,s,i,r,a,o,l,h,c){const u=this.curves;let d=this.getFrameCount()+18*t;0==n&&(u[e]=2+d);const f=.03*(s-2*r+o),p=.03*l-.06*a,m=.006*(3*(r-o)-s+h),g=.018*(a-l+.33333333);let v=2*f+m,x=2*p+g,y=.3*(r-s)+f+.16666667*m,_=.3*a+p+.16666667*g,b=s+y,w=_;for(let E=d+18;d<E;d+=2)u[d]=b,u[d+1]=w,y+=v,_+=x,v+=m,x+=g,b+=y,w+=_}getCurvePercent(t,e){const n=this.curves;let s=n[e];switch(s){case 0:const n=this.frames[e];return(t-n)/(this.frames[e+this.getFrameEntries()]-n);case 1:return 0}if(s-=2,n[s]>t){const i=this.frames[e];return n[s+1]*(t-i)/(n[s]-i)}const i=s+18;for(s+=2;s<i;s+=2)if(n[s]>=t){const e=n[s-2],i=n[s-1];return i+(t-e)/(n[s]-e)*(n[s+1]-i)}const r=n[i-2],a=n[i-1];return a+(1-a)*(t-r)/(this.frames[e+this.getFrameEntries()]-r)}apply(t,e,n,s,i,r,a){const o=t.slots[this.slotIndex];if(!o.bone.active)return;const l=o.getAttachment();if(!l)return;if(!(l instanceof bw)||l.timelineAttachment!=this.attachment)return;const h=o.deform;0==h.length&&(r=$x.setup);const c=this.vertices,u=c[0].length,d=this.frames;if(n<d[0]){switch(r){case $x.setup:return void(h.length=0);case $x.first:if(1==i)return void(h.length=0);h.length=u;const t=l;if(t.bones){i=1-i;for(let t=0;t<u;t++)h[t]*=i}else{const e=t.vertices;for(let t=0;t<u;t++)h[t]+=(e[t]-h[t])*i}}return}if(h.length=u,n>=d[d.length-1]){const t=c[d.length-1];if(1==i)if(r==$x.add){const e=l;if(e.bones)for(let n=0;n<u;n++)h[n]+=t[n];else{const n=e.vertices;for(let e=0;e<u;e++)h[e]+=t[e]-n[e]}}else xy.arrayCopy(t,0,h,0,u);else switch(r){case $x.setup:{const e=l;if(e.bones)for(let n=0;n<u;n++)h[n]=t[n]*i;else{const n=e.vertices;for(let e=0;e<u;e++){const s=n[e];h[e]=s+(t[e]-s)*i}}break}case $x.first:case $x.replace:for(let n=0;n<u;n++)h[n]+=(t[n]-h[n])*i;break;case $x.add:const e=l;if(e.bones)for(let n=0;n<u;n++)h[n]+=t[n]*i;else{const n=e.vertices;for(let e=0;e<u;e++)h[e]+=(t[e]-n[e])*i}}return}const f=tE.search1(d,n),p=this.getCurvePercent(n,f),m=c[f],g=c[f+1];if(1==i)if(r==$x.add){const t=l;if(t.bones)for(let e=0;e<u;e++){const t=m[e];h[e]+=t+(g[e]-t)*p}else{const e=t.vertices;for(let t=0;t<u;t++){const n=m[t];h[t]+=n+(g[t]-n)*p-e[t]}}}else for(let v=0;v<u;v++){const t=m[v];h[v]=t+(g[v]-t)*p}else switch(r){case $x.setup:{const t=l;if(t.bones)for(let e=0;e<u;e++){const t=m[e];h[e]=(t+(g[e]-t)*p)*i}else{const e=t.vertices;for(let t=0;t<u;t++){const n=m[t],s=e[t];h[t]=s+(n+(g[t]-n)*p-s)*i}}break}case $x.first:case $x.replace:for(let e=0;e<u;e++){const t=m[e];h[e]+=(t+(g[e]-t)*p-h[e])*i}break;case $x.add:const t=l;if(t.bones)for(let e=0;e<u;e++){const t=m[e];h[e]+=(t+(g[e]-t)*p)*i}else{const e=t.vertices;for(let t=0;t<u;t++){const n=m[t];h[t]+=(n+(g[t]-n)*p-e[t])*i}}}}}const bE=class extends tE{constructor(t){super(t,bE.propertyIds),this.events=new Array(t)}getFrameCount(){return this.frames.length}setFrame(t,e){this.frames[t]=e.time,this.events[t]=e}apply(t,e,n,s,i,r,a){if(!s)return;const o=this.frames,l=this.frames.length;if(e>n)this.apply(t,e,Number.MAX_VALUE,s,i,r,a),e=-1;else if(e>=o[l-1])return;if(n<o[0])return;let h=0;if(e<o[0])h=0;else{h=tE.search1(o,e)+1;const t=o[h];for(;h>0&&o[h-1]==t;)h--}for(;h<l&&n>=o[h];h++)s.push(this.events[h])}};let wE=bE;wE.propertyIds=[`${Hw}`];const EE=class extends tE{constructor(t){super(t,EE.propertyIds),this.drawOrders=new Array(t)}getFrameCount(){return this.frames.length}setFrame(t,e,n){this.frames[t]=e,this.drawOrders[t]=n}apply(t,e,n,s,i,r,a){if(a==qx.mixOut)return void(r==$x.setup&&xy.arrayCopy(t.slots,0,t.drawOrder,0,t.slots.length));if(n<this.frames[0])return void(r!=$x.setup&&r!=$x.first||xy.arrayCopy(t.slots,0,t.drawOrder,0,t.slots.length));const o=tE.search1(this.frames,n),l=this.drawOrders[o];if(l){const e=t.drawOrder,n=t.slots;for(let t=0,s=l.length;t<s;t++)e[t]=n[l[t]]}else xy.arrayCopy(t.slots,0,t.drawOrder,0,t.slots.length)}};let TE=EE;TE.propertyIds=[`${jw}`];class SE extends eE{constructor(t,e,n){super(t,e,[`${$w}|${n}`]),this.ikConstraintIndex=0,this.ikConstraintIndex=n}getFrameEntries(){return 6}setFrame(t,e,n,s,i,r,a){t*=6,this.frames[t]=e,this.frames[t+1]=n,this.frames[t+2]=s,this.frames[t+3]=i,this.frames[t+4]=r?1:0,this.frames[t+5]=a?1:0}apply(t,e,n,s,i,r,a){const o=t.ikConstraints[this.ikConstraintIndex];if(!o.active)return;const l=this.frames;if(n<l[0]){switch(r){case $x.setup:return o.mix=o.data.mix,o.softness=o.data.softness,o.bendDirection=o.data.bendDirection,o.compress=o.data.compress,void(o.stretch=o.data.stretch);case $x.first:o.mix+=(o.data.mix-o.mix)*i,o.softness+=(o.data.softness-o.softness)*i,o.bendDirection=o.data.bendDirection,o.compress=o.data.compress,o.stretch=o.data.stretch}return}let h=0,c=0;const u=tE.search(l,n,6),d=this.curves[u/6];switch(d){case 0:const t=l[u];h=l[u+1],c=l[u+2];const e=(n-t)/(l[u+6]-t);h+=(l[u+6+1]-h)*e,c+=(l[u+6+2]-c)*e;break;case 1:h=l[u+1],c=l[u+2];break;default:h=this.getBezierValue(n,u,1,d-2),c=this.getBezierValue(n,u,2,d+18-2)}r==$x.setup?(o.mix=o.data.mix+(h-o.data.mix)*i,o.softness=o.data.softness+(c-o.data.softness)*i,a==qx.mixOut?(o.bendDirection=o.data.bendDirection,o.compress=o.data.compress,o.stretch=o.data.stretch):(o.bendDirection=l[u+3],o.compress=0!=l[u+4],o.stretch=0!=l[u+5])):(o.mix+=(h-o.mix)*i,o.softness+=(c-o.softness)*i,a==qx.mixIn&&(o.bendDirection=l[u+3],o.compress=0!=l[u+4],o.stretch=0!=l[u+5]))}}class AE extends eE{constructor(t,e,n){super(t,e,[`${qw}|${n}`]),this.transformConstraintIndex=0,this.transformConstraintIndex=n}getFrameEntries(){return 7}setFrame(t,e,n,s,i,r,a,o){const l=this.frames;l[t*=7]=e,l[t+1]=n,l[t+2]=s,l[t+3]=i,l[t+4]=r,l[t+5]=a,l[t+6]=o}apply(t,e,n,s,i,r,a){const o=t.transformConstraints[this.transformConstraintIndex];if(!o.active)return;const l=this.frames;if(n<l[0]){const t=o.data;switch(r){case $x.setup:return o.mixRotate=t.mixRotate,o.mixX=t.mixX,o.mixY=t.mixY,o.mixScaleX=t.mixScaleX,o.mixScaleY=t.mixScaleY,void(o.mixShearY=t.mixShearY);case $x.first:o.mixRotate+=(t.mixRotate-o.mixRotate)*i,o.mixX+=(t.mixX-o.mixX)*i,o.mixY+=(t.mixY-o.mixY)*i,o.mixScaleX+=(t.mixScaleX-o.mixScaleX)*i,o.mixScaleY+=(t.mixScaleY-o.mixScaleY)*i,o.mixShearY+=(t.mixShearY-o.mixShearY)*i}return}let h,c,u,d,f,p;const m=tE.search(l,n,7),g=this.curves[m/7];switch(g){case 0:const t=l[m];h=l[m+1],c=l[m+2],u=l[m+3],d=l[m+4],f=l[m+5],p=l[m+6];const e=(n-t)/(l[m+7]-t);h+=(l[m+7+1]-h)*e,c+=(l[m+7+2]-c)*e,u+=(l[m+7+3]-u)*e,d+=(l[m+7+4]-d)*e,f+=(l[m+7+5]-f)*e,p+=(l[m+7+6]-p)*e;break;case 1:h=l[m+1],c=l[m+2],u=l[m+3],d=l[m+4],f=l[m+5],p=l[m+6];break;default:h=this.getBezierValue(n,m,1,g-2),c=this.getBezierValue(n,m,2,g+18-2),u=this.getBezierValue(n,m,3,g+36-2),d=this.getBezierValue(n,m,4,g+54-2),f=this.getBezierValue(n,m,5,g+72-2),p=this.getBezierValue(n,m,6,g+90-2)}if(r==$x.setup){const t=o.data;o.mixRotate=t.mixRotate+(h-t.mixRotate)*i,o.mixX=t.mixX+(c-t.mixX)*i,o.mixY=t.mixY+(u-t.mixY)*i,o.mixScaleX=t.mixScaleX+(d-t.mixScaleX)*i,o.mixScaleY=t.mixScaleY+(f-t.mixScaleY)*i,o.mixShearY=t.mixShearY+(p-t.mixShearY)*i}else o.mixRotate+=(h-o.mixRotate)*i,o.mixX+=(c-o.mixX)*i,o.mixY+=(u-o.mixY)*i,o.mixScaleX+=(d-o.mixScaleX)*i,o.mixScaleY+=(f-o.mixScaleY)*i,o.mixShearY+=(p-o.mixShearY)*i}}class CE extends nE{constructor(t,e,n){super(t,e,`${Kw}|${n}`),this.pathConstraintIndex=0,this.pathConstraintIndex=n}apply(t,e,n,s,i,r,a){const o=t.pathConstraints[this.pathConstraintIndex];if(!o.active)return;if(n<this.frames[0]){switch(r){case $x.setup:return void(o.position=o.data.position);case $x.first:o.position+=(o.data.position-o.position)*i}return}const l=this.getCurveValue(n);r==$x.setup?o.position=o.data.position+(l-o.data.position)*i:o.position+=(l-o.position)*i}}class IE extends nE{constructor(t,e,n){super(t,e,`${Zw}|${n}`),this.pathConstraintIndex=0,this.pathConstraintIndex=n}apply(t,e,n,s,i,r,a){const o=t.pathConstraints[this.pathConstraintIndex];if(!o.active)return;if(n<this.frames[0]){switch(r){case $x.setup:return void(o.spacing=o.data.spacing);case $x.first:o.spacing+=(o.data.spacing-o.spacing)*i}return}const l=this.getCurveValue(n);r==$x.setup?o.spacing=o.data.spacing+(l-o.data.spacing)*i:o.spacing+=(l-o.spacing)*i}}class ME extends eE{constructor(t,e,n){super(t,e,[`${Qw}|${n}`]),this.pathConstraintIndex=0,this.pathConstraintIndex=n}getFrameEntries(){return 4}setFrame(t,e,n,s,i){const r=this.frames;r[t<<=2]=e,r[t+1]=n,r[t+2]=s,r[t+3]=i}apply(t,e,n,s,i,r,a){const o=t.pathConstraints[this.pathConstraintIndex];if(!o.active)return;const l=this.frames;if(n<l[0]){switch(r){case $x.setup:return o.mixRotate=o.data.mixRotate,o.mixX=o.data.mixX,void(o.mixY=o.data.mixY);case $x.first:o.mixRotate+=(o.data.mixRotate-o.mixRotate)*i,o.mixX+=(o.data.mixX-o.mixX)*i,o.mixY+=(o.data.mixY-o.mixY)*i}return}let h,c,u;const d=tE.search(l,n,4),f=this.curves[d>>2];switch(f){case 0:const t=l[d];h=l[d+1],c=l[d+2],u=l[d+3];const e=(n-t)/(l[d+4]-t);h+=(l[d+4+1]-h)*e,c+=(l[d+4+2]-c)*e,u+=(l[d+4+3]-u)*e;break;case 1:h=l[d+1],c=l[d+2],u=l[d+3];break;default:h=this.getBezierValue(n,d,1,f-2),c=this.getBezierValue(n,d,2,f+18-2),u=this.getBezierValue(n,d,3,f+36-2)}if(r==$x.setup){const t=o.data;o.mixRotate=t.mixRotate+(h-t.mixRotate)*i,o.mixX=t.mixX+(c-t.mixX)*i,o.mixY=t.mixY+(u-t.mixY)*i}else o.mixRotate+=(h-o.mixRotate)*i,o.mixX+=(c-o.mixX)*i,o.mixY+=(u-o.mixY)*i}}const RE=class extends tE{constructor(t,e,n){super(t,[`${Jw}|${e}|${n.sequence.id}`]),this.slotIndex=e,this.attachment=n}getFrameEntries(){return RE.ENTRIES}getSlotIndex(){return this.slotIndex}getAttachment(){return this.attachment}setFrame(t,e,n,s,i){const r=this.frames;r[t*=RE.ENTRIES]=e,r[t+RE.MODE]=n|s<<4,r[t+RE.DELAY]=i}apply(t,e,n,s,i,r,a){const o=t.slots[this.slotIndex];if(!o.bone.active)return;const l=o.attachment,h=this.attachment;if(!(l==h||l instanceof bw&&l.timelineAttachment==h))return;const c=this.frames;if(n<c[0])return void(r!=$x.setup&&r!=$x.first||(o.sequenceIndex=-1));const u=tE.search(c,n,RE.ENTRIES),d=c[u],f=c[u+RE.MODE],p=c[u+RE.DELAY];if(!this.attachment.sequence)return;let m=f>>4;const g=this.attachment.sequence.regions.length,v=kw[15&f];if(v!=Pw.hold)switch(m+=(n-d)/p+1e-5|0,v){case Pw.once:m=Math.min(g-1,m);break;case Pw.loop:m%=g;break;case Pw.pingpong:{const t=(g<<1)-2;m=0==t?0:m%t,m>=g&&(m=t-m);break}case Pw.onceReverse:m=Math.max(g-1-m,0);break;case Pw.loopReverse:m=g-1-m%g;break;case Pw.pingpongReverse:{const t=(g<<1)-2;m=0==t?0:(m+g-1)%t,m>=g&&(m=t-m)}}o.sequenceIndex=m}};let PE=RE;PE.ENTRIES=3,PE.MODE=1,PE.DELAY=2;const kE=class{constructor(t){this.tracks=new Array,this.timeScale=1,this.unkeyedState=0,this.events=new Array,this.listeners=new Array,this.queue=new LE(this),this.propertyIDs=new hy,this.animationsChanged=!1,this.trackEntryPool=new yy((()=>new DE)),this.data=t}static emptyAnimation(){return kE._emptyAnimation}update(t){t*=this.timeScale;const e=this.tracks;for(let n=0,s=e.length;n<s;n++){const s=e[n];if(!s)continue;s.animationLast=s.nextAnimationLast,s.trackLast=s.nextTrackLast;let i=t*s.timeScale;if(s.delay>0){if(s.delay-=i,s.delay>0)continue;i=-s.delay,s.delay=0}let r=s.next;if(r){const e=s.trackLast-r.delay;if(e>=0){for(r.delay=0,r.trackTime+=0==s.timeScale?0:(e/s.timeScale+t)*r.timeScale,s.trackTime+=i,this.setCurrent(n,r,!0);r.mixingFrom;)r.mixTime+=t,r=r.mixingFrom;continue}}else if(s.trackLast>=s.trackEnd&&!s.mixingFrom){e[n]=null,this.queue.end(s),this.clearNext(s);continue}if(s.mixingFrom&&this.updateMixingFrom(s,t)){let t=s.mixingFrom;for(s.mixingFrom=null,t&&(t.mixingTo=null);t;)this.queue.end(t),t=t.mixingFrom}s.trackTime+=i}this.queue.drain()}updateMixingFrom(t,e){const n=t.mixingFrom;if(!n)return!0;const s=this.updateMixingFrom(n,e);return n.animationLast=n.nextAnimationLast,n.trackLast=n.nextTrackLast,t.mixTime>0&&t.mixTime>=t.mixDuration?(0!=n.totalAlpha&&0!=t.mixDuration||(t.mixingFrom=n.mixingFrom,n.mixingFrom&&(n.mixingFrom.mixingTo=t),t.interruptAlpha=n.interruptAlpha,this.queue.end(n)),s):(n.trackTime+=e*n.timeScale,t.mixTime+=e,!1)}apply(t){if(!t)throw new Error("skeleton cannot be null.");this.animationsChanged&&this._animationsChanged();const e=this.events,n=this.tracks;let s=!1;for(let a=0,o=n.length;a<o;a++){const i=n[a];if(!i||i.delay>0)continue;s=!0;const r=0==a?$x.first:i.mixBlend;let o=i.alpha;i.mixingFrom?o*=this.applyMixingFrom(i,t,r):i.trackTime>=i.trackEnd&&!i.next&&(o=0);const l=i.animationLast,h=i.getAnimationTime();let c=h,u=e;i.reverse&&(c=i.animation.duration-c,u=null);const d=i.animation.timelines,f=d.length;if(0==a&&1==o||r==$x.add)for(let e=0;e<f;e++){const n=d[e];n instanceof yE?this.applyAttachmentTimeline(n,t,c,r,!0):n.apply(t,l,c,u,o,r,qx.mixIn)}else{const e=i.timelineMode,n=i.shortestRotation,s=!n&&i.timelinesRotation.length!=f<<1;s&&(i.timelinesRotation.length=f<<1);for(let a=0;a<f;a++){const h=d[a],f=e[a]==BE?r:$x.setup;!n&&h instanceof iE?this.applyRotateTimeline(h,t,c,o,f,i.timelinesRotation,a<<1,s):h instanceof yE?this.applyAttachmentTimeline(h,t,c,r,!0):h.apply(t,l,c,u,o,f,qx.mixIn)}}this.queueEvents(i,h),e.length=0,i.nextAnimationLast=h,i.nextTrackLast=i.trackTime}const i=this.unkeyedState+WE,r=t.slots;for(let a=0,o=t.slots.length;a<o;a++){const e=r[a];if(e.attachmentState==i){const n=e.data.attachmentName;e.setAttachment(n?t.getAttachment(e.data.index,n):null)}}return this.unkeyedState+=2,this.queue.drain(),s}applyMixingFrom(t,e,n){const s=t.mixingFrom;s.mixingFrom&&this.applyMixingFrom(s,e,n);let i=0;0==t.mixDuration?(i=1,n==$x.first&&(n=$x.setup)):(i=t.mixTime/t.mixDuration,i>1&&(i=1),n!=$x.first&&(n=s.mixBlend));const r=i<s.attachmentThreshold,a=i<s.drawOrderThreshold,o=s.animation.timelines,l=o.length,h=s.alpha*t.interruptAlpha,c=h*(1-i),u=s.animationLast,d=s.getAnimationTime();let f=d,p=null;if(s.reverse?f=s.animation.duration-f:i<s.eventThreshold&&(p=this.events),n==$x.add)for(let m=0;m<l;m++)o[m].apply(e,u,f,p,c,n,qx.mixOut);else{const t=s.timelineMode,i=s.timelineHoldMix,d=s.shortestRotation,m=!d&&s.timelinesRotation.length!=l<<1;m&&(s.timelinesRotation.length=l<<1),s.totalAlpha=0;for(let g=0;g<l;g++){const l=o[g];let v,x=qx.mixOut,y=0;switch(t[g]){case BE:if(!a&&l instanceof TE)continue;v=n,y=c;break;case VE:v=$x.setup,y=c;break;case UE:v=n,y=h;break;case XE:v=$x.setup,y=h;break;default:v=$x.setup;const t=i[g];y=h*Math.max(0,1-t.mixTime/t.mixDuration)}s.totalAlpha+=y,!d&&l instanceof iE?this.applyRotateTimeline(l,e,f,y,v,s.timelinesRotation,g<<1,m):l instanceof yE?this.applyAttachmentTimeline(l,e,f,v,r):(a&&l instanceof TE&&v==$x.setup&&(x=qx.mixIn),l.apply(e,u,f,p,y,v,x))}}return t.mixDuration>0&&this.queueEvents(s,d),this.events.length=0,s.nextAnimationLast=d,s.nextTrackLast=s.trackTime,i}applyAttachmentTimeline(t,e,n,s,i){const r=e.slots[t.slotIndex];r.bone.active&&(n<t.frames[0]?s!=$x.setup&&s!=$x.first||this.setAttachment(e,r,r.data.attachmentName,i):this.setAttachment(e,r,t.attachmentNames[tE.search1(t.frames,n)],i),r.attachmentState<=this.unkeyedState&&(r.attachmentState=this.unkeyedState+WE))}setAttachment(t,e,n,s){e.setAttachment(n?t.getAttachment(e.data.index,n):null),s&&(e.attachmentState=this.unkeyedState+zE)}applyRotateTimeline(t,e,n,s,i,r,a,o){if(o&&(r[a]=0),1==s)return void t.apply(e,0,n,null,1,i,qx.mixIn);const l=e.bones[t.boneIndex];if(!l.active)return;let h=0,c=0;if(n<t.frames[0])switch(i){case $x.setup:l.rotation=l.data.rotation;default:return;case $x.first:h=l.rotation,c=l.data.rotation}else h=i==$x.setup?l.data.rotation:l.rotation,c=l.data.rotation+t.getCurveValue(n);let u=0,d=c-h;if(d-=360*(16384-(16384.499999999996-d/360|0)),0==d)u=r[a];else{let t=0,e=0;o?(t=0,e=d):(t=r[a],e=r[a+1]);const n=d>0;let s=t>=0;fy.signum(e)!=fy.signum(d)&&Math.abs(e)<=90&&(Math.abs(t)>180&&(t+=360*fy.signum(t)),s=n),u=d+t-t%360,s!=n&&(u+=360*fy.signum(t)),r[a]=u}r[a+1]=d,l.rotation=h+u*s}queueEvents(t,e){const n=t.animationStart,s=t.animationEnd,i=s-n,r=t.trackLast%i,a=this.events;let o=0;const l=a.length;for(;o<l;o++){const e=a[o];if(e.time<r)break;e.time>s||this.queue.event(t,e)}let h=!1;for(h=t.loop?0==i||r>t.trackTime%i:e>=s&&t.animationLast<s,h&&this.queue.complete(t);o<l;o++){const e=a[o];e.time<n||this.queue.event(t,e)}}clearTracks(){const t=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(let e=0,n=this.tracks.length;e<n;e++)this.clearTrack(e);this.tracks.length=0,this.queue.drainDisabled=t,this.queue.drain()}clearTrack(t){if(t>=this.tracks.length)return;const e=this.tracks[t];if(!e)return;this.queue.end(e),this.clearNext(e);let n=e;for(;;){const t=n.mixingFrom;if(!t)break;this.queue.end(t),n.mixingFrom=null,n.mixingTo=null,n=t}this.tracks[e.trackIndex]=null,this.queue.drain()}setCurrent(t,e,n){const s=this.expandToIndex(t);this.tracks[t]=e,e.previous=null,s&&(n&&this.queue.interrupt(s),e.mixingFrom=s,s.mixingTo=e,e.mixTime=0,s.mixingFrom&&s.mixDuration>0&&(e.interruptAlpha*=Math.min(1,s.mixTime/s.mixDuration)),s.timelinesRotation.length=0),this.queue.start(e)}setAnimation(t,e,n=!1){const s=this.data.skeletonData.findAnimation(e);if(!s)throw new Error(`Animation not found: ${e}`);return this.setAnimationWith(t,s,n)}setAnimationWith(t,e,n=!1){if(!e)throw new Error("animation cannot be null.");let s=!0,i=this.expandToIndex(t);i&&(-1==i.nextTrackLast?(this.tracks[t]=i.mixingFrom,this.queue.interrupt(i),this.queue.end(i),this.clearNext(i),i=i.mixingFrom,s=!1):this.clearNext(i));const r=this.trackEntry(t,e,n,i);return this.setCurrent(t,r,s),this.queue.drain(),r}addAnimation(t,e,n=!1,s=0){const i=this.data.skeletonData.findAnimation(e);if(!i)throw new Error(`Animation not found: ${e}`);return this.addAnimationWith(t,i,n,s)}addAnimationWith(t,e,n=!1,s=0){if(!e)throw new Error("animation cannot be null.");let i=this.expandToIndex(t);if(i)for(;i.next;)i=i.next;const r=this.trackEntry(t,e,n,i);return i?(i.next=r,r.previous=i,s<=0&&(s+=i.getTrackComplete()-r.mixDuration)):(this.setCurrent(t,r,!0),this.queue.drain()),r.delay=s,r}setEmptyAnimation(t,e=0){const n=this.setAnimationWith(t,kE.emptyAnimation(),!1);return n.mixDuration=e,n.trackEnd=e,n}addEmptyAnimation(t,e=0,n=0){const s=this.addAnimationWith(t,kE.emptyAnimation(),!1,n);return n<=0&&(s.delay+=s.mixDuration-e),s.mixDuration=e,s.trackEnd=e,s}setEmptyAnimations(t=0){const e=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(let n=0,s=this.tracks.length;n<s;n++){const e=this.tracks[n];e&&this.setEmptyAnimation(e.trackIndex,t)}this.queue.drainDisabled=e,this.queue.drain()}expandToIndex(t){return t<this.tracks.length?this.tracks[t]:(xy.ensureArrayCapacity(this.tracks,t+1,null),this.tracks.length=t+1,null)}trackEntry(t,e,n,s){const i=this.trackEntryPool.obtain();return i.reset(),i.trackIndex=t,i.animation=e,i.loop=n,i.holdPrevious=!1,i.reverse=!1,i.shortestRotation=!1,i.eventThreshold=0,i.attachmentThreshold=0,i.drawOrderThreshold=0,i.animationStart=0,i.animationEnd=e.duration,i.animationLast=-1,i.nextAnimationLast=-1,i.delay=0,i.trackTime=0,i.trackLast=-1,i.nextTrackLast=-1,i.trackEnd=Number.MAX_VALUE,i.timeScale=1,i.alpha=1,i.mixTime=0,i.mixDuration=s?this.data.getMix(s.animation,e):0,i.interruptAlpha=1,i.totalAlpha=0,i.mixBlend=$x.replace,i}clearNext(t){let e=t.next;for(;e;)this.queue.dispose(e),e=e.next;t.next=null}_animationsChanged(){this.animationsChanged=!1,this.propertyIDs.clear();const t=this.tracks;for(let e=0,n=t.length;e<n;e++){let n=t[e];if(n){for(;n.mixingFrom;)n=n.mixingFrom;do{n.mixingTo&&n.mixBlend==$x.add||this.computeHold(n),n=n.mixingTo}while(n)}}}computeHold(t){const e=t.mixingTo,n=t.animation.timelines,s=t.animation.timelines.length,i=t.timelineMode;i.length=s;const r=t.timelineHoldMix;r.length=0;const a=this.propertyIDs;if(e&&e.holdPrevious)for(let o=0;o<s;o++)i[o]=a.addAll(n[o].getPropertyIds())?XE:UE;else t:for(let o=0;o<s;o++){const s=n[o],l=s.getPropertyIds();if(a.addAll(l))if(!e||s instanceof yE||s instanceof TE||s instanceof wE||!e.animation.hasTimeline(l))i[o]=VE;else{for(let n=e.mixingTo;n;n=n.mixingTo)if(!n.animation.hasTimeline(l)){if(t.mixDuration>0){i[o]=YE,r[o]=n;continue t}break}i[o]=XE}else i[o]=BE}}getCurrent(t){return t>=this.tracks.length?null:this.tracks[t]}addListener(t){if(!t)throw new Error("listener cannot be null.");this.listeners.push(t)}removeListener(t){const e=this.listeners.indexOf(t);e>=0&&this.listeners.splice(e,1)}clearListeners(){this.listeners.length=0}clearListenerNotifications(){this.queue.clear()}setAnimationByName(t,e,n){kE.deprecatedWarning1||(kE.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: AnimationState.setAnimationByName is deprecated, please use setAnimation from now on.")),this.setAnimation(t,e,n)}addAnimationByName(t,e,n,s){kE.deprecatedWarning2||(kE.deprecatedWarning2=!0,console.warn("Spine Deprecation Warning: AnimationState.addAnimationByName is deprecated, please use addAnimation from now on.")),this.addAnimation(t,e,n,s)}hasAnimation(t){return null!==this.data.skeletonData.findAnimation(t)}hasAnimationByName(t){return kE.deprecatedWarning3||(kE.deprecatedWarning3=!0,console.warn("Spine Deprecation Warning: AnimationState.hasAnimationByName is deprecated, please use hasAnimation from now on.")),this.hasAnimation(t)}};let FE=kE;FE._emptyAnimation=new Fw("<empty>",[],0),FE.deprecatedWarning1=!1,FE.deprecatedWarning2=!1,FE.deprecatedWarning3=!1;const OE=class{constructor(){this.animation=null,this.previous=null,this.next=null,this.mixingFrom=null,this.mixingTo=null,this.listener=null,this.trackIndex=0,this.loop=!1,this.holdPrevious=!1,this.reverse=!1,this.shortestRotation=!1,this.eventThreshold=0,this.attachmentThreshold=0,this.drawOrderThreshold=0,this.animationStart=0,this.animationEnd=0,this.animationLast=0,this.nextAnimationLast=0,this.delay=0,this.trackTime=0,this.trackLast=0,this.nextTrackLast=0,this.trackEnd=0,this.timeScale=0,this.alpha=0,this.mixTime=0,this.mixDuration=0,this.interruptAlpha=0,this.totalAlpha=0,this.mixBlend=$x.replace,this.timelineMode=new Array,this.timelineHoldMix=new Array,this.timelinesRotation=new Array}reset(){this.next=null,this.previous=null,this.mixingFrom=null,this.mixingTo=null,this.animation=null,this.listener=null,this.timelineMode.length=0,this.timelineHoldMix.length=0,this.timelinesRotation.length=0}getAnimationTime(){if(this.loop){const t=this.animationEnd-this.animationStart;return 0==t?this.animationStart:this.trackTime%t+this.animationStart}return Math.min(this.trackTime+this.animationStart,this.animationEnd)}setAnimationLast(t){this.animationLast=t,this.nextAnimationLast=t}isComplete(){return this.trackTime>=this.animationEnd-this.animationStart}resetRotationDirections(){this.timelinesRotation.length=0}getTrackComplete(){const t=this.animationEnd-this.animationStart;if(0!=t){if(this.loop)return t*(1+(this.trackTime/t|0));if(this.trackTime<t)return t}return this.trackTime}get time(){return OE.deprecatedWarning1||(OE.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: TrackEntry.time is deprecated, please use trackTime from now on.")),this.trackTime}set time(t){OE.deprecatedWarning1||(OE.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: TrackEntry.time is deprecated, please use trackTime from now on.")),this.trackTime=t}get endTime(){return OE.deprecatedWarning2||(OE.deprecatedWarning2=!0,console.warn("Spine Deprecation Warning: TrackEntry.endTime is deprecated, please use trackEnd from now on.")),this.trackTime}set endTime(t){OE.deprecatedWarning2||(OE.deprecatedWarning2=!0,console.warn("Spine Deprecation Warning: TrackEntry.endTime is deprecated, please use trackEnd from now on.")),this.trackTime=t}loopsCount(){return Math.floor(this.trackTime/this.trackEnd)}};let DE=OE;DE.deprecatedWarning1=!1,DE.deprecatedWarning2=!1;class LE{constructor(t){this.objects=[],this.drainDisabled=!1,this.animState=t}start(t){this.objects.push(NE.start),this.objects.push(t),this.animState.animationsChanged=!0}interrupt(t){this.objects.push(NE.interrupt),this.objects.push(t)}end(t){this.objects.push(NE.end),this.objects.push(t),this.animState.animationsChanged=!0}dispose(t){this.objects.push(NE.dispose),this.objects.push(t)}complete(t){this.objects.push(NE.complete),this.objects.push(t)}event(t,e){this.objects.push(NE.event),this.objects.push(t),this.objects.push(e)}drain(){if(this.drainDisabled)return;this.drainDisabled=!0;const t=this.objects,e=this.animState.listeners;for(let n=0;n<t.length;n+=2){const s=t[n],i=t[n+1];switch(s){case NE.start:i.listener&&i.listener.start&&i.listener.start(i);for(let t=0;t<e.length;t++){const n=e[t];n.start&&n.start(i)}break;case NE.interrupt:i.listener&&i.listener.interrupt&&i.listener.interrupt(i);for(let t=0;t<e.length;t++){const n=e[t];n.interrupt&&n.interrupt(i)}break;case NE.end:i.listener&&i.listener.end&&i.listener.end(i);for(let t=0;t<e.length;t++){const n=e[t];n.end&&n.end(i)}case NE.dispose:i.listener&&i.listener.dispose&&i.listener.dispose(i);for(let t=0;t<e.length;t++){const n=e[t];n.dispose&&n.dispose(i)}this.animState.trackEntryPool.free(i);break;case NE.complete:i.listener&&i.listener.complete&&i.listener.complete(i);for(let t=0;t<e.length;t++){const n=e[t];n.complete&&n.complete(i)}break;case NE.event:const s=t[2+n++];i.listener&&i.listener.event&&i.listener.event(i,s);for(let t=0;t<e.length;t++){const n=e[t];n.event&&n.event(i,s)}}}this.clear(),this.drainDisabled=!1}clear(){this.objects.length=0}}var NE=(t=>(t[t.start=0]="start",t[t.interrupt=1]="interrupt",t[t.end=2]="end",t[t.dispose=3]="dispose",t[t.complete=4]="complete",t[t.event=5]="event",t))(NE||{});const BE=0,VE=1,UE=2,XE=3,YE=4,WE=1,zE=2;class GE{constructor(t){if(this.animationToMixTime={},this.defaultMix=0,!t)throw new Error("skeletonData cannot be null.");this.skeletonData=t}setMix(t,e,n){const s=this.skeletonData.findAnimation(t);if(!s)throw new Error(`Animation not found: ${t}`);const i=this.skeletonData.findAnimation(e);if(!i)throw new Error(`Animation not found: ${e}`);this.setMixWith(s,i,n)}setMixWith(t,e,n){if(!t)throw new Error("from cannot be null.");if(!e)throw new Error("to cannot be null.");const s=`${t.name}.${e.name}`;this.animationToMixTime[s]=n}getMix(t,e){const n=`${t.name}.${e.name}`,s=this.animationToMixTime[n];return void 0===s?this.defaultMix:s}}class HE{constructor(t){this.atlas=t}loadSequence(t,e,n){const s=n.regions;for(let i=0,r=s.length;i<r;i++){const r=n.getPath(e,i),a=this.atlas.findRegion(r);if(null==a)throw new Error(`Region not found in atlas: ${r} (sequence: ${t})`);s[i]=a,s[i].renderObject=s[i]}}newRegionAttachment(t,e,n,s){const i=new Iw(e,n);if(null!=s)this.loadSequence(e,n,s);else{const t=this.atlas.findRegion(n);if(!t)throw new Error(`Region not found in atlas: ${n} (region attachment: ${e})`);t.renderObject=t,i.region=t}return i}newMeshAttachment(t,e,n,s){const i=new Tw(e,n);if(null!=s)this.loadSequence(e,n,s);else{const t=this.atlas.findRegion(n);if(!t)throw new Error(`Region not found in atlas: ${n} (mesh attachment: ${e})`);t.renderObject=t,i.region=t}return i}newBoundingBoxAttachment(t,e){return new ww(e)}newPathAttachment(t,e){return new Sw(e)}newPointAttachment(t,e){return new Aw(e)}newClippingAttachment(t,e){return new Ew(e)}}class jE{constructor(t,e,n){if(this.matrix=new nh,this.parent=null,this.children=new Array,this.x=0,this.y=0,this.rotation=0,this.scaleX=0,this.scaleY=0,this.shearX=0,this.shearY=0,this.ax=0,this.ay=0,this.arotation=0,this.ascaleX=0,this.ascaleY=0,this.ashearX=0,this.ashearY=0,this.sorted=!1,this.active=!1,!t)throw new Error("data cannot be null.");if(!e)throw new Error("skeleton cannot be null.");this.data=t,this.skeleton=e,this.parent=n,this.setToSetupPose()}get worldX(){return this.matrix.tx}get worldY(){return this.matrix.ty}isActive(){return this.active}update(){this.updateWorldTransformWith(this.ax,this.ay,this.arotation,this.ascaleX,this.ascaleY,this.ashearX,this.ashearY)}updateWorldTransform(){this.updateWorldTransformWith(this.x,this.y,this.rotation,this.scaleX,this.scaleY,this.shearX,this.shearY)}updateWorldTransformWith(t,e,n,s,i,r,a){this.ax=t,this.ay=e,this.arotation=n,this.ascaleX=s,this.ascaleY=i,this.ashearX=r,this.ashearY=a;const o=this.parent,l=this.matrix,h=this.skeleton.scaleX,c=-this.skeleton.scaleY;if(!o){const o=this.skeleton,u=n+90+a;return l.a=fy.cosDeg(n+r)*s*h,l.c=fy.cosDeg(u)*i*h,l.b=fy.sinDeg(n+r)*s*c,l.d=fy.sinDeg(u)*i*c,l.tx=t*h+o.x,void(l.ty=e*c+o.y)}let u=o.matrix.a,d=o.matrix.c,f=o.matrix.b,p=o.matrix.d;switch(l.tx=u*t+d*e+o.matrix.tx,l.ty=f*t+p*e+o.matrix.ty,this.data.transformMode){case Qx.Normal:{const t=n+90+a,e=fy.cosDeg(n+r)*s,o=fy.cosDeg(t)*i,h=fy.sinDeg(n+r)*s,c=fy.sinDeg(t)*i;return l.a=u*e+d*h,l.c=u*o+d*c,l.b=f*e+p*h,void(l.d=f*o+p*c)}case Qx.OnlyTranslation:{const t=n+90+a;l.a=fy.cosDeg(n+r)*s,l.c=fy.cosDeg(t)*i,l.b=fy.sinDeg(n+r)*s,l.d=fy.sinDeg(t)*i;break}case Qx.NoRotationOrReflection:{let t=u*u+f*f,e=0;t>1e-4?(t=Math.abs(u*p-d*f)/t,u/=h,f/=c,d=f*t,p=u*t,e=Math.atan2(f,u)*fy.radDeg):(u=0,f=0,e=90-Math.atan2(p,d)*fy.radDeg);const o=n+r-e,m=n+a-e+90,g=fy.cosDeg(o)*s,v=fy.cosDeg(m)*i,x=fy.sinDeg(o)*s,y=fy.sinDeg(m)*i;l.a=u*g-d*x,l.c=u*v-d*y,l.b=f*g+p*x,l.d=f*v+p*y;break}case Qx.NoScale:case Qx.NoScaleOrReflection:{const t=fy.cosDeg(n),e=fy.sinDeg(n);let o=(u*t+d*e)/h,m=(f*t+p*e)/c,g=Math.sqrt(o*o+m*m);g>1e-5&&(g=1/g),o*=g,m*=g,g=Math.sqrt(o*o+m*m),this.data.transformMode==Qx.NoScale&&u*p-d*f<0!=(h<0!=c<0)&&(g=-g);const v=Math.PI/2+Math.atan2(m,o),x=Math.cos(v)*g,y=Math.sin(v)*g,_=fy.cosDeg(r)*s,b=fy.cosDeg(90+a)*i,w=fy.sinDeg(r)*s,E=fy.sinDeg(90+a)*i;l.a=o*_+x*w,l.c=o*b+x*E,l.b=m*_+y*w,l.d=m*b+y*E;break}}l.a*=h,l.c*=h,l.b*=c,l.d*=c}setToSetupPose(){const t=this.data;this.x=t.x,this.y=t.y,this.rotation=t.rotation,this.scaleX=t.scaleX,this.scaleY=t.scaleY,this.shearX=t.shearX,this.shearY=t.shearY}getWorldRotationX(){return Math.atan2(this.matrix.b,this.matrix.a)*fy.radDeg}getWorldRotationY(){return Math.atan2(this.matrix.d,this.matrix.c)*fy.radDeg}getWorldScaleX(){const t=this.matrix;return Math.sqrt(t.a*t.a+t.b*t.b)}getWorldScaleY(){const t=this.matrix;return Math.sqrt(t.c*t.c+t.d*t.d)}updateAppliedTransform(){const t=this.parent,e=this.matrix;if(!t)return this.ax=e.tx-this.skeleton.x,this.ay=e.ty-this.skeleton.y,this.arotation=Math.atan2(e.b,e.a)*fy.radDeg,this.ascaleX=Math.sqrt(e.a*e.a+e.b*e.b),this.ascaleY=Math.sqrt(e.c*e.c+e.d*e.d),this.ashearX=0,void(this.ashearY=Math.atan2(e.a*e.c+e.b*e.d,e.a*e.d-e.b*e.c)*fy.radDeg);const n=t.matrix,s=1/(n.a*n.d-n.b*n.c),i=e.tx-n.tx,r=e.ty-n.ty;this.ax=i*n.d*s-r*n.c*s,this.ay=r*n.a*s-i*n.b*s;const a=s*n.d,o=s*n.a,l=s*n.c,h=s*n.b,c=a*e.a-l*e.b,u=a*e.c-l*e.d,d=o*e.b-h*e.a,f=o*e.d-h*e.c;if(this.ashearX=0,this.ascaleX=Math.sqrt(c*c+d*d),this.ascaleX>1e-4){const t=c*f-u*d;this.ascaleY=t/this.ascaleX,this.ashearY=Math.atan2(c*u+d*f,t)*fy.radDeg,this.arotation=Math.atan2(d,c)*fy.radDeg}else this.ascaleX=0,this.ascaleY=Math.sqrt(u*u+f*f),this.ashearY=0,this.arotation=90-Math.atan2(f,u)*fy.radDeg}worldToLocal(t){const e=this.matrix,n=e.a,s=e.c,i=e.b,r=e.d,a=1/(n*r-s*i),o=t.x-e.tx,l=t.y-e.ty;return t.x=o*r*a-l*s*a,t.y=l*n*a-o*i*a,t}localToWorld(t){const e=this.matrix,n=t.x,s=t.y;return t.x=n*e.a+s*e.c+e.tx,t.y=n*e.b+s*e.d+e.ty,t}worldToLocalRotation(t){const e=fy.sinDeg(t),n=fy.cosDeg(t),s=this.matrix;return Math.atan2(s.a*e-s.b*n,s.d*n-s.c*e)*fy.radDeg}localToWorldRotation(t){t-=this.rotation-this.shearX;const e=fy.sinDeg(t),n=fy.cosDeg(t),s=this.matrix;return Math.atan2(n*s.b+e*s.d,n*s.a+e*s.c)*fy.radDeg}rotateWorld(t){const e=this.matrix,n=e.a,s=e.c,i=e.b,r=e.d,a=fy.cosDeg(t),o=fy.sinDeg(t);e.a=a*n-o*i,e.c=a*s-o*r,e.b=o*n+a*i,e.d=o*s+a*r}}class $E{constructor(t,e,n){if(this.index=0,this.parent=null,this.length=0,this.x=0,this.y=0,this.rotation=0,this.scaleX=1,this.scaleY=1,this.shearX=0,this.shearY=0,this.transformMode=Qx.Normal,this.skinRequired=!1,this.color=new uy,t<0)throw new Error("index must be >= 0.");if(!e)throw new Error("name cannot be null.");this.index=t,this.name=e,this.parent=n}}class qE{constructor(t,e,n){this.name=t,this.order=e,this.skinRequired=n}}let KE=class{constructor(t,e){if(this.intValue=0,this.floatValue=0,this.stringValue=null,this.time=0,this.volume=0,this.balance=0,!e)throw new Error("data cannot be null.");this.time=t,this.data=e}};class ZE{constructor(t){this.intValue=0,this.floatValue=0,this.stringValue=null,this.audioPath=null,this.volume=0,this.balance=0,this.name=t}}class QE{constructor(t,e){if(this.bendDirection=0,this.compress=!1,this.stretch=!1,this.mix=1,this.softness=0,this.active=!1,!t)throw new Error("data cannot be null.");if(!e)throw new Error("skeleton cannot be null.");this.data=t,this.mix=t.mix,this.softness=t.softness,this.bendDirection=t.bendDirection,this.compress=t.compress,this.stretch=t.stretch,this.bones=new Array;for(let s=0;s<t.bones.length;s++){const n=e.findBone(t.bones[s].name);if(!n)throw new Error(`Couldn't find bone ${t.bones[s].name}`);this.bones.push(n)}const n=e.findBone(t.target.name);if(!n)throw new Error(`Couldn't find bone ${t.target.name}`);this.target=n}isActive(){return this.active}update(){if(0==this.mix)return;const t=this.target,e=this.bones;switch(e.length){case 1:this.apply1(e[0],t.worldX,t.worldY,this.compress,this.stretch,this.data.uniform,this.mix);break;case 2:this.apply2(e[0],e[1],t.worldX,t.worldY,this.bendDirection,this.stretch,this.data.uniform,this.softness,this.mix)}}apply1(t,e,n,s,i,r,a){const o=t.parent.matrix;if(!o)throw new Error("IK bone must have parent.");const l=o.a;let h=o.c;const c=o.b;let u=o.d,d=-t.ashearX-t.arotation,f=0,p=0;const m=t.skeleton.scaleX,g=-t.skeleton.scaleY;switch(t.data.transformMode){case Qx.OnlyTranslation:f=e-t.worldX,p=n-t.worldY,p=-p;break;case Qx.NoRotationOrReflection:const s=Math.abs(l*u-h*c)/(l*l+c*c),i=l/m,r=c/g;h=-r*s*m,u=i*s*g,d+=Math.atan2(r,i)*fy.radDeg;default:const a=e-o.tx,v=n-o.ty,x=l*u-h*c;f=(a*u-v*h)/x-t.ax,p=(v*l-a*c)/x-t.ay}d+=Math.atan2(p,f)*fy.radDeg,t.ascaleX<0&&(d+=180),d>180?d-=360:d<-180&&(d+=360);let v=t.ascaleX,x=t.ascaleY;if(s||i){switch(t.data.transformMode){case Qx.NoScale:case Qx.NoScaleOrReflection:f=e-t.worldX,p=n-t.worldY}const o=t.data.length*v,l=Math.sqrt(f*f+p*p);if(s&&l<o||i&&l>o&&o>1e-4){const t=(l/o-1)*a+1;v*=t,r&&(x*=t)}}t.updateWorldTransformWith(t.ax,t.ay,t.arotation+d*a,v,x,t.ashearX,t.ashearY)}apply2(t,e,n,s,i,r,a,o,l){const h=t.ax,c=t.ay;let u=t.ascaleX,d=t.ascaleY,f=u,p=d,m=e.ascaleX;const g=t.matrix;let v=0,x=0,y=0;u<0?(u=-u,v=180,y=-1):(v=0,y=1),d<0&&(d=-d,y=-y),m<0?(m=-m,x=180):x=0;const _=e.ax;let b=0,w=0,E=0,T=g.a,S=g.c,A=g.b,C=g.d;const I=Math.abs(u-d)<=1e-4;!I||r?(b=0,w=T*_+g.tx,E=A*_+g.ty):(b=e.ay,w=T*_+S*b+g.tx,E=A*_+C*b+g.ty);const M=t.parent.matrix;if(!M)throw new Error("IK parent must itself have a parent.");T=M.a,S=M.c,A=M.b,C=M.d;const R=1/(T*C-S*A);let P=w-M.tx,k=E-M.ty;const F=(P*C-k*S)*R-h,O=(k*T-P*A)*R-c,D=Math.sqrt(F*F+O*O);let L,N,B=e.data.length*m;if(D<1e-4)return this.apply1(t,n,s,!1,r,!1,l),void e.updateWorldTransformWith(_,b,0,e.ascaleX,e.ascaleY,e.ashearX,e.ashearY);P=n-M.tx,k=s-M.ty;let V=(P*C-k*S)*R-h,U=(k*T-P*A)*R-c,X=V*V+U*U;if(0!=o){o*=u*(m+1)*.5;const t=Math.sqrt(X),e=t-D-B*u+o;if(e>0){let n=Math.min(1,e/(2*o))-1;n=(e-o*(1-n*n))/t,V-=n*V,U-=n*U,X=V*V+U*U}}t:if(I){B*=u;let t=(X-D*D-B*B)/(2*D*B);t<-1?(t=-1,N=Math.PI*i):t>1?(t=1,N=0,r&&(T=(Math.sqrt(X)/(D+B)-1)*l+1,f*=T,a&&(p*=T))):N=Math.acos(t)*i,T=D+B*t,S=B*Math.sin(N),L=Math.atan2(U*T-V*S,V*T+U*S)}else{T=u*B,S=d*B;const t=T*T,e=S*S,n=Math.atan2(U,V);A=e*D*D+t*X-t*e;const s=-2*e*D,r=e-t;if(C=s*s-4*r*A,C>=0){let t=Math.sqrt(C);s<0&&(t=-t),t=.5*-(s+t);const e=t/r,a=A/t,o=Math.abs(e)<Math.abs(a)?e:a;if(o*o<=X){k=Math.sqrt(X-o*o)*i,L=n-Math.atan2(k,o),N=Math.atan2(k/d,(o-D)/u);break t}}let a=fy.PI,o=D-T,l=o*o,h=0,c=0,f=D+T,p=f*f,m=0;A=-T*D/(t-e),A>=-1&&A<=1&&(A=Math.acos(A),P=T*Math.cos(A)+D,k=S*Math.sin(A),C=P*P+k*k,C<l&&(a=A,l=C,o=P,h=k),C>p&&(c=A,p=C,f=P,m=k)),X<=.5*(l+p)?(L=n-Math.atan2(h*i,o),N=a*i):(L=n-Math.atan2(m*i,f),N=c*i)}const Y=Math.atan2(b,_)*y;let W=t.arotation;L=(L-Y)*fy.radDeg+v-W,L>180?L-=360:L<-180&&(L+=360),t.updateWorldTransformWith(h,c,W+L*l,f,p,0,0),W=e.arotation,N=((N+Y)*fy.radDeg-e.ashearX)*y+x-W,N>180?N-=360:N<-180&&(N+=360),e.updateWorldTransformWith(_,b,W+N*l,e.ascaleX,e.ascaleY,e.ashearX,e.ashearY)}}class JE extends qE{constructor(t){super(t,0,!1),this.bones=new Array,this._target=null,this.bendDirection=1,this.compress=!1,this.stretch=!1,this.uniform=!1,this.mix=1,this.softness=0}set target(t){this._target=t}get target(){if(this._target)return this._target;throw new Error("BoneData not set.")}}class tT extends qE{constructor(t){super(t,0,!1),this.bones=new Array,this._target=null,this.positionMode=Kx.Fixed,this.spacingMode=eT.Fixed,this.rotateMode=Zx.Chain,this.offsetRotation=0,this.position=0,this.spacing=0,this.mixRotate=0,this.mixX=0,this.mixY=0}set target(t){this._target=t}get target(){if(this._target)return this._target;throw new Error("SlotData not set.")}}var eT=(t=>(t[t.Length=0]="Length",t[t.Fixed=1]="Fixed",t[t.Percent=2]="Percent",t[t.Proportional=3]="Proportional",t))(eT||{});const nT=class{constructor(t,e){if(this.position=0,this.spacing=0,this.mixRotate=0,this.mixX=0,this.mixY=0,this.spaces=new Array,this.positions=new Array,this.world=new Array,this.curves=new Array,this.lengths=new Array,this.segments=new Array,this.active=!1,!t)throw new Error("data cannot be null.");if(!e)throw new Error("skeleton cannot be null.");this.data=t,this.bones=new Array;for(let s=0,i=t.bones.length;s<i;s++){const n=e.findBone(t.bones[s].name);if(!n)throw new Error(`Couldn't find bone ${t.bones[s].name}.`);this.bones.push(n)}const n=e.findSlot(t.target.name);if(!n)throw new Error(`Couldn't find target bone ${t.target.name}`);this.target=n,this.position=t.position,this.spacing=t.spacing,this.mixRotate=t.mixRotate,this.mixX=t.mixX,this.mixY=t.mixY}isActive(){return this.active}update(){const t=this.target.getAttachment();if(!(t instanceof Sw))return;const e=this.mixRotate,n=this.mixX,s=this.mixY;if(0==e&&0==n&&0==s)return;const i=this.data,r=i.rotateMode==Zx.Tangent,a=i.rotateMode==Zx.ChainScale,o=this.bones,l=o.length,h=r?l:l+1,c=xy.setArraySize(this.spaces,h),u=a?this.lengths=xy.setArraySize(this.lengths,l):[],d=this.spacing;switch(i.spacingMode){case eT.Percent:if(a)for(let n=0,s=h-1;n<s;n++){const t=o[n],e=t.data.length;if(e<nT.epsilon)u[n]=0;else{const s=e*t.matrix.a,i=e*t.matrix.b;u[n]=Math.sqrt(s*s+i*i)}}xy.arrayFill(c,1,h,d);break;case eT.Proportional:let t=0;for(let n=0,s=h-1;n<s;){const e=o[n],s=e.data.length;if(s<nT.epsilon)a&&(u[n]=0),c[++n]=d;else{const i=s*e.matrix.a,r=s*e.matrix.b,o=Math.sqrt(i*i+r*r);a&&(u[n]=o),c[++n]=o,t+=o}}if(t>0){t=h/t*d;for(let e=1;e<h;e++)c[e]*=t}break;default:const e=i.spacingMode==eT.Length;for(let n=0,s=h-1;n<s;){const t=o[n],s=t.data.length;if(s<nT.epsilon)a&&(u[n]=0),c[++n]=d;else{const i=s*t.matrix.a,r=s*t.matrix.b,o=Math.sqrt(i*i+r*r);a&&(u[n]=o),c[++n]=(e?s+d:d)*o/s}}}const f=this.computeWorldPositions(t,h,r);let p=f[0],m=f[1],g=i.offsetRotation,v=!1;if(0==g)v=i.rotateMode==Zx.Chain;else{v=!1;const t=this.target.bone.matrix;g*=t.a*t.d-t.b*t.c>0?fy.degRad:-fy.degRad}for(let x=0,y=3;x<l;x++,y+=3){const t=o[x],i=t.matrix;i.tx+=(p-i.tx)*n,i.ty+=(m-i.ty)*s;const l=f[y],h=f[y+1],d=l-p,_=h-m;if(a){const t=u[x];if(0!=t){const n=(Math.sqrt(d*d+_*_)/t-1)*e+1;i.a*=n,i.b*=n}}if(p=l,m=h,e>0){const n=i.a,s=i.c,a=i.b,o=i.d;let l=0,h=0,u=0;if(l=r?f[y-1]:0==c[x+1]?f[y+2]:Math.atan2(_,d),l-=Math.atan2(a,n),v){h=Math.cos(l),u=Math.sin(l);const s=t.data.length;p+=(s*(h*n-u*a)-d)*e,m+=(s*(u*n+h*a)-_)*e}else l+=g;l>fy.PI?l-=fy.PI2:l<-fy.PI&&(l+=fy.PI2),l*=e,h=Math.cos(l),u=Math.sin(l),i.a=h*n-u*a,i.c=h*s-u*o,i.b=u*n+h*a,i.d=u*s+h*o}t.updateAppliedTransform()}}computeWorldPositions(t,e,n){const s=this.target;let i=this.position;const r=this.spaces,a=xy.setArraySize(this.positions,3*e+2);let o=this.world;const l=t.closed;let h=t.worldVerticesLength,c=h/6,u=nT.NONE;if(!t.constantSpeed){const d=t.lengths;c-=l?1:2;const f=d[c];let p;switch(this.data.positionMode==Kx.Percent&&(i*=f),this.data.spacingMode){case eT.Percent:p=f;break;case eT.Proportional:p=f/e;break;default:p=1}o=xy.setArraySize(this.world,8);for(let m=0,g=0,v=0;m<e;m++,g+=3){const e=r[m]*p;i+=e;let x=i;if(l)x%=f,x<0&&(x+=f),v=0;else{if(x<0){u!=nT.BEFORE&&(u=nT.BEFORE,t.computeWorldVertices(s,2,4,o,0,2)),this.addBeforePosition(x,o,0,a,g);continue}if(x>f){u!=nT.AFTER&&(u=nT.AFTER,t.computeWorldVertices(s,h-6,4,o,0,2)),this.addAfterPosition(x-f,o,0,a,g);continue}}for(;;v++){const t=d[v];if(!(x>t)){if(0==v)x/=t;else{const e=d[v-1];x=(x-e)/(t-e)}break}}v!=u&&(u=v,l&&v==c?(t.computeWorldVertices(s,h-4,4,o,0,2),t.computeWorldVertices(s,0,4,o,4,2)):t.computeWorldVertices(s,6*v+2,8,o,0,2)),this.addCurvePosition(x,o[0],o[1],o[2],o[3],o[4],o[5],o[6],o[7],a,g,n||m>0&&0==e)}return a}l?(h+=2,o=xy.setArraySize(this.world,h),t.computeWorldVertices(s,2,h-4,o,0,2),t.computeWorldVertices(s,0,2,o,h-4,2),o[h-2]=o[0],o[h-1]=o[1]):(c--,h-=4,o=xy.setArraySize(this.world,h),t.computeWorldVertices(s,2,h,o,0,2));const d=xy.setArraySize(this.curves,c);let f,p=0,m=o[0],g=o[1],v=0,x=0,y=0,_=0,b=0,w=0,E=0,T=0,S=0,A=0,C=0,I=0,M=0,R=0;for(let F=0,O=2;F<c;F++,O+=6)v=o[O],x=o[O+1],y=o[O+2],_=o[O+3],b=o[O+4],w=o[O+5],E=.1875*(m-2*v+y),T=.1875*(g-2*x+_),S=.09375*(3*(v-y)-m+b),A=.09375*(3*(x-_)-g+w),C=2*E+S,I=2*T+A,M=.75*(v-m)+E+.16666667*S,R=.75*(x-g)+T+.16666667*A,p+=Math.sqrt(M*M+R*R),M+=C,R+=I,C+=S,I+=A,p+=Math.sqrt(M*M+R*R),M+=C,R+=I,p+=Math.sqrt(M*M+R*R),M+=C+S,R+=I+A,p+=Math.sqrt(M*M+R*R),d[F]=p,m=b,g=w;switch(this.data.positionMode==Kx.Percent&&(i*=p),this.data.spacingMode){case eT.Percent:f=p;break;case eT.Proportional:f=p/e;break;default:f=1}const P=this.segments;let k=0;for(let F=0,O=0,D=0,L=0;F<e;F++,O+=3){const t=r[F]*f;i+=t;let e=i;if(l)e%=p,e<0&&(e+=p),D=0;else{if(e<0){this.addBeforePosition(e,o,0,a,O);continue}if(e>p){this.addAfterPosition(e-p,o,h-4,a,O);continue}}for(;;D++){const t=d[D];if(!(e>t)){if(0==D)e/=t;else{const n=d[D-1];e=(e-n)/(t-n)}break}}if(D!=u){u=D;let t=6*D;for(m=o[t],g=o[t+1],v=o[t+2],x=o[t+3],y=o[t+4],_=o[t+5],b=o[t+6],w=o[t+7],E=.03*(m-2*v+y),T=.03*(g-2*x+_),S=.006*(3*(v-y)-m+b),A=.006*(3*(x-_)-g+w),C=2*E+S,I=2*T+A,M=.3*(v-m)+E+.16666667*S,R=.3*(x-g)+T+.16666667*A,k=Math.sqrt(M*M+R*R),P[0]=k,t=1;t<8;t++)M+=C,R+=I,C+=S,I+=A,k+=Math.sqrt(M*M+R*R),P[t]=k;M+=C,R+=I,k+=Math.sqrt(M*M+R*R),P[8]=k,M+=C+S,R+=I+A,k+=Math.sqrt(M*M+R*R),P[9]=k,L=0}for(e*=k;;L++){const t=P[L];if(!(e>t)){if(0==L)e/=t;else{const n=P[L-1];e=L+(e-n)/(t-n)}break}}this.addCurvePosition(.1*e,m,g,v,x,y,_,b,w,a,O,n||F>0&&0==t)}return a}addBeforePosition(t,e,n,s,i){const r=e[n],a=e[n+1],o=e[n+2]-r,l=e[n+3]-a,h=Math.atan2(l,o);s[i]=r+t*Math.cos(h),s[i+1]=a+t*Math.sin(h),s[i+2]=h}addAfterPosition(t,e,n,s,i){const r=e[n+2],a=e[n+3],o=r-e[n],l=a-e[n+1],h=Math.atan2(l,o);s[i]=r+t*Math.cos(h),s[i+1]=a+t*Math.sin(h),s[i+2]=h}addCurvePosition(t,e,n,s,i,r,a,o,l,h,c,u){if(0==t||isNaN(t))return h[c]=e,h[c+1]=n,void(h[c+2]=Math.atan2(i-n,s-e));const d=t*t,f=d*t,p=1-t,m=p*p,g=m*p,v=p*t,x=3*v,y=p*x,_=x*t,b=e*g+s*y+r*_+o*f,w=n*g+i*y+a*_+l*f;h[c]=b,h[c+1]=w,u&&(h[c+2]=t<.001?Math.atan2(i-n,s-e):Math.atan2(w-(n*m+i*v*2+a*d),b-(e*m+s*v*2+r*d)))}};let sT=nT;sT.NONE=-1,sT.BEFORE=-2,sT.AFTER=-3,sT.epsilon=1e-5;class iT{constructor(t,e){if(this.darkColor=null,this.attachment=null,this.attachmentState=0,this.sequenceIndex=-1,this.deform=new Array,!t)throw new Error("data cannot be null.");if(!e)throw new Error("bone cannot be null.");this.data=t,this.bone=e,this.color=new uy,this.darkColor=t.darkColor?new uy:null,this.setToSetupPose(),this.blendMode=this.data.blendMode}getSkeleton(){return this.bone.skeleton}getAttachment(){return this.attachment}setAttachment(t){this.attachment!=t&&(t instanceof bw&&this.attachment instanceof bw&&t.timelineAttachment==this.attachment.timelineAttachment||(this.deform.length=0),this.attachment=t,this.sequenceIndex=-1)}setToSetupPose(){this.color.setFromColor(this.data.color),this.darkColor&&this.darkColor.setFromColor(this.data.darkColor),this.data.attachmentName?(this.attachment=null,this.setAttachment(this.bone.skeleton.getAttachment(this.data.index,this.data.attachmentName))):this.attachment=null}}class rT{constructor(t,e){if(this.mixRotate=0,this.mixX=0,this.mixY=0,this.mixScaleX=0,this.mixScaleY=0,this.mixShearY=0,this.temp=new _y,this.active=!1,!t)throw new Error("data cannot be null.");if(!e)throw new Error("skeleton cannot be null.");this.data=t,this.mixRotate=t.mixRotate,this.mixX=t.mixX,this.mixY=t.mixY,this.mixScaleX=t.mixScaleX,this.mixScaleY=t.mixScaleY,this.mixShearY=t.mixShearY,this.bones=new Array;for(let s=0;s<t.bones.length;s++){const n=e.findBone(t.bones[s].name);if(!n)throw new Error(`Couldn't find bone ${t.bones[s].name}.`);this.bones.push(n)}const n=e.findBone(t.target.name);if(!n)throw new Error(`Couldn't find target bone ${t.target.name}.`);this.target=n}isActive(){return this.active}update(){0==this.mixRotate&&0==this.mixX&&0==this.mixY&&0==this.mixScaleX&&0==this.mixScaleX&&0==this.mixShearY||(this.data.local?this.data.relative?this.applyRelativeLocal():this.applyAbsoluteLocal():this.data.relative?this.applyRelativeWorld():this.applyAbsoluteWorld())}applyAbsoluteWorld(){const t=this.mixRotate,e=this.mixX,n=this.mixY,s=this.mixScaleX,i=this.mixScaleY,r=this.mixShearY,a=0!=e||0!=n,o=this.target,l=o.matrix,h=l.a,c=l.c,u=l.b,d=l.d,f=h*d-c*u>0?fy.degRad:-fy.degRad,p=this.data.offsetRotation*f,m=this.data.offsetShearY*f,g=this.bones;for(let v=0,x=g.length;v<x;v++){const l=g[v],f=l.matrix;if(0!=t){const e=f.a,n=f.c,s=f.b,i=f.d;let r=Math.atan2(u,h)-Math.atan2(s,e)+p;r>fy.PI?r-=fy.PI2:r<-fy.PI&&(r+=fy.PI2),r*=t;const a=Math.cos(r),o=Math.sin(r);f.a=a*e-o*s,f.c=a*n-o*i,f.b=o*e+a*s,f.d=o*n+a*i}if(a){const t=this.temp;o.localToWorld(t.set(this.data.offsetX,this.data.offsetY)),f.tx+=(t.x-f.tx)*e,f.ty+=(t.y-f.ty)*n}if(0!=s){let t=Math.sqrt(f.a*f.a+f.b*f.b);0!=t&&(t=(t+(Math.sqrt(h*h+u*u)-t+this.data.offsetScaleX)*s)/t),f.a*=t,f.b*=t}if(0!=i){let t=Math.sqrt(f.c*f.c+f.d*f.d);0!=t&&(t=(t+(Math.sqrt(c*c+d*d)-t+this.data.offsetScaleY)*i)/t),f.c*=t,f.d*=t}if(r>0){const t=f.c,e=f.d,n=Math.atan2(e,t);let s=Math.atan2(d,c)-Math.atan2(u,h)-(n-Math.atan2(f.b,f.a));s>fy.PI?s-=fy.PI2:s<-fy.PI&&(s+=fy.PI2),s=n+(s+m)*r;const i=Math.sqrt(t*t+e*e);f.c=Math.cos(s)*i,f.d=Math.sin(s)*i}l.updateAppliedTransform()}}applyRelativeWorld(){const t=this.mixRotate,e=this.mixX,n=this.mixY,s=this.mixScaleX,i=this.mixScaleY,r=this.mixShearY,a=0!=e||0!=n,o=this.target,l=o.matrix,h=l.a,c=l.c,u=l.b,d=l.d,f=h*d-c*u>0?fy.degRad:-fy.degRad,p=this.data.offsetRotation*f,m=this.data.offsetShearY*f,g=this.bones;for(let v=0,x=g.length;v<x;v++){const l=g[v],f=l.matrix;if(0!=t){const e=f.a,n=f.c,s=f.b,i=f.d;let r=Math.atan2(u,h)+p;r>fy.PI?r-=fy.PI2:r<-fy.PI&&(r+=fy.PI2),r*=t;const a=Math.cos(r),o=Math.sin(r);f.a=a*e-o*s,f.c=a*n-o*i,f.b=o*e+a*s,f.d=o*n+a*i}if(a){const t=this.temp;o.localToWorld(t.set(this.data.offsetX,this.data.offsetY)),f.tx+=t.x*e,f.ty+=t.y*n}if(0!=s){const t=(Math.sqrt(h*h+u*u)-1+this.data.offsetScaleX)*s+1;f.a*=t,f.b*=t}if(0!=i){const t=(Math.sqrt(c*c+d*d)-1+this.data.offsetScaleY)*i+1;f.c*=t,f.d*=t}if(r>0){let t=Math.atan2(d,c)-Math.atan2(u,h);t>fy.PI?t-=fy.PI2:t<-fy.PI&&(t+=fy.PI2);const e=f.c,n=f.d;t=Math.atan2(n,e)+(t-fy.PI/2+m)*r;const s=Math.sqrt(e*e+n*n);f.c=Math.cos(t)*s,f.d=Math.sin(t)*s}l.updateAppliedTransform()}}applyAbsoluteLocal(){const t=this.mixRotate,e=this.mixX,n=this.mixY,s=this.mixScaleX,i=this.mixScaleY,r=this.mixShearY,a=this.target,o=this.bones;for(let l=0,h=o.length;l<h;l++){const h=o[l];let c=h.arotation;if(0!=t){let e=a.arotation-c+this.data.offsetRotation;e-=360*(16384-(16384.499999999996-e/360|0)),c+=e*t}let u=h.ax,d=h.ay;u+=(a.ax-u+this.data.offsetX)*e,d+=(a.ay-d+this.data.offsetY)*n;let f=h.ascaleX,p=h.ascaleY;0!=s&&0!=f&&(f=(f+(a.ascaleX-f+this.data.offsetScaleX)*s)/f),0!=i&&0!=p&&(p=(p+(a.ascaleY-p+this.data.offsetScaleY)*i)/p);let m=h.ashearY;if(0!=r){let t=a.ashearY-m+this.data.offsetShearY;t-=360*(16384-(16384.499999999996-t/360|0)),m+=t*r}h.updateWorldTransformWith(u,d,c,f,p,h.ashearX,m)}}applyRelativeLocal(){const t=this.mixRotate,e=this.mixX,n=this.mixY,s=this.mixScaleX,i=this.mixScaleY,r=this.mixShearY,a=this.target,o=this.bones;for(let l=0,h=o.length;l<h;l++){const h=o[l],c=h.arotation+(a.arotation+this.data.offsetRotation)*t,u=h.ax+(a.ax+this.data.offsetX)*e,d=h.ay+(a.ay+this.data.offsetY)*n,f=h.ascaleX*((a.ascaleX-1+this.data.offsetScaleX)*s+1),p=h.ascaleY*((a.ascaleY-1+this.data.offsetScaleY)*i+1),m=h.ashearY+(a.ashearY+this.data.offsetShearY)*r;h.updateWorldTransformWith(u,d,c,f,p,h.ashearX,m)}}}const aT=class{constructor(t){if(this._updateCache=new Array,this.skin=null,this.scaleX=1,this.scaleY=1,this.x=0,this.y=0,!t)throw new Error("data cannot be null.");this.data=t,this.bones=new Array;for(let e=0;e<t.bones.length;e++){const n=t.bones[e];let s;if(n.parent){const t=this.bones[n.parent.index];s=new jE(n,this,t),t.children.push(s)}else s=new jE(n,this,null);this.bones.push(s)}this.slots=new Array,this.drawOrder=new Array;for(let e=0;e<t.slots.length;e++){const n=t.slots[e],s=this.bones[n.boneData.index],i=new iT(n,s);this.slots.push(i),this.drawOrder.push(i)}this.ikConstraints=new Array;for(let e=0;e<t.ikConstraints.length;e++){const n=t.ikConstraints[e];this.ikConstraints.push(new QE(n,this))}this.transformConstraints=new Array;for(let e=0;e<t.transformConstraints.length;e++){const n=t.transformConstraints[e];this.transformConstraints.push(new rT(n,this))}this.pathConstraints=new Array;for(let e=0;e<t.pathConstraints.length;e++){const n=t.pathConstraints[e];this.pathConstraints.push(new sT(n,this))}this.color=new uy(1,1,1,1),this.updateCache()}updateCache(){this._updateCache.length=0;const t=this.bones;for(let l=0,h=t.length;l<h;l++){const e=t[l];e.sorted=e.data.skinRequired,e.active=!e.sorted}if(this.skin){const t=this.skin.bones;for(let e=0,n=this.skin.bones.length;e<n;e++){let n=this.bones[t[e].index];do{n.sorted=!1,n.active=!0,n=n.parent}while(n)}}const e=this.ikConstraints,n=this.transformConstraints,s=this.pathConstraints,i=e.length,r=n.length,a=s.length,o=i+r+a;t:for(let l=0;l<o;l++){for(let t=0;t<i;t++){const n=e[t];if(n.data.order==l){this.sortIkConstraint(n);continue t}}for(let t=0;t<r;t++){const e=n[t];if(e.data.order==l){this.sortTransformConstraint(e);continue t}}for(let t=0;t<a;t++){const e=s[t];if(e.data.order==l){this.sortPathConstraint(e);continue t}}}for(let l=0,h=t.length;l<h;l++)this.sortBone(t[l])}sortIkConstraint(t){if(t.active=t.target.isActive()&&(!t.data.skinRequired||this.skin&&xy.contains(this.skin.constraints,t.data,!0)),!t.active)return;const e=t.target;this.sortBone(e);const n=t.bones,s=n[0];if(this.sortBone(s),1==n.length)this._updateCache.push(t),this.sortReset(s.children);else{const e=n[n.length-1];this.sortBone(e),this._updateCache.push(t),this.sortReset(s.children),e.sorted=!0}}sortPathConstraint(t){if(t.active=t.target.bone.isActive()&&(!t.data.skinRequired||this.skin&&xy.contains(this.skin.constraints,t.data,!0)),!t.active)return;const e=t.target,n=e.data.index,s=e.bone;this.skin&&this.sortPathConstraintAttachment(this.skin,n,s),this.data.defaultSkin&&this.data.defaultSkin!=this.skin&&this.sortPathConstraintAttachment(this.data.defaultSkin,n,s);for(let o=0,l=this.data.skins.length;o<l;o++)this.sortPathConstraintAttachment(this.data.skins[o],n,s);const i=e.getAttachment();i instanceof Sw&&this.sortPathConstraintAttachmentWith(i,s);const r=t.bones,a=r.length;for(let o=0;o<a;o++)this.sortBone(r[o]);this._updateCache.push(t);for(let o=0;o<a;o++)this.sortReset(r[o].children);for(let o=0;o<a;o++)r[o].sorted=!0}sortTransformConstraint(t){if(t.active=t.target.isActive()&&(!t.data.skinRequired||this.skin&&xy.contains(this.skin.constraints,t.data,!0)),!t.active)return;this.sortBone(t.target);const e=t.bones,n=e.length;if(t.data.local)for(let s=0;s<n;s++){const t=e[s];this.sortBone(t.parent),this.sortBone(t)}else for(let s=0;s<n;s++)this.sortBone(e[s]);this._updateCache.push(t);for(let s=0;s<n;s++)this.sortReset(e[s].children);for(let s=0;s<n;s++)e[s].sorted=!0}sortPathConstraintAttachment(t,e,n){const s=t.attachments[e];if(s)for(const i in s)this.sortPathConstraintAttachmentWith(s[i],n)}sortPathConstraintAttachmentWith(t,e){if(!(t instanceof Sw))return;const n=t.bones;if(n){const t=this.bones;for(let e=0,s=n.length;e<s;){let s=n[e++];for(s+=e;e<s;)this.sortBone(t[n[e++]])}}else this.sortBone(e)}sortBone(t){if(!t)return;if(t.sorted)return;const e=t.parent;e&&this.sortBone(e),t.sorted=!0,this._updateCache.push(t)}sortReset(t){for(let e=0,n=t.length;e<n;e++){const n=t[e];n.active&&(n.sorted&&this.sortReset(n.children),n.sorted=!1)}}updateWorldTransform(){const t=this.bones;for(let n=0,s=t.length;n<s;n++){const e=t[n];e.ax=e.x,e.ay=e.y,e.arotation=e.rotation,e.ascaleX=e.scaleX,e.ascaleY=e.scaleY,e.ashearX=e.shearX,e.ashearY=e.shearY}const e=this._updateCache;for(let n=0,s=e.length;n<s;n++)e[n].update()}updateWorldTransformWith(t){const e=this.getRootBone(),n=t.matrix.a,s=t.matrix.c,i=t.matrix.b,r=t.matrix.d;e.matrix.tx=n*this.x+s*this.y+t.worldX,e.matrix.ty=i*this.x+r*this.y+t.worldY;const a=e.rotation+90+e.shearY,o=fy.cosDeg(e.rotation+e.shearX)*e.scaleX,l=fy.cosDeg(a)*e.scaleY,h=fy.sinDeg(e.rotation+e.shearX)*e.scaleX,c=fy.sinDeg(a)*e.scaleY,u=this.scaleX,d=-this.scaleY;e.matrix.a=(n*o+s*h)*u,e.matrix.c=(n*l+s*c)*u,e.matrix.b=(i*o+r*h)*d,e.matrix.d=(i*l+r*c)*d;const f=this._updateCache;for(let p=0,m=f.length;p<m;p++){const t=f[p];t!=e&&t.update()}}setToSetupPose(){this.setBonesToSetupPose(),this.setSlotsToSetupPose()}setBonesToSetupPose(){const t=this.bones;for(let i=0,r=t.length;i<r;i++)t[i].setToSetupPose();const e=this.ikConstraints;for(let i=0,r=e.length;i<r;i++){const t=e[i];t.mix=t.data.mix,t.softness=t.data.softness,t.bendDirection=t.data.bendDirection,t.compress=t.data.compress,t.stretch=t.data.stretch}const n=this.transformConstraints;for(let i=0,r=n.length;i<r;i++){const t=n[i],e=t.data;t.mixRotate=e.mixRotate,t.mixX=e.mixX,t.mixY=e.mixY,t.mixScaleX=e.mixScaleX,t.mixScaleY=e.mixScaleY,t.mixShearY=e.mixShearY}const s=this.pathConstraints;for(let i=0,r=s.length;i<r;i++){const t=s[i],e=t.data;t.position=e.position,t.spacing=e.spacing,t.mixRotate=e.mixRotate,t.mixX=e.mixX,t.mixY=e.mixY}}setSlotsToSetupPose(){const t=this.slots;xy.arrayCopy(t,0,this.drawOrder,0,t.length);for(let e=0,n=t.length;e<n;e++)t[e].setToSetupPose()}getRootBone(){return 0==this.bones.length?null:this.bones[0]}findBone(t){if(!t)throw new Error("boneName cannot be null.");const e=this.bones;for(let n=0,s=e.length;n<s;n++){const s=e[n];if(s.data.name==t)return s}return null}findBoneIndex(t){if(!t)throw new Error("boneName cannot be null.");const e=this.bones;for(let n=0,s=e.length;n<s;n++)if(e[n].data.name==t)return n;return-1}findSlot(t){if(!t)throw new Error("slotName cannot be null.");const e=this.slots;for(let n=0,s=e.length;n<s;n++){const s=e[n];if(s.data.name==t)return s}return null}findSlotIndex(t){if(!t)throw new Error("slotName cannot be null.");const e=this.slots;for(let n=0,s=e.length;n<s;n++)if(e[n].data.name==t)return n;return-1}setSkinByName(t){const e=this.data.findSkin(t);if(!e)throw new Error(`Skin not found: ${t}`);this.setSkin(e)}setSkin(t){if(t!=this.skin){if(t)if(this.skin)t.attachAll(this,this.skin);else{const e=this.slots;for(let n=0,s=e.length;n<s;n++){const s=e[n],i=s.data.attachmentName;if(i){const e=t.getAttachment(n,i);e&&s.setAttachment(e)}}}this.skin=t,this.updateCache()}}getAttachmentByName(t,e){const n=this.data.findSlot(t);if(!n)throw new Error(`Can't find slot with name ${t}`);return this.getAttachment(n.index,e)}getAttachment(t,e){if(!e)throw new Error("attachmentName cannot be null.");if(this.skin){const n=this.skin.getAttachment(t,e);if(n)return n}return this.data.defaultSkin?this.data.defaultSkin.getAttachment(t,e):null}setAttachment(t,e){if(!t)throw new Error("slotName cannot be null.");const n=this.slots;for(let s=0,i=n.length;s<i;s++){const i=n[s];if(i.data.name==t){let n=null;if(e&&(n=this.getAttachment(s,e),!n))throw new Error(`Attachment not found: ${e}, for slot: ${t}`);return void i.setAttachment(n)}}throw new Error(`Slot not found: ${t}`)}findIkConstraint(t){if(!t)throw new Error("constraintName cannot be null.");const e=this.ikConstraints;for(let n=0,s=e.length;n<s;n++){const s=e[n];if(s.data.name==t)return s}return null}findTransformConstraint(t){if(!t)throw new Error("constraintName cannot be null.");const e=this.transformConstraints;for(let n=0,s=e.length;n<s;n++){const s=e[n];if(s.data.name==t)return s}return null}findPathConstraint(t){if(!t)throw new Error("constraintName cannot be null.");const e=this.pathConstraints;for(let n=0,s=e.length;n<s;n++){const s=e[n];if(s.data.name==t)return s}return null}getBoundsRect(){const t=new _y,e=new _y;return this.getBounds(t,e),{x:t.x,y:t.y,width:e.x,height:e.y}}getBounds(t,e,n=new Array(2)){if(!t)throw new Error("offset cannot be null.");if(!e)throw new Error("size cannot be null.");const s=this.drawOrder;let i=Number.POSITIVE_INFINITY,r=Number.POSITIVE_INFINITY,a=Number.NEGATIVE_INFINITY,o=Number.NEGATIVE_INFINITY;for(let l=0,h=s.length;l<h;l++){const t=s[l];if(!t.bone.active)continue;let e=0,h=null;const c=t.getAttachment();if(c instanceof Iw)e=8,h=xy.setArraySize(n,e,0),c.computeWorldVertices(t,h,0,2);else if(c instanceof Tw){const s=c;e=s.worldVerticesLength,h=xy.setArraySize(n,e,0),s.computeWorldVertices(t,0,e,h,0,2)}if(h)for(let n=0,s=h.length;n<s;n+=2){const t=h[n],e=h[n+1];i=Math.min(i,t),r=Math.min(r,e),a=Math.max(a,t),o=Math.max(o,e)}}t.set(i,r),e.set(a-i,o-r)}get flipX(){return-1==this.scaleX}set flipX(t){aT.deprecatedWarning1||(aT.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: `Skeleton.flipX/flipY` was deprecated, please use scaleX/scaleY")),this.scaleX=t?1:-1}get flipY(){return-1==this.scaleY}set flipY(t){aT.deprecatedWarning1||(aT.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: `Skeleton.flipX/flipY` was deprecated, please use scaleX/scaleY")),this.scaleY=t?1:-1}};let oT=aT;oT.deprecatedWarning1=!1;class lT{constructor(){this.name=null,this.bones=new Array,this.slots=new Array,this.skins=new Array,this.defaultSkin=null,this.events=new Array,this.animations=new Array,this.ikConstraints=new Array,this.transformConstraints=new Array,this.pathConstraints=new Array,this.x=0,this.y=0,this.width=0,this.height=0,this.version=null,this.hash=null,this.fps=0,this.imagesPath=null,this.audioPath=null}findBone(t){if(!t)throw new Error("boneName cannot be null.");const e=this.bones;for(let n=0,s=e.length;n<s;n++){const s=e[n];if(s.name==t)return s}return null}findBoneIndex(t){if(!t)throw new Error("boneName cannot be null.");const e=this.bones;for(let n=0,s=e.length;n<s;n++)if(e[n].name==t)return n;return-1}findSlot(t){if(!t)throw new Error("slotName cannot be null.");const e=this.slots;for(let n=0,s=e.length;n<s;n++){const s=e[n];if(s.name==t)return s}return null}findSlotIndex(t){if(!t)throw new Error("slotName cannot be null.");const e=this.slots;for(let n=0,s=e.length;n<s;n++)if(e[n].name==t)return n;return-1}findSkin(t){if(!t)throw new Error("skinName cannot be null.");const e=this.skins;for(let n=0,s=e.length;n<s;n++){const s=e[n];if(s.name==t)return s}return null}findEvent(t){if(!t)throw new Error("eventDataName cannot be null.");const e=this.events;for(let n=0,s=e.length;n<s;n++){const s=e[n];if(s.name==t)return s}return null}findAnimation(t){if(!t)throw new Error("animationName cannot be null.");const e=this.animations;for(let n=0,s=e.length;n<s;n++){const s=e[n];if(s.name==t)return s}return null}findIkConstraint(t){if(!t)throw new Error("constraintName cannot be null.");const e=this.ikConstraints;for(let n=0,s=e.length;n<s;n++){const s=e[n];if(s.name==t)return s}return null}findTransformConstraint(t){if(!t)throw new Error("constraintName cannot be null.");const e=this.transformConstraints;for(let n=0,s=e.length;n<s;n++){const s=e[n];if(s.name==t)return s}return null}findPathConstraint(t){if(!t)throw new Error("constraintName cannot be null.");const e=this.pathConstraints;for(let n=0,s=e.length;n<s;n++){const s=e[n];if(s.name==t)return s}return null}findPathConstraintIndex(t){if(null==t)throw new Error("pathConstraintName cannot be null.");const e=this.pathConstraints;for(let n=0,s=e.length;n<s;n++)if(e[n].name==t)return n;return-1}}class hT{constructor(t,e,n){if(this.index=0,this.color=new uy(1,1,1,1),this.darkColor=null,this.attachmentName=null,this.blendMode=Ir.NORMAL,t<0)throw new Error("index must be >= 0.");if(!e)throw new Error("name cannot be null.");if(!n)throw new Error("boneData cannot be null.");this.index=t,this.name=e,this.boneData=n}}class cT extends qE{constructor(t){super(t,0,!1),this.bones=new Array,this._target=null,this.mixRotate=0,this.mixX=0,this.mixY=0,this.mixScaleX=0,this.mixScaleY=0,this.mixShearY=0,this.offsetRotation=0,this.offsetX=0,this.offsetY=0,this.offsetScaleX=0,this.offsetScaleY=0,this.offsetShearY=0,this.relative=!1,this.local=!1}set target(t){this._target=t}get target(){if(this._target)return this._target;throw new Error("BoneData not set.")}}class uT{constructor(t,e,n){this.slotIndex=t,this.name=e,this.attachment=n}}class dT{constructor(t){if(this.attachments=new Array,this.bones=Array(),this.constraints=new Array,!t)throw new Error("name cannot be null.");this.name=t}setAttachment(t,e,n){if(!n)throw new Error("attachment cannot be null.");const s=this.attachments;t>=s.length&&(s.length=t+1),s[t]||(s[t]={}),s[t][e]=n}addSkin(t){for(let n=0;n<t.bones.length;n++){const e=t.bones[n];let s=!1;for(let t=0;t<this.bones.length;t++)if(this.bones[t]==e){s=!0;break}s||this.bones.push(e)}for(let n=0;n<t.constraints.length;n++){const e=t.constraints[n];let s=!1;for(let t=0;t<this.constraints.length;t++)if(this.constraints[t]==e){s=!0;break}s||this.constraints.push(e)}const e=t.getAttachments();for(let n=0;n<e.length;n++){const t=e[n];this.setAttachment(t.slotIndex,t.name,t.attachment)}}copySkin(t){for(let n=0;n<t.bones.length;n++){const e=t.bones[n];let s=!1;for(let t=0;t<this.bones.length;t++)if(this.bones[t]==e){s=!0;break}s||this.bones.push(e)}for(let n=0;n<t.constraints.length;n++){const e=t.constraints[n];let s=!1;for(let t=0;t<this.constraints.length;t++)if(this.constraints[t]==e){s=!0;break}s||this.constraints.push(e)}const e=t.getAttachments();for(let n=0;n<e.length;n++){const t=e[n];t.attachment&&(t.attachment instanceof Tw?(t.attachment=t.attachment.newLinkedMesh(),this.setAttachment(t.slotIndex,t.name,t.attachment)):(t.attachment=t.attachment.copy(),this.setAttachment(t.slotIndex,t.name,t.attachment)))}}getAttachment(t,e){const n=this.attachments[t];return n?n[e]:null}removeAttachment(t,e){const n=this.attachments[t];n&&delete n[e]}getAttachments(){const t=new Array;for(let e=0;e<this.attachments.length;e++){const n=this.attachments[e];if(n)for(const s in n){const i=n[s];i&&t.push(new uT(e,s,i))}}return t}getAttachmentsForSlot(t,e){const n=this.attachments[t];if(n)for(const s in n){const i=n[s];i&&e.push(new uT(t,s,i))}}clear(){this.attachments.length=0,this.bones.length=0,this.constraints.length=0}attachAll(t,e){let n=0;for(let s=0;s<t.slots.length;s++){const i=t.slots[s],r=i.getAttachment();if(r&&n<e.attachments.length){const t=e.attachments[n];for(const e in t){if(r==t[e]){const t=this.getAttachment(n,e);t&&i.setAttachment(t);break}}}n++}}}class fT{constructor(t){this.ver40=!1,this.scale=1,this.linkedMeshes=new Array,this.attachmentLoader=t}readSkeletonData(t){const e=this.scale,n=new lT;n.name="";const s=new jx(t),i=s.readInt32(),r=s.readInt32();n.hash=0==r&&0==i?null:r.toString(16)+i.toString(16),n.version=s.readString();const a=n.version.substr(0,3);if("4.0"!==a&&"4.1"!==a){const t=`Spine 4.1 loader cant load version ${n.version}. Please configure your pixi-spine bundle`;console.error(t)}this.ver40="4.0"===a,n.x=s.readFloat(),n.y=s.readFloat(),n.width=s.readFloat(),n.height=s.readFloat();const o=s.readBoolean();o&&(n.fps=s.readFloat(),n.imagesPath=s.readString(),n.audioPath=s.readString());let l=0;l=s.readInt(!0);for(let c=0;c<l;c++){const t=s.readString();if(!t)throw new Error("String in string table must not be null.");s.strings.push(t)}l=s.readInt(!0);for(let c=0;c<l;c++){const t=s.readString();if(!t)throw new Error("Bone name must not be null.");const i=0==c?null:n.bones[s.readInt(!0)],r=new $E(c,t,i);r.rotation=s.readFloat(),r.x=s.readFloat()*e,r.y=s.readFloat()*e,r.scaleX=s.readFloat(),r.scaleY=s.readFloat(),r.shearX=s.readFloat(),r.shearY=s.readFloat(),r.length=s.readFloat()*e,r.transformMode=s.readInt(!0),r.skinRequired=s.readBoolean(),o&&uy.rgba8888ToColor(r.color,s.readInt32()),n.bones.push(r)}l=s.readInt(!0);for(let c=0;c<l;c++){const t=s.readString();if(!t)throw new Error("Slot name must not be null.");const e=n.bones[s.readInt(!0)],i=new hT(c,t,e);uy.rgba8888ToColor(i.color,s.readInt32());const r=s.readInt32();-1!=r&&uy.rgb888ToColor(i.darkColor=new uy,r),i.attachmentName=s.readStringRef(),i.blendMode=s.readInt(!0),n.slots.push(i)}l=s.readInt(!0);for(let c,u=0;u<l;u++){const t=s.readString();if(!t)throw new Error("IK constraint data name must not be null.");const i=new JE(t);i.order=s.readInt(!0),i.skinRequired=s.readBoolean(),c=s.readInt(!0);for(let e=0;e<c;e++)i.bones.push(n.bones[s.readInt(!0)]);i.target=n.bones[s.readInt(!0)],i.mix=s.readFloat(),i.softness=s.readFloat()*e,i.bendDirection=s.readByte(),i.compress=s.readBoolean(),i.stretch=s.readBoolean(),i.uniform=s.readBoolean(),n.ikConstraints.push(i)}l=s.readInt(!0);for(let c,u=0;u<l;u++){const t=s.readString();if(!t)throw new Error("Transform constraint data name must not be null.");const i=new cT(t);i.order=s.readInt(!0),i.skinRequired=s.readBoolean(),c=s.readInt(!0);for(let e=0;e<c;e++)i.bones.push(n.bones[s.readInt(!0)]);i.target=n.bones[s.readInt(!0)],i.local=s.readBoolean(),i.relative=s.readBoolean(),i.offsetRotation=s.readFloat(),i.offsetX=s.readFloat()*e,i.offsetY=s.readFloat()*e,i.offsetScaleX=s.readFloat(),i.offsetScaleY=s.readFloat(),i.offsetShearY=s.readFloat(),i.mixRotate=s.readFloat(),i.mixX=s.readFloat(),i.mixY=s.readFloat(),i.mixScaleX=s.readFloat(),i.mixScaleY=s.readFloat(),i.mixShearY=s.readFloat(),n.transformConstraints.push(i)}l=s.readInt(!0);for(let c,u=0;u<l;u++){const t=s.readString();if(!t)throw new Error("Path constraint data name must not be null.");const i=new tT(t);i.order=s.readInt(!0),i.skinRequired=s.readBoolean(),c=s.readInt(!0);for(let e=0;e<c;e++)i.bones.push(n.bones[s.readInt(!0)]);i.target=n.slots[s.readInt(!0)],i.positionMode=s.readInt(!0),i.spacingMode=s.readInt(!0),i.rotateMode=s.readInt(!0),i.offsetRotation=s.readFloat(),i.position=s.readFloat(),i.positionMode==Kx.Fixed&&(i.position*=e),i.spacing=s.readFloat(),i.spacingMode!=eT.Length&&i.spacingMode!=eT.Fixed||(i.spacing*=e),i.mixRotate=s.readFloat(),i.mixX=s.readFloat(),i.mixY=s.readFloat(),n.pathConstraints.push(i)}const h=this.readSkin(s,n,!0,o);h&&(n.defaultSkin=h,n.skins.push(h));{let t=n.skins.length;for(xy.setArraySize(n.skins,l=t+s.readInt(!0));t<l;t++){const e=this.readSkin(s,n,!1,o);if(!e)throw new Error("readSkin() should not have returned null.");n.skins[t]=e}}l=this.linkedMeshes.length;for(let c=0;c<l;c++){const t=this.linkedMeshes[c],e=t.skin?n.findSkin(t.skin):n.defaultSkin;if(!e)throw new Error("Not skin found for linked mesh.");if(!t.parent)throw new Error("Linked mesh parent must not be null");const s=e.getAttachment(t.slotIndex,t.parent);if(!s)throw new Error(`Parent mesh not found: ${t.parent}`);t.mesh.timelineAttachment=t.inheritTimeline?s:t.mesh,t.mesh.setParentMesh(s)}this.linkedMeshes.length=0,l=s.readInt(!0);for(let c=0;c<l;c++){const t=s.readStringRef();if(!t)throw new Error;const e=new ZE(t);e.intValue=s.readInt(!1),e.floatValue=s.readFloat(),e.stringValue=s.readString(),e.audioPath=s.readString(),e.audioPath&&(e.volume=s.readFloat(),e.balance=s.readFloat()),n.events.push(e)}l=s.readInt(!0);for(let c=0;c<l;c++){const t=s.readString();if(!t)throw new Error("Animatio name must not be null.");n.animations.push(this.readAnimation(s,t,n))}return n}readSkin(t,e,n,s){let i=null,r=0;if(n){if(r=t.readInt(!0),0==r)return null;i=new dT("default")}else{const n=t.readStringRef();if(!n)throw new Error("Skin name must not be null.");i=new dT(n),i.bones.length=t.readInt(!0);for(let s=0,r=i.bones.length;s<r;s++)i.bones[s]=e.bones[t.readInt(!0)];for(let s=0,r=t.readInt(!0);s<r;s++)i.constraints.push(e.ikConstraints[t.readInt(!0)]);for(let s=0,r=t.readInt(!0);s<r;s++)i.constraints.push(e.transformConstraints[t.readInt(!0)]);for(let s=0,r=t.readInt(!0);s<r;s++)i.constraints.push(e.pathConstraints[t.readInt(!0)]);r=t.readInt(!0)}for(let a=0;a<r;a++){const n=t.readInt(!0);for(let r=0,a=t.readInt(!0);r<a;r++){const r=t.readStringRef();if(!r)throw new Error("Attachment name must not be null");const a=this.readAttachment(t,e,i,n,r,s);a&&i.setAttachment(n,r,a)}}return i}readAttachment(t,e,n,s,i,r){const a=this.scale;let o=t.readStringRef();switch(o||(o=i),t.readByte()){case Hx.Region:{let e=t.readStringRef();const s=t.readFloat(),i=t.readFloat(),r=t.readFloat(),l=t.readFloat(),h=t.readFloat(),c=t.readFloat(),u=t.readFloat(),d=t.readInt32(),f=this.readSequence(t);e||(e=o);const p=this.attachmentLoader.newRegionAttachment(n,o,e,f);return p?(p.path=e,p.x=i*a,p.y=r*a,p.scaleX=l,p.scaleY=h,p.rotation=s,p.width=c*a,p.height=u*a,uy.rgba8888ToColor(p.color,d),p.sequence=f,null==f&&p.updateRegion(),p):null}case Hx.BoundingBox:{const e=t.readInt(!0),s=this.readVertices(t,e),i=r?t.readInt32():0,a=this.attachmentLoader.newBoundingBoxAttachment(n,o);return a?(a.worldVerticesLength=e<<1,a.vertices=s.vertices,a.bones=s.bones,r&&uy.rgba8888ToColor(a.color,i),a):null}case Hx.Mesh:{let e=t.readStringRef();const s=t.readInt32(),i=t.readInt(!0),l=this.readFloatArray(t,i<<1,1),h=this.readShortArray(t),c=this.readVertices(t,i),u=t.readInt(!0),d=this.readSequence(t);let f=[],p=0,m=0;r&&(f=this.readShortArray(t),p=t.readFloat(),m=t.readFloat()),e||(e=o);const g=this.attachmentLoader.newMeshAttachment(n,o,e,d);return g?(g.path=e,uy.rgba8888ToColor(g.color,s),g.bones=c.bones,g.vertices=c.vertices,g.worldVerticesLength=i<<1,g.triangles=h,g.regionUVs=new Float32Array(l),g.hullLength=u<<1,g.sequence=d,r&&(g.edges=f,g.width=p*a,g.height=m*a),g):null}case Hx.LinkedMesh:{let e=t.readStringRef();const i=t.readInt32(),l=t.readStringRef(),h=t.readStringRef(),c=t.readBoolean(),u=this.readSequence(t);let d=0,f=0;r&&(d=t.readFloat(),f=t.readFloat()),e||(e=o);const p=this.attachmentLoader.newMeshAttachment(n,o,e,u);return p?(p.path=e,uy.rgba8888ToColor(p.color,i),p.sequence=u,r&&(p.width=d*a,p.height=f*a),this.linkedMeshes.push(new pT(p,l,s,h,c)),p):null}case Hx.Path:{const e=t.readBoolean(),s=t.readBoolean(),i=t.readInt(!0),l=this.readVertices(t,i),h=xy.newArray(i/3,0);for(let n=0,r=h.length;n<r;n++)h[n]=t.readFloat()*a;const c=r?t.readInt32():0,u=this.attachmentLoader.newPathAttachment(n,o);return u?(u.closed=e,u.constantSpeed=s,u.worldVerticesLength=i<<1,u.vertices=l.vertices,u.bones=l.bones,u.lengths=h,r&&uy.rgba8888ToColor(u.color,c),u):null}case Hx.Point:{const e=t.readFloat(),s=t.readFloat(),i=t.readFloat(),l=r?t.readInt32():0,h=this.attachmentLoader.newPointAttachment(n,o);return h?(h.x=s*a,h.y=i*a,h.rotation=e,r&&uy.rgba8888ToColor(h.color,l),h):null}case Hx.Clipping:{const s=t.readInt(!0),i=t.readInt(!0),a=this.readVertices(t,i),l=r?t.readInt32():0,h=this.attachmentLoader.newClippingAttachment(n,o);return h?(h.endSlot=e.slots[s],h.worldVerticesLength=i<<1,h.vertices=a.vertices,h.bones=a.bones,r&&uy.rgba8888ToColor(h.color,l),h):null}}return null}readSequence(t){if(this.ver40||!t.readBoolean())return null;const e=new Rw(t.readInt(!0));return e.start=t.readInt(!0),e.digits=t.readInt(!0),e.setupIndex=t.readInt(!0),e}readDeformTimelineType(t){return this.ver40?DT:t.readByte()}readVertices(t,e){const n=this.scale,s=e<<1,i=new mT;if(!t.readBoolean())return i.vertices=this.readFloatArray(t,s,n),i;const r=new Array,a=new Array;for(let o=0;o<e;o++){const e=t.readInt(!0);a.push(e);for(let s=0;s<e;s++)a.push(t.readInt(!0)),r.push(t.readFloat()*n),r.push(t.readFloat()*n),r.push(t.readFloat())}return i.vertices=xy.toFloatArray(r),i.bones=a,i}readFloatArray(t,e,n){const s=new Array(e);if(1==n)for(let i=0;i<e;i++)s[i]=t.readFloat();else for(let i=0;i<e;i++)s[i]=t.readFloat()*n;return s}readShortArray(t){const e=t.readInt(!0),n=new Array(e);for(let s=0;s<e;s++)n[s]=t.readShort();return n}readAnimation(t,e,n){t.readInt(!0);const s=new Array,i=this.scale;for(let l=0,h=t.readInt(!0);l<h;l++){const e=t.readInt(!0);for(let n=0,i=t.readInt(!0);n<i;n++){const n=t.readByte(),i=t.readInt(!0),r=i-1;switch(n){case MT:{const n=new yE(i,e);for(let e=0;e<i;e++)n.setFrame(e,t.readFloat(),t.readStringRef());s.push(n);break}case RT:{const n=t.readInt(!0),a=new pE(i,n,e);let o=t.readFloat(),l=t.readUnsignedByte()/255,h=t.readUnsignedByte()/255,c=t.readUnsignedByte()/255,u=t.readUnsignedByte()/255;for(let e=0,s=0;a.setFrame(e,o,l,h,c,u),e!=r;e++){const n=t.readFloat(),i=t.readUnsignedByte()/255,r=t.readUnsignedByte()/255,d=t.readUnsignedByte()/255,f=t.readUnsignedByte()/255;switch(t.readByte()){case UT:a.setStepped(e);break;case XT:xT(t,a,s++,e,0,o,n,l,i,1),xT(t,a,s++,e,1,o,n,h,r,1),xT(t,a,s++,e,2,o,n,c,d,1),xT(t,a,s++,e,3,o,n,u,f,1)}o=n,l=i,h=r,c=d,u=f}s.push(a);break}case PT:{const n=t.readInt(!0),a=new mE(i,n,e);let o=t.readFloat(),l=t.readUnsignedByte()/255,h=t.readUnsignedByte()/255,c=t.readUnsignedByte()/255;for(let e=0,s=0;a.setFrame(e,o,l,h,c),e!=r;e++){const n=t.readFloat(),i=t.readUnsignedByte()/255,r=t.readUnsignedByte()/255,u=t.readUnsignedByte()/255;switch(t.readByte()){case UT:a.setStepped(e);break;case XT:xT(t,a,s++,e,0,o,n,l,i,1),xT(t,a,s++,e,1,o,n,h,r,1),xT(t,a,s++,e,2,o,n,c,u,1)}o=n,l=i,h=r,c=u}s.push(a);break}case kT:{const n=t.readInt(!0),a=new vE(i,n,e);let o=t.readFloat(),l=t.readUnsignedByte()/255,h=t.readUnsignedByte()/255,c=t.readUnsignedByte()/255,u=t.readUnsignedByte()/255,d=t.readUnsignedByte()/255,f=t.readUnsignedByte()/255,p=t.readUnsignedByte()/255;for(let e=0,s=0;a.setFrame(e,o,l,h,c,u,d,f,p),e!=r;e++){const n=t.readFloat(),i=t.readUnsignedByte()/255,r=t.readUnsignedByte()/255,m=t.readUnsignedByte()/255,g=t.readUnsignedByte()/255,v=t.readUnsignedByte()/255,x=t.readUnsignedByte()/255,y=t.readUnsignedByte()/255;switch(t.readByte()){case UT:a.setStepped(e);break;case XT:xT(t,a,s++,e,0,o,n,l,i,1),xT(t,a,s++,e,1,o,n,h,r,1),xT(t,a,s++,e,2,o,n,c,m,1),xT(t,a,s++,e,3,o,n,u,g,1),xT(t,a,s++,e,4,o,n,d,v,1),xT(t,a,s++,e,5,o,n,f,x,1),xT(t,a,s++,e,6,o,n,p,y,1)}o=n,l=i,h=r,c=m,u=g,d=v,f=x,p=y}s.push(a);break}case FT:{const n=t.readInt(!0),a=new xE(i,n,e);let o=t.readFloat(),l=t.readUnsignedByte()/255,h=t.readUnsignedByte()/255,c=t.readUnsignedByte()/255,u=t.readUnsignedByte()/255,d=t.readUnsignedByte()/255,f=t.readUnsignedByte()/255;for(let e=0,s=0;a.setFrame(e,o,l,h,c,u,d,f),e!=r;e++){const n=t.readFloat(),i=t.readUnsignedByte()/255,r=t.readUnsignedByte()/255,p=t.readUnsignedByte()/255,m=t.readUnsignedByte()/255,g=t.readUnsignedByte()/255,v=t.readUnsignedByte()/255;switch(t.readByte()){case UT:a.setStepped(e);break;case XT:xT(t,a,s++,e,0,o,n,l,i,1),xT(t,a,s++,e,1,o,n,h,r,1),xT(t,a,s++,e,2,o,n,c,p,1),xT(t,a,s++,e,3,o,n,u,m,1),xT(t,a,s++,e,4,o,n,d,g,1),xT(t,a,s++,e,5,o,n,f,v,1)}o=n,l=i,h=r,c=p,u=m,d=g,f=v}s.push(a);break}case OT:{const n=new gE(i,t.readInt(!0),e);let a=t.readFloat(),o=t.readUnsignedByte()/255;for(let e=0,s=0;n.setFrame(e,a,o),e!=r;e++){const i=t.readFloat(),r=t.readUnsignedByte()/255;switch(t.readByte()){case UT:n.setStepped(e);break;case XT:xT(t,n,s++,e,0,a,i,o,r,1)}a=i,o=r}s.push(n)}}}}for(let l=0,h=t.readInt(!0);l<h;l++){const e=t.readInt(!0);for(let n=0,r=t.readInt(!0);n<r;n++){const n=t.readByte(),r=t.readInt(!0),a=t.readInt(!0);switch(n){case yT:s.push(gT(t,new iE(r,a,e),1));break;case _T:s.push(vT(t,new rE(r,a,e),i));break;case bT:s.push(gT(t,new aE(r,a,e),i));break;case wT:s.push(gT(t,new oE(r,a,e),i));break;case ET:s.push(vT(t,new lE(r,a,e),1));break;case TT:s.push(gT(t,new hE(r,a,e),1));break;case ST:s.push(gT(t,new cE(r,a,e),1));break;case AT:s.push(vT(t,new uE(r,a,e),1));break;case CT:s.push(gT(t,new dE(r,a,e),1));break;case IT:s.push(gT(t,new fE(r,a,e),1))}}}for(let l=0,h=t.readInt(!0);l<h;l++){const e=t.readInt(!0),n=t.readInt(!0),r=n-1,a=new SE(n,t.readInt(!0),e);let o=t.readFloat(),l=t.readFloat(),h=t.readFloat()*i;for(let s=0,c=0;a.setFrame(s,o,l,h,t.readByte(),t.readBoolean(),t.readBoolean()),s!=r;s++){const e=t.readFloat(),n=t.readFloat(),r=t.readFloat()*i;switch(t.readByte()){case UT:a.setStepped(s);break;case XT:xT(t,a,c++,s,0,o,e,l,n,1),xT(t,a,c++,s,1,o,e,h,r,i)}o=e,l=n,h=r}s.push(a)}for(let l=0,h=t.readInt(!0);l<h;l++){const e=t.readInt(!0),n=t.readInt(!0),i=n-1,r=new AE(n,t.readInt(!0),e);let a=t.readFloat(),o=t.readFloat(),l=t.readFloat(),h=t.readFloat(),c=t.readFloat(),u=t.readFloat(),d=t.readFloat();for(let s=0,f=0;r.setFrame(s,a,o,l,h,c,u,d),s!=i;s++){const e=t.readFloat(),n=t.readFloat(),i=t.readFloat(),p=t.readFloat(),m=t.readFloat(),g=t.readFloat(),v=t.readFloat();switch(t.readByte()){case UT:r.setStepped(s);break;case XT:xT(t,r,f++,s,0,a,e,o,n,1),xT(t,r,f++,s,1,a,e,l,i,1),xT(t,r,f++,s,2,a,e,h,p,1),xT(t,r,f++,s,3,a,e,c,m,1),xT(t,r,f++,s,4,a,e,u,g,1),xT(t,r,f++,s,5,a,e,d,v,1)}a=e,o=n,l=i,h=p,c=m,u=g,d=v}s.push(r)}for(let l=0,h=t.readInt(!0);l<h;l++){const e=t.readInt(!0),r=n.pathConstraints[e];for(let n=0,a=t.readInt(!0);n<a;n++)switch(t.readByte()){case NT:s.push(gT(t,new CE(t.readInt(!0),t.readInt(!0),e),r.positionMode==Kx.Fixed?i:1));break;case BT:s.push(gT(t,new IE(t.readInt(!0),t.readInt(!0),e),r.spacingMode==eT.Length||r.spacingMode==eT.Fixed?i:1));break;case VT:const n=new ME(t.readInt(!0),t.readInt(!0),e);let a=t.readFloat(),o=t.readFloat(),l=t.readFloat(),h=t.readFloat();for(let e=0,s=0,i=n.getFrameCount()-1;n.setFrame(e,a,o,l,h),e!=i;e++){const i=t.readFloat(),r=t.readFloat(),c=t.readFloat(),u=t.readFloat();switch(t.readByte()){case UT:n.setStepped(e);break;case XT:xT(t,n,s++,e,0,a,i,o,r,1),xT(t,n,s++,e,1,a,i,l,c,1),xT(t,n,s++,e,2,a,i,h,u,1)}a=i,o=r,l=c,h=u}s.push(n)}}for(let l=0,h=t.readInt(!0);l<h;l++){const e=n.skins[t.readInt(!0)];for(let n=0,r=t.readInt(!0);n<r;n++){const n=t.readInt(!0);for(let r=0,a=t.readInt(!0);r<a;r++){const r=t.readStringRef();if(!r)throw new Error("attachmentName must not be null.");const a=e.getAttachment(n,r),o=this.readDeformTimelineType(t),l=t.readInt(!0),h=l-1;switch(o){case DT:{const e=a,r=e.bones,o=e.vertices,c=r?o.length/3*2:o.length,u=t.readInt(!0),d=new _E(l,u,n,e);let f=t.readFloat();for(let n=0,s=0;;n++){let e,a=t.readInt(!0);if(0==a)e=r?xy.newFloatArray(c):o;else{e=xy.newFloatArray(c);const n=t.readInt(!0);if(a+=n,1==i)for(let s=n;s<a;s++)e[s]=t.readFloat();else for(let s=n;s<a;s++)e[s]=t.readFloat()*i;if(!r)for(let t=0,s=e.length;t<s;t++)e[t]+=o[t]}if(d.setFrame(n,f,e),n==h)break;const l=t.readFloat();switch(t.readByte()){case UT:d.setStepped(n);break;case XT:xT(t,d,s++,n,0,f,l,0,1,1)}f=l}s.push(d);break}case LT:{const e=new PE(l,n,a);for(let n=0;n<l;n++){const s=t.readFloat(),i=t.readInt32();e.setFrame(n,s,kw[15&i],i>>4,t.readFloat())}s.push(e);break}}}}}const r=t.readInt(!0);if(r>0){const e=new TE(r),i=n.slots.length;for(let n=0;n<r;n++){const s=t.readFloat(),r=t.readInt(!0),a=xy.newArray(i,0);for(let t=i-1;t>=0;t--)a[t]=-1;const o=xy.newArray(i-r,0);let l=0,h=0;for(let e=0;e<r;e++){const e=t.readInt(!0);for(;l!=e;)o[h++]=l++;a[l+t.readInt(!0)]=l++}for(;l<i;)o[h++]=l++;for(let t=i-1;t>=0;t--)-1==a[t]&&(a[t]=o[--h]);e.setFrame(n,s,a)}s.push(e)}const a=t.readInt(!0);if(a>0){const e=new wE(a);for(let s=0;s<a;s++){const i=t.readFloat(),r=n.events[t.readInt(!0)],a=new KE(i,r);a.intValue=t.readInt(!1),a.floatValue=t.readFloat(),a.stringValue=t.readBoolean()?t.readString():r.stringValue,a.data.audioPath&&(a.volume=t.readFloat(),a.balance=t.readFloat()),e.setFrame(s,a)}s.push(e)}let o=0;for(let l=0,h=s.length;l<h;l++)o=Math.max(o,s[l].getDuration());return new Fw(e,s,o)}}fT.BlendModeValues=[Ir.NORMAL,Ir.ADD,Ir.MULTIPLY,Ir.SCREEN];let pT=class{constructor(t,e,n,s,i){this.mesh=t,this.skin=e,this.slotIndex=n,this.parent=s,this.inheritTimeline=i}};class mT{constructor(t=null,e=null){this.bones=t,this.vertices=e}}function gT(t,e,n){let s=t.readFloat(),i=t.readFloat()*n;for(let r=0,a=0,o=e.getFrameCount()-1;e.setFrame(r,s,i),r!=o;r++){const o=t.readFloat(),l=t.readFloat()*n;switch(t.readByte()){case UT:e.setStepped(r);break;case XT:xT(t,e,a++,r,0,s,o,i,l,n)}s=o,i=l}return e}function vT(t,e,n){let s=t.readFloat(),i=t.readFloat()*n,r=t.readFloat()*n;for(let a=0,o=0,l=e.getFrameCount()-1;e.setFrame(a,s,i,r),a!=l;a++){const l=t.readFloat(),h=t.readFloat()*n,c=t.readFloat()*n;switch(t.readByte()){case UT:e.setStepped(a);break;case XT:xT(t,e,o++,a,0,s,l,i,h,n),xT(t,e,o++,a,1,s,l,r,c,n)}s=l,i=h,r=c}return e}function xT(t,e,n,s,i,r,a,o,l,h){e.setBezier(n,s,i,r,o,t.readFloat(),t.readFloat()*h,t.readFloat(),t.readFloat()*h,a,l)}const yT=0,_T=1,bT=2,wT=3,ET=4,TT=5,ST=6,AT=7,CT=8,IT=9,MT=0,RT=1,PT=2,kT=3,FT=4,OT=5,DT=0,LT=1,NT=0,BT=1,VT=2,UT=1,XT=2;class YT{constructor(t){this.scale=1,this.linkedMeshes=new Array,this.attachmentLoader=t}readSkeletonData(t){const e=this.scale,n=new lT,s="string"==typeof t?JSON.parse(t):t,i=s.skeleton;if(i){n.hash=i.hash,n.version=i.spine;const t=n.version.substr(0,3);if("4.0"!==t&&"4.1"!==t){const t=`Spine 4.1 loader cant load version ${i.spine}. Please configure your pixi-spine bundle`;console.error(t)}n.x=i.x,n.y=i.y,n.width=i.width,n.height=i.height,n.fps=i.fps,n.imagesPath=i.images}if(s.bones)for(let r=0;r<s.bones.length;r++){const t=s.bones[r];let i=null;const a=jT(t,"parent",null);if(null!=a&&(i=n.findBone(a),null==i))throw new Error(`Parent bone not found: ${a}`);const o=new $E(n.bones.length,t.name,i);o.length=jT(t,"length",0)*e,o.x=jT(t,"x",0)*e,o.y=jT(t,"y",0)*e,o.rotation=jT(t,"rotation",0),o.scaleX=jT(t,"scaleX",1),o.scaleY=jT(t,"scaleY",1),o.shearX=jT(t,"shearX",0),o.shearY=jT(t,"shearY",0),o.transformMode=xy.enumValue(Qx,jT(t,"transform","Normal")),o.skinRequired=jT(t,"skin",!1);const l=jT(t,"color",null);l&&o.color.setFromString(l),n.bones.push(o)}if(s.slots)for(let r=0;r<s.slots.length;r++){const t=s.slots[r],e=n.findBone(t.bone);if(!e)throw new Error(`Couldn't find bone ${t.bone} for slot ${t.name}`);const i=new hT(n.slots.length,t.name,e),a=jT(t,"color",null);a&&i.color.setFromString(a);const o=jT(t,"dark",null);o&&(i.darkColor=uy.fromString(o)),i.attachmentName=jT(t,"attachment",null),i.blendMode=YT.blendModeFromString(jT(t,"blend","normal")),n.slots.push(i)}if(s.ik)for(let r=0;r<s.ik.length;r++){const t=s.ik[r],i=new JE(t.name);i.order=jT(t,"order",0),i.skinRequired=jT(t,"skin",!1);for(let e=0;e<t.bones.length;e++){const s=t.bones[e],r=n.findBone(s);if(null==r)throw new Error(`IK bone not found: ${s}`);i.bones.push(r)}i.target=n.findBone(t.target),i.mix=jT(t,"mix",1),i.softness=jT(t,"softness",0)*e,i.bendDirection=jT(t,"bendPositive",!0)?1:-1,i.compress=jT(t,"compress",!1),i.stretch=jT(t,"stretch",!1),i.uniform=jT(t,"uniform",!1),n.ikConstraints.push(i)}if(s.transform)for(let r=0;r<s.transform.length;r++){const t=s.transform[r],i=new cT(t.name);i.order=jT(t,"order",0),i.skinRequired=jT(t,"skin",!1);for(let e=0;e<t.bones.length;e++){const s=t.bones[e],r=n.findBone(s);if(!r)throw new Error(`Couldn't find bone ${s} for transform constraint ${t.name}.`);i.bones.push(r)}const a=t.target,o=n.findBone(a);if(!o)throw new Error(`Couldn't find target bone ${a} for transform constraint ${t.name}.`);i.target=o,i.local=jT(t,"local",!1),i.relative=jT(t,"relative",!1),i.offsetRotation=jT(t,"rotation",0),i.offsetX=jT(t,"x",0)*e,i.offsetY=jT(t,"y",0)*e,i.offsetScaleX=jT(t,"scaleX",0),i.offsetScaleY=jT(t,"scaleY",0),i.offsetShearY=jT(t,"shearY",0),i.mixRotate=jT(t,"mixRotate",1),i.mixX=jT(t,"mixX",1),i.mixY=jT(t,"mixY",i.mixX),i.mixScaleX=jT(t,"mixScaleX",1),i.mixScaleY=jT(t,"mixScaleY",i.mixScaleX),i.mixShearY=jT(t,"mixShearY",1),n.transformConstraints.push(i)}if(s.path)for(let r=0;r<s.path.length;r++){const t=s.path[r],i=new tT(t.name);i.order=jT(t,"order",0),i.skinRequired=jT(t,"skin",!1);for(let e=0;e<t.bones.length;e++){const s=t.bones[e],r=n.findBone(s);if(!r)throw new Error(`Couldn't find bone ${s} for path constraint ${t.name}.`);i.bones.push(r)}const a=t.target,o=n.findSlot(a);if(!o)throw new Error(`Couldn't find target slot ${a} for path constraint ${t.name}.`);i.target=o,i.positionMode=xy.enumValue(Kx,jT(t,"positionMode","Percent")),i.spacingMode=xy.enumValue(eT,jT(t,"spacingMode","Length")),i.rotateMode=xy.enumValue(Zx,jT(t,"rotateMode","Tangent")),i.offsetRotation=jT(t,"rotation",0),i.position=jT(t,"position",0),i.positionMode==Kx.Fixed&&(i.position*=e),i.spacing=jT(t,"spacing",0),i.spacingMode!=eT.Length&&i.spacingMode!=eT.Fixed||(i.spacing*=e),i.mixRotate=jT(t,"mixRotate",1),i.mixX=jT(t,"mixX",1),i.mixY=jT(t,"mixY",i.mixX),n.pathConstraints.push(i)}if(s.skins)for(let r=0;r<s.skins.length;r++){const t=s.skins[r],e=new dT(t.name);if(t.bones)for(let s=0;s<t.bones.length;s++){const i=t.bones[s],r=n.findBone(i);if(!r)throw new Error(`Couldn't find bone ${i} for skin ${t.name}.`);e.bones.push(r)}if(t.ik)for(let s=0;s<t.ik.length;s++){const i=t.ik[s],r=n.findIkConstraint(i);if(!r)throw new Error(`Couldn't find IK constraint ${i} for skin ${t.name}.`);e.constraints.push(r)}if(t.transform)for(let s=0;s<t.transform.length;s++){const i=t.transform[s],r=n.findTransformConstraint(i);if(!r)throw new Error(`Couldn't find transform constraint ${i} for skin ${t.name}.`);e.constraints.push(r)}if(t.path)for(let s=0;s<t.path.length;s++){const i=t.path[s],r=n.findPathConstraint(i);if(!r)throw new Error(`Couldn't find path constraint ${i} for skin ${t.name}.`);e.constraints.push(r)}for(const s in t.attachments){const i=n.findSlot(s);if(!i)throw new Error(`Couldn't find slot ${s} for skin ${t.name}.`);const r=t.attachments[s];for(const t in r){const s=this.readAttachment(r[t],e,i.index,t,n);s&&e.setAttachment(i.index,t,s)}}n.skins.push(e),"default"==e.name&&(n.defaultSkin=e)}for(let r=0,a=this.linkedMeshes.length;r<a;r++){const t=this.linkedMeshes[r],e=t.skin?n.findSkin(t.skin):n.defaultSkin;if(!e)throw new Error(`Skin not found: ${t.skin}`);const s=e.getAttachment(t.slotIndex,t.parent);if(!s)throw new Error(`Parent mesh not found: ${t.parent}`);t.mesh.timelineAttachment=t.inheritTimeline?s:t.mesh,t.mesh.setParentMesh(s)}if(this.linkedMeshes.length=0,s.events)for(const r in s.events){const t=s.events[r],e=new ZE(r);e.intValue=jT(t,"int",0),e.floatValue=jT(t,"float",0),e.stringValue=jT(t,"string",""),e.audioPath=jT(t,"audio",null),e.audioPath&&(e.volume=jT(t,"volume",1),e.balance=jT(t,"balance",0)),n.events.push(e)}if(s.animations)for(const r in s.animations){const t=s.animations[r];this.readAnimation(t,r,n)}return n}readAttachment(t,e,n,s,i){const r=this.scale;switch(s=jT(t,"name",s),jT(t,"type","region")){case"region":{const n=jT(t,"path",s),i=this.readSequence(jT(t,"sequence",null)),a=this.attachmentLoader.newRegionAttachment(e,s,n,i);if(!a)return null;a.path=n,a.x=jT(t,"x",0)*r,a.y=jT(t,"y",0)*r,a.scaleX=jT(t,"scaleX",1),a.scaleY=jT(t,"scaleY",1),a.rotation=jT(t,"rotation",0),a.width=t.width*r,a.height=t.height*r,a.sequence=i;const o=jT(t,"color",null);return o&&a.color.setFromString(o),a}case"boundingbox":{const n=this.attachmentLoader.newBoundingBoxAttachment(e,s);if(!n)return null;this.readVertices(t,n,t.vertexCount<<1);const i=jT(t,"color",null);return i&&n.color.setFromString(i),n}case"mesh":case"linkedmesh":{const i=jT(t,"path",s),a=this.readSequence(jT(t,"sequence",null)),o=this.attachmentLoader.newMeshAttachment(e,s,i,a);if(!o)return null;o.path=i;const l=jT(t,"color",null);l&&o.color.setFromString(l),o.width=jT(t,"width",0)*r,o.height=jT(t,"height",0)*r,o.sequence=a;const h=jT(t,"parent",null);if(h)return this.linkedMeshes.push(new WT(o,jT(t,"skin",null),n,h,jT(t,"timelines",!0))),o;const c=t.uvs;return this.readVertices(t,o,c.length),o.triangles=t.triangles,o.regionUVs=new Float32Array(c),o.edges=jT(t,"edges",null),o.hullLength=2*jT(t,"hull",0),o}case"path":{const n=this.attachmentLoader.newPathAttachment(e,s);if(!n)return null;n.closed=jT(t,"closed",!1),n.constantSpeed=jT(t,"constantSpeed",!0);const i=t.vertexCount;this.readVertices(t,n,i<<1);const a=xy.newArray(i/3,0);for(let e=0;e<t.lengths.length;e++)a[e]=t.lengths[e]*r;n.lengths=a;const o=jT(t,"color",null);return o&&n.color.setFromString(o),n}case"point":{const n=this.attachmentLoader.newPointAttachment(e,s);if(!n)return null;n.x=jT(t,"x",0)*r,n.y=jT(t,"y",0)*r,n.rotation=jT(t,"rotation",0);const i=jT(t,"color",null);return i&&n.color.setFromString(i),n}case"clipping":{const n=this.attachmentLoader.newClippingAttachment(e,s);if(!n)return null;const r=jT(t,"end",null);if(null!=r){const t=i.findSlot(r);if(null==t)throw new Error(`Clipping end slot not found: ${r}`);n.endSlot=t}const a=t.vertexCount;this.readVertices(t,n,a<<1);const o=jT(t,"color",null);return o&&n.color.setFromString(o),n}}return null}readSequence(t){if(null==t)return null;const e=new Rw(jT(t,"count",0));return e.start=jT(t,"start",1),e.digits=jT(t,"digits",0),e.setupIndex=jT(t,"setup",0),e}readVertices(t,e,n){const s=this.scale;e.worldVerticesLength=n;const i=t.vertices;if(n==i.length){const t=xy.toFloatArray(i);if(1!=s)for(let e=0,n=i.length;e<n;e++)t[e]*=s;return void(e.vertices=t)}const r=new Array,a=new Array;for(let o=0,l=i.length;o<l;){const t=i[o++];a.push(t);for(let e=o+4*t;o<e;o+=4)a.push(i[o]),r.push(i[o+1]*s),r.push(i[o+2]*s),r.push(i[o+3])}e.bones=a,e.vertices=xy.toFloatArray(r)}readAnimation(t,e,n){const s=this.scale,i=new Array;if(t.slots)for(const a in t.slots){const e=t.slots[a],s=n.findSlot(a);if(!s)throw new Error(`Slot not found: ${a}`);const r=s.index;for(const t in e){const n=e[t];if(!n)continue;const s=n.length;if("attachment"==t){const t=new yE(s,r);for(let e=0;e<s;e++){const s=n[e];t.setFrame(e,jT(s,"time",0),jT(s,"name",null))}i.push(t)}else if("rgba"==t){const t=new pE(s,s<<2,r);let e=n[0],a=jT(e,"time",0),o=uy.fromString(e.color);for(let s=0,i=0;;s++){t.setFrame(s,a,o.r,o.g,o.b,o.a);const r=n[s+1];if(!r){t.shrink(i);break}const l=jT(r,"time",0),h=uy.fromString(r.color),c=e.curve;c&&(i=HT(c,t,i,s,0,a,l,o.r,h.r,1),i=HT(c,t,i,s,1,a,l,o.g,h.g,1),i=HT(c,t,i,s,2,a,l,o.b,h.b,1),i=HT(c,t,i,s,3,a,l,o.a,h.a,1)),a=l,o=h,e=r}i.push(t)}else if("rgb"==t){const t=new mE(s,3*s,r);let e=n[0],a=jT(e,"time",0),o=uy.fromString(e.color);for(let s=0,i=0;;s++){t.setFrame(s,a,o.r,o.g,o.b);const r=n[s+1];if(!r){t.shrink(i);break}const l=jT(r,"time",0),h=uy.fromString(r.color),c=e.curve;c&&(i=HT(c,t,i,s,0,a,l,o.r,h.r,1),i=HT(c,t,i,s,1,a,l,o.g,h.g,1),i=HT(c,t,i,s,2,a,l,o.b,h.b,1)),a=l,o=h,e=r}i.push(t)}else if("alpha"==t)i.push(zT(n,new gE(s,s,r),0,1));else if("rgba2"==t){const t=new vE(s,7*s,r);let e=n[0],a=jT(e,"time",0),o=uy.fromString(e.light),l=uy.fromString(e.dark);for(let s=0,i=0;;s++){t.setFrame(s,a,o.r,o.g,o.b,o.a,l.r,l.g,l.b);const r=n[s+1];if(!r){t.shrink(i);break}const h=jT(r,"time",0),c=uy.fromString(r.light),u=uy.fromString(r.dark),d=e.curve;d&&(i=HT(d,t,i,s,0,a,h,o.r,c.r,1),i=HT(d,t,i,s,1,a,h,o.g,c.g,1),i=HT(d,t,i,s,2,a,h,o.b,c.b,1),i=HT(d,t,i,s,3,a,h,o.a,c.a,1),i=HT(d,t,i,s,4,a,h,l.r,u.r,1),i=HT(d,t,i,s,5,a,h,l.g,u.g,1),i=HT(d,t,i,s,6,a,h,l.b,u.b,1)),a=h,o=c,l=u,e=r}i.push(t)}else if("rgb2"==t){const t=new xE(s,6*s,r);let e=n[0],a=jT(e,"time",0),o=uy.fromString(e.light),l=uy.fromString(e.dark);for(let s=0,i=0;;s++){t.setFrame(s,a,o.r,o.g,o.b,l.r,l.g,l.b);const r=n[s+1];if(!r){t.shrink(i);break}const h=jT(r,"time",0),c=uy.fromString(r.light),u=uy.fromString(r.dark),d=e.curve;d&&(i=HT(d,t,i,s,0,a,h,o.r,c.r,1),i=HT(d,t,i,s,1,a,h,o.g,c.g,1),i=HT(d,t,i,s,2,a,h,o.b,c.b,1),i=HT(d,t,i,s,3,a,h,l.r,u.r,1),i=HT(d,t,i,s,4,a,h,l.g,u.g,1),i=HT(d,t,i,s,5,a,h,l.b,u.b,1)),a=h,o=c,l=u,e=r}i.push(t)}}}if(t.bones)for(const a in t.bones){const e=t.bones[a],r=n.findBone(a);if(!r)throw new Error(`Bone not found: ${a}`);const o=r.index;for(const t in e){const n=e[t],r=n.length;if(0!=r)if("rotate"===t)i.push(zT(n,new iE(r,r,o),0,1));else if("translate"===t){const t=new rE(r,r<<1,o);i.push(GT(n,t,"x","y",0,s))}else if("translatex"===t){const t=new aE(r,r,o);i.push(zT(n,t,0,s))}else if("translatey"===t){const t=new oE(r,r,o);i.push(zT(n,t,0,s))}else if("scale"===t){const t=new lE(r,r<<1,o);i.push(GT(n,t,"x","y",1,1))}else if("scalex"===t){const t=new hE(r,r,o);i.push(zT(n,t,1,1))}else if("scaley"===t){const t=new cE(r,r,o);i.push(zT(n,t,1,1))}else if("shear"===t){const t=new uE(r,r<<1,o);i.push(GT(n,t,"x","y",0,1))}else if("shearx"===t){const t=new dE(r,r,o);i.push(zT(n,t,0,1))}else if("sheary"===t){const t=new fE(r,r,o);i.push(zT(n,t,0,1))}}}if(t.ik)for(const a in t.ik){const e=t.ik[a];let r=e[0];if(!r)continue;const o=n.findIkConstraint(a);if(!o)throw new Error(`IK Constraint not found: ${a}`);const l=n.ikConstraints.indexOf(o),h=new SE(e.length,e.length<<1,l);let c=jT(r,"time",0),u=jT(r,"mix",1),d=jT(r,"softness",0)*s;for(let t=0,n=0;;t++){h.setFrame(t,c,u,d,jT(r,"bendPositive",!0)?1:-1,jT(r,"compress",!1),jT(r,"stretch",!1));const i=e[t+1];if(!i){h.shrink(n);break}const a=jT(i,"time",0),o=jT(i,"mix",1),l=jT(i,"softness",0)*s,f=r.curve;f&&(n=HT(f,h,n,t,0,c,a,u,o,1),n=HT(f,h,n,t,1,c,a,d,l,s)),c=a,u=o,d=l,r=i}i.push(h)}if(t.transform)for(const a in t.transform){const e=t.transform[a];let s=e[0];if(!s)continue;const r=n.findTransformConstraint(a);if(!r)throw new Error(`Transform constraint not found: ${a}`);const o=n.transformConstraints.indexOf(r),l=new AE(e.length,6*e.length,o);let h=jT(s,"time",0),c=jT(s,"mixRotate",1),u=jT(s,"mixX",1),d=jT(s,"mixY",u),f=jT(s,"mixScaleX",1),p=jT(s,"mixScaleY",f);const m=jT(s,"mixShearY",1);for(let t=0,n=0;;t++){l.setFrame(t,h,c,u,d,f,p,m);const i=e[t+1];if(!i){l.shrink(n);break}const r=jT(i,"time",0),a=jT(i,"mixRotate",1),o=jT(i,"mixX",1),g=jT(i,"mixY",o),v=jT(i,"mixScaleX",1),x=jT(i,"mixScaleY",v),y=jT(i,"mixShearY",1),_=s.curve;_&&(n=HT(_,l,n,t,0,h,r,c,a,1),n=HT(_,l,n,t,1,h,r,u,o,1),n=HT(_,l,n,t,2,h,r,d,g,1),n=HT(_,l,n,t,3,h,r,f,v,1),n=HT(_,l,n,t,4,h,r,p,x,1),n=HT(_,l,n,t,5,h,r,m,y,1)),h=r,c=a,u=o,d=g,f=v,p=x,f=v,s=i}i.push(l)}if(t.path)for(const a in t.path){const e=t.path[a],r=n.findPathConstraint(a);if(!r)throw new Error(`Path constraint not found: ${a}`);const o=n.pathConstraints.indexOf(r);for(const t in e){const n=e[t];let a=n[0];if(!a)continue;const l=n.length;if("position"===t){const t=new CE(l,l,o);i.push(zT(n,t,0,r.positionMode==Kx.Fixed?s:1))}else if("spacing"===t){const t=new IE(l,l,o);i.push(zT(n,t,0,r.spacingMode==eT.Length||r.spacingMode==eT.Fixed?s:1))}else if("mix"===t){const t=new ME(l,3*l,o);let e=jT(a,"time",0),s=jT(a,"mixRotate",1),r=jT(a,"mixX",1),h=jT(a,"mixY",r);for(let i=0,o=0;;i++){t.setFrame(i,e,s,r,h);const l=n[i+1];if(!l){t.shrink(o);break}const c=jT(l,"time",0),u=jT(l,"mixRotate",1),d=jT(l,"mixX",1),f=jT(l,"mixY",d),p=a.curve;p&&(o=HT(p,t,o,i,0,e,c,s,u,1),o=HT(p,t,o,i,1,e,c,r,d,1),o=HT(p,t,o,i,2,e,c,h,f,1)),e=c,s=u,r=d,h=f,a=l}i.push(t)}}}if(t.deform){t.attachments={};for(const e in t.deform){const n=t.deform[e],s=t.attachments[e]={};for(const t in n){const e=n[t],i=s[t]={};for(const t in e)i[t]={deform:e[t]}}}}if(t.attachments)for(const a in t.attachments){const e=t.attachments[a],r=n.findSkin(a);if(null!=r)for(const t in e){const a=e[t],o=n.findSlot(t);if(!o)throw new Error(`Slot not found: ${t}`);const l=o.index;for(const t in a){const e=a[t],n=r.getAttachment(l,t);for(const t in e){const r=e[t];let a=r[0];if(a)if("deform"==t){const t=n.bones,e=n.vertices,o=t?e.length/3*2:e.length,h=new _E(r.length,r.length,l,n);let c=jT(a,"time",0);for(let n=0,i=0;;n++){let l;const u=jT(a,"vertices",null);if(u){l=xy.newFloatArray(o);const n=jT(a,"offset",0);if(xy.arrayCopy(u,0,l,n,u.length),1!=s)for(let t=n,e=t+u.length;t<e;t++)l[t]*=s;if(!t)for(let t=0;t<o;t++)l[t]+=e[t]}else l=t?xy.newFloatArray(o):e;h.setFrame(n,c,l);const d=r[n+1];if(!d){h.shrink(i);break}const f=jT(d,"time",0),p=a.curve;p&&(i=HT(p,h,i,n,0,c,f,0,1,1)),c=f,a=d}i.push(h)}else if("sequence"==t){const t=new PE(r.length,l,n);let e=0;for(let n=0;n<r.length;n++){const s=jT(a,"delay",e),i=jT(a,"time",0),o=Pw[jT(a,"mode","hold")],l=jT(a,"index",0);t.setFrame(n,i,o,l,s),e=s,a=r[n+1]}i.push(t)}}}}}if(t.drawOrder){const e=new TE(t.drawOrder.length),s=n.slots.length;let r=0;for(let i=0;i<t.drawOrder.length;i++,r++){const a=t.drawOrder[i];let o=null;const l=jT(a,"offsets",null);if(l){o=xy.newArray(s,-1);const t=xy.newArray(s-l.length,0);let e=0,i=0;for(let s=0;s<l.length;s++){const r=l[s],a=n.findSlot(r.slot);if(!a)throw new Error(`Slot not found: ${a}`);const h=a.index;for(;e!=h;)t[i++]=e++;o[e+r.offset]=e++}for(;e<s;)t[i++]=e++;for(let n=s-1;n>=0;n--)-1==o[n]&&(o[n]=t[--i])}e.setFrame(r,jT(a,"time",0),o)}i.push(e)}if(t.events){const e=new wE(t.events.length);let s=0;for(let i=0;i<t.events.length;i++,s++){const r=t.events[i],a=n.findEvent(r.name);if(!a)throw new Error(`Event not found: ${r.name}`);const o=new KE(xy.toSinglePrecision(jT(r,"time",0)),a);o.intValue=jT(r,"int",a.intValue),o.floatValue=jT(r,"float",a.floatValue),o.stringValue=jT(r,"string",a.stringValue),o.data.audioPath&&(o.volume=jT(r,"volume",1),o.balance=jT(r,"balance",0)),e.setFrame(s,o)}i.push(e)}let r=0;for(let a=0,o=i.length;a<o;a++)r=Math.max(r,i[a].getDuration());if(isNaN(r))throw new Error("Error while parsing animation, duration is NaN");n.animations.push(new Fw(e,i,r))}static blendModeFromString(t){if("normal"==(t=t.toLowerCase()))return Ir.NORMAL;if("additive"==t)return Ir.ADD;if("multiply"==t)return Ir.MULTIPLY;if("screen"==t)return Ir.SCREEN;throw new Error(`Unknown blend mode: ${t}`)}}class WT{constructor(t,e,n,s,i){this.mesh=t,this.skin=e,this.slotIndex=n,this.parent=s,this.inheritTimeline=i}}function zT(t,e,n,s){let i=t[0],r=jT(i,"time",0),a=jT(i,"value",n)*s,o=0;for(let l=0;;l++){e.setFrame(l,r,a);const h=t[l+1];if(!h)return e.shrink(o),e;const c=jT(h,"time",0),u=jT(h,"value",n)*s;i.curve&&(o=HT(i.curve,e,o,l,0,r,c,a,u,s)),r=c,a=u,i=h}}function GT(t,e,n,s,i,r){let a=t[0],o=jT(a,"time",0),l=jT(a,n,i)*r,h=jT(a,s,i)*r,c=0;for(let u=0;;u++){e.setFrame(u,o,l,h);const d=t[u+1];if(!d)return e.shrink(c),e;const f=jT(d,"time",0),p=jT(d,n,i)*r,m=jT(d,s,i)*r,g=a.curve;g&&(c=HT(g,e,c,u,0,o,f,l,p,r),c=HT(g,e,c,u,1,o,f,h,m,r)),o=f,l=p,h=m,a=d}}function HT(t,e,n,s,i,r,a,o,l,h){if("stepped"==t)return e.setStepped(s),n;const c=i<<2,u=t[c],d=t[c+1]*h,f=t[c+2],p=t[c+3]*h;return e.setBezier(n,s,i,r,o,u,d,f,p,a,l),n+1}function jT(t,e,n){return void 0!==t[e]?t[e]:n}const $T=Object.freeze(Object.defineProperty({__proto__:null,AlphaTimeline:gE,Animation:Fw,AnimationState:FE,AnimationStateAdapter:class{start(t){}interrupt(t){}end(t){}dispose(t){}complete(t){}event(t,e){}},AnimationStateData:GE,AtlasAttachmentLoader:HE,Attachment:yw,AttachmentTimeline:yE,Bone:jE,BoneData:$E,BoundingBoxAttachment:ww,ClippingAttachment:Ew,ConstraintData:qE,CurveTimeline:eE,CurveTimeline1:nE,CurveTimeline2:sE,DeformTimeline:_E,DrawOrderTimeline:TE,Event:KE,EventData:ZE,EventQueue:LE,EventTimeline:wE,EventType:NE,IkConstraint:QE,IkConstraintData:JE,IkConstraintTimeline:SE,MeshAttachment:Tw,PathAttachment:Sw,PathConstraint:sT,PathConstraintData:tT,PathConstraintMixTimeline:ME,PathConstraintPositionTimeline:CE,PathConstraintSpacingTimeline:IE,PointAttachment:Aw,RGB2Timeline:xE,RGBA2Timeline:vE,RGBATimeline:pE,RGBTimeline:mE,RegionAttachment:Iw,RotateTimeline:iE,ScaleTimeline:lE,ScaleXTimeline:hE,ScaleYTimeline:cE,Sequence:Rw,SequenceMode:Pw,SequenceModeValues:kw,SequenceTimeline:PE,ShearTimeline:uE,ShearXTimeline:dE,ShearYTimeline:fE,Skeleton:oT,SkeletonBinary:fT,SkeletonBounds:class extends by{},SkeletonData:lT,SkeletonJson:YT,Skin:dT,SkinEntry:uT,Slot:iT,SlotData:hT,SpacingMode:eT,Spine:class extends Cy{createSkeleton(t){this.skeleton=new oT(t),this.skeleton.updateWorldTransform(),this.stateData=new GE(t),this.state=new FE(this.stateData)}},Timeline:tE,TrackEntry:DE,TransformConstraint:rT,TransformConstraintData:cT,TransformConstraintTimeline:AE,TranslateTimeline:rE,TranslateXTimeline:aE,TranslateYTimeline:oE,VertexAttachment:bw},Symbol.toStringTag,{value:"Module"}));var qT=(t=>(t[t.UNKNOWN=0]="UNKNOWN",t[t.VER37=37]="VER37",t[t.VER38=38]="VER38",t[t.VER40=40]="VER40",t[t.VER41=41]="VER41",t))(qT||{});function KT(t){const e=t.substr(0,3),n=Math.floor(10*Number(e)+.001);return"3.7"===e?37:"3.8"===e?38:"4.0"===e?40:"4.1"===e?41:n<37?37:0}class ZT{constructor(){this.scale=1}readSkeletonData(t,e){let n=null,s=this.readVersionOldFormat(e),i=KT(s);if(i===qT.VER38&&(n=new K_(new M_(t))),s=this.readVersionNewFormat(e),i=KT(s),i!==qT.VER40&&i!==qT.VER41||(n=new fT(new HE(t))),!n){const t=`Unsupported version of spine model ${s}, please update pixi-spine`;console.error(t)}return n.scale=this.scale,n.readSkeletonData(e)}readVersionOldFormat(t){const e=new jx(t);let n;try{e.readString(),n=e.readString()}catch(_m){n=""}return n||""}readVersionNewFormat(t){const e=new jx(t);let n;e.readInt32(),e.readInt32();try{n=e.readString()}catch(_m){n=""}return n||""}}class QT{constructor(){this.scale=1}readSkeletonData(t,e){const n=e.skeleton.spine,s=KT(n);let i=null;if(s===qT.VER37&&(i=new gw(new Qb(t))),s===qT.VER38&&(i=new J_(new M_(t))),s!==qT.VER40&&s!==qT.VER41||(i=new YT(new HE(t))),!i){const t=`Unsupported version of spine model ${n}, please update pixi-spine`;console.error(t)}return i.scale=this.scale,i.readSkeletonData(e)}}class JT extends Cy{createSkeleton(t){const e=KT(t.version);let n=null;if(e===qT.VER37&&(n=xw),e===qT.VER38&&(n=eb),e!==qT.VER40&&e!==qT.VER41||(n=$T),!n){const e=`Cant detect version of spine model ${t.version}`;console.error(e)}this.skeleton=new n.Skeleton(t),this.skeleton.updateWorldTransform(),this.stateData=new n.AnimationStateData(t),this.state=new n.AnimationState(this.stateData)}}(new class extends ky{createBinaryParser(){return new ZT}createJsonParser(){return new QT}parseData(t,e,n){return{spineData:t.readSkeletonData(e,n),spineAtlas:e}}}).installLoader();const tS=class extends(Ag(JT)){constructor(t){super(globalThis.pgame.getSpine(t).spineData),p(this,"_pivotRule",_g.Center),this.autoUpdate=!1,this.update=this._update}get pivotRule(){return _g.Center}get debugBox(){return!1}get enable(){return this.update===this._update}set enable(t){this.update=t?this._update:globalThis.doNothing}_update(t){JT.prototype.update.call(this,.001*globalThis.pgame.DeltaMS)}get debug(){return super.debug}set debug(t){super.debug=t}constructDebugRenderer(t=!0){void 0!==this.debug||(this.debug=t?tS.debug:new Iy)}};let eS=tS;p(eS,"debug",new Iy);class nS extends ua{constructor(t,e,n=0,s=0,i=!1){super(),p(this,"enable"),p(this,"time"),p(this,"delay"),p(this,"repeat"),p(this,"isEnded"),p(this,"isStarted"),p(this,"preserved"),p(this,"_delayTime"),p(this,"_elapsedTime"),p(this,"_repeat"),p(this,"_timerManager"),p(this,"_next"),this.time=e,this.enable=!1,this.delay=s,this.repeat=n,this.preserved=i,this.isEnded=!1,this.isStarted=!1,this._delayTime=0,this._elapsedTime=0,this._repeat=0,this._timerManager=t,this.preserved&&t.add(this)}get timerManager(){return this._timerManager}set timerManager(t){this._timerManager!==t&&(this._timerManager.remove(this),this._timerManager=t,this.preserved&&t.add(this))}start(t=!1){return t&&this.reset(),this.enable=!0,this.preserved||this._timerManager.add(this),this}stop(t=!0){return this.isEnded=!0,this.enable=!1,t&&this.emit("end",this._elapsedTime),this}reset(){return this._elapsedTime=0,this._repeat=0,this._delayTime=0,this.isStarted=!1,this.isEnded=!1,this}remove(){return this._timerManager.remove(this),this}chain(t){return this._next=t,t.timerManager=this.timerManager,this}single(t,e,n){return this.off(t).on(t,e,n)}update(t){var e;if(this.delay>this._delayTime)this._delayTime+=t;else if(this.isStarted||(this.isStarted=!0,this.emit("start",this._elapsedTime)),this.time>this._elapsedTime){const n=this._elapsedTime+t,s=n>=this.time;if(this._elapsedTime=s?this.time:n,this.emit("update",this._elapsedTime,t),s){if(this.repeat>this._repeat)return this._repeat++,this.emit("repeat",this._elapsedTime,this._repeat),void(this._elapsedTime=0);this.stop(),null==(e=this._next)||e.start()}}}}class sS{constructor(){p(this,"_timers",[]),p(this,"_timersToDelete",[])}size(){return this._timers.length}update(t){if(this._timersToDelete.length){for(const t of this._timersToDelete)this._remove(t);this._timersToDelete.length=0}for(const e of this._timers)e.enable&&(e.update(t),e.isEnded&&!e.preserved&&this.remove(e))}add(t){(t.preserved||t.enable)&&this._timers.push(t)}stopAll(t=!1){for(const e of this._timers)e.stop(t)}remove(t){this._timersToDelete.push(t)}_remove(t){const e=this._timers.indexOf(t);e>-1&&this._timers.splice(e,1)}}class iS{constructor(t){p(this,"name"),p(this,"_firstIn",!0),p(this,"_firstOut",!0),p(this,"_canExit",!1),p(this,"_nextState"),p(this,"timers"),this.name=t,this._nextState="",this.timers=new sS}enter(){}update(t){}prepareExit(){this._canExit=!0}exit(){}setNext(t){this._nextState=t}runFSM(t){return this._firstIn&&(this._firstIn=!1,this._firstOut=!0,this._canExit=!1,this._nextState="",this.enter()),globalThis.pgame.timers.update(globalThis.pgame.DeltaMS),this.timers.update(globalThis.pgame.DeltaMS),this.update(t),""!=this._nextState&&(this._firstOut&&(this._firstOut=!1,this.prepareExit()),this._canExit)?(this._firstIn=!0,this.exit(),this._nextState):""}createTimer(t,e=0,n=0,s=!1){return new nS(this.timers,t,e,n,s)}}class rS{constructor(t,e,n){this.value=t,this.time=e,this.next=null,this.isStepped=!1,this.ease=n?"function"==typeof n?n:fS(n):null}static createList(t){if("list"in t){const e=t.list;let n;const{value:s,time:i}=e[0],r=n=new rS("string"==typeof s?dS(s):s,i,t.ease);if(e.length>2||2===e.length&&e[1].value!==s)for(let t=1;t<e.length;++t){const{value:s,time:i}=e[t];n.next=new rS("string"==typeof s?dS(s):s,i),n=n.next}return r.isStepped=!!t.isStepped,r}const e=new rS("string"==typeof t.start?dS(t.start):t.start,0);return t.end!==t.start&&(e.next=new rS("string"==typeof t.end?dS(t.end):t.end,1)),e}}let aS=ic.from;const oS=Math.PI/180;function lS(t,e){if(!t)return;const n=Math.sin(t),s=Math.cos(t),i=e.x*s-e.y*n,r=e.x*n+e.y*s;e.x=i,e.y=r}function hS(t,e,n){return t<<16|e<<8|n}function cS(t){return Math.sqrt(t.x*t.x+t.y*t.y)}function uS(t,e){t.x*=e,t.y*=e}function dS(t,e){let n;return e||(e={}),"#"===t.charAt(0)?t=t.substr(1):0===t.indexOf("0x")&&(t=t.substr(2)),8===t.length&&(n=t.substr(0,2),t=t.substr(2)),e.r=parseInt(t.substr(0,2),16),e.g=parseInt(t.substr(2,2),16),e.b=parseInt(t.substr(4,2),16),n&&(e.a=parseInt(n,16)),e}function fS(t){const e=t.length,n=1/e;return function(s){const i=e*s|0,r=(s-i*n)*e,a=t[i]||t[e-1];return a.s+r*(2*(1-r)*(a.cp-a.s)+r*(a.e-a.s))}}class pS extends Pu{constructor(t){super(),this.prevChild=this.nextChild=null,this.emitter=t,this.config={},this.anchor.x=this.anchor.y=.5,this.maxLife=0,this.age=0,this.agePercent=0,this.oneOverLife=0,this.next=null,this.prev=null,this.init=this.init,this.kill=this.kill}init(t){this.maxLife=t,this.age=this.agePercent=0,this.rotation=0,this.position.x=this.position.y=0,this.scale.x=this.scale.y=1,this.tint=16777215,this.alpha=1,this.oneOverLife=1/this.maxLife,this.visible=!0}kill(){this.emitter.recycle(this)}destroy(){this.parent&&this.parent.removeChild(this),this.emitter=this.next=this.prev=null,super.destroy()}}var mS,gS;(gS=mS||(mS={}))[gS.Spawn=0]="Spawn",gS[gS.Normal=2]="Normal",gS[gS.Late=5]="Late";const vS=iu.shared,xS=Symbol("Position particle per emitter position");class yS{constructor(t,e){this.initBehaviors=[],this.updateBehaviors=[],this.recycleBehaviors=[],this.minLifetime=0,this.maxLifetime=0,this.customEase=null,this._frequency=1,this.spawnChance=1,this.maxParticles=1e3,this.emitterLifetime=-1,this.spawnPos=new ql,this.particlesPerWave=1,this.rotation=0,this.ownerPos=new ql,this._prevEmitterPos=new ql,this._prevPosIsValid=!1,this._posChanged=!1,this._parent=null,this.addAtBack=!1,this.particleCount=0,this._emit=!1,this._spawnTimer=0,this._emitterLife=-1,this._activeParticlesFirst=null,this._activeParticlesLast=null,this._poolFirst=null,this._origConfig=null,this._autoUpdate=!1,this._destroyWhenComplete=!1,this._completeCallback=null,this.parent=t,e&&this.init(e),this.recycle=this.recycle,this.update=this.update,this.rotate=this.rotate,this.updateSpawnPos=this.updateSpawnPos,this.updateOwnerPos=this.updateOwnerPos}static registerBehavior(t){yS.knownBehaviors[t.type]=t}get frequency(){return this._frequency}set frequency(t){this._frequency="number"==typeof t&&t>0?t:1}get parent(){return this._parent}set parent(t){this.cleanup(),this._parent=t}init(t){if(!t)return;this.cleanup(),this._origConfig=t,this.minLifetime=t.lifetime.min,this.maxLifetime=t.lifetime.max,t.ease?this.customEase="function"==typeof t.ease?t.ease:fS(t.ease):this.customEase=null,this.particlesPerWave=1,t.particlesPerWave&&t.particlesPerWave>1&&(this.particlesPerWave=t.particlesPerWave),this.frequency=t.frequency,this.spawnChance="number"==typeof t.spawnChance&&t.spawnChance>0?t.spawnChance:1,this.emitterLifetime=t.emitterLifetime||-1,this.maxParticles=t.maxParticles>0?t.maxParticles:1e3,this.addAtBack=!!t.addAtBack,this.rotation=0,this.ownerPos.set(0),t.pos?this.spawnPos.copyFrom(t.pos):this.spawnPos.set(0),this._prevEmitterPos.copyFrom(this.spawnPos),this._prevPosIsValid=!1,this._spawnTimer=0,this.emit=void 0===t.emit||!!t.emit,this.autoUpdate=!!t.autoUpdate;const e=t.behaviors.map((t=>{const e=yS.knownBehaviors[t.type];return e?new e(t.config):(console.error(`Unknown behavior: ${t.type}`),null)})).filter((t=>!!t));e.push(xS),e.sort(((t,e)=>t===xS?e.order===mS.Spawn?1:-1:e===xS?t.order===mS.Spawn?-1:1:t.order-e.order)),this.initBehaviors=e.slice(),this.updateBehaviors=e.filter((t=>t!==xS&&t.updateParticle)),this.recycleBehaviors=e.filter((t=>t!==xS&&t.recycleParticle))}getBehavior(t){return yS.knownBehaviors[t]&&this.initBehaviors.find((e=>e instanceof yS.knownBehaviors[t]))||null}fillPool(t){for(;t>0;--t){const t=new pS(this);t.next=this._poolFirst,this._poolFirst=t}}recycle(t,e=!1){for(let n=0;n<this.recycleBehaviors.length;++n)this.recycleBehaviors[n].recycleParticle(t,!e);t.next&&(t.next.prev=t.prev),t.prev&&(t.prev.next=t.next),t===this._activeParticlesLast&&(this._activeParticlesLast=t.prev),t===this._activeParticlesFirst&&(this._activeParticlesFirst=t.next),t.prev=null,t.next=this._poolFirst,this._poolFirst=t,t.parent&&t.parent.removeChild(t),--this.particleCount}rotate(t){if(this.rotation===t)return;const e=t-this.rotation;this.rotation=t,lS(e,this.spawnPos),this._posChanged=!0}updateSpawnPos(t,e){this._posChanged=!0,this.spawnPos.x=t,this.spawnPos.y=e}updateOwnerPos(t,e){this._posChanged=!0,this.ownerPos.x=t,this.ownerPos.y=e}resetPositionTracking(){this._prevPosIsValid=!1}get emit(){return this._emit}set emit(t){this._emit=!!t,this._emitterLife=this.emitterLifetime}get autoUpdate(){return this._autoUpdate}set autoUpdate(t){this._autoUpdate&&!t?vS.remove(this.update,this):!this._autoUpdate&&t&&vS.add(this.update,this),this._autoUpdate=!!t}playOnceAndDestroy(t){this.autoUpdate=!0,this.emit=!0,this._destroyWhenComplete=!0,this._completeCallback=t}playOnce(t){this.emit=!0,this._completeCallback=t}update(t){if(this._autoUpdate&&(t=.001*vS.elapsedMS),!this._parent)return;for(let r,a=this._activeParticlesFirst;a;a=r)if(r=a.next,a.age+=t,a.age>a.maxLife||a.age<0)this.recycle(a);else{let e=a.age*a.oneOverLife;this.customEase&&(e=4===this.customEase.length?this.customEase(e,0,1,1):this.customEase(e)),a.agePercent=e;for(let n=0;n<this.updateBehaviors.length;++n)if(this.updateBehaviors[n].updateParticle(a,t)){this.recycle(a);break}}let e,n;this._prevPosIsValid&&(e=this._prevEmitterPos.x,n=this._prevEmitterPos.y);const s=this.ownerPos.x+this.spawnPos.x,i=this.ownerPos.y+this.spawnPos.y;if(this._emit)for(this._spawnTimer-=t<0?0:t;this._spawnTimer<=0;){if(this._emitterLife>=0&&(this._emitterLife-=this._frequency,this._emitterLife<=0)){this._spawnTimer=0,this._emitterLife=0,this.emit=!1;break}if(this.particleCount>=this.maxParticles){this._spawnTimer+=this._frequency;continue}let r,a;if(this._prevPosIsValid&&this._posChanged){const o=1+this._spawnTimer/t;r=(s-e)*o+e,a=(i-n)*o+n}else r=s,a=i;let o=null,l=null;for(let t=Math.min(this.particlesPerWave,this.maxParticles-this.particleCount),e=0;e<t;++e){if(this.spawnChance<1&&Math.random()>=this.spawnChance)continue;let t,e;(t=this.minLifetime===this.maxLifetime?this.minLifetime:Math.random()*(this.maxLifetime-this.minLifetime)+this.minLifetime,-this._spawnTimer>=t)||(this._poolFirst?(e=this._poolFirst,this._poolFirst=this._poolFirst.next,e.next=null):e=new pS(this),e.init(t),this.addAtBack?this._parent.addChildAt(e,0):this._parent.addChild(e),o?(l.next=e,e.prev=l,l=e):l=o=e,++this.particleCount)}if(o){this._activeParticlesLast?(this._activeParticlesLast.next=o,o.prev=this._activeParticlesLast,this._activeParticlesLast=l):(this._activeParticlesFirst=o,this._activeParticlesLast=l);for(let t=0;t<this.initBehaviors.length;++t){const e=this.initBehaviors[t];if(e===xS)for(let t,n=o;n;n=t){t=n.next,0!==this.rotation&&(lS(this.rotation,n.position),n.rotation+=this.rotation),n.position.x+=r,n.position.y+=a,n.age+=-this._spawnTimer;let e=n.age*n.oneOverLife;this.customEase&&(e=4===this.customEase.length?this.customEase(e,0,1,1):this.customEase(e)),n.agePercent=e}else e.initParticles(o)}for(let t,e=o;e;e=t){t=e.next;for(let t=0;t<this.updateBehaviors.length;++t)if(this.updateBehaviors[t].updateParticle(e,-this._spawnTimer)){this.recycle(e);break}}}this._spawnTimer+=this._frequency}if(this._posChanged&&(this._prevEmitterPos.x=s,this._prevEmitterPos.y=i,this._prevPosIsValid=!0,this._posChanged=!1),!this._emit&&!this._activeParticlesFirst){if(this._completeCallback){const t=this._completeCallback;this._completeCallback=null,t()}this._destroyWhenComplete&&this.destroy()}}emitNow(){const t=this.ownerPos.x+this.spawnPos.x,e=this.ownerPos.y+this.spawnPos.y;let n=null,s=null;for(let i=Math.min(this.particlesPerWave,this.maxParticles-this.particleCount),r=0;r<i;++r){if(this.spawnChance<1&&Math.random()>=this.spawnChance)continue;let t,e;this._poolFirst?(t=this._poolFirst,this._poolFirst=this._poolFirst.next,t.next=null):t=new pS(this),e=this.minLifetime===this.maxLifetime?this.minLifetime:Math.random()*(this.maxLifetime-this.minLifetime)+this.minLifetime,t.init(e),this.addAtBack?this._parent.addChildAt(t,0):this._parent.addChild(t),n?(s.next=t,t.prev=s,s=t):s=n=t,++this.particleCount}if(n){this._activeParticlesLast?(this._activeParticlesLast.next=n,n.prev=this._activeParticlesLast,this._activeParticlesLast=s):(this._activeParticlesFirst=n,this._activeParticlesLast=s);for(let s=0;s<this.initBehaviors.length;++s){const i=this.initBehaviors[s];if(i===xS)for(let s,r=n;r;r=s)s=r.next,0!==this.rotation&&(lS(this.rotation,r.position),r.rotation+=this.rotation),r.position.x+=t,r.position.y+=e;else i.initParticles(n)}}}cleanup(){let t,e;for(t=this._activeParticlesFirst;t;t=e)e=t.next,this.recycle(t,!0);this._activeParticlesFirst=this._activeParticlesLast=null,this.particleCount=0}get destroyed(){return!(this._parent&&this.initBehaviors.length)}destroy(){let t;this.autoUpdate=!1,this.cleanup();for(let e=this._poolFirst;e;e=t)t=e.next,e.destroy();this._poolFirst=this._parent=this.spawnPos=this.ownerPos=this.customEase=this._completeCallback=null,this.initBehaviors.length=this.updateBehaviors.length=this.recycleBehaviors.length=0}}yS.knownBehaviors={};class _S{constructor(t){this.x=t.x,this.y=t.y,this.w=t.w,this.h=t.h}getRandPos(t){t.x=Math.random()*this.w+this.x,t.y=Math.random()*this.h+this.y}}_S.type="rect",_S.editorConfig=null;class bS{constructor(t){this.x=t.x||0,this.y=t.y||0,this.radius=t.radius,this.innerRadius=t.innerRadius||0,this.rotation=!!t.affectRotation}getRandPos(t){this.innerRadius!==this.radius?t.x=Math.random()*(this.radius-this.innerRadius)+this.innerRadius:t.x=this.radius,t.y=0;const e=Math.random()*Math.PI*2;this.rotation&&(t.rotation+=e),lS(e,t.position),t.position.x+=this.x,t.position.y+=this.y}}bS.type="torus",bS.editorConfig=null;class wS{constructor(t){this.segments=[],this.countingLengths=[],this.totalLength=0,this.init(t)}init(t){if(t&&t.length)if(Array.isArray(t[0]))for(let e=0;e<t.length;++e){const n=t[e];let s=n[0];for(let t=1;t<n.length;++t){const e=n[t];this.segments.push({p1:s,p2:e,l:0}),s=e}}else{let e=t[0];for(let n=1;n<t.length;++n){const s=t[n];this.segments.push({p1:e,p2:s,l:0}),e=s}}else this.segments.push({p1:{x:0,y:0},p2:{x:0,y:0},l:0});for(let e=0;e<this.segments.length;++e){const{p1:t,p2:n}=this.segments[e],s=Math.sqrt((n.x-t.x)*(n.x-t.x)+(n.y-t.y)*(n.y-t.y));this.segments[e].l=s,this.totalLength+=s,this.countingLengths.push(this.totalLength)}}getRandPos(t){const e=Math.random()*this.totalLength;let n,s;if(1===this.segments.length)n=this.segments[0],s=e;else for(let a=0;a<this.countingLengths.length;++a)if(e<this.countingLengths[a]){n=this.segments[a],s=0===a?e:e-this.countingLengths[a-1];break}s/=n.l||1;const{p1:i,p2:r}=n;t.x=i.x+s*(r.x-i.x),t.y=i.y+s*(r.y-i.y)}}wS.type="polygonalChain",wS.editorConfig=null;class ES{constructor(t){var e;this.order=mS.Late,this.minStart=t.minStart,this.maxStart=t.maxStart,this.accel=t.accel,this.rotate=!!t.rotate,this.maxSpeed=null!==(e=t.maxSpeed)&&void 0!==e?e:0}initParticles(t){let e=t;for(;e;){const t=Math.random()*(this.maxStart-this.minStart)+this.minStart;e.config.velocity?e.config.velocity.set(t,0):e.config.velocity=new ql(t,0),lS(e.rotation,e.config.velocity),e=e.next}}updateParticle(t,e){const n=t.config.velocity,s=n.x,i=n.y;if(n.x+=this.accel.x*e,n.y+=this.accel.y*e,this.maxSpeed){const t=cS(n);t>this.maxSpeed&&uS(n,this.maxSpeed/t)}t.x+=(s+n.x)/2*e,t.y+=(i+n.y)/2*e,this.rotate&&(t.rotation=Math.atan2(n.y,n.x))}}function TS(t){return this.ease&&(t=this.ease(t)),(this.first.next.value-this.first.value)*t+this.first.value}function SS(t){this.ease&&(t=this.ease(t));const e=this.first.value,n=this.first.next.value;return hS((n.r-e.r)*t+e.r,(n.g-e.g)*t+e.g,(n.b-e.b)*t+e.b)}function AS(t){this.ease&&(t=this.ease(t));let e=this.first,n=e.next;for(;t>n.time;)e=n,n=n.next;return t=(t-e.time)/(n.time-e.time),(n.value-e.value)*t+e.value}function CS(t){this.ease&&(t=this.ease(t));let e=this.first,n=e.next;for(;t>n.time;)e=n,n=n.next;t=(t-e.time)/(n.time-e.time);const s=e.value,i=n.value;return hS((i.r-s.r)*t+s.r,(i.g-s.g)*t+s.g,(i.b-s.b)*t+s.b)}function IS(t){this.ease&&(t=this.ease(t));let e=this.first;for(;e.next&&t>e.next.time;)e=e.next;return e.value}function MS(t){this.ease&&(t=this.ease(t));let e=this.first;for(;e.next&&t>e.next.time;)e=e.next;const n=e.value;return hS(n.r,n.g,n.b)}ES.type="moveAcceleration",ES.editorConfig=null;class RS{constructor(t=!1){this.first=null,this.isColor=!!t,this.interpolate=null,this.ease=null}reset(t){this.first=t;t.next&&t.next.time>=1?this.interpolate=this.isColor?SS:TS:t.isStepped?this.interpolate=this.isColor?MS:IS:this.interpolate=this.isColor?CS:AS,this.ease=this.first.ease}}class PS{constructor(t){this.order=mS.Normal,this.list=new RS(!1),this.list.reset(rS.createList(t.alpha))}initParticles(t){let e=t;for(;e;)e.alpha=this.list.first.value,e=e.next}updateParticle(t){t.alpha=this.list.interpolate(t.agePercent)}}PS.type="alpha",PS.editorConfig=null;class kS{constructor(t){this.order=mS.Normal,this.value=t.alpha}initParticles(t){let e=t;for(;e;)e.alpha=this.value,e=e.next}}function FS(t){const e=[];for(let n=0;n<t.length;++n){let s=t[n];if("string"==typeof s)e.push(aS(s));else if(s instanceof ic)e.push(s);else{let t=s.count||1;for(s="string"==typeof s.texture?aS(s.texture):s.texture;t>0;--t)e.push(s)}}return e}kS.type="alphaStatic",kS.editorConfig=null;class OS{constructor(t){this.order=mS.Normal,this.anims=[];for(let e=0;e<t.anims.length;++e){const n=t.anims[e],s=FS(n.textures),i=n.framerate<0?-1:n.framerate>0?n.framerate:60,r={textures:s,duration:i>0?s.length/i:0,framerate:i,loop:i>0&&!!n.loop};this.anims.push(r)}}initParticles(t){let e=t;for(;e;){const t=Math.floor(Math.random()*this.anims.length),n=e.config.anim=this.anims[t];e.texture=n.textures[0],e.config.animElapsed=0,-1===n.framerate?(e.config.animDuration=e.maxLife,e.config.animFramerate=n.textures.length/e.maxLife):(e.config.animDuration=n.duration,e.config.animFramerate=n.framerate),e=e.next}}updateParticle(t,e){const n=t.config,s=n.anim;n.animElapsed+=e,n.animElapsed>=n.animDuration&&(n.anim.loop?n.animElapsed=n.animElapsed%n.animDuration:n.animElapsed=n.animDuration-1e-6);const i=n.animElapsed*n.animFramerate+1e-7|0;t.texture=s.textures[i]||s.textures[s.textures.length-1]||ic.EMPTY}}OS.type="animatedRandom",OS.editorConfig=null;class DS{constructor(t){this.order=mS.Normal;const e=t.anim,n=FS(e.textures),s=e.framerate<0?-1:e.framerate>0?e.framerate:60;this.anim={textures:n,duration:s>0?n.length/s:0,framerate:s,loop:s>0&&!!e.loop}}initParticles(t){let e=t;const n=this.anim;for(;e;)e.texture=n.textures[0],e.config.animElapsed=0,-1===n.framerate?(e.config.animDuration=e.maxLife,e.config.animFramerate=n.textures.length/e.maxLife):(e.config.animDuration=n.duration,e.config.animFramerate=n.framerate),e=e.next}updateParticle(t,e){const n=this.anim,s=t.config;s.animElapsed+=e,s.animElapsed>=s.animDuration&&(n.loop?s.animElapsed=s.animElapsed%s.animDuration:s.animElapsed=s.animDuration-1e-6);const i=s.animElapsed*s.animFramerate+1e-7|0;t.texture=n.textures[i]||n.textures[n.textures.length-1]||ic.EMPTY}}DS.type="animatedSingle",DS.editorConfig=null;class LS{constructor(t){this.order=mS.Normal,this.value=t.blendMode}initParticles(t){let e=t;for(;e;)e.blendMode=(n=this.value)?(n=n.toUpperCase().replace(/ /g,"_"),Ir[n]||Ir.NORMAL):Ir.NORMAL,e=e.next;var n}}LS.type="blendMode",LS.editorConfig=null;class NS{constructor(t){this.order=mS.Spawn,this.spacing=t.spacing*oS,this.start=t.start*oS,this.distance=t.distance}initParticles(t){let e=0,n=t;for(;n;){let t;t=this.spacing?this.start+this.spacing*e:Math.random()*Math.PI*2,n.rotation=t,this.distance&&(n.position.x=this.distance,lS(t,n.position)),n=n.next,++e}}}NS.type="spawnBurst",NS.editorConfig=null;class BS{constructor(t){this.order=mS.Normal,this.list=new RS(!0),this.list.reset(rS.createList(t.color))}initParticles(t){let e=t;const n=this.list.first.value,s=hS(n.r,n.g,n.b);for(;e;)e.tint=s,e=e.next}updateParticle(t){t.tint=this.list.interpolate(t.agePercent)}}BS.type="color",BS.editorConfig=null;class VS{constructor(t){this.order=mS.Normal;let e=t.color;"#"===e.charAt(0)?e=e.substr(1):0===e.indexOf("0x")&&(e=e.substr(2)),this.value=parseInt(e,16)}initParticles(t){let e=t;for(;e;)e.tint=this.value,e=e.next}}VS.type="colorStatic",VS.editorConfig=null;class US{constructor(t){this.order=mS.Normal,this.index=0,this.textures=t.textures.map((t=>"string"==typeof t?aS(t):t))}initParticles(t){let e=t;for(;e;)e.texture=this.textures[this.index],++this.index>=this.textures.length&&(this.index=0),e=e.next}}US.type="textureOrdered",US.editorConfig=null;const XS=new ql,YS=["E","LN2","LN10","LOG2E","LOG10E","PI","SQRT1_2","SQRT2","abs","acos","acosh","asin","asinh","atan","atanh","atan2","cbrt","ceil","cos","cosh","exp","expm1","floor","fround","hypot","log","log1p","log10","log2","max","min","pow","random","round","sign","sin","sinh","sqrt","tan","tanh"],WS=new RegExp(["[01234567890\\.\\*\\-\\+\\/\\(\\)x ,]"].concat(YS).join("|"),"g");class zS{constructor(t){var e;if(this.order=mS.Late,t.path)if("function"==typeof t.path)this.path=t.path;else try{this.path=function(t){const e=t.match(WS);for(let n=e.length-1;n>=0;--n)YS.indexOf(e[n])>=0&&(e[n]=`Math.${e[n]}`);return t=e.join(""),new Function("x",`return ${t};`)}(t.path)}catch(_m){this.path=null}else this.path=t=>t;this.list=new RS(!1),this.list.reset(rS.createList(t.speed)),this.minMult=null!==(e=t.minMult)&&void 0!==e?e:1}initParticles(t){let e=t;for(;e;){e.config.initRotation=e.rotation,e.config.initPosition?e.config.initPosition.copyFrom(e.position):e.config.initPosition=new ql(e.x,e.y),e.config.movement=0;const t=Math.random()*(1-this.minMult)+this.minMult;e.config.speedMult=t,e=e.next}}updateParticle(t,e){const n=this.list.interpolate(t.agePercent)*t.config.speedMult;t.config.movement+=n*e,XS.x=t.config.movement,XS.y=this.path(XS.x),lS(t.config.initRotation,XS),t.position.x=t.config.initPosition.x+XS.x,t.position.y=t.config.initPosition.y+XS.y}}zS.type="movePath",zS.editorConfig=null;class GS{constructor(){this.order=mS.Spawn}initParticles(t){}}GS.type="spawnPoint",GS.editorConfig=null;class HS{constructor(t){this.order=mS.Normal,this.textures=t.textures.map((t=>"string"==typeof t?aS(t):t))}initParticles(t){let e=t;for(;e;){const t=Math.floor(Math.random()*this.textures.length);e.texture=this.textures[t],e=e.next}}}HS.type="textureRandom",HS.editorConfig=null;class jS{constructor(t){this.order=mS.Normal,this.minStart=t.minStart*oS,this.maxStart=t.maxStart*oS,this.minSpeed=t.minSpeed*oS,this.maxSpeed=t.maxSpeed*oS,this.accel=t.accel*oS}initParticles(t){let e=t;for(;e;)this.minStart===this.maxStart?e.rotation+=this.maxStart:e.rotation+=Math.random()*(this.maxStart-this.minStart)+this.minStart,e.config.rotSpeed=Math.random()*(this.maxSpeed-this.minSpeed)+this.minSpeed,e=e.next}updateParticle(t,e){if(this.accel){const n=t.config.rotSpeed;t.config.rotSpeed+=this.accel*e,t.rotation+=(t.config.rotSpeed+n)/2*e}else t.rotation+=t.config.rotSpeed*e}}jS.type="rotation",jS.editorConfig=null;class $S{constructor(t){this.order=mS.Normal,this.min=t.min*oS,this.max=t.max*oS}initParticles(t){let e=t;for(;e;)this.min===this.max?e.rotation+=this.max:e.rotation+=Math.random()*(this.max-this.min)+this.min,e=e.next}}$S.type="rotationStatic",$S.editorConfig=null;class qS{constructor(t){this.order=mS.Late+1,this.rotation=(t.rotation||0)*oS}initParticles(t){let e=t;for(;e;)e.rotation=this.rotation,e=e.next}}qS.type="noRotation",qS.editorConfig=null;class KS{constructor(t){var e;this.order=mS.Normal,this.list=new RS(!1),this.list.reset(rS.createList(t.scale)),this.minMult=null!==(e=t.minMult)&&void 0!==e?e:1}initParticles(t){let e=t;for(;e;){const t=Math.random()*(1-this.minMult)+this.minMult;e.config.scaleMult=t,e.scale.x=e.scale.y=this.list.first.value*t,e=e.next}}updateParticle(t){t.scale.x=t.scale.y=this.list.interpolate(t.agePercent)*t.config.scaleMult}}KS.type="scale",KS.editorConfig=null;class ZS{constructor(t){this.order=mS.Normal,this.min=t.min,this.max=t.max}initParticles(t){let e=t;for(;e;){const t=Math.random()*(this.max-this.min)+this.min;e.scale.x=e.scale.y=t,e=e.next}}}ZS.type="scaleStatic",ZS.editorConfig=null;class QS{constructor(t){this.order=mS.Spawn;const e=QS.shapes[t.type];if(!e)throw new Error(`No shape found with type '${t.type}'`);this.shape=new e(t.data)}static registerShape(t,e){QS.shapes[e||t.type]=t}initParticles(t){let e=t;for(;e;)this.shape.getRandPos(e),e=e.next}}QS.type="spawnShape",QS.editorConfig=null,QS.shapes={},QS.registerShape(wS),QS.registerShape(_S),QS.registerShape(bS),QS.registerShape(bS,"circle");class JS{constructor(t){this.order=mS.Normal,this.texture="string"==typeof t.texture?aS(t.texture):t.texture}initParticles(t){let e=t;for(;e;)e.texture=this.texture,e=e.next}}JS.type="textureSingle",JS.editorConfig=null;class tA{constructor(t){var e;this.order=mS.Late,this.list=new RS(!1),this.list.reset(rS.createList(t.speed)),this.minMult=null!==(e=t.minMult)&&void 0!==e?e:1}initParticles(t){let e=t;for(;e;){const t=Math.random()*(1-this.minMult)+this.minMult;e.config.speedMult=t,e.config.velocity?e.config.velocity.set(this.list.first.value*t,0):e.config.velocity=new ql(this.list.first.value*t,0),lS(e.rotation,e.config.velocity),e=e.next}}updateParticle(t,e){const n=this.list.interpolate(t.agePercent)*t.config.speedMult,s=t.config.velocity;!function(t){const e=1/cS(t);t.x*=e,t.y*=e}(s),uS(s,n),t.x+=s.x*e,t.y+=s.y*e}}tA.type="moveSpeed",tA.editorConfig=null;class eA{constructor(t){this.order=mS.Late,this.min=t.min,this.max=t.max}initParticles(t){let e=t;for(;e;){const t=Math.random()*(this.max-this.min)+this.min;e.config.velocity?e.config.velocity.set(t,0):e.config.velocity=new ql(t,0),lS(e.rotation,e.config.velocity),e=e.next}}updateParticle(t,e){const n=t.config.velocity;t.x+=n.x*e,t.y+=n.y*e}}eA.type="moveSpeedStatic",eA.editorConfig=null,yS.registerBehavior(ES),yS.registerBehavior(PS),yS.registerBehavior(kS),yS.registerBehavior(OS),yS.registerBehavior(DS),yS.registerBehavior(LS),yS.registerBehavior(NS),yS.registerBehavior(BS),yS.registerBehavior(VS),yS.registerBehavior(US),yS.registerBehavior(zS),yS.registerBehavior(GS),yS.registerBehavior(HS),yS.registerBehavior(jS),yS.registerBehavior($S),yS.registerBehavior(qS),yS.registerBehavior(KS),yS.registerBehavior(ZS),yS.registerBehavior(QS),yS.registerBehavior(JS),yS.registerBehavior(tA),yS.registerBehavior(eA);var nA=Object.defineProperty,sA=(t,e,n)=>(((t,e,n)=>{e in t?nA(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n})(t,"symbol"!=typeof e?e+"":e,n),n);class iA{constructor(t){sA(this,"parent"),sA(this,"paused"),this.parent=t,this.paused=!1}destroy(){}down(t){return!1}move(t){return!1}up(t){return!1}wheel(t){return!1}update(t){}resize(){}reset(){}pause(){this.paused=!0}resume(){this.paused=!1}}var rA,aA=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},oA={exports:{}};rA=oA,function(){var t,e;e=function(t){return rA.exports=t},t={linear:function(t,e,n,s){return n*t/s+e},easeInQuad:function(t,e,n,s){return n*(t/=s)*t+e},easeOutQuad:function(t,e,n,s){return-n*(t/=s)*(t-2)+e},easeInOutQuad:function(t,e,n,s){return(t/=s/2)<1?n/2*t*t+e:-n/2*(--t*(t-2)-1)+e},easeInCubic:function(t,e,n,s){return n*(t/=s)*t*t+e},easeOutCubic:function(t,e,n,s){return n*((t=t/s-1)*t*t+1)+e},easeInOutCubic:function(t,e,n,s){return(t/=s/2)<1?n/2*t*t*t+e:n/2*((t-=2)*t*t+2)+e},easeInQuart:function(t,e,n,s){return n*(t/=s)*t*t*t+e},easeOutQuart:function(t,e,n,s){return-n*((t=t/s-1)*t*t*t-1)+e},easeInOutQuart:function(t,e,n,s){return(t/=s/2)<1?n/2*t*t*t*t+e:-n/2*((t-=2)*t*t*t-2)+e},easeInQuint:function(t,e,n,s){return n*(t/=s)*t*t*t*t+e},easeOutQuint:function(t,e,n,s){return n*((t=t/s-1)*t*t*t*t+1)+e},easeInOutQuint:function(t,e,n,s){return(t/=s/2)<1?n/2*t*t*t*t*t+e:n/2*((t-=2)*t*t*t*t+2)+e},easeInSine:function(t,e,n,s){return-n*Math.cos(t/s*(Math.PI/2))+n+e},easeOutSine:function(t,e,n,s){return n*Math.sin(t/s*(Math.PI/2))+e},easeInOutSine:function(t,e,n,s){return-n/2*(Math.cos(Math.PI*t/s)-1)+e},easeInExpo:function(t,e,n,s){return 0===t?e:n*Math.pow(2,10*(t/s-1))+e},easeOutExpo:function(t,e,n,s){return t===s?e+n:n*(1-Math.pow(2,-10*t/s))+e},easeInOutExpo:function(t,e,n,s){return(t/=s/2)<1?n/2*Math.pow(2,10*(t-1))+e:n/2*(2-Math.pow(2,-10*--t))+e},easeInCirc:function(t,e,n,s){return-n*(Math.sqrt(1-(t/=s)*t)-1)+e},easeOutCirc:function(t,e,n,s){return n*Math.sqrt(1-(t=t/s-1)*t)+e},easeInOutCirc:function(t,e,n,s){return(t/=s/2)<1?-n/2*(Math.sqrt(1-t*t)-1)+e:n/2*(Math.sqrt(1-(t-=2)*t)+1)+e},easeInElastic:function(t,e,n,s){var i,r,a;return a=1.70158,0===t||(t/=s),(r=0)||(r=.3*s),(i=n)<Math.abs(n)?(i=n,a=r/4):a=r/(2*Math.PI)*Math.asin(n/i),-i*Math.pow(2,10*(t-=1))*Math.sin((t*s-a)*(2*Math.PI)/r)+e},easeOutElastic:function(t,e,n,s){var i,r,a;return a=1.70158,0===t||(t/=s),(r=0)||(r=.3*s),(i=n)<Math.abs(n)?(i=n,a=r/4):a=r/(2*Math.PI)*Math.asin(n/i),i*Math.pow(2,-10*t)*Math.sin((t*s-a)*(2*Math.PI)/r)+n+e},easeInOutElastic:function(t,e,n,s){var i,r,a;return a=1.70158,0===t||(t/=s/2),(r=0)||(r=s*(.3*1.5)),(i=n)<Math.abs(n)?(i=n,a=r/4):a=r/(2*Math.PI)*Math.asin(n/i),t<1?i*Math.pow(2,10*(t-=1))*Math.sin((t*s-a)*(2*Math.PI)/r)*-.5+e:i*Math.pow(2,-10*(t-=1))*Math.sin((t*s-a)*(2*Math.PI)/r)*.5+n+e},easeInBack:function(t,e,n,s,i){return void 0===i&&(i=1.70158),n*(t/=s)*t*((i+1)*t-i)+e},easeOutBack:function(t,e,n,s,i){return void 0===i&&(i=1.70158),n*((t=t/s-1)*t*((i+1)*t+i)+1)+e},easeInOutBack:function(t,e,n,s,i){return void 0===i&&(i=1.70158),(t/=s/2)<1?n/2*(t*t*((1+(i*=1.525))*t-i))+e:n/2*((t-=2)*t*((1+(i*=1.525))*t+i)+2)+e},easeInBounce:function(e,n,s,i){return s-t.easeOutBounce(i-e,0,s,i)+n},easeOutBounce:function(t,e,n,s){return(t/=s)<1/2.75?n*(7.5625*t*t)+e:t<2/2.75?n*(7.5625*(t-=1.5/2.75)*t+.75)+e:t<2.5/2.75?n*(7.5625*(t-=2.25/2.75)*t+.9375)+e:n*(7.5625*(t-=2.625/2.75)*t+.984375)+e},easeInOutBounce:function(e,n,s,i){return e<i/2?.5*t.easeInBounce(2*e,0,s,i)+n:.5*t.easeOutBounce(2*e-i,0,s,i)+.5*s+n}},e(t)}.call(aA);const lA=oA.exports;function hA(t,e){return t?"function"==typeof t?t:"string"==typeof t?lA[t]:void 0:lA[e]}const cA={removeOnInterrupt:!1,ease:"linear",time:1e3};class uA extends iA{constructor(t,e={}){super(t),sA(this,"options"),sA(this,"startX"),sA(this,"startY"),sA(this,"deltaX"),sA(this,"deltaY"),sA(this,"keepCenter"),sA(this,"startWidth",null),sA(this,"startHeight",null),sA(this,"deltaWidth",null),sA(this,"deltaHeight",null),sA(this,"width",null),sA(this,"height",null),sA(this,"time",0),this.options=Object.assign({},cA,e),this.options.ease=hA(this.options.ease),this.setupPosition(),this.setupZoom(),this.time=0}setupPosition(){typeof this.options.position<"u"?(this.startX=this.parent.center.x,this.startY=this.parent.center.y,this.deltaX=this.options.position.x-this.parent.center.x,this.deltaY=this.options.position.y-this.parent.center.y,this.keepCenter=!1):this.keepCenter=!0}setupZoom(){this.width=null,this.height=null,typeof this.options.scale<"u"?this.width=this.parent.screenWidth/this.options.scale:typeof this.options.scaleX<"u"||typeof this.options.scaleY<"u"?(typeof this.options.scaleX<"u"&&(this.width=this.parent.screenWidth/this.options.scaleX),typeof this.options.scaleY<"u"&&(this.height=this.parent.screenHeight/this.options.scaleY)):(typeof this.options.width<"u"&&(this.width=this.options.width),typeof this.options.height<"u"&&(this.height=this.options.height)),null!==this.width&&(this.startWidth=this.parent.screenWidthInWorldPixels,this.deltaWidth=this.width-this.startWidth),null!==this.height&&(this.startHeight=this.parent.screenHeightInWorldPixels,this.deltaHeight=this.height-this.startHeight)}down(){return this.options.removeOnInterrupt&&this.parent.plugins.remove("animate"),!1}complete(){this.parent.plugins.remove("animate"),null!==this.width&&this.parent.fitWidth(this.width,this.keepCenter,null===this.height),null!==this.height&&this.parent.fitHeight(this.height,this.keepCenter,null===this.width),!this.keepCenter&&this.options.position&&this.parent.moveCenter(this.options.position),this.parent.emit("animate-end",this.parent),this.options.callbackOnComplete&&this.options.callbackOnComplete(this.parent)}update(t){if(this.paused)return;this.time+=t;const e=new ql(this.parent.scale.x,this.parent.scale.y);if(this.time>=this.options.time){const t=this.parent.width,n=this.parent.height;this.complete(),(t!==this.parent.width||n!==this.parent.height)&&this.parent.emit("zoomed",{viewport:this.parent,original:e,type:"animate"})}else{const t=this.options.ease(this.time,0,1,this.options.time);if(null!==this.width){const e=this.startWidth,n=this.deltaWidth;this.parent.fitWidth(e+n*t,this.keepCenter,null===this.height)}if(null!==this.height){const e=this.startHeight,n=this.deltaHeight;this.parent.fitHeight(e+n*t,this.keepCenter,null===this.width)}if(null===this.width?this.parent.scale.x=this.parent.scale.y:null===this.height&&(this.parent.scale.y=this.parent.scale.x),!this.keepCenter){const e=this.startX,n=this.startY,s=this.deltaX,i=this.deltaY,r=new ql(this.parent.x,this.parent.y);this.parent.moveCenter(e+s*t,n+i*t),this.parent.emit("moved",{viewport:this.parent,original:r,type:"animate"})}(this.width||this.height)&&this.parent.emit("zoomed",{viewport:this.parent,original:e,type:"animate"})}}}const dA={sides:"all",friction:.5,time:150,ease:"easeInOutSine",underflow:"center",bounceBox:null};class fA extends iA{constructor(t,e={}){super(t),sA(this,"options"),sA(this,"left"),sA(this,"top"),sA(this,"right"),sA(this,"bottom"),sA(this,"underflowX"),sA(this,"underflowY"),sA(this,"ease"),sA(this,"toX"),sA(this,"toY"),this.options=Object.assign({},dA,e),this.ease=hA(this.options.ease,"easeInOutSine"),this.options.sides?"all"===this.options.sides?this.top=this.bottom=this.left=this.right=!0:"horizontal"===this.options.sides?(this.right=this.left=!0,this.top=this.bottom=!1):"vertical"===this.options.sides?(this.left=this.right=!1,this.top=this.bottom=!0):(this.top=-1!==this.options.sides.indexOf("top"),this.bottom=-1!==this.options.sides.indexOf("bottom"),this.left=-1!==this.options.sides.indexOf("left"),this.right=-1!==this.options.sides.indexOf("right")):this.left=this.top=this.right=this.bottom=!1;const n=this.options.underflow.toLowerCase();"center"===n?(this.underflowX=0,this.underflowY=0):(this.underflowX=-1!==n.indexOf("left")?-1:-1!==n.indexOf("right")?1:0,this.underflowY=-1!==n.indexOf("top")?-1:-1!==n.indexOf("bottom")?1:0),this.reset()}isActive(){return null!==this.toX||null!==this.toY}down(){return this.toX=this.toY=null,!1}up(){return this.bounce(),!1}update(t){if(!this.paused){if(this.bounce(),this.toX){const e=this.toX;e.time+=t,this.parent.emit("moved",{viewport:this.parent,type:"bounce-x"}),e.time>=this.options.time?(this.parent.x=e.end,this.toX=null,this.parent.emit("bounce-x-end",this.parent)):this.parent.x=this.ease(e.time,e.start,e.delta,this.options.time)}if(this.toY){const e=this.toY;e.time+=t,this.parent.emit("moved",{viewport:this.parent,type:"bounce-y"}),e.time>=this.options.time?(this.parent.y=e.end,this.toY=null,this.parent.emit("bounce-y-end",this.parent)):this.parent.y=this.ease(e.time,e.start,e.delta,this.options.time)}}}calcUnderflowX(){let t;switch(this.underflowX){case-1:t=0;break;case 1:t=this.parent.screenWidth-this.parent.screenWorldWidth;break;default:t=(this.parent.screenWidth-this.parent.screenWorldWidth)/2}return t}calcUnderflowY(){let t;switch(this.underflowY){case-1:t=0;break;case 1:t=this.parent.screenHeight-this.parent.screenWorldHeight;break;default:t=(this.parent.screenHeight-this.parent.screenWorldHeight)/2}return t}oob(){const t=this.options.bounceBox;if(t){const e=typeof t.x>"u"?0:t.x,n=typeof t.y>"u"?0:t.y,s=typeof t.width>"u"?this.parent.worldWidth:t.width,i=typeof t.height>"u"?this.parent.worldHeight:t.height;return{left:this.parent.left<e,right:this.parent.right>s,top:this.parent.top<n,bottom:this.parent.bottom>i,topLeft:new ql(e*this.parent.scale.x,n*this.parent.scale.y),bottomRight:new ql(s*this.parent.scale.x-this.parent.screenWidth,i*this.parent.scale.y-this.parent.screenHeight)}}return{left:this.parent.left<0,right:this.parent.right>this.parent.worldWidth,top:this.parent.top<0,bottom:this.parent.bottom>this.parent.worldHeight,topLeft:new ql(0,0),bottomRight:new ql(this.parent.worldWidth*this.parent.scale.x-this.parent.screenWidth,this.parent.worldHeight*this.parent.scale.y-this.parent.screenHeight)}}bounce(){var t,e;if(this.paused)return;let n,s=this.parent.plugins.get("decelerate",!0);s&&(s.x||s.y)&&(s.x&&s.percentChangeX===(null==(t=s.options)?void 0:t.friction)||s.y&&s.percentChangeY===(null==(e=s.options)?void 0:e.friction))&&(n=this.oob(),(n.left&&this.left||n.right&&this.right)&&(s.percentChangeX=this.options.friction),(n.top&&this.top||n.bottom&&this.bottom)&&(s.percentChangeY=this.options.friction));const i=this.parent.plugins.get("drag",!0)||{},r=this.parent.plugins.get("pinch",!0)||{};if(s=s||{},!(null!=i&&i.active||null!=r&&r.active||this.toX&&this.toY||s.x&&s.y)){n=n||this.oob();const t=n.topLeft,e=n.bottomRight;if(!this.toX&&!s.x){let s=null;n.left&&this.left?s=this.parent.screenWorldWidth<this.parent.screenWidth?this.calcUnderflowX():-t.x:n.right&&this.right&&(s=this.parent.screenWorldWidth<this.parent.screenWidth?this.calcUnderflowX():-e.x),null!==s&&this.parent.x!==s&&(this.toX={time:0,start:this.parent.x,delta:s-this.parent.x,end:s},this.parent.emit("bounce-x-start",this.parent))}if(!this.toY&&!s.y){let s=null;n.top&&this.top?s=this.parent.screenWorldHeight<this.parent.screenHeight?this.calcUnderflowY():-t.y:n.bottom&&this.bottom&&(s=this.parent.screenWorldHeight<this.parent.screenHeight?this.calcUnderflowY():-e.y),null!==s&&this.parent.y!==s&&(this.toY={time:0,start:this.parent.y,delta:s-this.parent.y,end:s},this.parent.emit("bounce-y-start",this.parent))}}}reset(){this.toX=this.toY=null,this.bounce()}}const pA={left:!1,right:!1,top:!1,bottom:!1,direction:null,underflow:"center"};class mA extends iA{constructor(t,e={}){super(t),sA(this,"options"),sA(this,"last"),sA(this,"noUnderflow"),sA(this,"underflowX"),sA(this,"underflowY"),this.options=Object.assign({},pA,e),this.options.direction&&(this.options.left="x"===this.options.direction||"all"===this.options.direction||null,this.options.right="x"===this.options.direction||"all"===this.options.direction||null,this.options.top="y"===this.options.direction||"all"===this.options.direction||null,this.options.bottom="y"===this.options.direction||"all"===this.options.direction||null),this.parseUnderflow(),this.last={x:null,y:null,scaleX:null,scaleY:null},this.update()}parseUnderflow(){const t=this.options.underflow.toLowerCase();"none"===t?this.noUnderflow=!0:"center"===t?(this.underflowX=this.underflowY=0,this.noUnderflow=!1):(this.underflowX=-1!==t.indexOf("left")?-1:-1!==t.indexOf("right")?1:0,this.underflowY=-1!==t.indexOf("top")?-1:-1!==t.indexOf("bottom")?1:0,this.noUnderflow=!1)}move(){return this.update(),!1}update(){if(this.paused||this.parent.x===this.last.x&&this.parent.y===this.last.y&&this.parent.scale.x===this.last.scaleX&&this.parent.scale.y===this.last.scaleY)return;const t=new ql(this.parent.x,this.parent.y),e=this.parent.plugins.decelerate||{};if(null!==this.options.left||null!==this.options.right){let n=!1;if(!this.noUnderflow&&this.parent.screenWorldWidth<this.parent.screenWidth)switch(this.underflowX){case-1:0!==this.parent.x&&(this.parent.x=0,n=!0);break;case 1:this.parent.x!==this.parent.screenWidth-this.parent.screenWorldWidth&&(this.parent.x=this.parent.screenWidth-this.parent.screenWorldWidth,n=!0);break;default:this.parent.x!==(this.parent.screenWidth-this.parent.screenWorldWidth)/2&&(this.parent.x=(this.parent.screenWidth-this.parent.screenWorldWidth)/2,n=!0)}else null!==this.options.left&&this.parent.left<(!0===this.options.left?0:this.options.left)&&(this.parent.x=-(!0===this.options.left?0:this.options.left)*this.parent.scale.x,e.x=0,n=!0),null!==this.options.right&&this.parent.right>(!0===this.options.right?this.parent.worldWidth:this.options.right)&&(this.parent.x=-(!0===this.options.right?this.parent.worldWidth:this.options.right)*this.parent.scale.x+this.parent.screenWidth,e.x=0,n=!0);n&&this.parent.emit("moved",{viewport:this.parent,original:t,type:"clamp-x"})}if(null!==this.options.top||null!==this.options.bottom){let n=!1;if(!this.noUnderflow&&this.parent.screenWorldHeight<this.parent.screenHeight)switch(this.underflowY){case-1:0!==this.parent.y&&(this.parent.y=0,n=!0);break;case 1:this.parent.y!==this.parent.screenHeight-this.parent.screenWorldHeight&&(this.parent.y=this.parent.screenHeight-this.parent.screenWorldHeight,n=!0);break;default:this.parent.y!==(this.parent.screenHeight-this.parent.screenWorldHeight)/2&&(this.parent.y=(this.parent.screenHeight-this.parent.screenWorldHeight)/2,n=!0)}else null!==this.options.top&&this.parent.top<(!0===this.options.top?0:this.options.top)&&(this.parent.y=-(!0===this.options.top?0:this.options.top)*this.parent.scale.y,e.y=0,n=!0),null!==this.options.bottom&&this.parent.bottom>(!0===this.options.bottom?this.parent.worldHeight:this.options.bottom)&&(this.parent.y=-(!0===this.options.bottom?this.parent.worldHeight:this.options.bottom)*this.parent.scale.y+this.parent.screenHeight,e.y=0,n=!0);n&&this.parent.emit("moved",{viewport:this.parent,original:t,type:"clamp-y"})}this.last.x=this.parent.x,this.last.y=this.parent.y,this.last.scaleX=this.parent.scale.x,this.last.scaleY=this.parent.scale.y}reset(){this.update()}}const gA={minWidth:null,minHeight:null,maxWidth:null,maxHeight:null,minScale:null,maxScale:null};class vA extends iA{constructor(t,e={}){super(t),sA(this,"options"),this.options=Object.assign({},gA,e),this.clamp()}resize(){this.clamp()}clamp(){if(!this.paused)if(this.options.minWidth||this.options.minHeight||this.options.maxWidth||this.options.maxHeight){let t=this.parent.worldScreenWidth,e=this.parent.worldScreenHeight;if(null!==this.options.minWidth&&t<this.options.minWidth){const n=this.parent.scale.x;this.parent.fitWidth(this.options.minWidth,!1,!1,!0),this.parent.scale.y*=this.parent.scale.x/n,t=this.parent.worldScreenWidth,e=this.parent.worldScreenHeight,this.parent.emit("zoomed",{viewport:this.parent,type:"clamp-zoom"})}if(null!==this.options.maxWidth&&t>this.options.maxWidth){const n=this.parent.scale.x;this.parent.fitWidth(this.options.maxWidth,!1,!1,!0),this.parent.scale.y*=this.parent.scale.x/n,t=this.parent.worldScreenWidth,e=this.parent.worldScreenHeight,this.parent.emit("zoomed",{viewport:this.parent,type:"clamp-zoom"})}if(null!==this.options.minHeight&&e<this.options.minHeight){const n=this.parent.scale.y;this.parent.fitHeight(this.options.minHeight,!1,!1,!0),this.parent.scale.x*=this.parent.scale.y/n,t=this.parent.worldScreenWidth,e=this.parent.worldScreenHeight,this.parent.emit("zoomed",{viewport:this.parent,type:"clamp-zoom"})}if(null!==this.options.maxHeight&&e>this.options.maxHeight){const t=this.parent.scale.y;this.parent.fitHeight(this.options.maxHeight,!1,!1,!0),this.parent.scale.x*=this.parent.scale.y/t,this.parent.emit("zoomed",{viewport:this.parent,type:"clamp-zoom"})}}else if(this.options.minScale||this.options.maxScale){const t={x:null,y:null},e={x:null,y:null};if("number"==typeof this.options.minScale)t.x=this.options.minScale,t.y=this.options.minScale;else if(null!==this.options.minScale){const e=this.options.minScale;t.x=typeof e.x>"u"?null:e.x,t.y=typeof e.y>"u"?null:e.y}if("number"==typeof this.options.maxScale)e.x=this.options.maxScale,e.y=this.options.maxScale;else if(null!==this.options.maxScale){const t=this.options.maxScale;e.x=typeof t.x>"u"?null:t.x,e.y=typeof t.y>"u"?null:t.y}let n=this.parent.scale.x,s=this.parent.scale.y;null!==t.x&&n<t.x&&(n=t.x),null!==e.x&&n>e.x&&(n=e.x),null!==t.y&&s<t.y&&(s=t.y),null!==e.y&&s>e.y&&(s=e.y),(n!==this.parent.scale.x||s!==this.parent.scale.y)&&(this.parent.scale.set(n,s),this.parent.emit("zoomed",{viewport:this.parent,type:"clamp-zoom"}))}}reset(){this.clamp()}}const xA={friction:.98,bounce:.8,minSpeed:.01},yA=16;class _A extends iA{constructor(t,e={}){super(t),sA(this,"options"),sA(this,"x"),sA(this,"y"),sA(this,"percentChangeX"),sA(this,"percentChangeY"),sA(this,"saved"),sA(this,"timeSinceRelease"),this.options=Object.assign({},xA,e),this.saved=[],this.timeSinceRelease=0,this.reset(),this.parent.on("moved",(t=>this.handleMoved(t)))}down(){return this.saved=[],this.x=this.y=null,!1}isActive(){return!(!this.x&&!this.y)}move(){if(this.paused)return!1;const t=this.parent.input.count();return(1===t||t>1&&!this.parent.plugins.get("pinch",!0))&&(this.saved.push({x:this.parent.x,y:this.parent.y,time:performance.now()}),this.saved.length>60&&this.saved.splice(0,30)),!1}handleMoved(t){if(this.saved.length){const e=this.saved[this.saved.length-1];"clamp-x"===t.type&&t.original?e.x===t.original.x&&(e.x=this.parent.x):"clamp-y"===t.type&&t.original&&e.y===t.original.y&&(e.y=this.parent.y)}}up(){if(0===this.parent.input.count()&&this.saved.length){const t=performance.now();for(const e of this.saved)if(e.time>=t-100){const n=t-e.time;this.x=(this.parent.x-e.x)/n,this.y=(this.parent.y-e.y)/n,this.percentChangeX=this.percentChangeY=this.options.friction,this.timeSinceRelease=0;break}}return!1}activate(t){typeof(t=t||{}).x<"u"&&(this.x=t.x,this.percentChangeX=this.options.friction),typeof t.y<"u"&&(this.y=t.y,this.percentChangeY=this.options.friction)}update(t){if(this.paused)return;const e=this.x||this.y,n=this.timeSinceRelease,s=this.timeSinceRelease+t;if(this.x){const e=this.percentChangeX,i=Math.log(e);this.parent.x+=this.x*yA/i*(Math.pow(e,s/yA)-Math.pow(e,n/yA)),this.x*=Math.pow(this.percentChangeX,t/yA)}if(this.y){const e=this.percentChangeY,i=Math.log(e);this.parent.y+=this.y*yA/i*(Math.pow(e,s/yA)-Math.pow(e,n/yA)),this.y*=Math.pow(this.percentChangeY,t/yA)}this.timeSinceRelease+=t,this.x&&this.y?Math.abs(this.x)<this.options.minSpeed&&Math.abs(this.y)<this.options.minSpeed&&(this.x=0,this.y=0):(Math.abs(this.x||0)<this.options.minSpeed&&(this.x=0),Math.abs(this.y||0)<this.options.minSpeed&&(this.y=0)),e&&this.parent.emit("moved",{viewport:this.parent,type:"decelerate"})}reset(){this.x=this.y=null}}const bA={direction:"all",pressDrag:!0,wheel:!0,wheelScroll:1,reverse:!1,clampWheel:!1,underflow:"center",factor:1,mouseButtons:"all",keyToPress:null,ignoreKeyToPressOnTouch:!1,lineHeight:20,wheelSwapAxes:!1};class wA extends iA{constructor(t,e={}){super(t),sA(this,"options"),sA(this,"moved"),sA(this,"reverse"),sA(this,"xDirection"),sA(this,"yDirection"),sA(this,"keyIsPressed"),sA(this,"mouse"),sA(this,"underflowX"),sA(this,"underflowY"),sA(this,"last"),sA(this,"current"),sA(this,"windowEventHandlers",[]),this.options=Object.assign({},bA,e),this.moved=!1,this.reverse=this.options.reverse?1:-1,this.xDirection=!this.options.direction||"all"===this.options.direction||"x"===this.options.direction,this.yDirection=!this.options.direction||"all"===this.options.direction||"y"===this.options.direction,this.keyIsPressed=!1,this.parseUnderflow(),this.mouseButtons(this.options.mouseButtons),this.options.keyToPress&&this.handleKeyPresses(this.options.keyToPress)}handleKeyPresses(t){this.addWindowEventHandler("keyup",(e=>{t.includes(e.code)&&(this.keyIsPressed=!1)})),this.addWindowEventHandler("keydown",(e=>{t.includes(e.code)&&(this.keyIsPressed=!0)}))}addWindowEventHandler(t,e){window.addEventListener(t,e),this.windowEventHandlers.push({event:t,handler:e})}destroy(){this.windowEventHandlers.forEach((({event:t,handler:e})=>{window.removeEventListener(t,e)}))}mouseButtons(t){this.mouse=t&&"all"!==t?[-1!==t.indexOf("left"),-1!==t.indexOf("middle"),-1!==t.indexOf("right")]:[!0,!0,!0]}parseUnderflow(){const t=this.options.underflow.toLowerCase();"center"===t?(this.underflowX=0,this.underflowY=0):(t.includes("left")?this.underflowX=-1:t.includes("right")?this.underflowX=1:this.underflowX=0,t.includes("top")?this.underflowY=-1:t.includes("bottom")?this.underflowY=1:this.underflowY=0)}checkButtons(t){const e="mouse"===t.pointerType,n=this.parent.input.count();return!(!(1===n||n>1&&!this.parent.plugins.get("pinch",!0))||e&&!this.mouse[t.button])}checkKeyPress(t){return!this.options.keyToPress||this.keyIsPressed||this.options.ignoreKeyToPressOnTouch&&"touch"===t.data.pointerType}down(t){return!(this.paused||!this.options.pressDrag)&&(this.checkButtons(t)&&this.checkKeyPress(t)?(this.last={x:t.global.x,y:t.global.y},this.current=t.pointerId,!0):(this.last=null,!1))}get active(){return this.moved}move(t){if(this.paused||!this.options.pressDrag)return!1;if(this.last&&this.current===t.data.pointerId){const e=t.global.x,n=t.global.y,s=this.parent.input.count();if(1===s||s>1&&!this.parent.plugins.get("pinch",!0)){const s=e-this.last.x,i=n-this.last.y;if(this.moved||this.xDirection&&this.parent.input.checkThreshold(s)||this.yDirection&&this.parent.input.checkThreshold(i)){const s={x:e,y:n};return this.xDirection&&(this.parent.x+=(s.x-this.last.x)*this.options.factor),this.yDirection&&(this.parent.y+=(s.y-this.last.y)*this.options.factor),this.last=s,this.moved||this.parent.emit("drag-start",{event:t,screen:new ql(this.last.x,this.last.y),world:this.parent.toWorld(new ql(this.last.x,this.last.y)),viewport:this.parent}),this.moved=!0,this.parent.emit("moved",{viewport:this.parent,type:"drag"}),!0}}else this.moved=!1}return!1}up(t){if(this.paused)return!1;const e=this.parent.input.touches;if(1===e.length){const t=e[0];return t.last&&(this.last={x:t.last.x,y:t.last.y},this.current=t.id),this.moved=!1,!0}if(this.last&&this.moved){const e=new ql(this.last.x,this.last.y);return this.parent.emit("drag-end",{event:t,screen:e,world:this.parent.toWorld(e),viewport:this.parent}),this.last=null,this.moved=!1,!0}return!1}wheel(t){if(this.paused)return!1;if(this.options.wheel){const e=this.parent.plugins.get("wheel",!0);if(!e||!e.options.wheelZoom&&!t.ctrlKey){const e=t.deltaMode?this.options.lineHeight:1,n=[t.deltaX,t.deltaY],[s,i]=this.options.wheelSwapAxes?n.reverse():n;return this.xDirection&&(this.parent.x+=s*e*this.options.wheelScroll*this.reverse),this.yDirection&&(this.parent.y+=i*e*this.options.wheelScroll*this.reverse),this.options.clampWheel&&this.clamp(),this.parent.emit("wheel-scroll",this.parent),this.parent.emit("moved",{viewport:this.parent,type:"wheel"}),this.parent.options.passiveWheel||t.preventDefault(),this.parent.options.stopPropagation&&t.stopPropagation(),!0}}return!1}resume(){this.last=null,this.paused=!1}clamp(){const t=this.parent.plugins.get("decelerate",!0)||{};if("y"!==this.options.clampWheel)if(this.parent.screenWorldWidth<this.parent.screenWidth)switch(this.underflowX){case-1:this.parent.x=0;break;case 1:this.parent.x=this.parent.screenWidth-this.parent.screenWorldWidth;break;default:this.parent.x=(this.parent.screenWidth-this.parent.screenWorldWidth)/2}else this.parent.left<0?(this.parent.x=0,t.x=0):this.parent.right>this.parent.worldWidth&&(this.parent.x=-this.parent.worldWidth*this.parent.scale.x+this.parent.screenWidth,t.x=0);if("x"!==this.options.clampWheel)if(this.parent.screenWorldHeight<this.parent.screenHeight)switch(this.underflowY){case-1:this.parent.y=0;break;case 1:this.parent.y=this.parent.screenHeight-this.parent.screenWorldHeight;break;default:this.parent.y=(this.parent.screenHeight-this.parent.screenWorldHeight)/2}else this.parent.top<0&&(this.parent.y=0,t.y=0),this.parent.bottom>this.parent.worldHeight&&(this.parent.y=-this.parent.worldHeight*this.parent.scale.y+this.parent.screenHeight,t.y=0)}}const EA={speed:0,acceleration:null,radius:null};class TA extends iA{constructor(t,e,n={}){super(t),sA(this,"options"),sA(this,"target"),sA(this,"velocity"),this.target=e,this.options=Object.assign({},EA,n),this.velocity={x:0,y:0}}update(t){if(this.paused)return;const e=this.parent.center;let n=this.target.x,s=this.target.y;if(this.options.radius){if(!(Math.sqrt(Math.pow(this.target.y-e.y,2)+Math.pow(this.target.x-e.x,2))>this.options.radius))return;{const t=Math.atan2(this.target.y-e.y,this.target.x-e.x);n=this.target.x-Math.cos(t)*this.options.radius,s=this.target.y-Math.sin(t)*this.options.radius}}const i=n-e.x,r=s-e.y;if(i||r)if(this.options.speed)if(this.options.acceleration){const t=Math.atan2(s-e.y,n-e.x),a=Math.sqrt(Math.pow(i,2)+Math.pow(r,2));if(a){const o=(Math.pow(this.velocity.x,2)+Math.pow(this.velocity.y,2))/(2*this.options.acceleration);this.velocity=a>o?{x:Math.min(this.velocity.x+(this.options.acceleration,this.options.speed)),y:Math.min(this.velocity.y+(this.options.acceleration,this.options.speed))}:{x:Math.max(this.velocity.x-this.options.acceleration*this.options.speed,0),y:Math.max(this.velocity.y-this.options.acceleration*this.options.speed,0)};const l=Math.cos(t)*this.velocity.x,h=Math.sin(t)*this.velocity.y,c=Math.abs(l)>Math.abs(i)?n:e.x+l,u=Math.abs(h)>Math.abs(r)?s:e.y+h;this.parent.moveCenter(c,u),this.parent.emit("moved",{viewport:this.parent,type:"follow"})}}else{const t=Math.atan2(s-e.y,n-e.x),a=Math.cos(t)*this.options.speed,o=Math.sin(t)*this.options.speed,l=Math.abs(a)>Math.abs(i)?n:e.x+a,h=Math.abs(o)>Math.abs(r)?s:e.y+o;this.parent.moveCenter(l,h),this.parent.emit("moved",{viewport:this.parent,type:"follow"})}else this.parent.moveCenter(n,s),this.parent.emit("moved",{viewport:this.parent,type:"follow"})}}const SA={radius:null,distance:null,top:null,bottom:null,left:null,right:null,speed:8,reverse:!1,noDecelerate:!1,linear:!1,allowButtons:!1};class AA extends iA{constructor(t,e={}){super(t),sA(this,"options"),sA(this,"reverse"),sA(this,"radiusSquared"),sA(this,"left"),sA(this,"top"),sA(this,"right"),sA(this,"bottom"),sA(this,"horizontal"),sA(this,"vertical"),this.options=Object.assign({},SA,e),this.reverse=this.options.reverse?1:-1,this.radiusSquared="number"==typeof this.options.radius?Math.pow(this.options.radius,2):null,this.resize()}resize(){const t=this.options.distance;null!==t?(this.left=t,this.top=t,this.right=this.parent.screenWidth-t,this.bottom=this.parent.screenHeight-t):this.options.radius||(this.left=this.options.left,this.top=this.options.top,this.right=null===this.options.right?null:this.parent.screenWidth-this.options.right,this.bottom=null===this.options.bottom?null:this.parent.screenHeight-this.options.bottom)}down(){return this.paused||this.options.allowButtons||(this.horizontal=this.vertical=null),!1}move(t){if(this.paused||"mouse"!==t.pointerType&&1!==t.pointerId||!this.options.allowButtons&&0!==t.buttons)return!1;const e=t.global.x,n=t.global.y;if(this.radiusSquared){const t=this.parent.toScreen(this.parent.center);if(Math.pow(t.x-e,2)+Math.pow(t.y-n,2)>=this.radiusSquared){const s=Math.atan2(t.y-n,t.x-e);this.options.linear?(this.horizontal=Math.round(Math.cos(s))*this.options.speed*this.reverse*.06,this.vertical=Math.round(Math.sin(s))*this.options.speed*this.reverse*.06):(this.horizontal=Math.cos(s)*this.options.speed*this.reverse*.06,this.vertical=Math.sin(s)*this.options.speed*this.reverse*.06)}else this.horizontal&&this.decelerateHorizontal(),this.vertical&&this.decelerateVertical(),this.horizontal=this.vertical=0}else null!==this.left&&e<this.left?this.horizontal=Number(this.reverse)*this.options.speed*.06:null!==this.right&&e>this.right?this.horizontal=-1*this.reverse*this.options.speed*.06:(this.decelerateHorizontal(),this.horizontal=0),null!==this.top&&n<this.top?this.vertical=Number(this.reverse)*this.options.speed*.06:null!==this.bottom&&n>this.bottom?this.vertical=-1*this.reverse*this.options.speed*.06:(this.decelerateVertical(),this.vertical=0);return!1}decelerateHorizontal(){const t=this.parent.plugins.get("decelerate",!0);this.horizontal&&t&&!this.options.noDecelerate&&t.activate({x:this.horizontal*this.options.speed*this.reverse/(1e3/60)})}decelerateVertical(){const t=this.parent.plugins.get("decelerate",!0);this.vertical&&t&&!this.options.noDecelerate&&t.activate({y:this.vertical*this.options.speed*this.reverse/(1e3/60)})}up(){return this.paused||(this.horizontal&&this.decelerateHorizontal(),this.vertical&&this.decelerateVertical(),this.horizontal=this.vertical=null),!1}update(){if(!this.paused&&(this.horizontal||this.vertical)){const t=this.parent.center;this.horizontal&&(t.x+=this.horizontal*this.options.speed),this.vertical&&(t.y+=this.vertical*this.options.speed),this.parent.moveCenter(t),this.parent.emit("moved",{viewport:this.parent,type:"mouse-edges"})}}}const CA={noDrag:!1,percent:1,center:null,factor:1,axis:"all"};class IA extends iA{constructor(t,e={}){super(t),sA(this,"options"),sA(this,"active",!1),sA(this,"pinching",!1),sA(this,"moved",!1),sA(this,"lastCenter"),this.options=Object.assign({},CA,e)}down(){return this.parent.input.count()>=2&&(this.active=!0,!0)}isAxisX(){return["all","x"].includes(this.options.axis)}isAxisY(){return["all","y"].includes(this.options.axis)}move(t){if(this.paused||!this.active)return!1;const e=t.global.x,n=t.global.y,s=this.parent.input.touches;if(s.length>=2){const i=s[0],r=s[1],a=i.last&&r.last?Math.sqrt(Math.pow(r.last.x-i.last.x,2)+Math.pow(r.last.y-i.last.y,2)):null;if(i.id===t.pointerId?i.last={x:e,y:n,data:t}:r.id===t.pointerId&&(r.last={x:e,y:n,data:t}),a){let t;const e=new ql(i.last.x+(r.last.x-i.last.x)/2,i.last.y+(r.last.y-i.last.y)/2);this.options.center||(t=this.parent.toLocal(e));let n=Math.sqrt(Math.pow(r.last.x-i.last.x,2)+Math.pow(r.last.y-i.last.y,2));n=0===n?n=1e-10:n;const s=(1-a/n)*this.options.percent*(this.isAxisX()?this.parent.scale.x:this.parent.scale.y);this.isAxisX()&&(this.parent.scale.x+=s),this.isAxisY()&&(this.parent.scale.y+=s),this.parent.emit("zoomed",{viewport:this.parent,type:"pinch",center:e});const o=this.parent.plugins.get("clamp-zoom",!0);if(o&&o.clamp(),this.options.center)this.parent.moveCenter(this.options.center);else{const n=this.parent.toGlobal(t);this.parent.x+=(e.x-n.x)*this.options.factor,this.parent.y+=(e.y-n.y)*this.options.factor,this.parent.emit("moved",{viewport:this.parent,type:"pinch"})}!this.options.noDrag&&this.lastCenter&&(this.parent.x+=(e.x-this.lastCenter.x)*this.options.factor,this.parent.y+=(e.y-this.lastCenter.y)*this.options.factor,this.parent.emit("moved",{viewport:this.parent,type:"pinch"})),this.lastCenter=e,this.moved=!0}else this.pinching||(this.parent.emit("pinch-start",this.parent),this.pinching=!0);return!0}return!1}up(){return!!(this.pinching&&this.parent.input.touches.length<=1)&&(this.active=!1,this.lastCenter=null,this.pinching=!1,this.moved=!1,this.parent.emit("pinch-end",this.parent),!0)}}const MA={topLeft:!1,friction:.8,time:1e3,ease:"easeInOutSine",interrupt:!0,removeOnComplete:!1,removeOnInterrupt:!1,forceStart:!1};class RA extends iA{constructor(t,e,n,s={}){super(t),sA(this,"options"),sA(this,"ease"),sA(this,"x"),sA(this,"y"),sA(this,"percent"),sA(this,"snapping"),sA(this,"deltaX"),sA(this,"deltaY"),sA(this,"startX"),sA(this,"startY"),this.options=Object.assign({},MA,s),this.ease=hA(s.ease,"easeInOutSine"),this.x=e,this.y=n,this.options.forceStart&&this.snapStart()}snapStart(){this.percent=0,this.snapping={time:0};const t=this.options.topLeft?this.parent.corner:this.parent.center;this.deltaX=this.x-t.x,this.deltaY=this.y-t.y,this.startX=t.x,this.startY=t.y,this.parent.emit("snap-start",this.parent)}wheel(){return this.options.removeOnInterrupt&&this.parent.plugins.remove("snap"),!1}down(){return this.options.removeOnInterrupt?this.parent.plugins.remove("snap"):this.options.interrupt&&(this.snapping=null),!1}up(){if(0===this.parent.input.count()){const t=this.parent.plugins.get("decelerate",!0);t&&(t.x||t.y)&&(t.percentChangeX=t.percentChangeY=this.options.friction)}return!1}update(t){if(!(this.paused||this.options.interrupt&&0!==this.parent.input.count()))if(this.snapping){const e=this.snapping;let n,s,i;e.time+=t;const r=this.startX,a=this.startY,o=this.deltaX,l=this.deltaY;if(e.time>this.options.time)n=!0,s=r+o,i=a+l;else{const t=this.ease(e.time,0,1,this.options.time);s=r+o*t,i=a+l*t}this.options.topLeft?this.parent.moveCorner(s,i):this.parent.moveCenter(s,i),this.parent.emit("moved",{viewport:this.parent,type:"snap"}),n&&(this.options.removeOnComplete&&this.parent.plugins.remove("snap"),this.parent.emit("snap-end",this.parent),this.snapping=null)}else{const t=this.options.topLeft?this.parent.corner:this.parent.center;(t.x!==this.x||t.y!==this.y)&&this.snapStart()}}}const PA={width:0,height:0,time:1e3,ease:"easeInOutSine",center:null,interrupt:!0,removeOnComplete:!1,removeOnInterrupt:!1,forceStart:!1,noMove:!1};class kA extends iA{constructor(t,e={}){super(t),sA(this,"options"),sA(this,"ease"),sA(this,"xScale"),sA(this,"yScale"),sA(this,"xIndependent"),sA(this,"yIndependent"),sA(this,"snapping"),this.options=Object.assign({},PA,e),this.ease=hA(this.options.ease),this.xIndependent=!1,this.yIndependent=!1,this.xScale=0,this.yScale=0,this.options.width>0&&(this.xScale=t.screenWidth/this.options.width,this.xIndependent=!0),this.options.height>0&&(this.yScale=t.screenHeight/this.options.height,this.yIndependent=!0),this.xScale=this.xIndependent?this.xScale:this.yScale,this.yScale=this.yIndependent?this.yScale:this.xScale,0===this.options.time?(t.container.scale.x=this.xScale,t.container.scale.y=this.yScale,this.options.removeOnComplete&&this.parent.plugins.remove("snap-zoom")):e.forceStart&&this.createSnapping()}createSnapping(){const t=this.parent.worldScreenWidth,e=this.parent.worldScreenHeight,n=this.parent.screenWidth/this.xScale,s=this.parent.screenHeight/this.yScale;this.snapping={time:0,startX:t,startY:e,deltaX:n-t,deltaY:s-e},this.parent.emit("snap-zoom-start",this.parent)}resize(){this.snapping=null,this.options.width>0&&(this.xScale=this.parent.screenWidth/this.options.width),this.options.height>0&&(this.yScale=this.parent.screenHeight/this.options.height),this.xScale=this.xIndependent?this.xScale:this.yScale,this.yScale=this.yIndependent?this.yScale:this.xScale}wheel(){return this.options.removeOnInterrupt&&this.parent.plugins.remove("snap-zoom"),!1}down(){return this.options.removeOnInterrupt?this.parent.plugins.remove("snap-zoom"):this.options.interrupt&&(this.snapping=null),!1}update(t){if(this.paused||this.options.interrupt&&0!==this.parent.input.count())return;let e;if(!this.options.center&&!this.options.noMove&&(e=this.parent.center),this.snapping){if(this.snapping){const n=this.snapping;if(n.time+=t,n.time>=this.options.time)this.parent.scale.set(this.xScale,this.yScale),this.options.removeOnComplete&&this.parent.plugins.remove("snap-zoom"),this.parent.emit("snap-zoom-end",this.parent),this.snapping=null;else{const t=this.snapping,e=this.ease(t.time,t.startX,t.deltaX,this.options.time),n=this.ease(t.time,t.startY,t.deltaY,this.options.time);this.parent.scale.x=this.parent.screenWidth/e,this.parent.scale.y=this.parent.screenHeight/n}const s=this.parent.plugins.get("clamp-zoom",!0);s&&s.clamp(),this.options.noMove||(this.options.center?this.parent.moveCenter(this.options.center):this.parent.moveCenter(e))}}else(this.parent.scale.x!==this.xScale||this.parent.scale.y!==this.yScale)&&this.createSnapping()}resume(){this.snapping=null,super.resume()}}const FA={percent:.1,smooth:!1,interrupt:!0,reverse:!1,center:null,lineHeight:20,axis:"all",keyToPress:null,trackpadPinch:!1,wheelZoom:!0};class OA extends iA{constructor(t,e={}){super(t),sA(this,"options"),sA(this,"smoothing"),sA(this,"smoothingCenter"),sA(this,"smoothingCount"),sA(this,"keyIsPressed"),this.options=Object.assign({},FA,e),this.keyIsPressed=!1,this.options.keyToPress&&this.handleKeyPresses(this.options.keyToPress)}handleKeyPresses(t){window.addEventListener("keydown",(e=>{t.includes(e.code)&&(this.keyIsPressed=!0)})),window.addEventListener("keyup",(e=>{t.includes(e.code)&&(this.keyIsPressed=!1)}))}checkKeyPress(){return!this.options.keyToPress||this.keyIsPressed}down(){return this.options.interrupt&&(this.smoothing=null),!1}isAxisX(){return["all","x"].includes(this.options.axis)}isAxisY(){return["all","y"].includes(this.options.axis)}update(){if(this.smoothing){const t=this.smoothingCenter,e=this.smoothing;let n;this.options.center||(n=this.parent.toLocal(t)),this.isAxisX()&&(this.parent.scale.x+=e.x),this.isAxisY()&&(this.parent.scale.y+=e.y),this.parent.emit("zoomed",{viewport:this.parent,type:"wheel"});const s=this.parent.plugins.get("clamp-zoom",!0);if(s&&s.clamp(),this.options.center)this.parent.moveCenter(this.options.center);else{const e=this.parent.toGlobal(n);this.parent.x+=t.x-e.x,this.parent.y+=t.y-e.y}this.parent.emit("moved",{viewport:this.parent,type:"wheel"}),this.smoothingCount++,this.smoothingCount>=this.options.smooth&&(this.smoothing=null)}}pinch(t){if(this.paused)return;const e=this.parent.input.getPointerPosition(t),n=-t.deltaY*(t.deltaMode?this.options.lineHeight:1)/200,s=Math.pow(2,(1+this.options.percent)*n);let i;this.options.center||(i=this.parent.toLocal(e)),this.isAxisX()&&(this.parent.scale.x*=s),this.isAxisY()&&(this.parent.scale.y*=s),this.parent.emit("zoomed",{viewport:this.parent,type:"wheel"});const r=this.parent.plugins.get("clamp-zoom",!0);if(r&&r.clamp(),this.options.center)this.parent.moveCenter(this.options.center);else{const t=this.parent.toGlobal(i);this.parent.x+=e.x-t.x,this.parent.y+=e.y-t.y}this.parent.emit("moved",{viewport:this.parent,type:"wheel"}),this.parent.emit("wheel-start",{event:t,viewport:this.parent})}wheel(t){if(this.paused||!this.checkKeyPress())return!1;if(t.ctrlKey&&this.options.trackpadPinch)this.pinch(t);else if(this.options.wheelZoom){const e=this.parent.input.getPointerPosition(t),n=(this.options.reverse?-1:1)*-t.deltaY*(t.deltaMode?this.options.lineHeight:1)/500,s=Math.pow(2,(1+this.options.percent)*n);if(this.options.smooth){const t={x:this.smoothing?this.smoothing.x*(this.options.smooth-this.smoothingCount):0,y:this.smoothing?this.smoothing.y*(this.options.smooth-this.smoothingCount):0};this.smoothing={x:((this.parent.scale.x+t.x)*s-this.parent.scale.x)/this.options.smooth,y:((this.parent.scale.y+t.y)*s-this.parent.scale.y)/this.options.smooth},this.smoothingCount=0,this.smoothingCenter=e}else{let t;this.options.center||(t=this.parent.toLocal(e)),this.isAxisX()&&(this.parent.scale.x*=s),this.isAxisY()&&(this.parent.scale.y*=s),this.parent.emit("zoomed",{viewport:this.parent,type:"wheel"});const n=this.parent.plugins.get("clamp-zoom",!0);if(n&&n.clamp(),this.options.center)this.parent.moveCenter(this.options.center);else{const n=this.parent.toGlobal(t);this.parent.x+=e.x-n.x,this.parent.y+=e.y-n.y}}this.parent.emit("moved",{viewport:this.parent,type:"wheel"}),this.parent.emit("wheel-start",{event:t,viewport:this.parent})}return!this.parent.options.passiveWheel}}class DA{constructor(t){sA(this,"viewport"),sA(this,"clickedAvailable"),sA(this,"isMouseDown"),sA(this,"last"),sA(this,"wheelFunction"),sA(this,"touches"),this.viewport=t,this.touches=[],this.addListeners()}addListeners(){this.viewport.interactive=!0,this.viewport.forceHitArea||(this.viewport.hitArea=new Zl(0,0,this.viewport.worldWidth,this.viewport.worldHeight)),this.viewport.on("pointerdown",this.down,this),this.viewport.on("pointermove",this.move,this),this.viewport.on("pointerup",this.up,this),this.viewport.on("pointerupoutside",this.up,this),this.viewport.on("pointercancel",this.up,this),this.viewport.on("pointerout",this.up,this),this.wheelFunction=t=>this.handleWheel(t),this.viewport.options.events.domElement.addEventListener("wheel",this.wheelFunction,{passive:this.viewport.options.passiveWheel}),this.isMouseDown=!1}destroy(){this.viewport.options.events.domElement.removeEventListener("wheel",this.wheelFunction)}down(t){if(!this.viewport.pause&&this.viewport.worldVisible){if("mouse"===t.pointerType?this.isMouseDown=!0:this.get(t.pointerId)||this.touches.push({id:t.pointerId,last:null}),1===this.count()){this.last=t.global.clone();const e=this.viewport.plugins.get("decelerate",!0),n=this.viewport.plugins.get("bounce",!0);e&&e.isActive()||n&&n.isActive()?this.clickedAvailable=!1:this.clickedAvailable=!0}else this.clickedAvailable=!1;this.viewport.plugins.down(t)&&this.viewport.options.stopPropagation&&t.stopPropagation()}}clear(){this.isMouseDown=!1,this.touches=[],this.last=null}checkThreshold(t){return Math.abs(t)>=this.viewport.threshold}move(t){if(this.viewport.pause||!this.viewport.worldVisible)return;const e=this.viewport.plugins.move(t);if(this.clickedAvailable&&this.last){const e=t.global.x-this.last.x,n=t.global.y-this.last.y;(this.checkThreshold(e)||this.checkThreshold(n))&&(this.clickedAvailable=!1)}e&&this.viewport.options.stopPropagation&&t.stopPropagation()}up(t){if(this.viewport.pause||!this.viewport.worldVisible)return;"mouse"===t.pointerType&&(this.isMouseDown=!1),"mouse"!==t.pointerType&&this.remove(t.pointerId);const e=this.viewport.plugins.up(t);this.clickedAvailable&&0===this.count()&&this.last&&(this.viewport.emit("clicked",{event:t,screen:this.last,world:this.viewport.toWorld(this.last),viewport:this.viewport}),this.clickedAvailable=!1),e&&this.viewport.options.stopPropagation&&t.stopPropagation()}getPointerPosition(t){const e=new ql;return this.viewport.options.events.mapPositionToPoint(e,t.clientX,t.clientY),e}handleWheel(t){if(this.viewport.pause||!this.viewport.worldVisible)return;const e=this.viewport.toLocal(this.getPointerPosition(t));this.viewport.left<=e.x&&e.x<=this.viewport.right&&this.viewport.top<=e.y&&e.y<=this.viewport.bottom&&this.viewport.plugins.wheel(t)&&!this.viewport.options.passiveWheel&&t.preventDefault()}pause(){this.touches=[],this.isMouseDown=!1}get(t){for(const e of this.touches)if(e.id===t)return e;return null}remove(t){for(let e=0;e<this.touches.length;e++)if(this.touches[e].id===t)return void this.touches.splice(e,1)}count(){return(this.isMouseDown?1:0)+this.touches.length}}const LA=["drag","pinch","wheel","follow","mouse-edges","decelerate","animate","bounce","snap-zoom","clamp-zoom","snap","clamp"];class NA{constructor(t){sA(this,"plugins"),sA(this,"list"),sA(this,"viewport"),this.viewport=t,this.list=[],this.plugins={}}add(t,e,n=LA.length){const s=this.plugins[t];s&&s.destroy(),this.plugins[t]=e;const i=LA.indexOf(t);-1!==i&&LA.splice(i,1),LA.splice(n,0,t),this.sort()}get(t,e){var n;return e&&null!=(n=this.plugins[t])&&n.paused?null:this.plugins[t]}update(t){for(const e of this.list)e.update(t)}resize(){for(const t of this.list)t.resize()}reset(){for(const t of this.list)t.reset()}removeAll(){this.list.forEach((t=>{t.destroy()})),this.plugins={},this.sort()}remove(t){var e;this.plugins[t]&&(null==(e=this.plugins[t])||e.destroy(),delete this.plugins[t],this.viewport.emit("plugin-remove",t),this.sort())}pause(t){var e;null==(e=this.plugins[t])||e.pause()}resume(t){var e;null==(e=this.plugins[t])||e.resume()}sort(){this.list=[];for(const t of LA)this.plugins[t]&&this.list.push(this.plugins[t])}down(t){let e=!1;for(const n of this.list)n.down(t)&&(e=!0);return e}move(t){let e=!1;for(const n of this.viewport.plugins.list)n.move(t)&&(e=!0);return e}up(t){let e=!1;for(const n of this.list)n.up(t)&&(e=!0);return e}wheel(t){let e=!1;for(const n of this.list)n.wheel(t)&&(e=!0);return e}}const BA={screenWidth:window.innerWidth,screenHeight:window.innerHeight,worldWidth:null,worldHeight:null,threshold:5,passiveWheel:!0,stopPropagation:!1,forceHitArea:null,noTicker:!1,disableOnContextMenu:!1,ticker:iu.shared};class VA extends Iu{constructor(t){super(),sA(this,"moving"),sA(this,"screenWidth"),sA(this,"screenHeight"),sA(this,"threshold"),sA(this,"input"),sA(this,"plugins"),sA(this,"zooming"),sA(this,"lastViewport"),sA(this,"options"),sA(this,"_dirty"),sA(this,"_forceHitArea"),sA(this,"_hitAreaDefault"),sA(this,"_pause"),sA(this,"tickerFunction"),sA(this,"_worldWidth"),sA(this,"_worldHeight"),sA(this,"_disableOnContextMenu",(t=>t.preventDefault())),this.options=u(u({},BA),t),this.screenWidth=this.options.screenWidth,this.screenHeight=this.options.screenHeight,this._worldWidth=this.options.worldWidth,this._worldHeight=this.options.worldHeight,this.forceHitArea=this.options.forceHitArea,this.threshold=this.options.threshold,this.options.disableOnContextMenu&&this.options.events.domElement.addEventListener("contextmenu",this._disableOnContextMenu),this.options.noTicker||(this.tickerFunction=()=>this.update(this.options.ticker.elapsedMS),this.options.ticker.add(this.tickerFunction)),this.input=new DA(this),this.plugins=new NA(this)}destroy(t){!this.options.noTicker&&this.tickerFunction&&this.options.ticker.remove(this.tickerFunction),this.options.disableOnContextMenu&&this.options.events.domElement.removeEventListener("contextmenu",this._disableOnContextMenu),this.input.destroy(),super.destroy(t)}update(t){this.pause||(this.plugins.update(t),this.lastViewport&&(this.lastViewport.x!==this.x||this.lastViewport.y!==this.y?this.moving=!0:this.moving&&(this.emit("moved-end",this),this.moving=!1),this.lastViewport.scaleX!==this.scale.x||this.lastViewport.scaleY!==this.scale.y?this.zooming=!0:this.zooming&&(this.emit("zoomed-end",this),this.zooming=!1)),this.forceHitArea||(this._hitAreaDefault=new Zl(this.left,this.top,this.worldScreenWidth,this.worldScreenHeight),this.hitArea=this._hitAreaDefault),this._dirty=this._dirty||!this.lastViewport||this.lastViewport.x!==this.x||this.lastViewport.y!==this.y||this.lastViewport.scaleX!==this.scale.x||this.lastViewport.scaleY!==this.scale.y,this.lastViewport={x:this.x,y:this.y,scaleX:this.scale.x,scaleY:this.scale.y},this.emit("frame-end",this))}resize(t=window.innerWidth,e=window.innerHeight,n,s){this.screenWidth=t,this.screenHeight=e,typeof n<"u"&&(this._worldWidth=n),typeof s<"u"&&(this._worldHeight=s),this.plugins.resize(),this.dirty=!0}get worldWidth(){return this._worldWidth?this._worldWidth:this.width/this.scale.x}set worldWidth(t){this._worldWidth=t,this.plugins.resize()}get worldHeight(){return this._worldHeight?this._worldHeight:this.height/this.scale.y}set worldHeight(t){this._worldHeight=t,this.plugins.resize()}getVisibleBounds(){return new Zl(this.left,this.top,this.worldScreenWidth,this.worldScreenHeight)}toWorld(t,e){return 2===arguments.length?this.toLocal(new ql(t,e)):this.toLocal(t)}toScreen(t,e){return 2===arguments.length?this.toGlobal(new ql(t,e)):this.toGlobal(t)}get worldScreenWidth(){return this.screenWidth/this.scale.x}get worldScreenHeight(){return this.screenHeight/this.scale.y}get screenWorldWidth(){return this.worldWidth*this.scale.x}get screenWorldHeight(){return this.worldHeight*this.scale.y}get center(){return new ql(this.worldScreenWidth/2-this.x/this.scale.x,this.worldScreenHeight/2-this.y/this.scale.y)}set center(t){this.moveCenter(t)}moveCenter(...t){let e,n;"number"==typeof t[0]?(e=t[0],n=t[1]):(e=t[0].x,n=t[0].y);const s=(this.worldScreenWidth/2-e)*this.scale.x,i=(this.worldScreenHeight/2-n)*this.scale.y;return(this.x!==s||this.y!==i)&&(this.position.set(s,i),this.plugins.reset(),this.dirty=!0),this}get corner(){return new ql(-this.x/this.scale.x,-this.y/this.scale.y)}set corner(t){this.moveCorner(t)}moveCorner(...t){let e,n;return 1===t.length?(e=-t[0].x*this.scale.x,n=-t[0].y*this.scale.y):(e=-t[0]*this.scale.x,n=-t[1]*this.scale.y),(e!==this.x||n!==this.y)&&(this.position.set(e,n),this.plugins.reset(),this.dirty=!0),this}get screenWidthInWorldPixels(){return this.screenWidth/this.scale.x}get screenHeightInWorldPixels(){return this.screenHeight/this.scale.y}findFitWidth(t){return this.screenWidth/t}findFitHeight(t){return this.screenHeight/t}findFit(t,e){const n=this.screenWidth/t,s=this.screenHeight/e;return Math.min(n,s)}findCover(t,e){const n=this.screenWidth/t,s=this.screenHeight/e;return Math.max(n,s)}fitWidth(t=this.worldWidth,e,n=!0,s){let i;e&&(i=this.center),this.scale.x=this.screenWidth/t,n&&(this.scale.y=this.scale.x);const r=this.plugins.get("clamp-zoom",!0);return!s&&r&&r.clamp(),e&&i&&this.moveCenter(i),this}fitHeight(t=this.worldHeight,e,n=!0,s){let i;e&&(i=this.center),this.scale.y=this.screenHeight/t,n&&(this.scale.x=this.scale.y);const r=this.plugins.get("clamp-zoom",!0);return!s&&r&&r.clamp(),e&&i&&this.moveCenter(i),this}fitWorld(t){let e;t&&(e=this.center),this.scale.x=this.screenWidth/this.worldWidth,this.scale.y=this.screenHeight/this.worldHeight,this.scale.x<this.scale.y?this.scale.y=this.scale.x:this.scale.x=this.scale.y;const n=this.plugins.get("clamp-zoom",!0);return n&&n.clamp(),t&&e&&this.moveCenter(e),this}fit(t,e=this.worldWidth,n=this.worldHeight){let s;t&&(s=this.center),this.scale.x=this.screenWidth/e,this.scale.y=this.screenHeight/n,this.scale.x<this.scale.y?this.scale.y=this.scale.x:this.scale.x=this.scale.y;const i=this.plugins.get("clamp-zoom",!0);return i&&i.clamp(),t&&s&&this.moveCenter(s),this}setZoom(t,e){let n;e&&(n=this.center),this.scale.set(t);const s=this.plugins.get("clamp-zoom",!0);return s&&s.clamp(),e&&n&&this.moveCenter(n),this}zoomPercent(t,e){return this.setZoom(this.scale.x+this.scale.x*t,e)}zoom(t,e){return this.fitWidth(t+this.worldScreenWidth,e),this}get scaled(){return this.scale.x}set scaled(t){this.setZoom(t,!0)}snapZoom(t){return this.plugins.add("snap-zoom",new kA(this,t)),this}OOB(){return{left:this.left<0,right:this.right>this.worldWidth,top:this.top<0,bottom:this.bottom>this.worldHeight,cornerPoint:new ql(this.worldWidth*this.scale.x-this.screenWidth,this.worldHeight*this.scale.y-this.screenHeight)}}get right(){return-this.x/this.scale.x+this.worldScreenWidth}set right(t){this.x=-t*this.scale.x+this.screenWidth,this.plugins.reset()}get left(){return-this.x/this.scale.x}set left(t){this.x=-t*this.scale.x,this.plugins.reset()}get top(){return-this.y/this.scale.y}set top(t){this.y=-t*this.scale.y,this.plugins.reset()}get bottom(){return-this.y/this.scale.y+this.worldScreenHeight}set bottom(t){this.y=-t*this.scale.y+this.screenHeight,this.plugins.reset()}get dirty(){return!!this._dirty}set dirty(t){this._dirty=t}get forceHitArea(){return this._forceHitArea}set forceHitArea(t){t?(this._forceHitArea=t,this.hitArea=t):(this._forceHitArea=null,this.hitArea=new Zl(0,0,this.worldWidth,this.worldHeight))}drag(t){return this.plugins.add("drag",new wA(this,t)),this}clamp(t){return this.plugins.add("clamp",new mA(this,t)),this}decelerate(t){return this.plugins.add("decelerate",new _A(this,t)),this}bounce(t){return this.plugins.add("bounce",new fA(this,t)),this}pinch(t){return this.plugins.add("pinch",new IA(this,t)),this}snap(t,e,n){return this.plugins.add("snap",new RA(this,t,e,n)),this}follow(t,e){return this.plugins.add("follow",new TA(this,t,e)),this}wheel(t){return this.plugins.add("wheel",new OA(this,t)),this}animate(t){return this.plugins.add("animate",new uA(this,t)),this}clampZoom(t){return this.plugins.add("clamp-zoom",new vA(this,t)),this}mouseEdges(t){return this.plugins.add("mouse-edges",new AA(this,t)),this}get pause(){return!!this._pause}set pause(t){this._pause=t,this.lastViewport=null,this.moving=!1,this.zooming=!1,t&&this.input.pause()}ensureVisible(t,e,n,s,i){i&&(n>this.worldScreenWidth||s>this.worldScreenHeight)&&(this.fit(!0,n,s),this.emit("zoomed",{viewport:this,type:"ensureVisible"}));let r=!1;t<this.left?(this.left=t,r=!0):t+n>this.right&&(this.right=t+n,r=!0),e<this.top?(this.top=e,r=!0):e+s>this.bottom&&(this.bottom=e+s,r=!0),r&&this.emit("moved",{viewport:this,type:"ensureVisible"})}}class UA extends(Ag(VA)){get parentContainer(){return this.parent}sendObjToBack(t){this.parentContainer.sendObjToBack(t)}bringObjToFront(t){this.parentContainer.bringObjToFront(t)}}var XA={};function YA(){const t=pgame.gui.sidePanel;pgame.stage.tweens.remove(t.autoPlayTweens),pgame.data.nAutoPlays=0,pgame.gui.enableBetButtons()}!function(t,e){(function(){var n,s=200,i="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",r="Expected a function",a="Invalid `variable` option passed into `_.template`",o="__lodash_hash_undefined__",l=500,h="__lodash_placeholder__",c=1,u=2,d=4,f=1,p=2,m=1,g=2,v=4,x=8,y=16,_=32,b=64,w=128,E=256,T=512,S=30,A="...",C=800,I=16,M=1,R=2,P=1/0,k=9007199254740991,F=17976931348623157e292,O=NaN,D=4294967295,L=D-1,N=D>>>1,B=[["ary",w],["bind",m],["bindKey",g],["curry",x],["curryRight",y],["flip",T],["partial",_],["partialRight",b],["rearg",E]],V="[object Arguments]",U="[object Array]",X="[object AsyncFunction]",Y="[object Boolean]",W="[object Date]",z="[object DOMException]",G="[object Error]",H="[object Function]",j="[object GeneratorFunction]",$="[object Map]",q="[object Number]",K="[object Null]",Z="[object Object]",Q="[object Promise]",J="[object Proxy]",tt="[object RegExp]",et="[object Set]",nt="[object String]",st="[object Symbol]",it="[object Undefined]",rt="[object WeakMap]",at="[object WeakSet]",ot="[object ArrayBuffer]",lt="[object DataView]",ht="[object Float32Array]",ct="[object Float64Array]",ut="[object Int8Array]",dt="[object Int16Array]",ft="[object Int32Array]",pt="[object Uint8Array]",mt="[object Uint8ClampedArray]",gt="[object Uint16Array]",vt="[object Uint32Array]",xt=/\b__p \+= '';/g,yt=/\b(__p \+=) '' \+/g,_t=/(__e\(.*?\)|\b__t\)) \+\n'';/g,bt=/&(?:amp|lt|gt|quot|#39);/g,wt=/[&<>"']/g,Et=RegExp(bt.source),Tt=RegExp(wt.source),St=/<%-([\s\S]+?)%>/g,At=/<%([\s\S]+?)%>/g,Ct=/<%=([\s\S]+?)%>/g,It=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Mt=/^\w*$/,Rt=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Pt=/[\\^$.*+?()[\]{}|]/g,kt=RegExp(Pt.source),Ft=/^\s+/,Ot=/\s/,Dt=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Lt=/\{\n\/\* \[wrapped with (.+)\] \*/,Nt=/,? & /,Bt=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Vt=/[()=,{}\[\]\/\s]/,Ut=/\\(\\)?/g,Xt=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Yt=/\w*$/,Wt=/^[-+]0x[0-9a-f]+$/i,zt=/^0b[01]+$/i,Gt=/^\[object .+?Constructor\]$/,Ht=/^0o[0-7]+$/i,jt=/^(?:0|[1-9]\d*)$/,$t=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,qt=/($^)/,Kt=/['\n\r\u2028\u2029\\]/g,Zt="\\ud800-\\udfff",Qt="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",Jt="\\u2700-\\u27bf",te="a-z\\xdf-\\xf6\\xf8-\\xff",ee="A-Z\\xc0-\\xd6\\xd8-\\xde",ne="\\ufe0e\\ufe0f",se="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",ie="['’]",re="["+Zt+"]",ae="["+se+"]",oe="["+Qt+"]",le="\\d+",he="["+Jt+"]",ce="["+te+"]",ue="[^"+Zt+se+le+Jt+te+ee+"]",de="\\ud83c[\\udffb-\\udfff]",fe="[^"+Zt+"]",pe="(?:\\ud83c[\\udde6-\\uddff]){2}",me="[\\ud800-\\udbff][\\udc00-\\udfff]",ge="["+ee+"]",ve="\\u200d",xe="(?:"+ce+"|"+ue+")",ye="(?:"+ge+"|"+ue+")",_e="(?:['’](?:d|ll|m|re|s|t|ve))?",be="(?:['’](?:D|LL|M|RE|S|T|VE))?",we="(?:"+oe+"|"+de+")"+"?",Ee="["+ne+"]?",Te=Ee+we+("(?:"+ve+"(?:"+[fe,pe,me].join("|")+")"+Ee+we+")*"),Se="(?:"+[he,pe,me].join("|")+")"+Te,Ae="(?:"+[fe+oe+"?",oe,pe,me,re].join("|")+")",Ce=RegExp(ie,"g"),Ie=RegExp(oe,"g"),Me=RegExp(de+"(?="+de+")|"+Ae+Te,"g"),Re=RegExp([ge+"?"+ce+"+"+_e+"(?="+[ae,ge,"$"].join("|")+")",ye+"+"+be+"(?="+[ae,ge+xe,"$"].join("|")+")",ge+"?"+xe+"+"+_e,ge+"+"+be,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",le,Se].join("|"),"g"),Pe=RegExp("["+ve+Zt+Qt+ne+"]"),ke=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Fe=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Oe=-1,De={};De[ht]=De[ct]=De[ut]=De[dt]=De[ft]=De[pt]=De[mt]=De[gt]=De[vt]=!0,De[V]=De[U]=De[ot]=De[Y]=De[lt]=De[W]=De[G]=De[H]=De[$]=De[q]=De[Z]=De[tt]=De[et]=De[nt]=De[rt]=!1;var Le={};Le[V]=Le[U]=Le[ot]=Le[lt]=Le[Y]=Le[W]=Le[ht]=Le[ct]=Le[ut]=Le[dt]=Le[ft]=Le[$]=Le[q]=Le[Z]=Le[tt]=Le[et]=Le[nt]=Le[st]=Le[pt]=Le[mt]=Le[gt]=Le[vt]=!0,Le[G]=Le[H]=Le[rt]=!1;var Ne={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Be=parseFloat,Ve=parseInt,Ue="object"==typeof ha&&ha&&ha.Object===Object&&ha,Xe="object"==typeof self&&self&&self.Object===Object&&self,Ye=Ue||Xe||Function("return this")(),We=e&&!e.nodeType&&e,ze=We&&t&&!t.nodeType&&t,Ge=ze&&ze.exports===We,He=Ge&&Ue.process,je=function(){try{var t=ze&&ze.require&&ze.require("util").types;return t||He&&He.binding&&He.binding("util")}catch(_m){}}(),$e=je&&je.isArrayBuffer,qe=je&&je.isDate,Ke=je&&je.isMap,Ze=je&&je.isRegExp,Qe=je&&je.isSet,Je=je&&je.isTypedArray;function tn(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}function en(t,e,n,s){for(var i=-1,r=null==t?0:t.length;++i<r;){var a=t[i];e(s,a,n(a),t)}return s}function nn(t,e){for(var n=-1,s=null==t?0:t.length;++n<s&&!1!==e(t[n],n,t););return t}function sn(t,e){for(var n=null==t?0:t.length;n--&&!1!==e(t[n],n,t););return t}function rn(t,e){for(var n=-1,s=null==t?0:t.length;++n<s;)if(!e(t[n],n,t))return!1;return!0}function an(t,e){for(var n=-1,s=null==t?0:t.length,i=0,r=[];++n<s;){var a=t[n];e(a,n,t)&&(r[i++]=a)}return r}function on(t,e){return!!(null==t?0:t.length)&&vn(t,e,0)>-1}function ln(t,e,n){for(var s=-1,i=null==t?0:t.length;++s<i;)if(n(e,t[s]))return!0;return!1}function hn(t,e){for(var n=-1,s=null==t?0:t.length,i=Array(s);++n<s;)i[n]=e(t[n],n,t);return i}function cn(t,e){for(var n=-1,s=e.length,i=t.length;++n<s;)t[i+n]=e[n];return t}function un(t,e,n,s){var i=-1,r=null==t?0:t.length;for(s&&r&&(n=t[++i]);++i<r;)n=e(n,t[i],i,t);return n}function dn(t,e,n,s){var i=null==t?0:t.length;for(s&&i&&(n=t[--i]);i--;)n=e(n,t[i],i,t);return n}function fn(t,e){for(var n=-1,s=null==t?0:t.length;++n<s;)if(e(t[n],n,t))return!0;return!1}var pn=bn("length");function mn(t,e,n){var s;return n(t,(function(t,n,i){if(e(t,n,i))return s=n,!1})),s}function gn(t,e,n,s){for(var i=t.length,r=n+(s?1:-1);s?r--:++r<i;)if(e(t[r],r,t))return r;return-1}function vn(t,e,n){return e==e?function(t,e,n){var s=n-1,i=t.length;for(;++s<i;)if(t[s]===e)return s;return-1}(t,e,n):gn(t,yn,n)}function xn(t,e,n,s){for(var i=n-1,r=t.length;++i<r;)if(s(t[i],e))return i;return-1}function yn(t){return t!=t}function _n(t,e){var n=null==t?0:t.length;return n?Tn(t,e)/n:O}function bn(t){return function(e){return null==e?n:e[t]}}function wn(t){return function(e){return null==t?n:t[e]}}function En(t,e,n,s,i){return i(t,(function(t,i,r){n=s?(s=!1,t):e(n,t,i,r)})),n}function Tn(t,e){for(var s,i=-1,r=t.length;++i<r;){var a=e(t[i]);a!==n&&(s=s===n?a:s+a)}return s}function Sn(t,e){for(var n=-1,s=Array(t);++n<t;)s[n]=e(n);return s}function An(t){return t?t.slice(0,Yn(t)+1).replace(Ft,""):t}function Cn(t){return function(e){return t(e)}}function In(t,e){return hn(e,(function(e){return t[e]}))}function Mn(t,e){return t.has(e)}function Rn(t,e){for(var n=-1,s=t.length;++n<s&&vn(e,t[n],0)>-1;);return n}function Pn(t,e){for(var n=t.length;n--&&vn(e,t[n],0)>-1;);return n}var kn=wn({"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","Ç":"C","ç":"c","Ð":"D","ð":"d","È":"E","É":"E","Ê":"E","Ë":"E","è":"e","é":"e","ê":"e","ë":"e","Ì":"I","Í":"I","Î":"I","Ï":"I","ì":"i","í":"i","î":"i","ï":"i","Ñ":"N","ñ":"n","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","Ù":"U","Ú":"U","Û":"U","Ü":"U","ù":"u","ú":"u","û":"u","ü":"u","Ý":"Y","ý":"y","ÿ":"y","Æ":"Ae","æ":"ae","Þ":"Th","þ":"th","ß":"ss","Ā":"A","Ă":"A","Ą":"A","ā":"a","ă":"a","ą":"a","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","ć":"c","ĉ":"c","ċ":"c","č":"c","Ď":"D","Đ":"D","ď":"d","đ":"d","Ē":"E","Ĕ":"E","Ė":"E","Ę":"E","Ě":"E","ē":"e","ĕ":"e","ė":"e","ę":"e","ě":"e","Ĝ":"G","Ğ":"G","Ġ":"G","Ģ":"G","ĝ":"g","ğ":"g","ġ":"g","ģ":"g","Ĥ":"H","Ħ":"H","ĥ":"h","ħ":"h","Ĩ":"I","Ī":"I","Ĭ":"I","Į":"I","İ":"I","ĩ":"i","ī":"i","ĭ":"i","į":"i","ı":"i","Ĵ":"J","ĵ":"j","Ķ":"K","ķ":"k","ĸ":"k","Ĺ":"L","Ļ":"L","Ľ":"L","Ŀ":"L","Ł":"L","ĺ":"l","ļ":"l","ľ":"l","ŀ":"l","ł":"l","Ń":"N","Ņ":"N","Ň":"N","Ŋ":"N","ń":"n","ņ":"n","ň":"n","ŋ":"n","Ō":"O","Ŏ":"O","Ő":"O","ō":"o","ŏ":"o","ő":"o","Ŕ":"R","Ŗ":"R","Ř":"R","ŕ":"r","ŗ":"r","ř":"r","Ś":"S","Ŝ":"S","Ş":"S","Š":"S","ś":"s","ŝ":"s","ş":"s","š":"s","Ţ":"T","Ť":"T","Ŧ":"T","ţ":"t","ť":"t","ŧ":"t","Ũ":"U","Ū":"U","Ŭ":"U","Ů":"U","Ű":"U","Ų":"U","ũ":"u","ū":"u","ŭ":"u","ů":"u","ű":"u","ų":"u","Ŵ":"W","ŵ":"w","Ŷ":"Y","ŷ":"y","Ÿ":"Y","Ź":"Z","Ż":"Z","Ž":"Z","ź":"z","ż":"z","ž":"z","Ĳ":"IJ","ĳ":"ij","Œ":"Oe","œ":"oe","ŉ":"'n","ſ":"s"}),Fn=wn({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function On(t){return"\\"+Ne[t]}function Dn(t){return Pe.test(t)}function Ln(t){var e=-1,n=Array(t.size);return t.forEach((function(t,s){n[++e]=[s,t]})),n}function Nn(t,e){return function(n){return t(e(n))}}function Bn(t,e){for(var n=-1,s=t.length,i=0,r=[];++n<s;){var a=t[n];a!==e&&a!==h||(t[n]=h,r[i++]=n)}return r}function Vn(t){var e=-1,n=Array(t.size);return t.forEach((function(t){n[++e]=t})),n}function Un(t){return Dn(t)?function(t){var e=Me.lastIndex=0;for(;Me.test(t);)++e;return e}(t):pn(t)}function Xn(t){return Dn(t)?function(t){return t.match(Me)||[]}(t):function(t){return t.split("")}(t)}function Yn(t){for(var e=t.length;e--&&Ot.test(t.charAt(e)););return e}var Wn=wn({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"});var zn=function t(e){var Ot,Zt=(e=null==e?Ye:zn.defaults(Ye.Object(),e,zn.pick(Ye,Fe))).Array,Qt=e.Date,Jt=e.Error,te=e.Function,ee=e.Math,ne=e.Object,se=e.RegExp,ie=e.String,re=e.TypeError,ae=Zt.prototype,oe=te.prototype,le=ne.prototype,he=e["__core-js_shared__"],ce=oe.toString,ue=le.hasOwnProperty,de=0,fe=(Ot=/[^.]+$/.exec(he&&he.keys&&he.keys.IE_PROTO||""))?"Symbol(src)_1."+Ot:"",pe=le.toString,me=ce.call(ne),ge=Ye._,ve=se("^"+ce.call(ue).replace(Pt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),xe=Ge?e.Buffer:n,ye=e.Symbol,_e=e.Uint8Array,be=xe?xe.allocUnsafe:n,we=Nn(ne.getPrototypeOf,ne),Ee=ne.create,Te=le.propertyIsEnumerable,Se=ae.splice,Ae=ye?ye.isConcatSpreadable:n,Me=ye?ye.iterator:n,Pe=ye?ye.toStringTag:n,Ne=function(){try{var t=Ur(ne,"defineProperty");return t({},"",{}),t}catch(_m){}}(),Ue=e.clearTimeout!==Ye.clearTimeout&&e.clearTimeout,Xe=Qt&&Qt.now!==Ye.Date.now&&Qt.now,We=e.setTimeout!==Ye.setTimeout&&e.setTimeout,ze=ee.ceil,He=ee.floor,je=ne.getOwnPropertySymbols,pn=xe?xe.isBuffer:n,wn=e.isFinite,Gn=ae.join,Hn=Nn(ne.keys,ne),jn=ee.max,$n=ee.min,qn=Qt.now,Kn=e.parseInt,Zn=ee.random,Qn=ae.reverse,Jn=Ur(e,"DataView"),ts=Ur(e,"Map"),es=Ur(e,"Promise"),ns=Ur(e,"Set"),ss=Ur(e,"WeakMap"),is=Ur(ne,"create"),rs=ss&&new ss,as={},os=ma(Jn),ls=ma(ts),hs=ma(es),cs=ma(ns),us=ma(ss),ds=ye?ye.prototype:n,fs=ds?ds.valueOf:n,ps=ds?ds.toString:n;function ms(t){if(Fo(t)&&!wo(t)&&!(t instanceof ys)){if(t instanceof xs)return t;if(ue.call(t,"__wrapped__"))return ga(t)}return new xs(t)}var gs=function(){function t(){}return function(e){if(!ko(e))return{};if(Ee)return Ee(e);t.prototype=e;var s=new t;return t.prototype=n,s}}();function vs(){}function xs(t,e){this.__wrapped__=t,this.__actions__=[],this.__chain__=!!e,this.__index__=0,this.__values__=n}function ys(t){this.__wrapped__=t,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=D,this.__views__=[]}function _s(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var s=t[e];this.set(s[0],s[1])}}function bs(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var s=t[e];this.set(s[0],s[1])}}function ws(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var s=t[e];this.set(s[0],s[1])}}function Es(t){var e=-1,n=null==t?0:t.length;for(this.__data__=new ws;++e<n;)this.add(t[e])}function Ts(t){var e=this.__data__=new bs(t);this.size=e.size}function Ss(t,e){var n=wo(t),s=!n&&bo(t),i=!n&&!s&&Ao(t),r=!n&&!s&&!i&&Xo(t),a=n||s||i||r,o=a?Sn(t.length,ie):[],l=o.length;for(var h in t)!e&&!ue.call(t,h)||a&&("length"==h||i&&("offset"==h||"parent"==h)||r&&("buffer"==h||"byteLength"==h||"byteOffset"==h)||jr(h,l))||o.push(h);return o}function As(t){var e=t.length;return e?t[Ei(0,e-1)]:n}function Cs(t,e){return ha(ir(t),Ls(e,0,t.length))}function Is(t){return ha(ir(t))}function Ms(t,e,s){(s!==n&&!xo(t[e],s)||s===n&&!(e in t))&&Os(t,e,s)}function Rs(t,e,s){var i=t[e];ue.call(t,e)&&xo(i,s)&&(s!==n||e in t)||Os(t,e,s)}function Ps(t,e){for(var n=t.length;n--;)if(xo(t[n][0],e))return n;return-1}function ks(t,e,n,s){return Xs(t,(function(t,i,r){e(s,t,n(t),r)})),s}function Fs(t,e){return t&&rr(e,hl(e),t)}function Os(t,e,n){"__proto__"==e&&Ne?Ne(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}function Ds(t,e){for(var s=-1,i=e.length,r=Zt(i),a=null==t;++s<i;)r[s]=a?n:il(t,e[s]);return r}function Ls(t,e,s){return t==t&&(s!==n&&(t=t<=s?t:s),e!==n&&(t=t>=e?t:e)),t}function Ns(t,e,s,i,r,a){var o,l=e&c,h=e&u,f=e&d;if(s&&(o=r?s(t,i,r,a):s(t)),o!==n)return o;if(!ko(t))return t;var p=wo(t);if(p){if(o=function(t){var e=t.length,n=new t.constructor(e);e&&"string"==typeof t[0]&&ue.call(t,"index")&&(n.index=t.index,n.input=t.input);return n}(t),!l)return ir(t,o)}else{var m=Wr(t),g=m==H||m==j;if(Ao(t))return Qi(t,l);if(m==Z||m==V||g&&!r){if(o=h||g?{}:Gr(t),!l)return h?function(t,e){return rr(t,Yr(t),e)}(t,function(t,e){return t&&rr(e,cl(e),t)}(o,t)):function(t,e){return rr(t,Xr(t),e)}(t,Fs(o,t))}else{if(!Le[m])return r?t:{};o=function(t,e,n){var s=t.constructor;switch(e){case ot:return Ji(t);case Y:case W:return new s(+t);case lt:return function(t,e){var n=e?Ji(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.byteLength)}(t,n);case ht:case ct:case ut:case dt:case ft:case pt:case mt:case gt:case vt:return tr(t,n);case $:return new s;case q:case nt:return new s(t);case tt:return function(t){var e=new t.constructor(t.source,Yt.exec(t));return e.lastIndex=t.lastIndex,e}(t);case et:return new s;case st:return i=t,fs?ne(fs.call(i)):{}}var i}(t,m,l)}}a||(a=new Ts);var v=a.get(t);if(v)return v;a.set(t,o),Bo(t)?t.forEach((function(n){o.add(Ns(n,e,s,n,t,a))})):Oo(t)&&t.forEach((function(n,i){o.set(i,Ns(n,e,s,i,t,a))}));var x=p?n:(f?h?Fr:kr:h?cl:hl)(t);return nn(x||t,(function(n,i){x&&(n=t[i=n]),Rs(o,i,Ns(n,e,s,i,t,a))})),o}function Bs(t,e,s){var i=s.length;if(null==t)return!i;for(t=ne(t);i--;){var r=s[i],a=e[r],o=t[r];if(o===n&&!(r in t)||!a(o))return!1}return!0}function Vs(t,e,s){if("function"!=typeof t)throw new re(r);return ra((function(){t.apply(n,s)}),e)}function Us(t,e,n,i){var r=-1,a=on,o=!0,l=t.length,h=[],c=e.length;if(!l)return h;n&&(e=hn(e,Cn(n))),i?(a=ln,o=!1):e.length>=s&&(a=Mn,o=!1,e=new Es(e));t:for(;++r<l;){var u=t[r],d=null==n?u:n(u);if(u=i||0!==u?u:0,o&&d==d){for(var f=c;f--;)if(e[f]===d)continue t;h.push(u)}else a(e,d,i)||h.push(u)}return h}ms.templateSettings={escape:St,evaluate:At,interpolate:Ct,variable:"",imports:{_:ms}},ms.prototype=vs.prototype,ms.prototype.constructor=ms,xs.prototype=gs(vs.prototype),xs.prototype.constructor=xs,ys.prototype=gs(vs.prototype),ys.prototype.constructor=ys,_s.prototype.clear=function(){this.__data__=is?is(null):{},this.size=0},_s.prototype.delete=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},_s.prototype.get=function(t){var e=this.__data__;if(is){var s=e[t];return s===o?n:s}return ue.call(e,t)?e[t]:n},_s.prototype.has=function(t){var e=this.__data__;return is?e[t]!==n:ue.call(e,t)},_s.prototype.set=function(t,e){var s=this.__data__;return this.size+=this.has(t)?0:1,s[t]=is&&e===n?o:e,this},bs.prototype.clear=function(){this.__data__=[],this.size=0},bs.prototype.delete=function(t){var e=this.__data__,n=Ps(e,t);return!(n<0)&&(n==e.length-1?e.pop():Se.call(e,n,1),--this.size,!0)},bs.prototype.get=function(t){var e=this.__data__,s=Ps(e,t);return s<0?n:e[s][1]},bs.prototype.has=function(t){return Ps(this.__data__,t)>-1},bs.prototype.set=function(t,e){var n=this.__data__,s=Ps(n,t);return s<0?(++this.size,n.push([t,e])):n[s][1]=e,this},ws.prototype.clear=function(){this.size=0,this.__data__={hash:new _s,map:new(ts||bs),string:new _s}},ws.prototype.delete=function(t){var e=Br(this,t).delete(t);return this.size-=e?1:0,e},ws.prototype.get=function(t){return Br(this,t).get(t)},ws.prototype.has=function(t){return Br(this,t).has(t)},ws.prototype.set=function(t,e){var n=Br(this,t),s=n.size;return n.set(t,e),this.size+=n.size==s?0:1,this},Es.prototype.add=Es.prototype.push=function(t){return this.__data__.set(t,o),this},Es.prototype.has=function(t){return this.__data__.has(t)},Ts.prototype.clear=function(){this.__data__=new bs,this.size=0},Ts.prototype.delete=function(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n},Ts.prototype.get=function(t){return this.__data__.get(t)},Ts.prototype.has=function(t){return this.__data__.has(t)},Ts.prototype.set=function(t,e){var n=this.__data__;if(n instanceof bs){var i=n.__data__;if(!ts||i.length<s-1)return i.push([t,e]),this.size=++n.size,this;n=this.__data__=new ws(i)}return n.set(t,e),this.size=n.size,this};var Xs=lr(qs),Ys=lr(Ks,!0);function Ws(t,e){var n=!0;return Xs(t,(function(t,s,i){return n=!!e(t,s,i)})),n}function zs(t,e,s){for(var i=-1,r=t.length;++i<r;){var a=t[i],o=e(a);if(null!=o&&(l===n?o==o&&!Uo(o):s(o,l)))var l=o,h=a}return h}function Gs(t,e){var n=[];return Xs(t,(function(t,s,i){e(t,s,i)&&n.push(t)})),n}function Hs(t,e,n,s,i){var r=-1,a=t.length;for(n||(n=Hr),i||(i=[]);++r<a;){var o=t[r];e>0&&n(o)?e>1?Hs(o,e-1,n,s,i):cn(i,o):s||(i[i.length]=o)}return i}var js=hr(),$s=hr(!0);function qs(t,e){return t&&js(t,e,hl)}function Ks(t,e){return t&&$s(t,e,hl)}function Zs(t,e){return an(e,(function(e){return Mo(t[e])}))}function Qs(t,e){for(var s=0,i=(e=$i(e,t)).length;null!=t&&s<i;)t=t[pa(e[s++])];return s&&s==i?t:n}function Js(t,e,n){var s=e(t);return wo(t)?s:cn(s,n(t))}function ti(t){return null==t?t===n?it:K:Pe&&Pe in ne(t)?function(t){var e=ue.call(t,Pe),s=t[Pe];try{t[Pe]=n;var i=!0}catch(_m){}var r=pe.call(t);i&&(e?t[Pe]=s:delete t[Pe]);return r}(t):function(t){return pe.call(t)}(t)}function ei(t,e){return t>e}function ni(t,e){return null!=t&&ue.call(t,e)}function si(t,e){return null!=t&&e in ne(t)}function ii(t,e,s){for(var i=s?ln:on,r=t[0].length,a=t.length,o=a,l=Zt(a),h=1/0,c=[];o--;){var u=t[o];o&&e&&(u=hn(u,Cn(e))),h=$n(u.length,h),l[o]=!s&&(e||r>=120&&u.length>=120)?new Es(o&&u):n}u=t[0];var d=-1,f=l[0];t:for(;++d<r&&c.length<h;){var p=u[d],m=e?e(p):p;if(p=s||0!==p?p:0,!(f?Mn(f,m):i(c,m,s))){for(o=a;--o;){var g=l[o];if(!(g?Mn(g,m):i(t[o],m,s)))continue t}f&&f.push(m),c.push(p)}}return c}function ri(t,e,s){var i=null==(t=na(t,e=$i(e,t)))?t:t[pa(Ca(e))];return null==i?n:tn(i,t,s)}function ai(t){return Fo(t)&&ti(t)==V}function oi(t,e,s,i,r){return t===e||(null==t||null==e||!Fo(t)&&!Fo(e)?t!=t&&e!=e:function(t,e,s,i,r,a){var o=wo(t),l=wo(e),h=o?U:Wr(t),c=l?U:Wr(e),u=(h=h==V?Z:h)==Z,d=(c=c==V?Z:c)==Z,m=h==c;if(m&&Ao(t)){if(!Ao(e))return!1;o=!0,u=!1}if(m&&!u)return a||(a=new Ts),o||Xo(t)?Rr(t,e,s,i,r,a):function(t,e,n,s,i,r,a){switch(n){case lt:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case ot:return!(t.byteLength!=e.byteLength||!r(new _e(t),new _e(e)));case Y:case W:case q:return xo(+t,+e);case G:return t.name==e.name&&t.message==e.message;case tt:case nt:return t==e+"";case $:var o=Ln;case et:var l=s&f;if(o||(o=Vn),t.size!=e.size&&!l)return!1;var h=a.get(t);if(h)return h==e;s|=p,a.set(t,e);var c=Rr(o(t),o(e),s,i,r,a);return a.delete(t),c;case st:if(fs)return fs.call(t)==fs.call(e)}return!1}(t,e,h,s,i,r,a);if(!(s&f)){var g=u&&ue.call(t,"__wrapped__"),v=d&&ue.call(e,"__wrapped__");if(g||v){var x=g?t.value():t,y=v?e.value():e;return a||(a=new Ts),r(x,y,s,i,a)}}if(!m)return!1;return a||(a=new Ts),function(t,e,s,i,r,a){var o=s&f,l=kr(t),h=l.length,c=kr(e),u=c.length;if(h!=u&&!o)return!1;var d=h;for(;d--;){var p=l[d];if(!(o?p in e:ue.call(e,p)))return!1}var m=a.get(t),g=a.get(e);if(m&&g)return m==e&&g==t;var v=!0;a.set(t,e),a.set(e,t);var x=o;for(;++d<h;){var y=t[p=l[d]],_=e[p];if(i)var b=o?i(_,y,p,e,t,a):i(y,_,p,t,e,a);if(!(b===n?y===_||r(y,_,s,i,a):b)){v=!1;break}x||(x="constructor"==p)}if(v&&!x){var w=t.constructor,E=e.constructor;w==E||!("constructor"in t)||!("constructor"in e)||"function"==typeof w&&w instanceof w&&"function"==typeof E&&E instanceof E||(v=!1)}return a.delete(t),a.delete(e),v}(t,e,s,i,r,a)}(t,e,s,i,oi,r))}function li(t,e,s,i){var r=s.length,a=r,o=!i;if(null==t)return!a;for(t=ne(t);r--;){var l=s[r];if(o&&l[2]?l[1]!==t[l[0]]:!(l[0]in t))return!1}for(;++r<a;){var h=(l=s[r])[0],c=t[h],u=l[1];if(o&&l[2]){if(c===n&&!(h in t))return!1}else{var d=new Ts;if(i)var m=i(c,u,h,t,e,d);if(!(m===n?oi(u,c,f|p,i,d):m))return!1}}return!0}function hi(t){return!(!ko(t)||(e=t,fe&&fe in e))&&(Mo(t)?ve:Gt).test(ma(t));var e}function ci(t){return"function"==typeof t?t:null==t?Dl:"object"==typeof t?wo(t)?gi(t[0],t[1]):mi(t):zl(t)}function ui(t){if(!Qr(t))return Hn(t);var e=[];for(var n in ne(t))ue.call(t,n)&&"constructor"!=n&&e.push(n);return e}function di(t){if(!ko(t))return function(t){var e=[];if(null!=t)for(var n in ne(t))e.push(n);return e}(t);var e=Qr(t),n=[];for(var s in t)("constructor"!=s||!e&&ue.call(t,s))&&n.push(s);return n}function fi(t,e){return t<e}function pi(t,e){var n=-1,s=To(t)?Zt(t.length):[];return Xs(t,(function(t,i,r){s[++n]=e(t,i,r)})),s}function mi(t){var e=Vr(t);return 1==e.length&&e[0][2]?ta(e[0][0],e[0][1]):function(n){return n===t||li(n,t,e)}}function gi(t,e){return qr(t)&&Jr(e)?ta(pa(t),e):function(s){var i=il(s,t);return i===n&&i===e?rl(s,t):oi(e,i,f|p)}}function vi(t,e,s,i,r){t!==e&&js(e,(function(a,o){if(r||(r=new Ts),ko(a))!function(t,e,s,i,r,a,o){var l=sa(t,s),h=sa(e,s),c=o.get(h);if(c)return void Ms(t,s,c);var u=a?a(l,h,s+"",t,e,o):n,d=u===n;if(d){var f=wo(h),p=!f&&Ao(h),m=!f&&!p&&Xo(h);u=h,f||p||m?wo(l)?u=l:So(l)?u=ir(l):p?(d=!1,u=Qi(h,!0)):m?(d=!1,u=tr(h,!0)):u=[]:Lo(h)||bo(h)?(u=l,bo(l)?u=qo(l):ko(l)&&!Mo(l)||(u=Gr(h))):d=!1}d&&(o.set(h,u),r(u,h,i,a,o),o.delete(h));Ms(t,s,u)}(t,e,o,s,vi,i,r);else{var l=i?i(sa(t,o),a,o+"",t,e,r):n;l===n&&(l=a),Ms(t,o,l)}}),cl)}function xi(t,e){var s=t.length;if(s)return jr(e+=e<0?s:0,s)?t[e]:n}function yi(t,e,n){e=e.length?hn(e,(function(t){return wo(t)?function(e){return Qs(e,1===t.length?t[0]:t)}:t})):[Dl];var s=-1;return e=hn(e,Cn(Nr())),function(t,e){var n=t.length;for(t.sort(e);n--;)t[n]=t[n].value;return t}(pi(t,(function(t,n,i){return{criteria:hn(e,(function(e){return e(t)})),index:++s,value:t}})),(function(t,e){return function(t,e,n){var s=-1,i=t.criteria,r=e.criteria,a=i.length,o=n.length;for(;++s<a;){var l=er(i[s],r[s]);if(l)return s>=o?l:l*("desc"==n[s]?-1:1)}return t.index-e.index}(t,e,n)}))}function _i(t,e,n){for(var s=-1,i=e.length,r={};++s<i;){var a=e[s],o=Qs(t,a);n(o,a)&&Ii(r,$i(a,t),o)}return r}function bi(t,e,n,s){var i=s?xn:vn,r=-1,a=e.length,o=t;for(t===e&&(e=ir(e)),n&&(o=hn(t,Cn(n)));++r<a;)for(var l=0,h=e[r],c=n?n(h):h;(l=i(o,c,l,s))>-1;)o!==t&&Se.call(o,l,1),Se.call(t,l,1);return t}function wi(t,e){for(var n=t?e.length:0,s=n-1;n--;){var i=e[n];if(n==s||i!==r){var r=i;jr(i)?Se.call(t,i,1):Ui(t,i)}}return t}function Ei(t,e){return t+He(Zn()*(e-t+1))}function Ti(t,e){var n="";if(!t||e<1||e>k)return n;do{e%2&&(n+=t),(e=He(e/2))&&(t+=t)}while(e);return n}function Si(t,e){return aa(ea(t,e,Dl),t+"")}function Ai(t){return As(xl(t))}function Ci(t,e){var n=xl(t);return ha(n,Ls(e,0,n.length))}function Ii(t,e,s,i){if(!ko(t))return t;for(var r=-1,a=(e=$i(e,t)).length,o=a-1,l=t;null!=l&&++r<a;){var h=pa(e[r]),c=s;if("__proto__"===h||"constructor"===h||"prototype"===h)return t;if(r!=o){var u=l[h];(c=i?i(u,h,l):n)===n&&(c=ko(u)?u:jr(e[r+1])?[]:{})}Rs(l,h,c),l=l[h]}return t}var Mi=rs?function(t,e){return rs.set(t,e),t}:Dl,Ri=Ne?function(t,e){return Ne(t,"toString",{configurable:!0,enumerable:!1,value:kl(e),writable:!0})}:Dl;function Pi(t){return ha(xl(t))}function ki(t,e,n){var s=-1,i=t.length;e<0&&(e=-e>i?0:i+e),(n=n>i?i:n)<0&&(n+=i),i=e>n?0:n-e>>>0,e>>>=0;for(var r=Zt(i);++s<i;)r[s]=t[s+e];return r}function Fi(t,e){var n;return Xs(t,(function(t,s,i){return!(n=e(t,s,i))})),!!n}function Oi(t,e,n){var s=0,i=null==t?s:t.length;if("number"==typeof e&&e==e&&i<=N){for(;s<i;){var r=s+i>>>1,a=t[r];null!==a&&!Uo(a)&&(n?a<=e:a<e)?s=r+1:i=r}return i}return Di(t,e,Dl,n)}function Di(t,e,s,i){var r=0,a=null==t?0:t.length;if(0===a)return 0;for(var o=(e=s(e))!=e,l=null===e,h=Uo(e),c=e===n;r<a;){var u=He((r+a)/2),d=s(t[u]),f=d!==n,p=null===d,m=d==d,g=Uo(d);if(o)var v=i||m;else v=c?m&&(i||f):l?m&&f&&(i||!p):h?m&&f&&!p&&(i||!g):!p&&!g&&(i?d<=e:d<e);v?r=u+1:a=u}return $n(a,L)}function Li(t,e){for(var n=-1,s=t.length,i=0,r=[];++n<s;){var a=t[n],o=e?e(a):a;if(!n||!xo(o,l)){var l=o;r[i++]=0===a?0:a}}return r}function Ni(t){return"number"==typeof t?t:Uo(t)?O:+t}function Bi(t){if("string"==typeof t)return t;if(wo(t))return hn(t,Bi)+"";if(Uo(t))return ps?ps.call(t):"";var e=t+"";return"0"==e&&1/t==-P?"-0":e}function Vi(t,e,n){var i=-1,r=on,a=t.length,o=!0,l=[],h=l;if(n)o=!1,r=ln;else if(a>=s){var c=e?null:Tr(t);if(c)return Vn(c);o=!1,r=Mn,h=new Es}else h=e?[]:l;t:for(;++i<a;){var u=t[i],d=e?e(u):u;if(u=n||0!==u?u:0,o&&d==d){for(var f=h.length;f--;)if(h[f]===d)continue t;e&&h.push(d),l.push(u)}else r(h,d,n)||(h!==l&&h.push(d),l.push(u))}return l}function Ui(t,e){return null==(t=na(t,e=$i(e,t)))||delete t[pa(Ca(e))]}function Xi(t,e,n,s){return Ii(t,e,n(Qs(t,e)),s)}function Yi(t,e,n,s){for(var i=t.length,r=s?i:-1;(s?r--:++r<i)&&e(t[r],r,t););return n?ki(t,s?0:r,s?r+1:i):ki(t,s?r+1:0,s?i:r)}function Wi(t,e){var n=t;return n instanceof ys&&(n=n.value()),un(e,(function(t,e){return e.func.apply(e.thisArg,cn([t],e.args))}),n)}function zi(t,e,n){var s=t.length;if(s<2)return s?Vi(t[0]):[];for(var i=-1,r=Zt(s);++i<s;)for(var a=t[i],o=-1;++o<s;)o!=i&&(r[i]=Us(r[i]||a,t[o],e,n));return Vi(Hs(r,1),e,n)}function Gi(t,e,s){for(var i=-1,r=t.length,a=e.length,o={};++i<r;){var l=i<a?e[i]:n;s(o,t[i],l)}return o}function Hi(t){return So(t)?t:[]}function ji(t){return"function"==typeof t?t:Dl}function $i(t,e){return wo(t)?t:qr(t,e)?[t]:fa(Ko(t))}var qi=Si;function Ki(t,e,s){var i=t.length;return s=s===n?i:s,!e&&s>=i?t:ki(t,e,s)}var Zi=Ue||function(t){return Ye.clearTimeout(t)};function Qi(t,e){if(e)return t.slice();var n=t.length,s=be?be(n):new t.constructor(n);return t.copy(s),s}function Ji(t){var e=new t.constructor(t.byteLength);return new _e(e).set(new _e(t)),e}function tr(t,e){var n=e?Ji(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.length)}function er(t,e){if(t!==e){var s=t!==n,i=null===t,r=t==t,a=Uo(t),o=e!==n,l=null===e,h=e==e,c=Uo(e);if(!l&&!c&&!a&&t>e||a&&o&&h&&!l&&!c||i&&o&&h||!s&&h||!r)return 1;if(!i&&!a&&!c&&t<e||c&&s&&r&&!i&&!a||l&&s&&r||!o&&r||!h)return-1}return 0}function nr(t,e,n,s){for(var i=-1,r=t.length,a=n.length,o=-1,l=e.length,h=jn(r-a,0),c=Zt(l+h),u=!s;++o<l;)c[o]=e[o];for(;++i<a;)(u||i<r)&&(c[n[i]]=t[i]);for(;h--;)c[o++]=t[i++];return c}function sr(t,e,n,s){for(var i=-1,r=t.length,a=-1,o=n.length,l=-1,h=e.length,c=jn(r-o,0),u=Zt(c+h),d=!s;++i<c;)u[i]=t[i];for(var f=i;++l<h;)u[f+l]=e[l];for(;++a<o;)(d||i<r)&&(u[f+n[a]]=t[i++]);return u}function ir(t,e){var n=-1,s=t.length;for(e||(e=Zt(s));++n<s;)e[n]=t[n];return e}function rr(t,e,s,i){var r=!s;s||(s={});for(var a=-1,o=e.length;++a<o;){var l=e[a],h=i?i(s[l],t[l],l,s,t):n;h===n&&(h=t[l]),r?Os(s,l,h):Rs(s,l,h)}return s}function ar(t,e){return function(n,s){var i=wo(n)?en:ks,r=e?e():{};return i(n,t,Nr(s,2),r)}}function or(t){return Si((function(e,s){var i=-1,r=s.length,a=r>1?s[r-1]:n,o=r>2?s[2]:n;for(a=t.length>3&&"function"==typeof a?(r--,a):n,o&&$r(s[0],s[1],o)&&(a=r<3?n:a,r=1),e=ne(e);++i<r;){var l=s[i];l&&t(e,l,i,a)}return e}))}function lr(t,e){return function(n,s){if(null==n)return n;if(!To(n))return t(n,s);for(var i=n.length,r=e?i:-1,a=ne(n);(e?r--:++r<i)&&!1!==s(a[r],r,a););return n}}function hr(t){return function(e,n,s){for(var i=-1,r=ne(e),a=s(e),o=a.length;o--;){var l=a[t?o:++i];if(!1===n(r[l],l,r))break}return e}}function cr(t){return function(e){var s=Dn(e=Ko(e))?Xn(e):n,i=s?s[0]:e.charAt(0),r=s?Ki(s,1).join(""):e.slice(1);return i[t]()+r}}function ur(t){return function(e){return un(Ml(bl(e).replace(Ce,"")),t,"")}}function dr(t){return function(){var e=arguments;switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3]);case 5:return new t(e[0],e[1],e[2],e[3],e[4]);case 6:return new t(e[0],e[1],e[2],e[3],e[4],e[5]);case 7:return new t(e[0],e[1],e[2],e[3],e[4],e[5],e[6])}var n=gs(t.prototype),s=t.apply(n,e);return ko(s)?s:n}}function fr(t){return function(e,s,i){var r=ne(e);if(!To(e)){var a=Nr(s,3);e=hl(e),s=function(t){return a(r[t],t,r)}}var o=t(e,s,i);return o>-1?r[a?e[o]:o]:n}}function pr(t){return Pr((function(e){var s=e.length,i=s,a=xs.prototype.thru;for(t&&e.reverse();i--;){var o=e[i];if("function"!=typeof o)throw new re(r);if(a&&!l&&"wrapper"==Dr(o))var l=new xs([],!0)}for(i=l?i:s;++i<s;){var h=Dr(o=e[i]),c="wrapper"==h?Or(o):n;l=c&&Kr(c[0])&&c[1]==(w|x|_|E)&&!c[4].length&&1==c[9]?l[Dr(c[0])].apply(l,c[3]):1==o.length&&Kr(o)?l[h]():l.thru(o)}return function(){var t=arguments,n=t[0];if(l&&1==t.length&&wo(n))return l.plant(n).value();for(var i=0,r=s?e[i].apply(this,t):n;++i<s;)r=e[i].call(this,r);return r}}))}function mr(t,e,s,i,r,a,o,l,h,c){var u=e&w,d=e&m,f=e&g,p=e&(x|y),v=e&T,_=f?n:dr(t);return function m(){for(var g=arguments.length,x=Zt(g),y=g;y--;)x[y]=arguments[y];if(p)var b=Lr(m),w=function(t,e){for(var n=t.length,s=0;n--;)t[n]===e&&++s;return s}(x,b);if(i&&(x=nr(x,i,r,p)),a&&(x=sr(x,a,o,p)),g-=w,p&&g<c){var E=Bn(x,b);return wr(t,e,mr,m.placeholder,s,x,E,l,h,c-g)}var T=d?s:this,S=f?T[t]:t;return g=x.length,l?x=function(t,e){var s=t.length,i=$n(e.length,s),r=ir(t);for(;i--;){var a=e[i];t[i]=jr(a,s)?r[a]:n}return t}(x,l):v&&g>1&&x.reverse(),u&&h<g&&(x.length=h),this&&this!==Ye&&this instanceof m&&(S=_||dr(S)),S.apply(T,x)}}function gr(t,e){return function(n,s){return function(t,e,n,s){return qs(t,(function(t,i,r){e(s,n(t),i,r)})),s}(n,t,e(s),{})}}function vr(t,e){return function(s,i){var r;if(s===n&&i===n)return e;if(s!==n&&(r=s),i!==n){if(r===n)return i;"string"==typeof s||"string"==typeof i?(s=Bi(s),i=Bi(i)):(s=Ni(s),i=Ni(i)),r=t(s,i)}return r}}function xr(t){return Pr((function(e){return e=hn(e,Cn(Nr())),Si((function(n){var s=this;return t(e,(function(t){return tn(t,s,n)}))}))}))}function yr(t,e){var s=(e=e===n?" ":Bi(e)).length;if(s<2)return s?Ti(e,t):e;var i=Ti(e,ze(t/Un(e)));return Dn(e)?Ki(Xn(i),0,t).join(""):i.slice(0,t)}function _r(t){return function(e,s,i){return i&&"number"!=typeof i&&$r(e,s,i)&&(s=i=n),e=Go(e),s===n?(s=e,e=0):s=Go(s),function(t,e,n,s){for(var i=-1,r=jn(ze((e-t)/(n||1)),0),a=Zt(r);r--;)a[s?r:++i]=t,t+=n;return a}(e,s,i=i===n?e<s?1:-1:Go(i),t)}}function br(t){return function(e,n){return"string"==typeof e&&"string"==typeof n||(e=$o(e),n=$o(n)),t(e,n)}}function wr(t,e,s,i,r,a,o,l,h,c){var u=e&x;e|=u?_:b,(e&=~(u?b:_))&v||(e&=~(m|g));var d=[t,e,r,u?a:n,u?o:n,u?n:a,u?n:o,l,h,c],f=s.apply(n,d);return Kr(t)&&ia(f,d),f.placeholder=i,oa(f,t,e)}function Er(t){var e=ee[t];return function(t,n){if(t=$o(t),(n=null==n?0:$n(Ho(n),292))&&wn(t)){var s=(Ko(t)+"e").split("e");return+((s=(Ko(e(s[0]+"e"+(+s[1]+n)))+"e").split("e"))[0]+"e"+(+s[1]-n))}return e(t)}}var Tr=ns&&1/Vn(new ns([,-0]))[1]==P?function(t){return new ns(t)}:Ul;function Sr(t){return function(e){var n=Wr(e);return n==$?Ln(e):n==et?function(t){var e=-1,n=Array(t.size);return t.forEach((function(t){n[++e]=[t,t]})),n}(e):function(t,e){return hn(e,(function(e){return[e,t[e]]}))}(e,t(e))}}function Ar(t,e,s,i,a,o,l,c){var u=e&g;if(!u&&"function"!=typeof t)throw new re(r);var d=i?i.length:0;if(d||(e&=~(_|b),i=a=n),l=l===n?l:jn(Ho(l),0),c=c===n?c:Ho(c),d-=a?a.length:0,e&b){var f=i,p=a;i=a=n}var T=u?n:Or(t),S=[t,e,s,i,a,f,p,o,l,c];if(T&&function(t,e){var n=t[1],s=e[1],i=n|s,r=i<(m|g|w),a=s==w&&n==x||s==w&&n==E&&t[7].length<=e[8]||s==(w|E)&&e[7].length<=e[8]&&n==x;if(!r&&!a)return t;s&m&&(t[2]=e[2],i|=n&m?0:v);var o=e[3];if(o){var l=t[3];t[3]=l?nr(l,o,e[4]):o,t[4]=l?Bn(t[3],h):e[4]}(o=e[5])&&(l=t[5],t[5]=l?sr(l,o,e[6]):o,t[6]=l?Bn(t[5],h):e[6]);(o=e[7])&&(t[7]=o);s&w&&(t[8]=null==t[8]?e[8]:$n(t[8],e[8]));null==t[9]&&(t[9]=e[9]);t[0]=e[0],t[1]=i}(S,T),t=S[0],e=S[1],s=S[2],i=S[3],a=S[4],!(c=S[9]=S[9]===n?u?0:t.length:jn(S[9]-d,0))&&e&(x|y)&&(e&=~(x|y)),e&&e!=m)A=e==x||e==y?function(t,e,s){var i=dr(t);return function r(){for(var a=arguments.length,o=Zt(a),l=a,h=Lr(r);l--;)o[l]=arguments[l];var c=a<3&&o[0]!==h&&o[a-1]!==h?[]:Bn(o,h);return(a-=c.length)<s?wr(t,e,mr,r.placeholder,n,o,c,n,n,s-a):tn(this&&this!==Ye&&this instanceof r?i:t,this,o)}}(t,e,c):e!=_&&e!=(m|_)||a.length?mr.apply(n,S):function(t,e,n,s){var i=e&m,r=dr(t);return function e(){for(var a=-1,o=arguments.length,l=-1,h=s.length,c=Zt(h+o),u=this&&this!==Ye&&this instanceof e?r:t;++l<h;)c[l]=s[l];for(;o--;)c[l++]=arguments[++a];return tn(u,i?n:this,c)}}(t,e,s,i);else var A=function(t,e,n){var s=e&m,i=dr(t);return function e(){return(this&&this!==Ye&&this instanceof e?i:t).apply(s?n:this,arguments)}}(t,e,s);return oa((T?Mi:ia)(A,S),t,e)}function Cr(t,e,s,i){return t===n||xo(t,le[s])&&!ue.call(i,s)?e:t}function Ir(t,e,s,i,r,a){return ko(t)&&ko(e)&&(a.set(e,t),vi(t,e,n,Ir,a),a.delete(e)),t}function Mr(t){return Lo(t)?n:t}function Rr(t,e,s,i,r,a){var o=s&f,l=t.length,h=e.length;if(l!=h&&!(o&&h>l))return!1;var c=a.get(t),u=a.get(e);if(c&&u)return c==e&&u==t;var d=-1,m=!0,g=s&p?new Es:n;for(a.set(t,e),a.set(e,t);++d<l;){var v=t[d],x=e[d];if(i)var y=o?i(x,v,d,e,t,a):i(v,x,d,t,e,a);if(y!==n){if(y)continue;m=!1;break}if(g){if(!fn(e,(function(t,e){if(!Mn(g,e)&&(v===t||r(v,t,s,i,a)))return g.push(e)}))){m=!1;break}}else if(v!==x&&!r(v,x,s,i,a)){m=!1;break}}return a.delete(t),a.delete(e),m}function Pr(t){return aa(ea(t,n,wa),t+"")}function kr(t){return Js(t,hl,Xr)}function Fr(t){return Js(t,cl,Yr)}var Or=rs?function(t){return rs.get(t)}:Ul;function Dr(t){for(var e=t.name+"",n=as[e],s=ue.call(as,e)?n.length:0;s--;){var i=n[s],r=i.func;if(null==r||r==t)return i.name}return e}function Lr(t){return(ue.call(ms,"placeholder")?ms:t).placeholder}function Nr(){var t=ms.iteratee||Ll;return t=t===Ll?ci:t,arguments.length?t(arguments[0],arguments[1]):t}function Br(t,e){var n,s,i=t.__data__;return("string"==(s=typeof(n=e))||"number"==s||"symbol"==s||"boolean"==s?"__proto__"!==n:null===n)?i["string"==typeof e?"string":"hash"]:i.map}function Vr(t){for(var e=hl(t),n=e.length;n--;){var s=e[n],i=t[s];e[n]=[s,i,Jr(i)]}return e}function Ur(t,e){var s=function(t,e){return null==t?n:t[e]}(t,e);return hi(s)?s:n}var Xr=je?function(t){return null==t?[]:(t=ne(t),an(je(t),(function(e){return Te.call(t,e)})))}:jl,Yr=je?function(t){for(var e=[];t;)cn(e,Xr(t)),t=we(t);return e}:jl,Wr=ti;function zr(t,e,n){for(var s=-1,i=(e=$i(e,t)).length,r=!1;++s<i;){var a=pa(e[s]);if(!(r=null!=t&&n(t,a)))break;t=t[a]}return r||++s!=i?r:!!(i=null==t?0:t.length)&&Po(i)&&jr(a,i)&&(wo(t)||bo(t))}function Gr(t){return"function"!=typeof t.constructor||Qr(t)?{}:gs(we(t))}function Hr(t){return wo(t)||bo(t)||!!(Ae&&t&&t[Ae])}function jr(t,e){var n=typeof t;return!!(e=null==e?k:e)&&("number"==n||"symbol"!=n&&jt.test(t))&&t>-1&&t%1==0&&t<e}function $r(t,e,n){if(!ko(n))return!1;var s=typeof e;return!!("number"==s?To(n)&&jr(e,n.length):"string"==s&&e in n)&&xo(n[e],t)}function qr(t,e){if(wo(t))return!1;var n=typeof t;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=t&&!Uo(t))||(Mt.test(t)||!It.test(t)||null!=e&&t in ne(e))}function Kr(t){var e=Dr(t),n=ms[e];if("function"!=typeof n||!(e in ys.prototype))return!1;if(t===n)return!0;var s=Or(n);return!!s&&t===s[0]}(Jn&&Wr(new Jn(new ArrayBuffer(1)))!=lt||ts&&Wr(new ts)!=$||es&&Wr(es.resolve())!=Q||ns&&Wr(new ns)!=et||ss&&Wr(new ss)!=rt)&&(Wr=function(t){var e=ti(t),s=e==Z?t.constructor:n,i=s?ma(s):"";if(i)switch(i){case os:return lt;case ls:return $;case hs:return Q;case cs:return et;case us:return rt}return e});var Zr=he?Mo:$l;function Qr(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||le)}function Jr(t){return t==t&&!ko(t)}function ta(t,e){return function(s){return null!=s&&(s[t]===e&&(e!==n||t in ne(s)))}}function ea(t,e,s){return e=jn(e===n?t.length-1:e,0),function(){for(var n=arguments,i=-1,r=jn(n.length-e,0),a=Zt(r);++i<r;)a[i]=n[e+i];i=-1;for(var o=Zt(e+1);++i<e;)o[i]=n[i];return o[e]=s(a),tn(t,this,o)}}function na(t,e){return e.length<2?t:Qs(t,ki(e,0,-1))}function sa(t,e){if(("constructor"!==e||"function"!=typeof t[e])&&"__proto__"!=e)return t[e]}var ia=la(Mi),ra=We||function(t,e){return Ye.setTimeout(t,e)},aa=la(Ri);function oa(t,e,n){var s=e+"";return aa(t,function(t,e){var n=e.length;if(!n)return t;var s=n-1;return e[s]=(n>1?"& ":"")+e[s],e=e.join(n>2?", ":" "),t.replace(Dt,"{\n/* [wrapped with "+e+"] */\n")}(s,function(t,e){return nn(B,(function(n){var s="_."+n[0];e&n[1]&&!on(t,s)&&t.push(s)})),t.sort()}(function(t){var e=t.match(Lt);return e?e[1].split(Nt):[]}(s),n)))}function la(t){var e=0,s=0;return function(){var i=qn(),r=I-(i-s);if(s=i,r>0){if(++e>=C)return arguments[0]}else e=0;return t.apply(n,arguments)}}function ha(t,e){var s=-1,i=t.length,r=i-1;for(e=e===n?i:e;++s<e;){var a=Ei(s,r),o=t[a];t[a]=t[s],t[s]=o}return t.length=e,t}var ca,ua,da,fa=(ca=function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(Rt,(function(t,n,s,i){e.push(s?i.replace(Ut,"$1"):n||t)})),e},ua=uo(ca,(function(t){return da.size===l&&da.clear(),t})),da=ua.cache,ua);function pa(t){if("string"==typeof t||Uo(t))return t;var e=t+"";return"0"==e&&1/t==-P?"-0":e}function ma(t){if(null!=t){try{return ce.call(t)}catch(_m){}try{return t+""}catch(_m){}}return""}function ga(t){if(t instanceof ys)return t.clone();var e=new xs(t.__wrapped__,t.__chain__);return e.__actions__=ir(t.__actions__),e.__index__=t.__index__,e.__values__=t.__values__,e}var va=Si((function(t,e){return So(t)?Us(t,Hs(e,1,So,!0)):[]})),xa=Si((function(t,e){var s=Ca(e);return So(s)&&(s=n),So(t)?Us(t,Hs(e,1,So,!0),Nr(s,2)):[]})),ya=Si((function(t,e){var s=Ca(e);return So(s)&&(s=n),So(t)?Us(t,Hs(e,1,So,!0),n,s):[]}));function _a(t,e,n){var s=null==t?0:t.length;if(!s)return-1;var i=null==n?0:Ho(n);return i<0&&(i=jn(s+i,0)),gn(t,Nr(e,3),i)}function ba(t,e,s){var i=null==t?0:t.length;if(!i)return-1;var r=i-1;return s!==n&&(r=Ho(s),r=s<0?jn(i+r,0):$n(r,i-1)),gn(t,Nr(e,3),r,!0)}function wa(t){return(null==t?0:t.length)?Hs(t,1):[]}function Ea(t){return t&&t.length?t[0]:n}var Ta=Si((function(t){var e=hn(t,Hi);return e.length&&e[0]===t[0]?ii(e):[]})),Sa=Si((function(t){var e=Ca(t),s=hn(t,Hi);return e===Ca(s)?e=n:s.pop(),s.length&&s[0]===t[0]?ii(s,Nr(e,2)):[]})),Aa=Si((function(t){var e=Ca(t),s=hn(t,Hi);return(e="function"==typeof e?e:n)&&s.pop(),s.length&&s[0]===t[0]?ii(s,n,e):[]}));function Ca(t){var e=null==t?0:t.length;return e?t[e-1]:n}var Ia=Si(Ma);function Ma(t,e){return t&&t.length&&e&&e.length?bi(t,e):t}var Ra=Pr((function(t,e){var n=null==t?0:t.length,s=Ds(t,e);return wi(t,hn(e,(function(t){return jr(t,n)?+t:t})).sort(er)),s}));function Pa(t){return null==t?t:Qn.call(t)}var ka=Si((function(t){return Vi(Hs(t,1,So,!0))})),Fa=Si((function(t){var e=Ca(t);return So(e)&&(e=n),Vi(Hs(t,1,So,!0),Nr(e,2))})),Oa=Si((function(t){var e=Ca(t);return e="function"==typeof e?e:n,Vi(Hs(t,1,So,!0),n,e)}));function Da(t){if(!t||!t.length)return[];var e=0;return t=an(t,(function(t){if(So(t))return e=jn(t.length,e),!0})),Sn(e,(function(e){return hn(t,bn(e))}))}function La(t,e){if(!t||!t.length)return[];var s=Da(t);return null==e?s:hn(s,(function(t){return tn(e,n,t)}))}var Na=Si((function(t,e){return So(t)?Us(t,e):[]})),Ba=Si((function(t){return zi(an(t,So))})),Va=Si((function(t){var e=Ca(t);return So(e)&&(e=n),zi(an(t,So),Nr(e,2))})),Ua=Si((function(t){var e=Ca(t);return e="function"==typeof e?e:n,zi(an(t,So),n,e)})),Xa=Si(Da);var Ya=Si((function(t){var e=t.length,s=e>1?t[e-1]:n;return s="function"==typeof s?(t.pop(),s):n,La(t,s)}));function Wa(t){var e=ms(t);return e.__chain__=!0,e}function za(t,e){return e(t)}var Ga=Pr((function(t){var e=t.length,s=e?t[0]:0,i=this.__wrapped__,r=function(e){return Ds(e,t)};return!(e>1||this.__actions__.length)&&i instanceof ys&&jr(s)?((i=i.slice(s,+s+(e?1:0))).__actions__.push({func:za,args:[r],thisArg:n}),new xs(i,this.__chain__).thru((function(t){return e&&!t.length&&t.push(n),t}))):this.thru(r)}));var Ha=ar((function(t,e,n){ue.call(t,n)?++t[n]:Os(t,n,1)}));var ja=fr(_a),$a=fr(ba);function qa(t,e){return(wo(t)?nn:Xs)(t,Nr(e,3))}function Ka(t,e){return(wo(t)?sn:Ys)(t,Nr(e,3))}var Za=ar((function(t,e,n){ue.call(t,n)?t[n].push(e):Os(t,n,[e])}));var Qa=Si((function(t,e,n){var s=-1,i="function"==typeof e,r=To(t)?Zt(t.length):[];return Xs(t,(function(t){r[++s]=i?tn(e,t,n):ri(t,e,n)})),r})),Ja=ar((function(t,e,n){Os(t,n,e)}));function to(t,e){return(wo(t)?hn:pi)(t,Nr(e,3))}var eo=ar((function(t,e,n){t[n?0:1].push(e)}),(function(){return[[],[]]}));var no=Si((function(t,e){if(null==t)return[];var n=e.length;return n>1&&$r(t,e[0],e[1])?e=[]:n>2&&$r(e[0],e[1],e[2])&&(e=[e[0]]),yi(t,Hs(e,1),[])})),so=Xe||function(){return Ye.Date.now()};function io(t,e,s){return e=s?n:e,e=t&&null==e?t.length:e,Ar(t,w,n,n,n,n,e)}function ro(t,e){var s;if("function"!=typeof e)throw new re(r);return t=Ho(t),function(){return--t>0&&(s=e.apply(this,arguments)),t<=1&&(e=n),s}}var ao=Si((function(t,e,n){var s=m;if(n.length){var i=Bn(n,Lr(ao));s|=_}return Ar(t,s,e,n,i)})),oo=Si((function(t,e,n){var s=m|g;if(n.length){var i=Bn(n,Lr(oo));s|=_}return Ar(e,s,t,n,i)}));function lo(t,e,s){var i,a,o,l,h,c,u=0,d=!1,f=!1,p=!0;if("function"!=typeof t)throw new re(r);function m(e){var s=i,r=a;return i=a=n,u=e,l=t.apply(r,s)}function g(t){var s=t-c;return c===n||s>=e||s<0||f&&t-u>=o}function v(){var t=so();if(g(t))return x(t);h=ra(v,function(t){var n=e-(t-c);return f?$n(n,o-(t-u)):n}(t))}function x(t){return h=n,p&&i?m(t):(i=a=n,l)}function y(){var t=so(),s=g(t);if(i=arguments,a=this,c=t,s){if(h===n)return function(t){return u=t,h=ra(v,e),d?m(t):l}(c);if(f)return Zi(h),h=ra(v,e),m(c)}return h===n&&(h=ra(v,e)),l}return e=$o(e)||0,ko(s)&&(d=!!s.leading,o=(f="maxWait"in s)?jn($o(s.maxWait)||0,e):o,p="trailing"in s?!!s.trailing:p),y.cancel=function(){h!==n&&Zi(h),u=0,i=c=a=h=n},y.flush=function(){return h===n?l:x(so())},y}var ho=Si((function(t,e){return Vs(t,1,e)})),co=Si((function(t,e,n){return Vs(t,$o(e)||0,n)}));function uo(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new re(r);var n=function(){var s=arguments,i=e?e.apply(this,s):s[0],r=n.cache;if(r.has(i))return r.get(i);var a=t.apply(this,s);return n.cache=r.set(i,a)||r,a};return n.cache=new(uo.Cache||ws),n}function fo(t){if("function"!=typeof t)throw new re(r);return function(){var e=arguments;switch(e.length){case 0:return!t.call(this);case 1:return!t.call(this,e[0]);case 2:return!t.call(this,e[0],e[1]);case 3:return!t.call(this,e[0],e[1],e[2])}return!t.apply(this,e)}}uo.Cache=ws;var po=qi((function(t,e){var n=(e=1==e.length&&wo(e[0])?hn(e[0],Cn(Nr())):hn(Hs(e,1),Cn(Nr()))).length;return Si((function(s){for(var i=-1,r=$n(s.length,n);++i<r;)s[i]=e[i].call(this,s[i]);return tn(t,this,s)}))})),mo=Si((function(t,e){var s=Bn(e,Lr(mo));return Ar(t,_,n,e,s)})),go=Si((function(t,e){var s=Bn(e,Lr(go));return Ar(t,b,n,e,s)})),vo=Pr((function(t,e){return Ar(t,E,n,n,n,e)}));function xo(t,e){return t===e||t!=t&&e!=e}var yo=br(ei),_o=br((function(t,e){return t>=e})),bo=ai(function(){return arguments}())?ai:function(t){return Fo(t)&&ue.call(t,"callee")&&!Te.call(t,"callee")},wo=Zt.isArray,Eo=$e?Cn($e):function(t){return Fo(t)&&ti(t)==ot};function To(t){return null!=t&&Po(t.length)&&!Mo(t)}function So(t){return Fo(t)&&To(t)}var Ao=pn||$l,Co=qe?Cn(qe):function(t){return Fo(t)&&ti(t)==W};function Io(t){if(!Fo(t))return!1;var e=ti(t);return e==G||e==z||"string"==typeof t.message&&"string"==typeof t.name&&!Lo(t)}function Mo(t){if(!ko(t))return!1;var e=ti(t);return e==H||e==j||e==X||e==J}function Ro(t){return"number"==typeof t&&t==Ho(t)}function Po(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=k}function ko(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}function Fo(t){return null!=t&&"object"==typeof t}var Oo=Ke?Cn(Ke):function(t){return Fo(t)&&Wr(t)==$};function Do(t){return"number"==typeof t||Fo(t)&&ti(t)==q}function Lo(t){if(!Fo(t)||ti(t)!=Z)return!1;var e=we(t);if(null===e)return!0;var n=ue.call(e,"constructor")&&e.constructor;return"function"==typeof n&&n instanceof n&&ce.call(n)==me}var No=Ze?Cn(Ze):function(t){return Fo(t)&&ti(t)==tt};var Bo=Qe?Cn(Qe):function(t){return Fo(t)&&Wr(t)==et};function Vo(t){return"string"==typeof t||!wo(t)&&Fo(t)&&ti(t)==nt}function Uo(t){return"symbol"==typeof t||Fo(t)&&ti(t)==st}var Xo=Je?Cn(Je):function(t){return Fo(t)&&Po(t.length)&&!!De[ti(t)]};var Yo=br(fi),Wo=br((function(t,e){return t<=e}));function zo(t){if(!t)return[];if(To(t))return Vo(t)?Xn(t):ir(t);if(Me&&t[Me])return function(t){for(var e,n=[];!(e=t.next()).done;)n.push(e.value);return n}(t[Me]());var e=Wr(t);return(e==$?Ln:e==et?Vn:xl)(t)}function Go(t){return t?(t=$o(t))===P||t===-P?(t<0?-1:1)*F:t==t?t:0:0===t?t:0}function Ho(t){var e=Go(t),n=e%1;return e==e?n?e-n:e:0}function jo(t){return t?Ls(Ho(t),0,D):0}function $o(t){if("number"==typeof t)return t;if(Uo(t))return O;if(ko(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=ko(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=An(t);var n=zt.test(t);return n||Ht.test(t)?Ve(t.slice(2),n?2:8):Wt.test(t)?O:+t}function qo(t){return rr(t,cl(t))}function Ko(t){return null==t?"":Bi(t)}var Zo=or((function(t,e){if(Qr(e)||To(e))rr(e,hl(e),t);else for(var n in e)ue.call(e,n)&&Rs(t,n,e[n])})),Qo=or((function(t,e){rr(e,cl(e),t)})),Jo=or((function(t,e,n,s){rr(e,cl(e),t,s)})),tl=or((function(t,e,n,s){rr(e,hl(e),t,s)})),el=Pr(Ds);var nl=Si((function(t,e){t=ne(t);var s=-1,i=e.length,r=i>2?e[2]:n;for(r&&$r(e[0],e[1],r)&&(i=1);++s<i;)for(var a=e[s],o=cl(a),l=-1,h=o.length;++l<h;){var c=o[l],u=t[c];(u===n||xo(u,le[c])&&!ue.call(t,c))&&(t[c]=a[c])}return t})),sl=Si((function(t){return t.push(n,Ir),tn(dl,n,t)}));function il(t,e,s){var i=null==t?n:Qs(t,e);return i===n?s:i}function rl(t,e){return null!=t&&zr(t,e,si)}var al=gr((function(t,e,n){null!=e&&"function"!=typeof e.toString&&(e=pe.call(e)),t[e]=n}),kl(Dl)),ol=gr((function(t,e,n){null!=e&&"function"!=typeof e.toString&&(e=pe.call(e)),ue.call(t,e)?t[e].push(n):t[e]=[n]}),Nr),ll=Si(ri);function hl(t){return To(t)?Ss(t):ui(t)}function cl(t){return To(t)?Ss(t,!0):di(t)}var ul=or((function(t,e,n){vi(t,e,n)})),dl=or((function(t,e,n,s){vi(t,e,n,s)})),fl=Pr((function(t,e){var n={};if(null==t)return n;var s=!1;e=hn(e,(function(e){return e=$i(e,t),s||(s=e.length>1),e})),rr(t,Fr(t),n),s&&(n=Ns(n,c|u|d,Mr));for(var i=e.length;i--;)Ui(n,e[i]);return n}));var pl=Pr((function(t,e){return null==t?{}:function(t,e){return _i(t,e,(function(e,n){return rl(t,n)}))}(t,e)}));function ml(t,e){if(null==t)return{};var n=hn(Fr(t),(function(t){return[t]}));return e=Nr(e),_i(t,n,(function(t,n){return e(t,n[0])}))}var gl=Sr(hl),vl=Sr(cl);function xl(t){return null==t?[]:In(t,hl(t))}var yl=ur((function(t,e,n){return e=e.toLowerCase(),t+(n?_l(e):e)}));function _l(t){return Il(Ko(t).toLowerCase())}function bl(t){return(t=Ko(t))&&t.replace($t,kn).replace(Ie,"")}var wl=ur((function(t,e,n){return t+(n?"-":"")+e.toLowerCase()})),El=ur((function(t,e,n){return t+(n?" ":"")+e.toLowerCase()})),Tl=cr("toLowerCase");var Sl=ur((function(t,e,n){return t+(n?"_":"")+e.toLowerCase()}));var Al=ur((function(t,e,n){return t+(n?" ":"")+Il(e)}));var Cl=ur((function(t,e,n){return t+(n?" ":"")+e.toUpperCase()})),Il=cr("toUpperCase");function Ml(t,e,s){return t=Ko(t),(e=s?n:e)===n?function(t){return ke.test(t)}(t)?function(t){return t.match(Re)||[]}(t):function(t){return t.match(Bt)||[]}(t):t.match(e)||[]}var Rl=Si((function(t,e){try{return tn(t,n,e)}catch(_m){return Io(_m)?_m:new Jt(_m)}})),Pl=Pr((function(t,e){return nn(e,(function(e){e=pa(e),Os(t,e,ao(t[e],t))})),t}));function kl(t){return function(){return t}}var Fl=pr(),Ol=pr(!0);function Dl(t){return t}function Ll(t){return ci("function"==typeof t?t:Ns(t,c))}var Nl=Si((function(t,e){return function(n){return ri(n,t,e)}})),Bl=Si((function(t,e){return function(n){return ri(t,n,e)}}));function Vl(t,e,n){var s=hl(e),i=Zs(e,s);null!=n||ko(e)&&(i.length||!s.length)||(n=e,e=t,t=this,i=Zs(e,hl(e)));var r=!(ko(n)&&"chain"in n&&!n.chain),a=Mo(t);return nn(i,(function(n){var s=e[n];t[n]=s,a&&(t.prototype[n]=function(){var e=this.__chain__;if(r||e){var n=t(this.__wrapped__);return(n.__actions__=ir(this.__actions__)).push({func:s,args:arguments,thisArg:t}),n.__chain__=e,n}return s.apply(t,cn([this.value()],arguments))})})),t}function Ul(){}var Xl=xr(hn),Yl=xr(rn),Wl=xr(fn);function zl(t){return qr(t)?bn(pa(t)):function(t){return function(e){return Qs(e,t)}}(t)}var Gl=_r(),Hl=_r(!0);function jl(){return[]}function $l(){return!1}var ql=vr((function(t,e){return t+e}),0),Kl=Er("ceil"),Zl=vr((function(t,e){return t/e}),1),Ql=Er("floor");var Jl,th=vr((function(t,e){return t*e}),1),eh=Er("round"),nh=vr((function(t,e){return t-e}),0);return ms.after=function(t,e){if("function"!=typeof e)throw new re(r);return t=Ho(t),function(){if(--t<1)return e.apply(this,arguments)}},ms.ary=io,ms.assign=Zo,ms.assignIn=Qo,ms.assignInWith=Jo,ms.assignWith=tl,ms.at=el,ms.before=ro,ms.bind=ao,ms.bindAll=Pl,ms.bindKey=oo,ms.castArray=function(){if(!arguments.length)return[];var t=arguments[0];return wo(t)?t:[t]},ms.chain=Wa,ms.chunk=function(t,e,s){e=(s?$r(t,e,s):e===n)?1:jn(Ho(e),0);var i=null==t?0:t.length;if(!i||e<1)return[];for(var r=0,a=0,o=Zt(ze(i/e));r<i;)o[a++]=ki(t,r,r+=e);return o},ms.compact=function(t){for(var e=-1,n=null==t?0:t.length,s=0,i=[];++e<n;){var r=t[e];r&&(i[s++]=r)}return i},ms.concat=function(){var t=arguments.length;if(!t)return[];for(var e=Zt(t-1),n=arguments[0],s=t;s--;)e[s-1]=arguments[s];return cn(wo(n)?ir(n):[n],Hs(e,1))},ms.cond=function(t){var e=null==t?0:t.length,n=Nr();return t=e?hn(t,(function(t){if("function"!=typeof t[1])throw new re(r);return[n(t[0]),t[1]]})):[],Si((function(n){for(var s=-1;++s<e;){var i=t[s];if(tn(i[0],this,n))return tn(i[1],this,n)}}))},ms.conforms=function(t){return function(t){var e=hl(t);return function(n){return Bs(n,t,e)}}(Ns(t,c))},ms.constant=kl,ms.countBy=Ha,ms.create=function(t,e){var n=gs(t);return null==e?n:Fs(n,e)},ms.curry=function t(e,s,i){var r=Ar(e,x,n,n,n,n,n,s=i?n:s);return r.placeholder=t.placeholder,r},ms.curryRight=function t(e,s,i){var r=Ar(e,y,n,n,n,n,n,s=i?n:s);return r.placeholder=t.placeholder,r},ms.debounce=lo,ms.defaults=nl,ms.defaultsDeep=sl,ms.defer=ho,ms.delay=co,ms.difference=va,ms.differenceBy=xa,ms.differenceWith=ya,ms.drop=function(t,e,s){var i=null==t?0:t.length;return i?ki(t,(e=s||e===n?1:Ho(e))<0?0:e,i):[]},ms.dropRight=function(t,e,s){var i=null==t?0:t.length;return i?ki(t,0,(e=i-(e=s||e===n?1:Ho(e)))<0?0:e):[]},ms.dropRightWhile=function(t,e){return t&&t.length?Yi(t,Nr(e,3),!0,!0):[]},ms.dropWhile=function(t,e){return t&&t.length?Yi(t,Nr(e,3),!0):[]},ms.fill=function(t,e,s,i){var r=null==t?0:t.length;return r?(s&&"number"!=typeof s&&$r(t,e,s)&&(s=0,i=r),function(t,e,s,i){var r=t.length;for((s=Ho(s))<0&&(s=-s>r?0:r+s),(i=i===n||i>r?r:Ho(i))<0&&(i+=r),i=s>i?0:jo(i);s<i;)t[s++]=e;return t}(t,e,s,i)):[]},ms.filter=function(t,e){return(wo(t)?an:Gs)(t,Nr(e,3))},ms.flatMap=function(t,e){return Hs(to(t,e),1)},ms.flatMapDeep=function(t,e){return Hs(to(t,e),P)},ms.flatMapDepth=function(t,e,s){return s=s===n?1:Ho(s),Hs(to(t,e),s)},ms.flatten=wa,ms.flattenDeep=function(t){return(null==t?0:t.length)?Hs(t,P):[]},ms.flattenDepth=function(t,e){return(null==t?0:t.length)?Hs(t,e=e===n?1:Ho(e)):[]},ms.flip=function(t){return Ar(t,T)},ms.flow=Fl,ms.flowRight=Ol,ms.fromPairs=function(t){for(var e=-1,n=null==t?0:t.length,s={};++e<n;){var i=t[e];s[i[0]]=i[1]}return s},ms.functions=function(t){return null==t?[]:Zs(t,hl(t))},ms.functionsIn=function(t){return null==t?[]:Zs(t,cl(t))},ms.groupBy=Za,ms.initial=function(t){return(null==t?0:t.length)?ki(t,0,-1):[]},ms.intersection=Ta,ms.intersectionBy=Sa,ms.intersectionWith=Aa,ms.invert=al,ms.invertBy=ol,ms.invokeMap=Qa,ms.iteratee=Ll,ms.keyBy=Ja,ms.keys=hl,ms.keysIn=cl,ms.map=to,ms.mapKeys=function(t,e){var n={};return e=Nr(e,3),qs(t,(function(t,s,i){Os(n,e(t,s,i),t)})),n},ms.mapValues=function(t,e){var n={};return e=Nr(e,3),qs(t,(function(t,s,i){Os(n,s,e(t,s,i))})),n},ms.matches=function(t){return mi(Ns(t,c))},ms.matchesProperty=function(t,e){return gi(t,Ns(e,c))},ms.memoize=uo,ms.merge=ul,ms.mergeWith=dl,ms.method=Nl,ms.methodOf=Bl,ms.mixin=Vl,ms.negate=fo,ms.nthArg=function(t){return t=Ho(t),Si((function(e){return xi(e,t)}))},ms.omit=fl,ms.omitBy=function(t,e){return ml(t,fo(Nr(e)))},ms.once=function(t){return ro(2,t)},ms.orderBy=function(t,e,s,i){return null==t?[]:(wo(e)||(e=null==e?[]:[e]),wo(s=i?n:s)||(s=null==s?[]:[s]),yi(t,e,s))},ms.over=Xl,ms.overArgs=po,ms.overEvery=Yl,ms.overSome=Wl,ms.partial=mo,ms.partialRight=go,ms.partition=eo,ms.pick=pl,ms.pickBy=ml,ms.property=zl,ms.propertyOf=function(t){return function(e){return null==t?n:Qs(t,e)}},ms.pull=Ia,ms.pullAll=Ma,ms.pullAllBy=function(t,e,n){return t&&t.length&&e&&e.length?bi(t,e,Nr(n,2)):t},ms.pullAllWith=function(t,e,s){return t&&t.length&&e&&e.length?bi(t,e,n,s):t},ms.pullAt=Ra,ms.range=Gl,ms.rangeRight=Hl,ms.rearg=vo,ms.reject=function(t,e){return(wo(t)?an:Gs)(t,fo(Nr(e,3)))},ms.remove=function(t,e){var n=[];if(!t||!t.length)return n;var s=-1,i=[],r=t.length;for(e=Nr(e,3);++s<r;){var a=t[s];e(a,s,t)&&(n.push(a),i.push(s))}return wi(t,i),n},ms.rest=function(t,e){if("function"!=typeof t)throw new re(r);return Si(t,e=e===n?e:Ho(e))},ms.reverse=Pa,ms.sampleSize=function(t,e,s){return e=(s?$r(t,e,s):e===n)?1:Ho(e),(wo(t)?Cs:Ci)(t,e)},ms.set=function(t,e,n){return null==t?t:Ii(t,e,n)},ms.setWith=function(t,e,s,i){return i="function"==typeof i?i:n,null==t?t:Ii(t,e,s,i)},ms.shuffle=function(t){return(wo(t)?Is:Pi)(t)},ms.slice=function(t,e,s){var i=null==t?0:t.length;return i?(s&&"number"!=typeof s&&$r(t,e,s)?(e=0,s=i):(e=null==e?0:Ho(e),s=s===n?i:Ho(s)),ki(t,e,s)):[]},ms.sortBy=no,ms.sortedUniq=function(t){return t&&t.length?Li(t):[]},ms.sortedUniqBy=function(t,e){return t&&t.length?Li(t,Nr(e,2)):[]},ms.split=function(t,e,s){return s&&"number"!=typeof s&&$r(t,e,s)&&(e=s=n),(s=s===n?D:s>>>0)?(t=Ko(t))&&("string"==typeof e||null!=e&&!No(e))&&!(e=Bi(e))&&Dn(t)?Ki(Xn(t),0,s):t.split(e,s):[]},ms.spread=function(t,e){if("function"!=typeof t)throw new re(r);return e=null==e?0:jn(Ho(e),0),Si((function(n){var s=n[e],i=Ki(n,0,e);return s&&cn(i,s),tn(t,this,i)}))},ms.tail=function(t){var e=null==t?0:t.length;return e?ki(t,1,e):[]},ms.take=function(t,e,s){return t&&t.length?ki(t,0,(e=s||e===n?1:Ho(e))<0?0:e):[]},ms.takeRight=function(t,e,s){var i=null==t?0:t.length;return i?ki(t,(e=i-(e=s||e===n?1:Ho(e)))<0?0:e,i):[]},ms.takeRightWhile=function(t,e){return t&&t.length?Yi(t,Nr(e,3),!1,!0):[]},ms.takeWhile=function(t,e){return t&&t.length?Yi(t,Nr(e,3)):[]},ms.tap=function(t,e){return e(t),t},ms.throttle=function(t,e,n){var s=!0,i=!0;if("function"!=typeof t)throw new re(r);return ko(n)&&(s="leading"in n?!!n.leading:s,i="trailing"in n?!!n.trailing:i),lo(t,e,{leading:s,maxWait:e,trailing:i})},ms.thru=za,ms.toArray=zo,ms.toPairs=gl,ms.toPairsIn=vl,ms.toPath=function(t){return wo(t)?hn(t,pa):Uo(t)?[t]:ir(fa(Ko(t)))},ms.toPlainObject=qo,ms.transform=function(t,e,n){var s=wo(t),i=s||Ao(t)||Xo(t);if(e=Nr(e,4),null==n){var r=t&&t.constructor;n=i?s?new r:[]:ko(t)&&Mo(r)?gs(we(t)):{}}return(i?nn:qs)(t,(function(t,s,i){return e(n,t,s,i)})),n},ms.unary=function(t){return io(t,1)},ms.union=ka,ms.unionBy=Fa,ms.unionWith=Oa,ms.uniq=function(t){return t&&t.length?Vi(t):[]},ms.uniqBy=function(t,e){return t&&t.length?Vi(t,Nr(e,2)):[]},ms.uniqWith=function(t,e){return e="function"==typeof e?e:n,t&&t.length?Vi(t,n,e):[]},ms.unset=function(t,e){return null==t||Ui(t,e)},ms.unzip=Da,ms.unzipWith=La,ms.update=function(t,e,n){return null==t?t:Xi(t,e,ji(n))},ms.updateWith=function(t,e,s,i){return i="function"==typeof i?i:n,null==t?t:Xi(t,e,ji(s),i)},ms.values=xl,ms.valuesIn=function(t){return null==t?[]:In(t,cl(t))},ms.without=Na,ms.words=Ml,ms.wrap=function(t,e){return mo(ji(e),t)},ms.xor=Ba,ms.xorBy=Va,ms.xorWith=Ua,ms.zip=Xa,ms.zipObject=function(t,e){return Gi(t||[],e||[],Rs)},ms.zipObjectDeep=function(t,e){return Gi(t||[],e||[],Ii)},ms.zipWith=Ya,ms.entries=gl,ms.entriesIn=vl,ms.extend=Qo,ms.extendWith=Jo,Vl(ms,ms),ms.add=ql,ms.attempt=Rl,ms.camelCase=yl,ms.capitalize=_l,ms.ceil=Kl,ms.clamp=function(t,e,s){return s===n&&(s=e,e=n),s!==n&&(s=(s=$o(s))==s?s:0),e!==n&&(e=(e=$o(e))==e?e:0),Ls($o(t),e,s)},ms.clone=function(t){return Ns(t,d)},ms.cloneDeep=function(t){return Ns(t,c|d)},ms.cloneDeepWith=function(t,e){return Ns(t,c|d,e="function"==typeof e?e:n)},ms.cloneWith=function(t,e){return Ns(t,d,e="function"==typeof e?e:n)},ms.conformsTo=function(t,e){return null==e||Bs(t,e,hl(e))},ms.deburr=bl,ms.defaultTo=function(t,e){return null==t||t!=t?e:t},ms.divide=Zl,ms.endsWith=function(t,e,s){t=Ko(t),e=Bi(e);var i=t.length,r=s=s===n?i:Ls(Ho(s),0,i);return(s-=e.length)>=0&&t.slice(s,r)==e},ms.eq=xo,ms.escape=function(t){return(t=Ko(t))&&Tt.test(t)?t.replace(wt,Fn):t},ms.escapeRegExp=function(t){return(t=Ko(t))&&kt.test(t)?t.replace(Pt,"\\$&"):t},ms.every=function(t,e,s){var i=wo(t)?rn:Ws;return s&&$r(t,e,s)&&(e=n),i(t,Nr(e,3))},ms.find=ja,ms.findIndex=_a,ms.findKey=function(t,e){return mn(t,Nr(e,3),qs)},ms.findLast=$a,ms.findLastIndex=ba,ms.findLastKey=function(t,e){return mn(t,Nr(e,3),Ks)},ms.floor=Ql,ms.forEach=qa,ms.forEachRight=Ka,ms.forIn=function(t,e){return null==t?t:js(t,Nr(e,3),cl)},ms.forInRight=function(t,e){return null==t?t:$s(t,Nr(e,3),cl)},ms.forOwn=function(t,e){return t&&qs(t,Nr(e,3))},ms.forOwnRight=function(t,e){return t&&Ks(t,Nr(e,3))},ms.get=il,ms.gt=yo,ms.gte=_o,ms.has=function(t,e){return null!=t&&zr(t,e,ni)},ms.hasIn=rl,ms.head=Ea,ms.identity=Dl,ms.includes=function(t,e,n,s){t=To(t)?t:xl(t),n=n&&!s?Ho(n):0;var i=t.length;return n<0&&(n=jn(i+n,0)),Vo(t)?n<=i&&t.indexOf(e,n)>-1:!!i&&vn(t,e,n)>-1},ms.indexOf=function(t,e,n){var s=null==t?0:t.length;if(!s)return-1;var i=null==n?0:Ho(n);return i<0&&(i=jn(s+i,0)),vn(t,e,i)},ms.inRange=function(t,e,s){return e=Go(e),s===n?(s=e,e=0):s=Go(s),function(t,e,n){return t>=$n(e,n)&&t<jn(e,n)}(t=$o(t),e,s)},ms.invoke=ll,ms.isArguments=bo,ms.isArray=wo,ms.isArrayBuffer=Eo,ms.isArrayLike=To,ms.isArrayLikeObject=So,ms.isBoolean=function(t){return!0===t||!1===t||Fo(t)&&ti(t)==Y},ms.isBuffer=Ao,ms.isDate=Co,ms.isElement=function(t){return Fo(t)&&1===t.nodeType&&!Lo(t)},ms.isEmpty=function(t){if(null==t)return!0;if(To(t)&&(wo(t)||"string"==typeof t||"function"==typeof t.splice||Ao(t)||Xo(t)||bo(t)))return!t.length;var e=Wr(t);if(e==$||e==et)return!t.size;if(Qr(t))return!ui(t).length;for(var n in t)if(ue.call(t,n))return!1;return!0},ms.isEqual=function(t,e){return oi(t,e)},ms.isEqualWith=function(t,e,s){var i=(s="function"==typeof s?s:n)?s(t,e):n;return i===n?oi(t,e,n,s):!!i},ms.isError=Io,ms.isFinite=function(t){return"number"==typeof t&&wn(t)},ms.isFunction=Mo,ms.isInteger=Ro,ms.isLength=Po,ms.isMap=Oo,ms.isMatch=function(t,e){return t===e||li(t,e,Vr(e))},ms.isMatchWith=function(t,e,s){return s="function"==typeof s?s:n,li(t,e,Vr(e),s)},ms.isNaN=function(t){return Do(t)&&t!=+t},ms.isNative=function(t){if(Zr(t))throw new Jt(i);return hi(t)},ms.isNil=function(t){return null==t},ms.isNull=function(t){return null===t},ms.isNumber=Do,ms.isObject=ko,ms.isObjectLike=Fo,ms.isPlainObject=Lo,ms.isRegExp=No,ms.isSafeInteger=function(t){return Ro(t)&&t>=-k&&t<=k},ms.isSet=Bo,ms.isString=Vo,ms.isSymbol=Uo,ms.isTypedArray=Xo,ms.isUndefined=function(t){return t===n},ms.isWeakMap=function(t){return Fo(t)&&Wr(t)==rt},ms.isWeakSet=function(t){return Fo(t)&&ti(t)==at},ms.join=function(t,e){return null==t?"":Gn.call(t,e)},ms.kebabCase=wl,ms.last=Ca,ms.lastIndexOf=function(t,e,s){var i=null==t?0:t.length;if(!i)return-1;var r=i;return s!==n&&(r=(r=Ho(s))<0?jn(i+r,0):$n(r,i-1)),e==e?function(t,e,n){for(var s=n+1;s--;)if(t[s]===e)return s;return s}(t,e,r):gn(t,yn,r,!0)},ms.lowerCase=El,ms.lowerFirst=Tl,ms.lt=Yo,ms.lte=Wo,ms.max=function(t){return t&&t.length?zs(t,Dl,ei):n},ms.maxBy=function(t,e){return t&&t.length?zs(t,Nr(e,2),ei):n},ms.mean=function(t){return _n(t,Dl)},ms.meanBy=function(t,e){return _n(t,Nr(e,2))},ms.min=function(t){return t&&t.length?zs(t,Dl,fi):n},ms.minBy=function(t,e){return t&&t.length?zs(t,Nr(e,2),fi):n},ms.stubArray=jl,ms.stubFalse=$l,ms.stubObject=function(){return{}},ms.stubString=function(){return""},ms.stubTrue=function(){return!0},ms.multiply=th,ms.nth=function(t,e){return t&&t.length?xi(t,Ho(e)):n},ms.noConflict=function(){return Ye._===this&&(Ye._=ge),this},ms.noop=Ul,ms.now=so,ms.pad=function(t,e,n){t=Ko(t);var s=(e=Ho(e))?Un(t):0;if(!e||s>=e)return t;var i=(e-s)/2;return yr(He(i),n)+t+yr(ze(i),n)},ms.padEnd=function(t,e,n){t=Ko(t);var s=(e=Ho(e))?Un(t):0;return e&&s<e?t+yr(e-s,n):t},ms.padStart=function(t,e,n){t=Ko(t);var s=(e=Ho(e))?Un(t):0;return e&&s<e?yr(e-s,n)+t:t},ms.parseInt=function(t,e,n){return n||null==e?e=0:e&&(e=+e),Kn(Ko(t).replace(Ft,""),e||0)},ms.random=function(t,e,s){if(s&&"boolean"!=typeof s&&$r(t,e,s)&&(e=s=n),s===n&&("boolean"==typeof e?(s=e,e=n):"boolean"==typeof t&&(s=t,t=n)),t===n&&e===n?(t=0,e=1):(t=Go(t),e===n?(e=t,t=0):e=Go(e)),t>e){var i=t;t=e,e=i}if(s||t%1||e%1){var r=Zn();return $n(t+r*(e-t+Be("1e-"+((r+"").length-1))),e)}return Ei(t,e)},ms.reduce=function(t,e,n){var s=wo(t)?un:En,i=arguments.length<3;return s(t,Nr(e,4),n,i,Xs)},ms.reduceRight=function(t,e,n){var s=wo(t)?dn:En,i=arguments.length<3;return s(t,Nr(e,4),n,i,Ys)},ms.repeat=function(t,e,s){return e=(s?$r(t,e,s):e===n)?1:Ho(e),Ti(Ko(t),e)},ms.replace=function(){var t=arguments,e=Ko(t[0]);return t.length<3?e:e.replace(t[1],t[2])},ms.result=function(t,e,s){var i=-1,r=(e=$i(e,t)).length;for(r||(r=1,t=n);++i<r;){var a=null==t?n:t[pa(e[i])];a===n&&(i=r,a=s),t=Mo(a)?a.call(t):a}return t},ms.round=eh,ms.runInContext=t,ms.sample=function(t){return(wo(t)?As:Ai)(t)},ms.size=function(t){if(null==t)return 0;if(To(t))return Vo(t)?Un(t):t.length;var e=Wr(t);return e==$||e==et?t.size:ui(t).length},ms.snakeCase=Sl,ms.some=function(t,e,s){var i=wo(t)?fn:Fi;return s&&$r(t,e,s)&&(e=n),i(t,Nr(e,3))},ms.sortedIndex=function(t,e){return Oi(t,e)},ms.sortedIndexBy=function(t,e,n){return Di(t,e,Nr(n,2))},ms.sortedIndexOf=function(t,e){var n=null==t?0:t.length;if(n){var s=Oi(t,e);if(s<n&&xo(t[s],e))return s}return-1},ms.sortedLastIndex=function(t,e){return Oi(t,e,!0)},ms.sortedLastIndexBy=function(t,e,n){return Di(t,e,Nr(n,2),!0)},ms.sortedLastIndexOf=function(t,e){if(null==t?0:t.length){var n=Oi(t,e,!0)-1;if(xo(t[n],e))return n}return-1},ms.startCase=Al,ms.startsWith=function(t,e,n){return t=Ko(t),n=null==n?0:Ls(Ho(n),0,t.length),e=Bi(e),t.slice(n,n+e.length)==e},ms.subtract=nh,ms.sum=function(t){return t&&t.length?Tn(t,Dl):0},ms.sumBy=function(t,e){return t&&t.length?Tn(t,Nr(e,2)):0},ms.template=function(t,e,s){var i=ms.templateSettings;s&&$r(t,e,s)&&(e=n),t=Ko(t),e=Jo({},e,i,Cr);var r,o,l=Jo({},e.imports,i.imports,Cr),h=hl(l),c=In(l,h),u=0,d=e.interpolate||qt,f="__p += '",p=se((e.escape||qt).source+"|"+d.source+"|"+(d===Ct?Xt:qt).source+"|"+(e.evaluate||qt).source+"|$","g"),m="//# sourceURL="+(ue.call(e,"sourceURL")?(e.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Oe+"]")+"\n";t.replace(p,(function(e,n,s,i,a,l){return s||(s=i),f+=t.slice(u,l).replace(Kt,On),n&&(r=!0,f+="' +\n__e("+n+") +\n'"),a&&(o=!0,f+="';\n"+a+";\n__p += '"),s&&(f+="' +\n((__t = ("+s+")) == null ? '' : __t) +\n'"),u=l+e.length,e})),f+="';\n";var g=ue.call(e,"variable")&&e.variable;if(g){if(Vt.test(g))throw new Jt(a)}else f="with (obj) {\n"+f+"\n}\n";f=(o?f.replace(xt,""):f).replace(yt,"$1").replace(_t,"$1;"),f="function("+(g||"obj")+") {\n"+(g?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(r?", __e = _.escape":"")+(o?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+f+"return __p\n}";var v=Rl((function(){return te(h,m+"return "+f).apply(n,c)}));if(v.source=f,Io(v))throw v;return v},ms.times=function(t,e){if((t=Ho(t))<1||t>k)return[];var n=D,s=$n(t,D);e=Nr(e),t-=D;for(var i=Sn(s,e);++n<t;)e(n);return i},ms.toFinite=Go,ms.toInteger=Ho,ms.toLength=jo,ms.toLower=function(t){return Ko(t).toLowerCase()},ms.toNumber=$o,ms.toSafeInteger=function(t){return t?Ls(Ho(t),-k,k):0===t?t:0},ms.toString=Ko,ms.toUpper=function(t){return Ko(t).toUpperCase()},ms.trim=function(t,e,s){if((t=Ko(t))&&(s||e===n))return An(t);if(!t||!(e=Bi(e)))return t;var i=Xn(t),r=Xn(e);return Ki(i,Rn(i,r),Pn(i,r)+1).join("")},ms.trimEnd=function(t,e,s){if((t=Ko(t))&&(s||e===n))return t.slice(0,Yn(t)+1);if(!t||!(e=Bi(e)))return t;var i=Xn(t);return Ki(i,0,Pn(i,Xn(e))+1).join("")},ms.trimStart=function(t,e,s){if((t=Ko(t))&&(s||e===n))return t.replace(Ft,"");if(!t||!(e=Bi(e)))return t;var i=Xn(t);return Ki(i,Rn(i,Xn(e))).join("")},ms.truncate=function(t,e){var s=S,i=A;if(ko(e)){var r="separator"in e?e.separator:r;s="length"in e?Ho(e.length):s,i="omission"in e?Bi(e.omission):i}var a=(t=Ko(t)).length;if(Dn(t)){var o=Xn(t);a=o.length}if(s>=a)return t;var l=s-Un(i);if(l<1)return i;var h=o?Ki(o,0,l).join(""):t.slice(0,l);if(r===n)return h+i;if(o&&(l+=h.length-l),No(r)){if(t.slice(l).search(r)){var c,u=h;for(r.global||(r=se(r.source,Ko(Yt.exec(r))+"g")),r.lastIndex=0;c=r.exec(u);)var d=c.index;h=h.slice(0,d===n?l:d)}}else if(t.indexOf(Bi(r),l)!=l){var f=h.lastIndexOf(r);f>-1&&(h=h.slice(0,f))}return h+i},ms.unescape=function(t){return(t=Ko(t))&&Et.test(t)?t.replace(bt,Wn):t},ms.uniqueId=function(t){var e=++de;return Ko(t)+e},ms.upperCase=Cl,ms.upperFirst=Il,ms.each=qa,ms.eachRight=Ka,ms.first=Ea,Vl(ms,(Jl={},qs(ms,(function(t,e){ue.call(ms.prototype,e)||(Jl[e]=t)})),Jl),{chain:!1}),ms.VERSION="4.17.21",nn(["bind","bindKey","curry","curryRight","partial","partialRight"],(function(t){ms[t].placeholder=ms})),nn(["drop","take"],(function(t,e){ys.prototype[t]=function(s){s=s===n?1:jn(Ho(s),0);var i=this.__filtered__&&!e?new ys(this):this.clone();return i.__filtered__?i.__takeCount__=$n(s,i.__takeCount__):i.__views__.push({size:$n(s,D),type:t+(i.__dir__<0?"Right":"")}),i},ys.prototype[t+"Right"]=function(e){return this.reverse()[t](e).reverse()}})),nn(["filter","map","takeWhile"],(function(t,e){var n=e+1,s=n==M||3==n;ys.prototype[t]=function(t){var e=this.clone();return e.__iteratees__.push({iteratee:Nr(t,3),type:n}),e.__filtered__=e.__filtered__||s,e}})),nn(["head","last"],(function(t,e){var n="take"+(e?"Right":"");ys.prototype[t]=function(){return this[n](1).value()[0]}})),nn(["initial","tail"],(function(t,e){var n="drop"+(e?"":"Right");ys.prototype[t]=function(){return this.__filtered__?new ys(this):this[n](1)}})),ys.prototype.compact=function(){return this.filter(Dl)},ys.prototype.find=function(t){return this.filter(t).head()},ys.prototype.findLast=function(t){return this.reverse().find(t)},ys.prototype.invokeMap=Si((function(t,e){return"function"==typeof t?new ys(this):this.map((function(n){return ri(n,t,e)}))})),ys.prototype.reject=function(t){return this.filter(fo(Nr(t)))},ys.prototype.slice=function(t,e){t=Ho(t);var s=this;return s.__filtered__&&(t>0||e<0)?new ys(s):(t<0?s=s.takeRight(-t):t&&(s=s.drop(t)),e!==n&&(s=(e=Ho(e))<0?s.dropRight(-e):s.take(e-t)),s)},ys.prototype.takeRightWhile=function(t){return this.reverse().takeWhile(t).reverse()},ys.prototype.toArray=function(){return this.take(D)},qs(ys.prototype,(function(t,e){var s=/^(?:filter|find|map|reject)|While$/.test(e),i=/^(?:head|last)$/.test(e),r=ms[i?"take"+("last"==e?"Right":""):e],a=i||/^find/.test(e);r&&(ms.prototype[e]=function(){var e=this.__wrapped__,o=i?[1]:arguments,l=e instanceof ys,h=o[0],c=l||wo(e),u=function(t){var e=r.apply(ms,cn([t],o));return i&&d?e[0]:e};c&&s&&"function"==typeof h&&1!=h.length&&(l=c=!1);var d=this.__chain__,f=!!this.__actions__.length,p=a&&!d,m=l&&!f;if(!a&&c){e=m?e:new ys(this);var g=t.apply(e,o);return g.__actions__.push({func:za,args:[u],thisArg:n}),new xs(g,d)}return p&&m?t.apply(this,o):(g=this.thru(u),p?i?g.value()[0]:g.value():g)})})),nn(["pop","push","shift","sort","splice","unshift"],(function(t){var e=ae[t],n=/^(?:push|sort|unshift)$/.test(t)?"tap":"thru",s=/^(?:pop|shift)$/.test(t);ms.prototype[t]=function(){var t=arguments;if(s&&!this.__chain__){var i=this.value();return e.apply(wo(i)?i:[],t)}return this[n]((function(n){return e.apply(wo(n)?n:[],t)}))}})),qs(ys.prototype,(function(t,e){var n=ms[e];if(n){var s=n.name+"";ue.call(as,s)||(as[s]=[]),as[s].push({name:e,func:n})}})),as[mr(n,g).name]=[{name:"wrapper",func:n}],ys.prototype.clone=function(){var t=new ys(this.__wrapped__);return t.__actions__=ir(this.__actions__),t.__dir__=this.__dir__,t.__filtered__=this.__filtered__,t.__iteratees__=ir(this.__iteratees__),t.__takeCount__=this.__takeCount__,t.__views__=ir(this.__views__),t},ys.prototype.reverse=function(){if(this.__filtered__){var t=new ys(this);t.__dir__=-1,t.__filtered__=!0}else(t=this.clone()).__dir__*=-1;return t},ys.prototype.value=function(){var t=this.__wrapped__.value(),e=this.__dir__,n=wo(t),s=e<0,i=n?t.length:0,r=function(t,e,n){var s=-1,i=n.length;for(;++s<i;){var r=n[s],a=r.size;switch(r.type){case"drop":t+=a;break;case"dropRight":e-=a;break;case"take":e=$n(e,t+a);break;case"takeRight":t=jn(t,e-a)}}return{start:t,end:e}}(0,i,this.__views__),a=r.start,o=r.end,l=o-a,h=s?o:a-1,c=this.__iteratees__,u=c.length,d=0,f=$n(l,this.__takeCount__);if(!n||!s&&i==l&&f==l)return Wi(t,this.__actions__);var p=[];t:for(;l--&&d<f;){for(var m=-1,g=t[h+=e];++m<u;){var v=c[m],x=v.iteratee,y=v.type,_=x(g);if(y==R)g=_;else if(!_){if(y==M)continue t;break t}}p[d++]=g}return p},ms.prototype.at=Ga,ms.prototype.chain=function(){return Wa(this)},ms.prototype.commit=function(){return new xs(this.value(),this.__chain__)},ms.prototype.next=function(){this.__values__===n&&(this.__values__=zo(this.value()));var t=this.__index__>=this.__values__.length;return{done:t,value:t?n:this.__values__[this.__index__++]}},ms.prototype.plant=function(t){for(var e,s=this;s instanceof vs;){var i=ga(s);i.__index__=0,i.__values__=n,e?r.__wrapped__=i:e=i;var r=i;s=s.__wrapped__}return r.__wrapped__=t,e},ms.prototype.reverse=function(){var t=this.__wrapped__;if(t instanceof ys){var e=t;return this.__actions__.length&&(e=new ys(this)),(e=e.reverse()).__actions__.push({func:za,args:[Pa],thisArg:n}),new xs(e,this.__chain__)}return this.thru(Pa)},ms.prototype.toJSON=ms.prototype.valueOf=ms.prototype.value=function(){return Wi(this.__wrapped__,this.__actions__)},ms.prototype.first=ms.prototype.head,Me&&(ms.prototype[Me]=function(){return this}),ms}();ze?((ze.exports=zn)._=zn,We._=zn):Ye._=zn}).call(ha)}({get exports(){return XA},set exports(t){XA=t}},XA);class WA extends iS{constructor(){super("Start"),p(this,"gui",pgame.gui),p(this,"msg",pgame.front),p(this,"cnvBet",this.gui.bottomPanel.cnvBet),p(this,"cnvColorsBoard",this.gui.middlePanel.cnvColorsBoard)}enter(){console.log("STATE: Start"),this.setBtnCallbacks(),this.gui.enableBetButtons()}update(t){0==pgame.data.betColor||pgame.data.totalBet}exit(){this.gui.disableBetButtons(),conn.request("bet")}setBtnCallbacks(){this.cnvBet.btnPlay.setOnClick((()=>{this.onBtnPlayClicked()})),this.cnvBet.btnReset.setOnClick((()=>{console.log("RESET"),pgame.data.setBetAtId(0)}));for(let t of this.cnvBet.btnChips)t.setOnClick((()=>{pgame.data.addBetByValue(this.cnvBet.configBetList[this.cnvBet.btnChips.indexOf(t)])}));for(let t of this.cnvColorsBoard.btnColors)t.setOnClick((()=>{pgame.data.setBetColor(this.cnvColorsBoard.colorsValue[this.cnvColorsBoard.btnColors.indexOf(t)]),this.cnvColorsBoard.highlightColor(this.cnvColorsBoard.btnColors.indexOf(t))}))}onBtnPlayClicked(){this.cnvBet.btnPlay.setOnClick(!1),pgame.interact.off("down- "),pgame.data.nAutoPlays>0?YA():function(t){var e;const n=pgame.data,s=pgame.front.popMsg;n.realCredits<n.totalBet||0==n.betColor?(s.txtKey("no-fund"),s.pop(1500,500).start(!0),t.setNext("Start")):(null==(e=pgame.gui.tweens.getByName("credit"))||e.stop(),t.setNext("PlayRun"))}(this)}OnBtnAutoPlayClicked(){pgame.sound.Click.play(),pgame.data.nAutoPlays>0?YA():API.showAutoPlayMenu(!0)}}const zA={key:0,class:"modal auto-play-modal"},GA={class:"outer"},HA={class:"inner"},jA={class:"heading"},$A={class:"sub-heading"},qA={class:"number-buttons"},KA=["onClick"],ZA={class:"must-choose-autoNumber"},QA={class:"sub-heading"},JA={class:"condition non-winning"},tC={for:"non-winning"},eC={class:"condition balance-decrease"},nC={for:"balance-decrease"},sC={class:"condition bonus"},iC=Er(kn({__name:"autoplay-modal",setup(t){const e=Ne(!1);let n=[10,20,30,50,100,500],s=Ne(0),i=Ne(!1),r=Ne(),a=Ne(),o=Ne("message.resetErrorMessage");API.showAutoPlayMenu=function(t){e.value=t};const l=()=>{e.value=!1,pgame.sound.Click.play()},h=()=>{i.value=!i.value,pgame.sound.Click.play(),pgame.gui.sidePanel.stopBonus=i.value},c=Ci((()=>({"check-on":i.value,"check-off":!i.value}))),u=()=>{pgame.nonWinning=1*r.value,pgame.countNonWinning=1*r.value,pgame.balanceDecreases=100*a.value,d(),s.value>0&&(e.value=!1,pgame.data.nAutoPlays=s.value,pgame.data.realCredits>=pgame.data.totalBet&&pgame.gui.disableBetButtons(),pgame.currState,pgame.gui.sidePanel,pgame.data.nAutoPlays<1&&YA())},d=()=>{s.value<1?o.value="message.no-Spin-Selected-Message":o.value="message.resetErrorMessage"};return(t,i)=>e.value?(qs(),Js("div",zA,[ai("div",GA,[ai("div",HA,[ai("div",{class:"general-button close-button",onClick:l}),ai("div",jA,M(t.$t("message.autoplay-header")),1),ai("div",$A,M(t.$t("message.autoplay-subheader")),1),ai("div",qA,[(qs(!0),Js(Ws,null,ss(Ue(n),(t=>(qs(),Js("button",{class:T(["general-button number",{on:t===Ue(s)}]),onClick:e=>{return n=t,s.value=n,pgame.sound.Click.play(),void d();var n},key:t},M(t),11,KA)))),128))]),ai("div",ZA,M(t.$t(Ue(o))),1),ai("div",QA,M(t.$t("message.autoplay-stop")),1),ai("div",JA,[ai("label",tC,M(t.$t("message.autoplay-nonwinning")),1),Zn(ai("input",{type:"text",id:"non-winning","onUpdate:modelValue":i[0]||(i[0]=t=>Le(r)?r.value=t:r=t),onInput:i[1]||(i[1]=t=>(r.value=r.value.toString().replace(/\D/g,""),void(r.value>999&&(r.value=parseInt(r.value.toString().slice(0,3))))))},null,544),[[Ki,Ue(r)]])]),ai("div",eC,[ai("label",nC,M(t.$t("message.autoplay-balance")),1),Zn(ai("input",{type:"text",id:"balance-decrease","onUpdate:modelValue":i[2]||(i[2]=t=>Le(a)?a.value=t:a=t),onInput:i[3]||(i[3]=t=>(a.value=a.value.toString().replace(/\D/g,""),void(a.value>9999&&(a.value=parseInt(a.value.toString().slice(0,4))))))},null,544),[[Ki,Ue(a)]])]),ai("div",sC,[ai("button",{class:T(["general-button check",Ue(c)]),onClick:h},null,2),ai("span",null,M(t.$t("message.autoplay-stopBonus")),1)]),ai("button",{class:"general-button confirm",onClick:u,id:"autoPlay"},M(t.$t("message.autoplay-start")),1)])])])):ci("",!0)}}),[["__scopeId","data-v-4cc7468c"]]),rC={class:"selector-buttons"},aC={class:"group"},oC={class:"group"},lC=Er(kn({__name:"sound-options",setup(t){function e(){API.musicMuted.value=!API.musicMuted.value}function n(){API.soundMuted.value=!API.soundMuted.value}const s=Ci((()=>({musicOn:!API.musicMuted.value,musicOff:API.musicMuted.value}))),i=Ci((()=>({soundOn:!API.soundMuted.value,soundOff:API.soundMuted.value})));return(t,r)=>(qs(),Js("div",null,[ai("div",rC,[ai("div",aC,[ai("span",null,M(t.$t("message.modal-sound-active-sound")),1),ai("button",{class:T(["general-button sound",Ue(i)]),onClick:n},null,2)]),ai("div",oC,[ai("span",null,M(t.$t("message.modal-sound-active-music")),1),ai("button",{class:T(["general-button music",Ue(s)]),onClick:e},null,2)])])]))}}),[["__scopeId","data-v-690b6f83"]]),hC={key:0,class:"modal sound-modal"},cC={class:"outer"},uC={class:"inner",style:{color:"white"}},dC={class:"heading"},fC={class:"sub-heading"},pC=Er(kn({__name:"sound-modal",setup(t){let e=Ne(!1);API.showSoundMenu=function(t){e.value=t};let n=()=>{e.value=!1,pgame.sound.Click.play()};return(t,s)=>Ue(e)?(qs(),Js("div",hC,[ai("div",cC,[ai("div",uC,[ai("div",{class:"general-button close-button",onClick:s[0]||(s[0]=(...t)=>Ue(n)&&Ue(n)(...t))}),ai("div",dC,M(t.$t("message.modal-sound-header")),1),ai("div",fC,M(t.$t("message.modal-sound-subheader")),1),oi(lC,{ref:"soundOption"},null,512),ai("button",{class:"general-button confirm",onClick:s[1]||(s[1]=(...t)=>Ue(n)&&Ue(n)(...t))},M(t.$t("message.confirm")),1)])])])):ci("",!0)}}),[["__scopeId","data-v-3d0789c4"]]),mC={class:"sound-settings"},gC={class:"heading title"},vC={class:"sound-controllers"},xC={class:"sub-heading param"},yC={class:"volume-range"},_C={class:"range"},bC={class:"form-group range__slider"},wC={it:{name:"Italiano",message:{"modal-sound-header":"Vuoi attivare i Suoni nel gioco?","modal-sound-subheader":"Scegli se giocare con gli effetti sonori","modal-sound-active-sound":"Attiva i suoni","modal-sound-active-music":"Attiva musica",confirm:"Conferma","modal-autoplay-header":"AUTOPLAY","modal-autoplay-sub-header-1":"Seleziona il numero di spin in modalità autoplay","modal-autoplay-sub-header-2":"Interrompi la riproduzione automatica se:","modal-autoplay-nonwinning":"Puntate consecutive non vincenti","modal-autoplay-balance-decrease":"Il saldo diminuisce di €","modal-autoplay-bonus":"Fermati quando ricevi il bonus","modal-autoplay-confirm":"Avvia la riproduzione automatica","paytable-tab":"PAYTABLE","introduction-tab":"INTRODUZIONE","features-tab":"FEATURES","info-tab":"ALTRE INFORMAZIONI","settings-tab":"IMPOSTAZIONI","sound-settings":"IMPOSTAZIONI AUDIO","volume-settings":"IMPOSTAZIONI DEL VOLUME","left-handed-header":"MODALITÀ MANCINA","left-handed-group":"Sposta i pulsanti di gioco a sinistra",language:"IMPOSTAZIONI LINGUA","rule-5th":"Eventuali malfunzionamenti annullano tutte le giocate e i pagamenti."}},en:{name:"English",message:{"modal-sound-header":"Vuoi attivare i Suoni nel gioco?","modal-sound-subheader":"Scegli se giocare con gli effetti sonori","modal-sound-active-sound":"Attiva i suoni","modal-sound-active-music":"Attiva musica",confirm:"Conferma","modal-autoplay-header":"AUTOPLAY","modal-autoplay-sub-header-1":"Seleziona il numero di spin in modalità autoplay","modal-autoplay-sub-header-2":"Interrompi la riproduzione automatica se:","modal-autoplay-nonwinning":"Puntate consecutive non vincenti","modal-autoplay-balance-decrease":"Il saldo diminuisce di €","modal-autoplay-bonus":"Fermati quando ricevi il bonus","modal-autoplay-confirm":"Avvia la riproduzione automatica","paytable-tab":"PAYTABLE","introduction-tab":"INTRODUZIONE","features-tab":"FEATURES","info-tab":"ALTRE INFORMAZIONI","settings-tab":"IMPOSTAZIONI","sound-settings":"IMPOSTAZIONI AUDIO","volume-settings":"IMPOSTAZIONI DEL VOLUME","left-handed-header":"MODALITÀ MANCINA","left-handed-group":"Sposta i pulsanti di gioco a sinistra",language:"IMPOSTAZIONI LINGUA","rule-5th":"Eventuali malfunzionamenti annullano tutte le giocate e i pagamenti."}}},EC={class:"language-settings"},TC={class:"left-handed-controller"},SC={class:"heading"},AC={class:"group"},CC={class:"heading"},IC={class:"lang-dropdown"},MC={class:"select-menu"},RC={class:"sBtn-text label"},PC={key:0,class:"options"},kC=["onClick"],FC={class:"option-text label"};const OC={name:"SettingSection",components:{SoundSetting:Er(kn({__name:"sound-setting",setup(t){const e=API.volume,n=Ci((()=>({"background-image":`linear-gradient(89.01deg, #5FBC02 2.47%, #BFD72F ${100*e.value}%, rgba(0, 0, 0, 0) ${100*e.value}%, rgba(0, 0, 0, 0) 100%)`})));return(t,s)=>(qs(),Js("div",mC,[ai("div",gC,M(t.$t("message.sound-settings")),1),ai("div",vC,[oi(lC)]),ai("div",xC,M(t.$t("message.volume-settings")),1),ai("div",yC,[ai("form",_C,[ai("div",bC,[Zn(ai("input",{style:y(Ue(n)),type:"range",class:"volume-slider","onUpdate:modelValue":s[0]||(s[0]=t=>Le(e)?e.value=t:null),step:"0.01",min:"0",max:"1"},null,4),[[Ki,Ue(e),void 0,{number:!0}]])])])])]))}}),[["__scopeId","data-v-0f131e9a"]]),LanguageSetting:Er({name:"LanguageSetting",data(){let t;return t="IMPOSTAZIONI LINGUA"===this.$t("message.language")?wC.it.name:wC.en.name,{leftHandedMode:pgame.vueLeftHandedMode,languageSelect:!1,chonseLanguge:t,selectLanguages:[]}},mounted(){Object.keys(wC).forEach((t=>{this.selectLanguages[t]=wC[t].name}))},methods:{toggleLeftHandedMode(){if(this.leftHandedMode=!this.leftHandedMode,pgame.sound.Click.play(),this.leftHandedMode){pgame.vueLeftHandedMode=!0,pgame.gui.sidePanel.position.set(75,30);for(let t=0;t<10;t++)pgame.reelsbox.lines[t].numWin.position.set(pgame.reelsbox.lines[t].trace[0].x+1105,pgame.reelsbox.lines[t].trace[0].y)}else{pgame.vueLeftHandedMode=!1,pgame.gui.sidePanel.position.set(1200,30);for(let t=0;t<10;t++)pgame.reelsbox.lines[t].numWin.position.set(pgame.reelsbox.lines[t].trace[0].x,pgame.reelsbox.lines[t].trace[0].y)}},toggleLangaugeSelect(){pgame.sound.Click.play(),this.languageSelect=!this.languageSelect},handleSelectLanguage(t){API.locale.value=t,this.$i18n.locale=t,this.languageSelect=!1,this.chonseLanguge=this.selectLanguages[t],pgame.sound.Click.play()}},computed:{leftHandedButtonStyle(){return{leftMode:this.leftHandedMode,rightMode:!this.leftHandedMode}},languageChevronStyle(){return{transform:this.languageSelect?"rotate(-180deg)":"rotate(0deg)"}}}},[["render",function(t,e,n,s,i,r){return qs(),Js("div",EC,[ai("div",TC,[ai("div",SC,M(t.$t("message.left-hand-mode")),1),ai("div",AC,[ai("span",null,M(t.$t("message.left-hand-desc")),1),ai("button",{class:T(["general-button left",r.leftHandedButtonStyle]),onClick:e[0]||(e[0]=(...t)=>r.toggleLeftHandedMode&&r.toggleLeftHandedMode(...t))},null,2)])]),ai("div",CC,M(t.$t("message.language-settings")),1),ai("div",IC,[ai("div",MC,[ai("div",{class:"select-btn",onClick:e[1]||(e[1]=(...t)=>r.toggleLangaugeSelect&&r.toggleLangaugeSelect(...t))},[ai("span",RC,M(i.chonseLanguge),1),ai("div",{class:"general-button chevron",style:y(r.languageChevronStyle)},null,4)]),i.languageSelect?(qs(),Js("ul",PC,[(qs(!0),Js(Ws,null,ss(Object.keys(i.selectLanguages),((t,e)=>(qs(),Js("li",{class:T(["option",i.chonseLanguge===i.selectLanguages[t]?"active":""]),onClick:e=>r.handleSelectLanguage(t),key:e},[ai("span",FC,M(i.selectLanguages[t]),1)],10,kC)))),128))])):ci("",!0)])])])}],["__scopeId","data-v-aa09a20a"]])}},DC={class:"settings-section"},LC=(t=>(xn("data-v-8341c488"),t=t(),yn(),t))((()=>ai("div",{class:"gapSettings"},null,-1)));const NC=Er(OC,[["render",function(t,e,n,s,i,r){const a=ts("SoundSetting"),o=ts("LanguageSetting");return qs(),Js("div",DC,[oi(a),LC,oi(o)])}],["__scopeId","data-v-8341c488"]]),BC=""+new URL("../assets/10-6ad0d61a.png",import.meta.url).href,VC=""+new URL("../assets/J-2f7006f8.png",import.meta.url).href,UC=""+new URL("../assets/Q-a530793a.png",import.meta.url).href,XC=""+new URL("../assets/K-522045d5.png",import.meta.url).href,YC=""+new URL("../assets/A-505b17e6.png",import.meta.url).href,WC=""+new URL("../assets/fox-83286fff.png",import.meta.url).href,zC=""+new URL("../assets/buffalo-f90cc961.png",import.meta.url).href,GC=""+new URL("../assets/eagle-1e064baf.png",import.meta.url).href,HC=""+new URL("../assets/Wild-ae4f17c0.png",import.meta.url).href,jC=""+new URL("../assets/Scatter-3013566f.png",import.meta.url).href,$C={name:"PaytableSection",data:()=>({winCases:[["3",50,50,100,150,250,500,1500,3e3],["4",100,100,150,200,400,1200,5e3,1e4],["5",250,250,500,700,1e3,3e3,1e4,5e4]],winDemo:[[[0,0,0,0,0],[1,1,1,1,1],[0,0,0,0,0]],[[1,1,1,1,1],[0,0,0,0,0],[0,0,0,0,0]],[[0,0,0,0,0],[0,0,0,0,0],[1,1,1,1,1]],[[1,0,0,0,1],[0,1,0,1,0],[0,0,1,0,0]],[[0,0,1,0,0],[0,1,0,1,0],[1,0,0,0,1]],[[1,1,0,1,1],[0,0,1,0,0],[0,0,0,0,0]],[[0,0,0,0,0],[0,0,1,0,0],[1,1,0,1,1]],[[0,1,1,1,0],[1,0,0,0,1],[0,0,0,0,0]],[[0,0,0,0,0],[1,0,0,0,1],[0,1,1,1,0]],[[1,0,1,0,1],[0,1,0,1,0],[0,0,0,0,0]]]}),computed:{}},qC=t=>(xn("data-v-719df0eb"),t=t(),yn(),t),KC={class:"paytable-section"},ZC=qC((()=>ai("td",null,[ai("img",{src:BC,alt:"SYMBOL 1"})],-1))),QC=qC((()=>ai("td",null,[ai("img",{src:VC,alt:"SYMBOL 2"})],-1))),JC=qC((()=>ai("td",null,[ai("img",{src:UC,alt:"SYMBOL 3"})],-1))),tI=qC((()=>ai("td",null,[ai("img",{src:XC,alt:"SYMBOL 4"})],-1))),eI=qC((()=>ai("td",null,[ai("img",{src:YC,alt:"SYMBOL 5"})],-1))),nI=qC((()=>ai("td",null,[ai("img",{src:WC,alt:"SYMBOL 6"})],-1))),sI=qC((()=>ai("td",null,[ai("img",{src:zC,alt:"SYMBOL 7"})],-1))),iI=qC((()=>ai("td",null,[ai("img",{src:GC,alt:"SYMBOL 8"})],-1))),rI={class:"tableDemo"},aI={class:"winDemo"},oI={class:"wild"},lI=qC((()=>ai("img",{src:HC,alt:"WILD"},null,-1))),hI=qC((()=>ai("p",null,[ai("span",null,"5 "),ai("b",null,"500 ")],-1))),cI=qC((()=>ai("span",null,"4 ",-1))),uI=qC((()=>ai("b",null,"100 ",-1))),dI=qC((()=>ai("span",null,"3 ",-1))),fI=qC((()=>ai("b",null,"30 ",-1))),pI={class:"scatter"},mI=qC((()=>ai("img",{src:jC,alt:"SCATTER"},null,-1))),gI=qC((()=>ai("p",null,"3 Scatters = 1 Golden Spin",-1))),vI=qC((()=>ai("p",null,"4 Scatters = 3 Golden Spins",-1))),xI=qC((()=>ai("p",null,"5 Scatters = 5 Golden Spins",-1))),yI={style:{width:"100%",margin:"20px auto"}},_I={class:"param","data-i18n":"rule-1th"},bI={class:"param","data-i18n":"rule-2st"},wI={class:"param","data-i18n":"rule-3rd"},EI={class:"param","data-i18n":"rule-4th"},TI={class:"param","data-i18n":"rule-5th",style:{"margin-bottom":"25px"}};const SI=Er($C,[["render",function(t,e,n,s,i,r){return qs(),Js("div",KC,[ai("h1",null,M(t.$t("message.paytable-header")),1),ai("table",null,[ai("thead",null,[ai("tr",null,[ai("td",null,M(t.$t("message.paytable-NoOfSymbol")),1),ZC,QC,JC,tI,eI,nI,sI,iI])]),ai("tbody",null,[(qs(!0),Js(Ws,null,ss(i.winCases,(t=>(qs(),Js("tr",null,[(qs(!0),Js(Ws,null,ss(t,(t=>(qs(),Js("td",null,M("number"==typeof t?t/100:t),1)))),256))])))),256))])]),ai("div",rI,[(qs(!0),Js(Ws,null,ss(i.winDemo,(t=>(qs(),Js("table",aI,[(qs(!0),Js(Ws,null,ss(t,(t=>(qs(),Js("tr",null,[(qs(!0),Js(Ws,null,ss(t,(t=>(qs(),Js("td",{style:y({backgroundColor:1===t?"red":"white"})},null,4)))),256))])))),256))])))),256))]),ai("div",oI,[lI,ai("div",null,[ai("p",null,M(t.$t("message.paytable-wild")),1),hI,ai("p",null,[cI,uI,hi(M(t.$t("message.paytable-wild4")),1)]),ai("p",null,[dI,fI,hi(M(t.$t("message.paytable-wild3")),1)])])]),ai("div",pI,[mI,ai("div",null,[ai("p",null,M(t.$t("message.paytable-scatter1")),1),ai("p",null,M(t.$t("message.paytable-scatter2")),1),gI,vI,xI])]),ai("ul",yI,[ai("li",_I,M(t.$t("message.paytable-rule1")),1),ai("li",bI,M(t.$t("message.paytable-rule2")),1),ai("li",wI,M(t.$t("message.paytable-rule3")),1),ai("li",EI,M(t.$t("message.paytable-rule4")),1),ai("li",TI,M(t.$t("message.paytable-rule5")),1)])])}],["__scopeId","data-v-719df0eb"]]),AI=""+new URL("../assets/play_button-86e9e097.png",import.meta.url).href,CI=""+new URL("../assets/autoplay_button-f899a045.png",import.meta.url).href,II=""+new URL("../assets/lefthanded-24234408.png",import.meta.url).href,MI=""+new URL("../assets/maxbet-0d92b34a.png",import.meta.url).href,RI=""+new URL("../assets/sound-97ee4062.png",import.meta.url).href,PI=""+new URL("../assets/music-72740f51.png",import.meta.url).href,kI=""+new URL("../assets/turbo-2c03c0d2.png",import.meta.url).href,FI={},OI=t=>(xn("data-v-404a499d"),t=t(),yn(),t),DI={class:"introduction-section"},LI={"data-i18n":"intro-1st",class:"param"},NI={"data-i18n":"intro-2nd",class:"param"},BI={"data-i18n":"intro-3rd",class:"param"},VI=OI((()=>ai("b",null,"BET",-1))),UI={"data-i18n":"intro-4th",class:"param"},XI=OI((()=>ai("b",null,"WIN",-1))),YI={"data-i18n":"intro-5th",class:"param"},WI=OI((()=>ai("b",null,"BALANCE",-1))),zI={"data-i18n":"game-func-header",class:"param"},GI={class:"game-func"},HI={"data-i18n":"game-func-button",class:"param"},jI={"data-i18n":"game-func-functions",class:"param"},$I=OI((()=>ai("td",null,[ai("img",{src:AI,alt:"play icon",width:"70",height:"70"})],-1))),qI={"data-i18n":"play-button",class:"param"},KI=OI((()=>ai("td",null,[ai("img",{src:CI,alt:"autoplay icon",width:"70",height:"70"})],-1))),ZI={"data-i18n":"autoplay-button",class:"param"},QI=OI((()=>ai("td",null,[ai("img",{src:II,alt:"spin amount icon",width:"70",height:"70"})],-1))),JI={"data-i18n":"spin-amount-button",class:"param"},tM=OI((()=>ai("td",null,[ai("img",{src:MI,alt:"maxbet icon",height:"30"})],-1))),eM={"data-i18n":"maxbet-button",class:"param"},nM=OI((()=>ai("td",null,[ai("img",{src:RI,alt:"sound icon",width:"70",height:"70"})],-1))),sM={"data-i18n":"sound-button",class:"param"},iM=OI((()=>ai("td",null,[ai("img",{src:PI,alt:"music icon",width:"70",height:"70"})],-1))),rM={"data-i18n":"help-button",class:"param"},aM=OI((()=>ai("td",null,[ai("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAAAyCAYAAACqNX6+AAAAAXNSR0IB2cksfwAAAAlwSFlzAAALEwAACxMBAJqcGAAADCNJREFUeJztWw1wFNUd/7+9r3C5JAdCE0TyIR+BYCFxnFF0bBIdi6K04NA6nc60ocW2dKoT+qFUaxPaitWpNJnasQo2SaftTFtGoCBMqxXoaC0zDqGCRCR4x0BJIpDkklxyH7v7um/fx749ArmDBXM0/5m73dvdt/v7vf///f+/9zZBMGHjytAnDWDC7DbhkHFmEw4ZZ3ZVHNIeqg/6/XklySSq1DQoI8cUBTDScQS5UcjtxuHywp/+52pgGe8Yr5hD3ut6qhqruAZ0WI5BrdQhipPaAGh6FCEEGGOEFOQBjxI0iE8CF8oNA+C9xmf7wuKfbbtSuMY7RscdcqDrh9UoqTRinKyOJo6jhHoW4vpZ80EmSR0IWfPRZGOwNsgirCA/8rqmwiRPMXhd08Kg6I2Lbni6zWl84x2jYw55J7Su1ONytWjacM1gogOGEyfM44pBkD0Hm1+cKwdAfpEr+Blj3+3yQ8A7zyBeGsagra8q3tD6/4LREYe8e+LJr2o41jSUOF4wEO+g9IASpRT4Y7CIORGCWAKD7HDcih+m5t6JXcjfBlp0bVVZU/+1jJE+7DJt/4l1Dao23Hhu5B2c0CLIYMcjjt2fU6VBiNgVZoo2ewJZ5yRYMrBgzkLI9c4OJ3StdnHZz8PXIkbrrpdh74Qea0joA41nhv+FVX3Y4MFuyqKIMGIBh9lox+ZROwBsdoGITNqOxihrY2zzciqgwDc/nNT1jAhnA8aUZ12avU2IapHG7ug+A1SCk+C5OCWWrB2agS3CIn/LaYFFqZzLSbv8nAqU750f9uCRqnRSQzZgTLVLcsg/Ox9brkF0a1d0rxl1qTdDPJjAnnPthdIUL8gki3m4YnOfR6mIXhq65n4wZxHke2dtu7Xs2RXZjnE0y9ghezrqS5HPs+fkwM4SVR9B4iam+sASCbNapsSkEJJ0T2pzgc7hF5p7NFIxFOXeg3yuKfW3lW1ozlaMF7LMHXL8By29scN1fbH3gU+eqH7HdF8iRZAqjAgGlq/5t/htxpzJB/GkgFniYO2lvGBe6XH58Q2BpZE4xMtqR0kL2YDxQpaRQ3aTyHPFQqeje3BSH+ayXK51KdrDegiy8NvTAg0uk5B8jhOX9A9SjI3OIjvoq4Apkyoa7yh7bn22YbyYZeSQNzq/19IV3V83mAiBDM0crFjmw4e8KR5tKj5VPqaSo8yQyDDi/vxaegvkUjy4OH9pvx5BN9ZWWRHoBMZzJ91wYGcApharcPP9Q45jvJil7RASeS4P+uh4ZAeoelSCkppzBU+LuNwJrEqayZtFniU3LSUjZClYaZ7NB0SBneqvxPneOd+tnfWLJicx7nguH3qO54CiKLDiybNw3UzVMYxjWfoO+bC+Lqqe+u2pobekKVVKDrWVxtFGhwhabPrBzOecFE6ZD/PbpE7IrCLs93wKX59bs++u2c/XOolxp+GQrg+94HK54P7v98P0uQnHMI5laTtkV2f91tOD/14eIanAaiyVNiQKnzgnO0FqJa7k32YqMdwDdOhwUWkDadK3F2Vis4MPgntQmUxSglMYdz6bD93MIUuJQ8oTjmEcq5/TdshrR+tDHw5sL0loQ4gXOS4DKRZ77LEyh62BbS+C1pIEiHb265gm5Q7EiOV/mhJoACI0M68WclDhiiXlz29zCuOOZ/JQj+EQRTFGyOMDUERGiEMYx+rntByyNVQfhHisr6NvC1UjXEoiHmVYpkvVBtWYIJPlj5QPkHshnLosQaOMLHmbO0yRMhlD8zl9DhT6b4agu3ztiE9vdQrja88EoPsoGyGPR6BoXtIRjPfO2zhmHUnLIX899kj1cLJvz7H+3WKdTZ5cMYJ25SSKtVXk2FsfNnlKISiDEkNfGkWsKMtrSWRT4C2D6wO3tiaw1uoUxp1P+6HnqMdwiBvuW2c4pFx1BOO9s5tWjdXX6Y2Qju/URLWeNzsjb1hLBhJBixxFNtLrgXc3lUK832cqFT6MU8eKZbY6C+X3n8alt59lfWoVTjnl8ONBXxnM8N/WGtPUtkwwDvQA/OUJDENnFHMkEJxky/fH+l25sg/PqY5khPG+uQ455FVjhAzFu/d0Rl6XOTLlcn6NOLbPi956yZCNhICRhxWXQrcppFwuxczTZJ/chW/zZ8Rh8SOdUsEHFr1ynqbZP+AphNKCu/cmQG/MBOPh1zH6+0Zsc8ZoHX8hp0yeqcJdj/83I4wPzGkeU2ml5ZA/H1tTHY2d2WuQPa+h0PcICQADHwP8/tEoRLqx6GSZlPlhThJOcVGy/jwX3PJFFebeHeUdaM0Z7CrT3AZzinFx7me2jyiJpkwxbnlMO2+E8ECh+6lOQWYa8wUAFjwwALNqBjPCuKy8eczFxvQccvjblcO4t/2D/l1gSj8mJHlNsGSMJQR56ebpArPiLSsVDp0LSUZIWsTj/WhfLJLl6mTfjVAcMFJWUmt2CuOuRh/0fOAxg+S+p4ahcL7qCMbPlf/KmZTV0l4f9HoH+w6e+5MghTg1c9/CJpEFuiRHNtKpUTpEAdtLCpsMZUa7V7oPV1LT/begaZPKG/uH3c1OYdzVQBziNkawAvc2xIhDHMG4ovyF9RfpZtEmLfvjkW+FDvVuLY1rg2J5gABUTLVE357JkyW+bM27BGH70BBzEmyrghiJ02wuD9aYQqwTjTDGCjZviecU3IP8SuGKlRUvbHMK4+4fe6HniNscIcQhRRUaOIXRMYf84f1vtnw0+Hbd2fhxGlmMCOK4zM7lQY8tOWkJKMzFIE0PGKOUFGB1UMp6rMnPkpe0E2jHLpz6EIzEcievMmbBTmHc/SMv6umggmTJemOEGA5xCqNjDvnd4W/UD6k9G4/0/41mU5A6kyJAIgnZRKcl/+Tix0mw86IUIj7s+Zu5VMA86xun831FeG7+kn1fmP/rWicx7nrCAx8foYLjsz+J48IFmmMYx7K0HdLSXhfU3Th0sPfVoKYneGtWPEe5KRmtYrlbkh78OGsvTcysThkVKM8KNOxJk7LAHWhqzqy6h+a/2OYkxjc3uOHkfqqslv0yjoMlumMYx7K0HWISPvxwy6nowTrjQ5syNWOLETk/28hLD+OqxADO8jukJAD7aGJpR5rpYZ8rAIumPEjO3vil+b8JO4nx3EcI3t3shpLFGOYtUx3HeDHLyCGbDq2uwTix58C5LSBFoKDIXiyfp0D4PMB0AiuK5tqQ7W82LDC0xoAt5ZBOFdKZMMy/HU/zzW778oKXVmUbxotZRg4htvnQ15u6YkceDUX2IzxawaR3leYctIBaA4RfQhrpLKqQpdpTV2itVCKWvEnkVU1bGVIB3bVqlMjLBowXsowdQvK06naFDvXtDkaS3cBI8rsJ7c9TkpglM/LkLE0BTP8DWNodWV1BSdMeENezhcLK61bCJCWw9is3vTzq6mk2YLyQZewQYpveW/35mD647VD/bhxXB6XqIOtHLmuZzrevJ4nLxVF71JmdJjpMvFnEMNNfCTMDVa2rbtp00TSQDRhHs0tyCDEjVzdE1XONh3p3gQpJsTwhXjyICBIZAayQsp4vZsvYFnvsrEwUoDi3CooDi8IomVeVjqbPBoypdskOIWYQbjQIN3T0/wNi2pDMTIom6RF8JVSYvOyOedKgR6XryJkSg6jxCYMbalZXvHLiWsIo22U5hBghHNMGG4x8DXF9iE6ApbeA/CFs6QKxapqyfkTnJ/xtD5/lkt8exYtJ1M2YtOBEUtNq11S1hq9FjNwu2yHEXn7va3VGKdt4cqh98onhAzzPMsVhrUPzVCEUjog4dp30AolYgbcI5uTfCTlKoM2tafWrqlov+X8vsgEjgEMOIfZie12pMbNtMCKw7mS0Hbpjx7ClTOira2uhR+RqS4OKHgJc4JkOM/wVaIq3OGyol7WrF77iyP/zZQNGxxzCjUzMDMgNRr6uGUh24Z6RThRJEOnJk4OVFqz8jMGnBOC6nBLywQXuoojRM01uVW2+3IjLNoyOO4QbiUaP21VvPKI6ieOV0WSvkb8HcUwdMidr5JocJQ+5FS8EPFOwVwn0Kxi2GwHb9vCnN++9UrjGO8Yr5hDZ6ETNXYmxXmokhBJ+XEco7NIhktQ8B9dUpT+bvRI2XjBeFYdMWPo24ZBxZhMOGWc24ZBxZhMOGWf2P2NOZ7rj4a6NAAAAAElFTkSuQmCC",alt:"minusplus icon",width:"70",height:"30"})],-1))),oM={"data-i18n":"minusplus-button",class:"param"},lM=OI((()=>ai("td",null,[ai("img",{src:kI,alt:"turbo icon",width:"70",height:"70"})],-1))),hM={"data-i18n":"turbo-button",class:"param"},cM=OI((()=>ai("li",{style:{height:"20px"}},null,-1)));const uM=Er(FI,[["render",function(t,e,n,s,i,r){return qs(),Js("div",DI,[ai("ul",null,[ai("li",LI,M(t.$t("message.intro-1")),1),ai("li",NI,M(t.$t("message.intro-2")),1),ai("li",BI,[VI,hi(" "+M(t.$t("message.intro-3")),1)]),ai("li",UI,[XI,hi(" "+M(t.$t("message.intro-4")),1)]),ai("li",YI,[WI,hi(" "+M(t.$t("message.intro-5")),1)]),ai("li",null,[ai("span",zI,M(t.$t("message.intro-gameFunc")),1),ai("table",GI,[ai("tr",null,[ai("th",HI,M(t.$t("message.intro-button")),1),ai("th",jI,M(t.$t("message.intro-func")),1)]),ai("tr",null,[$I,ai("td",qI,M(t.$t("message.intro-playButton")),1)]),ai("tr",null,[KI,ai("td",ZI,M(t.$t("message.intro-autoplayButton")),1)]),ai("tr",null,[QI,ai("td",JI,M(t.$t("message.intro-leftMode")),1)]),ai("tr",null,[tM,ai("td",eM,M(t.$t("message.intro-maxBet")),1)]),ai("tr",null,[nM,ai("td",sM,M(t.$t("message.intro-sound")),1)]),ai("tr",null,[iM,ai("td",rM,M(t.$t("message.intro-music")),1)]),ai("tr",null,[aM,ai("td",oM,M(t.$t("message.intro-minusPlus")),1)]),ai("tr",null,[lM,ai("td",hM,M(t.$t("message.intro-turbo")),1)])])]),cM])])}],["__scopeId","data-v-404a499d"]]),dM={name:"FeaturesSection"},fM=t=>(xn("data-v-39abdacc"),t=t(),yn(),t),pM={class:"features-section"},mM=fM((()=>ai("h4",{"data-i18n":"Bonuses",class:"title"},"Bonus",-1))),gM={style:{"padding-left":"0px"}},vM={"data-i18n":"mysterytoken",class:"param"},xM=fM((()=>ai("b",null,"Mystery Token ",-1))),yM=fM((()=>ai("br",null,null,-1))),_M={"data-i18n":"overall",class:"param"},bM=fM((()=>ai("b",null,"Golden Spin ",-1))),wM={"data-i18n":"pick-value",class:"param"},EM={"data-i18n":"pick-number",class:"param"},TM={class:"pick-number-table"},SM={"data-i18n":"scatters",class:"param"},AM={"data-i18n":"picks",class:"param"},CM=fM((()=>ai("tr",null,[ai("td",{"data-i18n":"3",class:"param"},"3"),ai("td",{"data-i18n":"spin1",class:"param"},"1")],-1))),IM=fM((()=>ai("tr",null,[ai("td",{"data-i18n":"4",class:"param"},"4"),ai("td",{"data-i18n":"spin2",class:"param"},"3")],-1))),MM=fM((()=>ai("tr",null,[ai("td",{"data-i18n":"5",class:"param"},"5"),ai("td",{"data-i18n":"spin3",class:"param"},"5")],-1))),RM={"data-i18n":"freespin"},PM={class:"param"},kM={class:"param"},FM={class:"param"};const OM=Er(dM,[["render",function(t,e,n,s,i,r){return qs(),Js("div",null,[ai("div",pM,[mM,ai("ul",gM,[ai("li",vM,[ai("p",null,[xM,hi(M(t.$t("message.features-mysToken")),1)])]),yM,ai("li",null,[ai("p",_M,[bM,hi(M(t.$t("message.features-goldenSpin")),1)]),ai("p",wM,M(t.$t("message.features-pickValue")),1),ai("p",EM,M(t.$t("message.features-pickNumber")),1),ai("table",TM,[ai("tr",null,[ai("th",SM,M(t.$t("message.features-scatters")),1),ai("th",AM,M(t.$t("message.features-picks")),1)]),CM,IM,MM])]),ai("li",RM,[ai("p",PM,M(t.$t("message.features-freeSpin1")),1),ai("p",kM,M(t.$t("message.features-freeSpin2")),1),ai("p",FM,M(t.$t("message.features-freeSpin3")),1)])])])])}],["__scopeId","data-v-39abdacc"]]),DM={class:"moreinfo-section"},LM={"data-i18n":"autoplay",class:"title"},NM={style:{"padding-left":"0px"}},BM={"data-i18n":"general",class:"param"},VM={"data-i18n":"note-1",class:"param"},UM={"data-i18n":"note-2",class:"param"};const XM=Er({name:"MoreInfoSection"},[["render",function(t,e,n,s,i,r){return qs(),Js("div",DM,[ai("h4",LM,M(t.$t("message.moreInfo-autoPlay")),1),ai("ul",NM,[ai("li",BM,M(t.$t("message.moreInfo-general")),1),ai("li",VM,M(t.$t("message.moreInfo-note1")),1),ai("li",UM,M(t.$t("message.moreInfo-note2")),1)])])}],["__scopeId","data-v-68d22d2f"]]),YM=t=>(xn("data-v-69207aa7"),t=t(),yn(),t),WM={key:0,class:"modal menu-modal"},zM={class:"outer"},GM={class:"inner"},HM={class:"content-section",ref:"content"},jM={class:"bottom-bar"},$M={class:"tab-selectors"},qM=["onClick"],KM=YM((()=>ai("span",null,null,-1))),ZM={class:"dropdown-tabs",style:{"text-align":"center"}},QM={key:0,class:"dropdown"},JM=["onClick"],tR={class:"content"},eR=[YM((()=>ai("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACQAAAAYCAYAAACSuF9OAAAACXBIWXMAACE4AAAhOAFFljFgAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAECSURBVHgBxZfdDYMwDIQ9AiMwAhvBCGxANqEbdYSM0BGudgsSQiR2wIFPylP8c0nIAUQXATDx+CxjoidZxOx5RlRCzDOiuGEPnZ7ugBt1y/OiITEd1YQbtDwi7EhsSzU4IaaeKC7Y8HjjPJLbkBdcbDY01ATP5AHy11uI+B+n5Uiv2YFVzCa+nijoXnN4rWGzhTKPMhYdMvkDTiwmVcyy7cFQJyg1IjQ78BLjIgo2r3lRIZKj1Dz2KNi8ptjcjAud90mTkhBxwf5RYgfQb0SEw7vIKGqUwNx2un5CQLeTSMgzkDNQTkQCYmIuUCWQtoPfDo13ilFEhe3k+isT6CaO+n4B8AieGNSTQegAAAAASUVORK5CYII=",style:{width:"20px"}},null,-1)))],nR=Er(kn({__name:"menu-modal",setup(t){const e=Ne(!1);let n=Ne(4),s=Ne(!1),i=[{name:"paytable-tab",code:"Paytable"},{name:"introduction-tab",code:"intro"},{name:"features-tab",code:"features"},{name:"info-tab",code:"info"},{name:"settings-tab",code:"settings"}];API.showMainMenu=function(t){e.value=t};const r=()=>{e.value=!1,pgame.sound.Click.play()},a=t=>{n.value=t,pgame.sound.Click.play()},o=()=>{s.value=!s.value,pgame.sound.Click.play()},l=()=>({transform:s.value?"rotate(0deg)":"rotate(-180deg)"});return(t,h)=>e.value?(qs(),Js("div",WM,[ai("div",zM,[ai("div",GM,[ai("div",{class:"general-button close-button",onClick:r}),ai("div",HM,[Ue(n)<Ue(i).length&&"Paytable"===Ue(i)[Ue(n)].code?(qs(),ti(SI,{key:0})):ci("",!0),Ue(n)<Ue(i).length&&"settings"===Ue(i)[Ue(n)].code?(qs(),ti(NC,{key:1})):ci("",!0),Ue(n)<Ue(i).length&&"intro"===Ue(i)[Ue(n)].code?(qs(),ti(uM,{key:2})):ci("",!0),Ue(n)<Ue(i).length&&"features"===Ue(i)[Ue(n)].code?(qs(),ti(OM,{key:3})):ci("",!0),Ue(n)<Ue(i).length&&"info"===Ue(i)[Ue(n)].code?(qs(),ti(XM,{key:4})):ci("",!0)],512),ai("div",jM,[ai("div",$M,[(qs(!0),Js(Ws,null,ss(Ue(i),((e,s)=>(qs(),Js("div",{class:T(["tab-selector title",{active:Ue(n)<Ue(i).length&&Ue(n)===s}]),style:{"text-align":"center"},onClick:t=>a(s),key:s},[hi(M(t.$t(`message.${e.name}`))+" ",1),KM],10,qM)))),128))]),ai("div",ZM,[Ue(s)?(qs(),Js("div",QM,[ai("ul",null,[(qs(!0),Js(Ws,null,ss(Ue(i),((e,n)=>(qs(),Js("li",{onClick:t=>{a(n),o()},key:n,class:"bg-hover"},M(t.$t("message."+e.name)),9,JM)))),128))])])):ci("",!0),ai("div",{class:"current-tab",onClick:o},[ai("div",tR,M(t.$t("message."+Ue(i)[Ue(n)].name)),1),ai("div",{class:"chevron",style:l},eR)])])])])])])):ci("",!0)}}),[["__scopeId","data-v-69207aa7"]]),sR=t=>(xn("data-v-9f0b22b9"),t=t(),yn(),t),iR={key:0,class:"modal cheat-modal"},rR={class:"outer"},aR={class:"inner"},oR=sR((()=>ai("label",{for:"cheat-enable"},"Enable cheat",-1))),lR=sR((()=>ai("label",{for:"cheat-option-comb"},"Choose combination",-1))),hR=sR((()=>ai("label",{for:"cheat-option-input"},"Input a number",-1))),cR=sR((()=>ai("label",{for:"cheat-symbid"},"Symbol ID: ",-1))),uR=["value"],dR={key:0},fR={key:1},pR={key:2},mR=sR((()=>ai("label",{for:"cheat-nsymb"},"Number of symbols: ",-1))),gR=["value"],vR={key:0},xR={key:1},yR=sR((()=>ai("label",{for:"cheat-rnd"},"Random number: ",-1))),_R=sR((()=>ai("div",{style:{"text-align":"center"}},[ai("p",null,"MYSTERY WIN CHEAT CODE:"),ai("p",null,"1149077684, 1153342357")],-1)));const bR=Er({name:"Modals",data:()=>({app_bg:"url('img/loader_black.png')",bg_position:"top",soundOn:!1,musicOn:!1,modalOn:"menu",enableModal:!0,isLandscape:window.innerWidth>window.innerHeight,canvasLoaded:!1}),created(){window.addEventListener("resize",this.myEventHandler)},destroyed(){window.removeEventListener("resize",this.myEventHandler)},methods:{myEventHandler(t){this.isLandscape=window.innerWidth>window.innerHeight},showAutoplay(){this.$refs.autoplay.enable=!0}},computed:{modalStyle(){return{display:this.enableModal?"block":"none"}},modalsClass(){return{modals:!0,"portrait-modals":!this.isLandscape}}},components:{autoplayModalVue:iC,soundModalVue:pC,menuModalVue:nR,cheatModalVue:Er(kn({__name:"cheat-modal",setup(t){const e=Ne(!1);API.showCheatPanel=t=>{e.value=t};let n=!0;const s=Ne("comb");let i=0;const r=Array.from({length:10},((t,e)=>e));let a=3;const o=Array.from({length:3},((t,e)=>3+e));let l=0;function h(){e.value=!1,n?("comb"==s.value?pgame.data.cheatRND=pgame.ce.combCheatTable[i][a-3]:pgame.data.cheatRND=l=Math.floor(l),console.debug(`Choose random number: ${pgame.data.cheatRND}`)):pgame.data.cheatRND=void 0}return(t,c)=>e.value?(qs(),Js("div",iR,[ai("div",rR,[ai("div",aR,[ai("p",null,[Zn(ai("input",{type:"checkbox",id:"cheat-enable","onUpdate:modelValue":c[0]||(c[0]=t=>Le(n)?n.value=t:n=t)},null,512),[[Zi,Ue(n)]]),oR]),ai("p",null,[Zn(ai("input",{type:"radio",id:"cheat-option-comb",name:"cheat-option",value:"comb","onUpdate:modelValue":c[1]||(c[1]=t=>s.value=t)},null,512),[[Ji,s.value]]),lR,Zn(ai("input",{type:"radio",id:"cheat-option-input",name:"cheat-option",value:"input","onUpdate:modelValue":c[2]||(c[2]=t=>s.value=t)},null,512),[[Ji,s.value]]),hR]),Zn(ai("p",null,[cR,Zn(ai("select",{id:"cheat-symbid","onUpdate:modelValue":c[3]||(c[3]=t=>Le(i)?i.value=t:i=t)},[(qs(!0),Js(Ws,null,ss(Ue(r),(t=>(qs(),Js("option",{key:t,value:t},[8===t?(qs(),Js("p",dR,"Wild")):9===t?(qs(),Js("p",fR,"Scatter")):(qs(),Js("p",pR,M(t),1))],8,uR)))),128))],512),[[tr,Ue(i)]]),hi("     "),mR,Zn(ai("select",{id:"cheat-nsymb","onUpdate:modelValue":c[4]||(c[4]=t=>Le(a)?a.value=t:a=t)},[(qs(!0),Js(Ws,null,ss(Ue(o),(t=>(qs(),Js("option",{key:t,value:t},[t<10?(qs(),Js("h1",vR,M(t),1)):(qs(),Js("h1",xR,M(">=10")))],8,gR)))),128))],512),[[tr,Ue(a)]])],512),[[ir,"comb"==s.value]]),Zn(ai("p",null,[yR,Zn(ai("input",{type:"number",id:"cheat-rnd",min:"0",step:"1","onUpdate:modelValue":c[5]||(c[5]=t=>Le(l)?l.value=t:l=t)},null,512),[[Ki,Ue(l)]]),_R],512),[[ir,"input"==s.value]]),ai("button",{onClick:h},"Confirm")])])])):ci("",!0)}}),[["__scopeId","data-v-9f0b22b9"]])}},[["render",function(t,e,n,s,i,r){const a=ts("autoplayModalVue"),o=ts("soundModalVue"),l=ts("menuModalVue"),h=ts("cheatModalVue");return qs(),Js("div",{class:T(r.modalsClass),style:y(r.modalStyle)},[oi(a,{ref:"autoplay"},null,512),oi(o,{ref:"sound"},null,512),oi(l,{ref:"menu"},null,512),oi(h)],6)}]]),wR=(t=>(xn("data-v-6f923fac"),t=t(),yn(),t))((()=>ai("div",{id:"blank-page"},null,-1))),ER=Er(kn({__name:"App",setup(t){const e=Ne();let n=!1,s=!1;const i=Ne(0),r=API.toggleCanvas,a=.1;let o;function l(){const{vb:t,MainGame:n}=o;if(i.value=a,void 0===e.value)return;new n(e.value),pgame.assets.onTotalProgress=t=>{i.value=a+(1-a)*t};const s=()=>{t.isMobile()&&!t.isApple()&&(document.body.ontouchend=()=>{t.isFullscreen()||t.enterFullscreen()}),window.addEventListener("resize",(()=>{pgame.detectStyleAndResize(document.body.clientWidth,window.innerHeight-.1)})),window.dispatchEvent(new Event("resize")),r.value=!0};pgame.onGameReady=()=>{setTimeout(s,100)}}return v((()=>import("./MainGame-7b8b4753.js")),[],import.meta.url).then((t=>{o=t,n&&l(),s=!0})),Yn((()=>{s&&l(),n=!0})),(t,n)=>(qs(),Js(Ws,null,[Zn(oi(Tr,{"progress-num":i.value},null,8,["progress-num"]),[[ir,!Ue(r)]]),wR,Zn(ai("canvas",{id:"game-canvas",ref_key:"canvas",ref:e},null,512),[[ir,Ue(r)]]),oi(bR,{ref:"modals"},null,512)],64))}}),[["__scopeId","data-v-6f923fac"]]),TR="undefined"!=typeof window,SR="function"==typeof Symbol&&"symbol"==typeof Symbol.toStringTag,AR=t=>SR?Symbol(t):t,CR=(t,e,n)=>IR({l:t,k:e,s:n}),IR=t=>JSON.stringify(t).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029").replace(/\u0027/g,"\\u0027"),MR=t=>"number"==typeof t&&isFinite(t),RR=t=>"[object Date]"===HR(t),PR=t=>"[object RegExp]"===HR(t),kR=t=>jR(t)&&0===Object.keys(t).length;function FR(t,e){"undefined"!=typeof console&&(console.warn("[intlify] "+t),e&&console.warn(e.stack))}const OR=Object.assign;let DR;const LR=()=>DR||(DR="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{});function NR(t){return t.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")}const BR=Object.prototype.hasOwnProperty;function VR(t,e){return BR.call(t,e)}const UR=Array.isArray,XR=t=>"function"==typeof t,YR=t=>"string"==typeof t,WR=t=>"boolean"==typeof t,zR=t=>null!==t&&"object"==typeof t,GR=Object.prototype.toString,HR=t=>GR.call(t),jR=t=>"[object Object]"===HR(t),$R={EXPECTED_TOKEN:1,INVALID_TOKEN_IN_PLACEHOLDER:2,UNTERMINATED_SINGLE_QUOTE_IN_PLACEHOLDER:3,UNKNOWN_ESCAPE_SEQUENCE:4,INVALID_UNICODE_ESCAPE_SEQUENCE:5,UNBALANCED_CLOSING_BRACE:6,UNTERMINATED_CLOSING_BRACE:7,EMPTY_PLACEHOLDER:8,NOT_ALLOW_NEST_PLACEHOLDER:9,INVALID_LINKED_FORMAT:10,MUST_HAVE_MESSAGES_IN_PLURAL:11,UNEXPECTED_EMPTY_LINKED_MODIFIER:12,UNEXPECTED_EMPTY_LINKED_KEY:13,UNEXPECTED_LEXICAL_ANALYSIS:14,__EXTEND_POINT__:15};function qR(t,e,n={}){const{domain:s,messages:i,args:r}=n,a=new SyntaxError(String(t));return a.code=t,e&&(a.location=e),a.domain=s,a}function KR(t){throw t}function ZR(t,e,n){const s={start:t,end:e};return null!=n&&(s.source=n),s}const QR=" ",JR="\r",tP="\n",eP=String.fromCharCode(8232),nP=String.fromCharCode(8233);function sP(t){const e=t;let n=0,s=1,i=1,r=0;const a=t=>e[t]===JR&&e[t+1]===tP,o=t=>e[t]===nP,l=t=>e[t]===eP,h=t=>a(t)||(t=>e[t]===tP)(t)||o(t)||l(t),c=t=>a(t)||o(t)||l(t)?tP:e[t];function u(){return r=0,h(n)&&(s++,i=0),a(n)&&n++,n++,i++,e[n]}return{index:()=>n,line:()=>s,column:()=>i,peekOffset:()=>r,charAt:c,currentChar:()=>c(n),currentPeek:()=>c(n+r),next:u,peek:function(){return a(n+r)&&r++,r++,e[n+r]},reset:function(){n=0,s=1,i=1,r=0},resetPeek:function(t=0){r=t},skipToPeek:function(){const t=n+r;for(;t!==n;)u();r=0}}}const iP=void 0,rP="'",aP="tokenizer";function oP(t,e={}){const n=!1!==e.location,s=sP(t),i=()=>s.index(),r=()=>{return t=s.line(),e=s.column(),n=s.index(),{line:t,column:e,offset:n};var t,e,n},a=r(),o=i(),l={currentType:14,offset:o,startLoc:a,endLoc:a,lastType:14,lastOffset:o,lastStartLoc:a,lastEndLoc:a,braceNest:0,inLinked:!1,text:""},h=()=>l,{onError:c}=e;function u(t,e,n,...s){const i=h();if(e.column+=n,e.offset+=n,c){const n=qR(t,ZR(i.startLoc,e),{domain:aP,args:s});c(n)}}function d(t,e,s){t.endLoc=r(),t.currentType=e;const i={type:e};return n&&(i.loc=ZR(t.startLoc,t.endLoc)),null!=s&&(i.value=s),i}const f=t=>d(t,14);function p(t,e){return t.currentChar()===e?(t.next(),e):(u($R.EXPECTED_TOKEN,r(),0,e),"")}function m(t){let e="";for(;t.currentPeek()===QR||t.currentPeek()===tP;)e+=t.currentPeek(),t.peek();return e}function g(t){const e=m(t);return t.skipToPeek(),e}function v(t){if(t===iP)return!1;const e=t.charCodeAt(0);return e>=97&&e<=122||e>=65&&e<=90||95===e}function x(t,e){const{currentType:n}=e;if(2!==n)return!1;m(t);const s=function(t){if(t===iP)return!1;const e=t.charCodeAt(0);return e>=48&&e<=57}("-"===t.currentPeek()?t.peek():t.currentPeek());return t.resetPeek(),s}function y(t){m(t);const e="|"===t.currentPeek();return t.resetPeek(),e}function _(t,e=!0){const n=(e=!1,s="",i=!1)=>{const r=t.currentPeek();return"{"===r?"%"!==s&&e:"@"!==r&&r?"%"===r?(t.peek(),n(e,"%",!0)):"|"===r?!("%"!==s&&!i)||!(s===QR||s===tP):r===QR?(t.peek(),n(!0,QR,i)):r!==tP||(t.peek(),n(!0,tP,i)):"%"===s||e},s=n();return e&&t.resetPeek(),s}function b(t,e){const n=t.currentChar();return n===iP?iP:e(n)?(t.next(),n):null}function w(t){return b(t,(t=>{const e=t.charCodeAt(0);return e>=97&&e<=122||e>=65&&e<=90||e>=48&&e<=57||95===e||36===e}))}function E(t){return b(t,(t=>{const e=t.charCodeAt(0);return e>=48&&e<=57}))}function T(t){return b(t,(t=>{const e=t.charCodeAt(0);return e>=48&&e<=57||e>=65&&e<=70||e>=97&&e<=102}))}function S(t){let e="",n="";for(;e=E(t);)n+=e;return n}function A(t){let e="";for(;;){const n=t.currentChar();if("{"===n||"}"===n||"@"===n||"|"===n||!n)break;if("%"===n){if(!_(t))break;e+=n,t.next()}else if(n===QR||n===tP)if(_(t))e+=n,t.next();else{if(y(t))break;e+=n,t.next()}else e+=n,t.next()}return e}function C(t){const e=t.currentChar();switch(e){case"\\":case"'":return t.next(),`\\${e}`;case"u":return I(t,e,4);case"U":return I(t,e,6);default:return u($R.UNKNOWN_ESCAPE_SEQUENCE,r(),0,e),""}}function I(t,e,n){p(t,e);let s="";for(let i=0;i<n;i++){const n=T(t);if(!n){u($R.INVALID_UNICODE_ESCAPE_SEQUENCE,r(),0,`\\${e}${s}${t.currentChar()}`);break}s+=n}return`\\${e}${s}`}function M(t){g(t);const e=p(t,"|");return g(t),e}function R(t,e){let n=null;switch(t.currentChar()){case"{":return e.braceNest>=1&&u($R.NOT_ALLOW_NEST_PLACEHOLDER,r(),0),t.next(),n=d(e,2,"{"),g(t),e.braceNest++,n;case"}":return e.braceNest>0&&2===e.currentType&&u($R.EMPTY_PLACEHOLDER,r(),0),t.next(),n=d(e,3,"}"),e.braceNest--,e.braceNest>0&&g(t),e.inLinked&&0===e.braceNest&&(e.inLinked=!1),n;case"@":return e.braceNest>0&&u($R.UNTERMINATED_CLOSING_BRACE,r(),0),n=P(t,e)||f(e),e.braceNest=0,n;default:let s=!0,i=!0,a=!0;if(y(t))return e.braceNest>0&&u($R.UNTERMINATED_CLOSING_BRACE,r(),0),n=d(e,1,M(t)),e.braceNest=0,e.inLinked=!1,n;if(e.braceNest>0&&(5===e.currentType||6===e.currentType||7===e.currentType))return u($R.UNTERMINATED_CLOSING_BRACE,r(),0),e.braceNest=0,k(t,e);if(s=function(t,e){const{currentType:n}=e;if(2!==n)return!1;m(t);const s=v(t.currentPeek());return t.resetPeek(),s}(t,e))return n=d(e,5,function(t){g(t);let e="",n="";for(;e=w(t);)n+=e;return t.currentChar()===iP&&u($R.UNTERMINATED_CLOSING_BRACE,r(),0),n}(t)),g(t),n;if(i=x(t,e))return n=d(e,6,function(t){g(t);let e="";return"-"===t.currentChar()?(t.next(),e+=`-${S(t)}`):e+=S(t),t.currentChar()===iP&&u($R.UNTERMINATED_CLOSING_BRACE,r(),0),e}(t)),g(t),n;if(a=function(t,e){const{currentType:n}=e;if(2!==n)return!1;m(t);const s=t.currentPeek()===rP;return t.resetPeek(),s}(t,e))return n=d(e,7,function(t){g(t),p(t,"'");let e="",n="";const s=t=>t!==rP&&t!==tP;for(;e=b(t,s);)n+="\\"===e?C(t):e;const i=t.currentChar();return i===tP||i===iP?(u($R.UNTERMINATED_SINGLE_QUOTE_IN_PLACEHOLDER,r(),0),i===tP&&(t.next(),p(t,"'")),n):(p(t,"'"),n)}(t)),g(t),n;if(!s&&!i&&!a)return n=d(e,13,function(t){g(t);let e="",n="";const s=t=>"{"!==t&&"}"!==t&&t!==QR&&t!==tP;for(;e=b(t,s);)n+=e;return n}(t)),u($R.INVALID_TOKEN_IN_PLACEHOLDER,r(),0,n.value),g(t),n}return n}function P(t,e){const{currentType:n}=e;let s=null;const i=t.currentChar();switch(8!==n&&9!==n&&12!==n&&10!==n||i!==tP&&i!==QR||u($R.INVALID_LINKED_FORMAT,r(),0),i){case"@":return t.next(),s=d(e,8,"@"),e.inLinked=!0,s;case".":return g(t),t.next(),d(e,9,".");case":":return g(t),t.next(),d(e,10,":");default:return y(t)?(s=d(e,1,M(t)),e.braceNest=0,e.inLinked=!1,s):function(t,e){const{currentType:n}=e;if(8!==n)return!1;m(t);const s="."===t.currentPeek();return t.resetPeek(),s}(t,e)||function(t,e){const{currentType:n}=e;if(8!==n&&12!==n)return!1;m(t);const s=":"===t.currentPeek();return t.resetPeek(),s}(t,e)?(g(t),P(t,e)):function(t,e){const{currentType:n}=e;if(9!==n)return!1;m(t);const s=v(t.currentPeek());return t.resetPeek(),s}(t,e)?(g(t),d(e,12,function(t){let e="",n="";for(;e=w(t);)n+=e;return n}(t))):function(t,e){const{currentType:n}=e;if(10!==n)return!1;const s=()=>{const e=t.currentPeek();return"{"===e?v(t.peek()):!("@"===e||"%"===e||"|"===e||":"===e||"."===e||e===QR||!e)&&(e===tP?(t.peek(),s()):v(e))},i=s();return t.resetPeek(),i}(t,e)?(g(t),"{"===i?R(t,e)||s:d(e,11,function(t){const e=(n=!1,s)=>{const i=t.currentChar();return"{"!==i&&"%"!==i&&"@"!==i&&"|"!==i&&i?i===QR?s:i===tP?(s+=i,t.next(),e(n,s)):(s+=i,t.next(),e(!0,s)):s};return e(!1,"")}(t))):(8===n&&u($R.INVALID_LINKED_FORMAT,r(),0),e.braceNest=0,e.inLinked=!1,k(t,e))}}function k(t,e){let n={type:14};if(e.braceNest>0)return R(t,e)||f(e);if(e.inLinked)return P(t,e)||f(e);switch(t.currentChar()){case"{":return R(t,e)||f(e);case"}":return u($R.UNBALANCED_CLOSING_BRACE,r(),0),t.next(),d(e,3,"}");case"@":return P(t,e)||f(e);default:if(y(t))return n=d(e,1,M(t)),e.braceNest=0,e.inLinked=!1,n;const{isModulo:s,hasSpace:i}=function(t){const e=m(t),n="%"===t.currentPeek()&&"{"===t.peek();return t.resetPeek(),{isModulo:n,hasSpace:e.length>0}}(t);if(s)return i?d(e,0,A(t)):d(e,4,function(t){g(t);const e=t.currentChar();return"%"!==e&&u($R.EXPECTED_TOKEN,r(),0,e),t.next(),"%"}(t));if(_(t))return d(e,0,A(t))}return n}return{nextToken:function(){const{currentType:t,offset:e,startLoc:n,endLoc:a}=l;return l.lastType=t,l.lastOffset=e,l.lastStartLoc=n,l.lastEndLoc=a,l.offset=i(),l.startLoc=r(),s.currentChar()===iP?d(l,14):k(s,l)},currentOffset:i,currentPosition:r,context:h}}const lP="parser",hP=/(?:\\\\|\\'|\\u([0-9a-fA-F]{4})|\\U([0-9a-fA-F]{6}))/g;function cP(t,e,n){switch(t){case"\\\\":return"\\";case"\\'":return"'";default:{const t=parseInt(e||n,16);return t<=55295||t>=57344?String.fromCodePoint(t):"�"}}}function uP(t={}){const e=!1!==t.location,{onError:n}=t;function s(t,e,s,i,...r){const a=t.currentPosition();if(a.offset+=i,a.column+=i,n){const t=qR(e,ZR(s,a),{domain:lP,args:r});n(t)}}function i(t,n,s){const i={type:t,start:n,end:n};return e&&(i.loc={start:s,end:s}),i}function r(t,n,s,i){t.end=n,i&&(t.type=i),e&&t.loc&&(t.loc.end=s)}function a(t,e){const n=t.context(),s=i(3,n.offset,n.startLoc);return s.value=e,r(s,t.currentOffset(),t.currentPosition()),s}function o(t,e){const n=t.context(),{lastOffset:s,lastStartLoc:a}=n,o=i(5,s,a);return o.index=parseInt(e,10),t.nextToken(),r(o,t.currentOffset(),t.currentPosition()),o}function l(t,e){const n=t.context(),{lastOffset:s,lastStartLoc:a}=n,o=i(4,s,a);return o.key=e,t.nextToken(),r(o,t.currentOffset(),t.currentPosition()),o}function h(t,e){const n=t.context(),{lastOffset:s,lastStartLoc:a}=n,o=i(9,s,a);return o.value=e.replace(hP,cP),t.nextToken(),r(o,t.currentOffset(),t.currentPosition()),o}function c(t){const e=t.context(),n=i(6,e.offset,e.startLoc);let a=t.nextToken();if(9===a.type){const e=function(t){const e=t.nextToken(),n=t.context(),{lastOffset:a,lastStartLoc:o}=n,l=i(8,a,o);return 12!==e.type?(s(t,$R.UNEXPECTED_EMPTY_LINKED_MODIFIER,n.lastStartLoc,0),l.value="",r(l,a,o),{nextConsumeToken:e,node:l}):(null==e.value&&s(t,$R.UNEXPECTED_LEXICAL_ANALYSIS,n.lastStartLoc,0,dP(e)),l.value=e.value||"",r(l,t.currentOffset(),t.currentPosition()),{node:l})}(t);n.modifier=e.node,a=e.nextConsumeToken||t.nextToken()}switch(10!==a.type&&s(t,$R.UNEXPECTED_LEXICAL_ANALYSIS,e.lastStartLoc,0,dP(a)),a=t.nextToken(),2===a.type&&(a=t.nextToken()),a.type){case 11:null==a.value&&s(t,$R.UNEXPECTED_LEXICAL_ANALYSIS,e.lastStartLoc,0,dP(a)),n.key=function(t,e){const n=t.context(),s=i(7,n.offset,n.startLoc);return s.value=e,r(s,t.currentOffset(),t.currentPosition()),s}(t,a.value||"");break;case 5:null==a.value&&s(t,$R.UNEXPECTED_LEXICAL_ANALYSIS,e.lastStartLoc,0,dP(a)),n.key=l(t,a.value||"");break;case 6:null==a.value&&s(t,$R.UNEXPECTED_LEXICAL_ANALYSIS,e.lastStartLoc,0,dP(a)),n.key=o(t,a.value||"");break;case 7:null==a.value&&s(t,$R.UNEXPECTED_LEXICAL_ANALYSIS,e.lastStartLoc,0,dP(a)),n.key=h(t,a.value||"");break;default:s(t,$R.UNEXPECTED_EMPTY_LINKED_KEY,e.lastStartLoc,0);const c=t.context(),u=i(7,c.offset,c.startLoc);return u.value="",r(u,c.offset,c.startLoc),n.key=u,r(n,c.offset,c.startLoc),{nextConsumeToken:a,node:n}}return r(n,t.currentOffset(),t.currentPosition()),{node:n}}function u(t){const e=t.context(),n=i(2,1===e.currentType?t.currentOffset():e.offset,1===e.currentType?e.endLoc:e.startLoc);n.items=[];let u=null;do{const i=u||t.nextToken();switch(u=null,i.type){case 0:null==i.value&&s(t,$R.UNEXPECTED_LEXICAL_ANALYSIS,e.lastStartLoc,0,dP(i)),n.items.push(a(t,i.value||""));break;case 6:null==i.value&&s(t,$R.UNEXPECTED_LEXICAL_ANALYSIS,e.lastStartLoc,0,dP(i)),n.items.push(o(t,i.value||""));break;case 5:null==i.value&&s(t,$R.UNEXPECTED_LEXICAL_ANALYSIS,e.lastStartLoc,0,dP(i)),n.items.push(l(t,i.value||""));break;case 7:null==i.value&&s(t,$R.UNEXPECTED_LEXICAL_ANALYSIS,e.lastStartLoc,0,dP(i)),n.items.push(h(t,i.value||""));break;case 8:const r=c(t);n.items.push(r.node),u=r.nextConsumeToken||null}}while(14!==e.currentType&&1!==e.currentType);return r(n,1===e.currentType?e.lastOffset:t.currentOffset(),1===e.currentType?e.lastEndLoc:t.currentPosition()),n}function d(t){const e=t.context(),{offset:n,startLoc:a}=e,o=u(t);return 14===e.currentType?o:function(t,e,n,a){const o=t.context();let l=0===a.items.length;const h=i(1,e,n);h.cases=[],h.cases.push(a);do{const e=u(t);l||(l=0===e.items.length),h.cases.push(e)}while(14!==o.currentType);return l&&s(t,$R.MUST_HAVE_MESSAGES_IN_PLURAL,n,0),r(h,t.currentOffset(),t.currentPosition()),h}(t,n,a,o)}return{parse:function(n){const a=oP(n,OR({},t)),o=a.context(),l=i(0,o.offset,o.startLoc);return e&&l.loc&&(l.loc.source=n),l.body=d(a),14!==o.currentType&&s(a,$R.UNEXPECTED_LEXICAL_ANALYSIS,o.lastStartLoc,0,n[o.offset]||""),r(l,a.currentOffset(),a.currentPosition()),l}}}function dP(t){if(14===t.type)return"EOF";const e=(t.value||"").replace(/\r?\n/gu,"\\n");return e.length>10?e.slice(0,9)+"…":e}function fP(t,e){for(let n=0;n<t.length;n++)pP(t[n],e)}function pP(t,e){switch(t.type){case 1:fP(t.cases,e),e.helper("plural");break;case 2:fP(t.items,e);break;case 6:pP(t.key,e),e.helper("linked"),e.helper("type");break;case 5:e.helper("interpolate"),e.helper("list");break;case 4:e.helper("interpolate"),e.helper("named")}}function mP(t,e={}){const n=function(t,e={}){const n={ast:t,helpers:new Set};return{context:()=>n,helper:t=>(n.helpers.add(t),t)}}(t);n.helper("normalize"),t.body&&pP(t.body,n);const s=n.context();t.helpers=Array.from(s.helpers)}function gP(t,e){const{helper:n}=t;switch(e.type){case 0:!function(t,e){e.body?gP(t,e.body):t.push("null")}(t,e);break;case 1:!function(t,e){const{helper:n,needIndent:s}=t;if(e.cases.length>1){t.push(`${n("plural")}([`),t.indent(s());const i=e.cases.length;for(let n=0;n<i&&(gP(t,e.cases[n]),n!==i-1);n++)t.push(", ");t.deindent(s()),t.push("])")}}(t,e);break;case 2:!function(t,e){const{helper:n,needIndent:s}=t;t.push(`${n("normalize")}([`),t.indent(s());const i=e.items.length;for(let r=0;r<i&&(gP(t,e.items[r]),r!==i-1);r++)t.push(", ");t.deindent(s()),t.push("])")}(t,e);break;case 6:!function(t,e){const{helper:n}=t;t.push(`${n("linked")}(`),gP(t,e.key),e.modifier?(t.push(", "),gP(t,e.modifier),t.push(", _type")):t.push(", undefined, _type"),t.push(")")}(t,e);break;case 8:case 7:case 9:case 3:t.push(JSON.stringify(e.value),e);break;case 5:t.push(`${n("interpolate")}(${n("list")}(${e.index}))`,e);break;case 4:t.push(`${n("interpolate")}(${n("named")}(${JSON.stringify(e.key)}))`,e)}}const vP=(t,e={})=>{const n=YR(e.mode)?e.mode:"normal",s=YR(e.filename)?e.filename:"message.intl",i=!!e.sourceMap,r=null!=e.breakLineCode?e.breakLineCode:"arrow"===n?";":"\n",a=e.needIndent?e.needIndent:"arrow"!==n,o=t.helpers||[],l=function(t,e){const{sourceMap:n,filename:s,breakLineCode:i,needIndent:r}=e,a={source:t.loc.source,filename:s,code:"",column:1,line:1,offset:0,map:void 0,breakLineCode:i,needIndent:r,indentLevel:0};function o(t,e){a.code+=t}function l(t,e=!0){const n=e?i:"";o(r?n+"  ".repeat(t):n)}return{context:()=>a,push:o,indent:function(t=!0){const e=++a.indentLevel;t&&l(e)},deindent:function(t=!0){const e=--a.indentLevel;t&&l(e)},newline:function(){l(a.indentLevel)},helper:t=>`_${t}`,needIndent:()=>a.needIndent}}(t,{mode:n,filename:s,sourceMap:i,breakLineCode:r,needIndent:a});l.push("normal"===n?"function __msg__ (ctx) {":"(ctx) => {"),l.indent(a),o.length>0&&(l.push(`const { ${o.map((t=>`${t}: _${t}`)).join(", ")} } = ctx`),l.newline()),l.push("return "),gP(l,t),l.deindent(a),l.push("}");const{code:h,map:c}=l.context();return{ast:t,code:h,map:c?c.toJSON():void 0}};const xP={I18nInit:"i18n:init",FunctionTranslate:"function:translate"},yP=[];yP[0]={w:[0],i:[3,0],"[":[4],o:[7]},yP[1]={w:[1],".":[2],"[":[4],o:[7]},yP[2]={w:[2],i:[3,0],0:[3,0]},yP[3]={i:[3,0],0:[3,0],w:[1,1],".":[2,1],"[":[4,1],o:[7,1]},yP[4]={"'":[5,0],'"':[6,0],"[":[4,2],"]":[1,3],o:8,l:[4,0]},yP[5]={"'":[4,0],o:8,l:[5,0]},yP[6]={'"':[4,0],o:8,l:[6,0]};const _P=/^\s?(?:true|false|-?[\d.]+|'[^']*'|"[^"]*")\s?$/;function bP(t){if(null==t)return"o";switch(t.charCodeAt(0)){case 91:case 93:case 46:case 34:case 39:return t;case 95:case 36:case 45:return"i";case 9:case 10:case 13:case 160:case 65279:case 8232:case 8233:return"w"}return"i"}function wP(t){const e=t.trim();return("0"!==t.charAt(0)||!isNaN(parseInt(t)))&&(n=e,_P.test(n)?function(t){const e=t.charCodeAt(0);return e!==t.charCodeAt(t.length-1)||34!==e&&39!==e?t:t.slice(1,-1)}(e):"*"+e);var n}const EP=new Map;function TP(t,e){return zR(t)?t[e]:null}const SP=t=>t,AP=t=>"",CP="text",IP=t=>0===t.length?"":t.join(""),MP=t=>null==t?"":UR(t)||jR(t)&&t.toString===GR?JSON.stringify(t,null,2):String(t);function RP(t,e){return t=Math.abs(t),2===e?t?t>1?1:0:1:t?Math.min(t,2):0}function PP(t={}){const e=t.locale,n=function(t){const e=MR(t.pluralIndex)?t.pluralIndex:-1;return t.named&&(MR(t.named.count)||MR(t.named.n))?MR(t.named.count)?t.named.count:MR(t.named.n)?t.named.n:e:e}(t),s=zR(t.pluralRules)&&YR(e)&&XR(t.pluralRules[e])?t.pluralRules[e]:RP,i=zR(t.pluralRules)&&YR(e)&&XR(t.pluralRules[e])?RP:void 0,r=t.list||[],a=t.named||{};MR(t.pluralIndex)&&function(t,e){e.count||(e.count=t),e.n||(e.n=t)}(n,a);function o(e){const n=XR(t.messages)?t.messages(e):!!zR(t.messages)&&t.messages[e];return n||(t.parent?t.parent.message(e):AP)}const l=jR(t.processor)&&XR(t.processor.normalize)?t.processor.normalize:IP,h=jR(t.processor)&&XR(t.processor.interpolate)?t.processor.interpolate:MP,c={list:t=>r[t],named:t=>a[t],plural:t=>t[s(n,t.length,i)],linked:(e,...n)=>{const[s,i]=n;let r="text",a="";1===n.length?zR(s)?(a=s.modifier||a,r=s.type||r):YR(s)&&(a=s||a):2===n.length&&(YR(s)&&(a=s||a),YR(i)&&(r=i||r));let l=o(e)(c);return"vnode"===r&&UR(l)&&a&&(l=l[0]),a?(h=a,t.modifiers?t.modifiers[h]:SP)(l,r):l;var h},message:o,type:jR(t.processor)&&YR(t.processor.type)?t.processor.type:CP,interpolate:h,normalize:l};return c}let kP=null;const FP=OP(xP.FunctionTranslate);function OP(t){return e=>kP&&kP.emit(t,e)}function DP(t,e,n){return[...new Set([n,...UR(e)?e:zR(e)?Object.keys(e):YR(e)?[e]:[n]])]}function LP(t,e,n){const s=YR(n)?n:YP,i=t;i.__localeChainCache||(i.__localeChainCache=new Map);let r=i.__localeChainCache.get(s);if(!r){r=[];let t=[n];for(;UR(t);)t=NP(r,t,e);const a=UR(e)||!jR(e)?e:e.default?e.default:null;t=YR(a)?[a]:a,UR(t)&&NP(r,t,!1),i.__localeChainCache.set(s,r)}return r}function NP(t,e,n){let s=!0;for(let i=0;i<e.length&&WR(s);i++){const r=e[i];YR(r)&&(s=BP(t,e[i],n))}return s}function BP(t,e,n){let s;const i=e.split("-");do{s=VP(t,i.join("-"),n),i.splice(-1,1)}while(i.length&&!0===s);return s}function VP(t,e,n){let s=!1;if(!t.includes(e)&&(s=!0,e)){s="!"!==e[e.length-1];const i=e.replace(/!/g,"");t.push(i),(UR(n)||jR(n))&&n[i]&&(s=n[i])}return s}const UP="9.2.2",XP=-1,YP="en-US",WP="",zP=t=>`${t.charAt(0).toLocaleUpperCase()}${t.substr(1)}`;let GP,HP,jP;let $P=null;const qP=t=>{$P=t},KP=()=>$P;let ZP=null;const QP=t=>{ZP=t},JP=()=>ZP;let tk=0;function ek(t={}){const e=YR(t.version)?t.version:UP,n=YR(t.locale)?t.locale:YP,s=UR(t.fallbackLocale)||jR(t.fallbackLocale)||YR(t.fallbackLocale)||!1===t.fallbackLocale?t.fallbackLocale:n,i=jR(t.messages)?t.messages:{[n]:{}},r=jR(t.datetimeFormats)?t.datetimeFormats:{[n]:{}},a=jR(t.numberFormats)?t.numberFormats:{[n]:{}},o=OR({},t.modifiers||{},{upper:(t,e)=>"text"===e&&YR(t)?t.toUpperCase():"vnode"===e&&zR(t)&&"__v_isVNode"in t?t.children.toUpperCase():t,lower:(t,e)=>"text"===e&&YR(t)?t.toLowerCase():"vnode"===e&&zR(t)&&"__v_isVNode"in t?t.children.toLowerCase():t,capitalize:(t,e)=>"text"===e&&YR(t)?zP(t):"vnode"===e&&zR(t)&&"__v_isVNode"in t?zP(t.children):t}),l=t.pluralRules||{},h=XR(t.missing)?t.missing:null,c=!WR(t.missingWarn)&&!PR(t.missingWarn)||t.missingWarn,u=!WR(t.fallbackWarn)&&!PR(t.fallbackWarn)||t.fallbackWarn,d=!!t.fallbackFormat,f=!!t.unresolving,p=XR(t.postTranslation)?t.postTranslation:null,m=jR(t.processor)?t.processor:null,g=!WR(t.warnHtmlMessage)||t.warnHtmlMessage,v=!!t.escapeParameter,x=XR(t.messageCompiler)?t.messageCompiler:GP,y=XR(t.messageResolver)?t.messageResolver:HP||TP,_=XR(t.localeFallbacker)?t.localeFallbacker:jP||DP,b=zR(t.fallbackContext)?t.fallbackContext:void 0,w=XR(t.onWarn)?t.onWarn:FR,E=t,T=zR(E.__datetimeFormatters)?E.__datetimeFormatters:new Map,S=zR(E.__numberFormatters)?E.__numberFormatters:new Map,A=zR(E.__meta)?E.__meta:{};tk++;const C={version:e,cid:tk,locale:n,fallbackLocale:s,messages:i,modifiers:o,pluralRules:l,missing:h,missingWarn:c,fallbackWarn:u,fallbackFormat:d,unresolving:f,postTranslation:p,processor:m,warnHtmlMessage:g,escapeParameter:v,messageCompiler:x,messageResolver:y,localeFallbacker:_,fallbackContext:b,onWarn:w,__meta:A};return C.datetimeFormats=r,C.numberFormats=a,C.__datetimeFormatters=T,C.__numberFormatters=S,__INTLIFY_PROD_DEVTOOLS__&&function(t,e,n){kP&&kP.emit(xP.I18nInit,{timestamp:Date.now(),i18n:t,version:e,meta:n})}(C,e,A),C}function nk(t,e,n,s,i){const{missing:r,onWarn:a}=t;if(null!==r){const s=r(t,n,e,i);return YR(s)?s:e}return e}function sk(t,e,n){t.__localeChainCache=new Map,t.localeFallbacker(t,n,e)}const ik=t=>t;let rk=Object.create(null);let ak=$R.__EXTEND_POINT__;const ok=()=>++ak,lk={INVALID_ARGUMENT:ak,INVALID_DATE_ARGUMENT:ok(),INVALID_ISO_DATE_ARGUMENT:ok(),__EXTEND_POINT__:ok()};function hk(t){return qR(t,null,void 0)}const ck=()=>"",uk=t=>XR(t);function dk(t,...e){const{fallbackFormat:n,postTranslation:s,unresolving:i,messageCompiler:r,fallbackLocale:a,messages:o}=t,[l,h]=mk(...e),c=WR(h.missingWarn)?h.missingWarn:t.missingWarn,u=WR(h.fallbackWarn)?h.fallbackWarn:t.fallbackWarn,d=WR(h.escapeParameter)?h.escapeParameter:t.escapeParameter,f=!!h.resolvedMessage,p=YR(h.default)||WR(h.default)?WR(h.default)?r?l:()=>l:h.default:n?r?l:()=>l:"",m=n||""!==p,g=YR(h.locale)?h.locale:t.locale;d&&function(t){UR(t.list)?t.list=t.list.map((t=>YR(t)?NR(t):t)):zR(t.named)&&Object.keys(t.named).forEach((e=>{YR(t.named[e])&&(t.named[e]=NR(t.named[e]))}))}(h);let[v,x,y]=f?[l,g,o[g]||{}]:fk(t,l,g,a,u,c),_=v,b=l;if(f||YR(_)||uk(_)||m&&(_=p,b=_),!(f||(YR(_)||uk(_))&&YR(x)))return i?XP:l;let w=!1;const E=uk(_)?_:pk(t,l,x,_,b,(()=>{w=!0}));if(w)return _;const T=function(t,e,n,s){const{modifiers:i,pluralRules:r,messageResolver:a,fallbackLocale:o,fallbackWarn:l,missingWarn:h,fallbackContext:c}=t,u=s=>{let i=a(n,s);if(null==i&&c){const[,,t]=fk(c,s,e,o,l,h);i=a(t,s)}if(YR(i)){let n=!1;const r=pk(t,s,e,i,s,(()=>{n=!0}));return n?ck:r}return uk(i)?i:ck},d={locale:e,modifiers:i,pluralRules:r,messages:u};t.processor&&(d.processor=t.processor);s.list&&(d.list=s.list);s.named&&(d.named=s.named);MR(s.plural)&&(d.pluralIndex=s.plural);return d}(t,x,y,h),S=function(t,e,n){const s=e(n);return s}(0,E,PP(T)),A=s?s(S,l):S;if(__INTLIFY_PROD_DEVTOOLS__){const e={timestamp:Date.now(),key:YR(l)?l:uk(_)?_.key:"",locale:x||(uk(_)?_.locale:""),format:YR(_)?_:uk(_)?_.source:"",message:A};e.meta=OR({},t.__meta,KP()||{}),FP(e)}return A}function fk(t,e,n,s,i,r){const{messages:a,onWarn:o,messageResolver:l,localeFallbacker:h}=t,c=h(t,s,n);let u,d={},f=null;for(let p=0;p<c.length&&(u=c[p],d=a[u]||{},null===(f=l(d,e))&&(f=d[e]),!YR(f)&&!XR(f));p++){const n=nk(t,e,u,0,"translate");n!==e&&(f=n)}return[f,u,d]}function pk(t,e,n,s,i,r){const{messageCompiler:a,warnHtmlMessage:o}=t;if(uk(s)){const t=s;return t.locale=t.locale||n,t.key=t.key||e,t}if(null==a){const t=()=>s;return t.locale=n,t.key=e,t}const l=a(s,function(t,e,n,s,i,r){return{warnHtmlMessage:i,onError:t=>{throw r&&r(t),t},onCacheKey:t=>CR(e,n,t)}}(0,n,i,0,o,r));return l.locale=n,l.key=e,l.source=s,l}function mk(...t){const[e,n,s]=t,i={};if(!YR(e)&&!MR(e)&&!uk(e))throw hk(lk.INVALID_ARGUMENT);const r=MR(e)?String(e):(uk(e),e);return MR(n)?i.plural=n:YR(n)?i.default=n:jR(n)&&!kR(n)?i.named=n:UR(n)&&(i.list=n),MR(s)?i.plural=s:YR(s)?i.default=s:jR(s)&&OR(i,s),[r,i]}function gk(t,...e){const{datetimeFormats:n,unresolving:s,fallbackLocale:i,onWarn:r,localeFallbacker:a}=t,{__datetimeFormatters:o}=t,[l,h,c,u]=xk(...e);WR(c.missingWarn)?c.missingWarn:t.missingWarn;WR(c.fallbackWarn)?c.fallbackWarn:t.fallbackWarn;const d=!!c.part,f=YR(c.locale)?c.locale:t.locale,p=a(t,i,f);if(!YR(l)||""===l)return new Intl.DateTimeFormat(f,u).format(h);let m,g={},v=null;for(let _=0;_<p.length&&(m=p[_],g=n[m]||{},v=g[l],!jR(v));_++)nk(t,l,m,0,"datetime format");if(!jR(v)||!YR(m))return s?XP:l;let x=`${m}__${l}`;kR(u)||(x=`${x}__${JSON.stringify(u)}`);let y=o.get(x);return y||(y=new Intl.DateTimeFormat(m,OR({},v,u)),o.set(x,y)),d?y.formatToParts(h):y.format(h)}const vk=["localeMatcher","weekday","era","year","month","day","hour","minute","second","timeZoneName","formatMatcher","hour12","timeZone","dateStyle","timeStyle","calendar","dayPeriod","numberingSystem","hourCycle","fractionalSecondDigits"];function xk(...t){const[e,n,s,i]=t,r={};let a,o={};if(YR(e)){const t=e.match(/(\d{4}-\d{2}-\d{2})(T|\s)?(.*)/);if(!t)throw hk(lk.INVALID_ISO_DATE_ARGUMENT);const n=t[3]?t[3].trim().startsWith("T")?`${t[1].trim()}${t[3].trim()}`:`${t[1].trim()}T${t[3].trim()}`:t[1].trim();a=new Date(n);try{a.toISOString()}catch(_m){throw hk(lk.INVALID_ISO_DATE_ARGUMENT)}}else if(RR(e)){if(isNaN(e.getTime()))throw hk(lk.INVALID_DATE_ARGUMENT);a=e}else{if(!MR(e))throw hk(lk.INVALID_ARGUMENT);a=e}return YR(n)?r.key=n:jR(n)&&Object.keys(n).forEach((t=>{vk.includes(t)?o[t]=n[t]:r[t]=n[t]})),YR(s)?r.locale=s:jR(s)&&(o=s),jR(i)&&(o=i),[r.key||"",a,r,o]}function yk(t,e,n){const s=t;for(const i in n){const t=`${e}__${i}`;s.__datetimeFormatters.has(t)&&s.__datetimeFormatters.delete(t)}}function _k(t,...e){const{numberFormats:n,unresolving:s,fallbackLocale:i,onWarn:r,localeFallbacker:a}=t,{__numberFormatters:o}=t,[l,h,c,u]=wk(...e);WR(c.missingWarn)?c.missingWarn:t.missingWarn;WR(c.fallbackWarn)?c.fallbackWarn:t.fallbackWarn;const d=!!c.part,f=YR(c.locale)?c.locale:t.locale,p=a(t,i,f);if(!YR(l)||""===l)return new Intl.NumberFormat(f,u).format(h);let m,g={},v=null;for(let _=0;_<p.length&&(m=p[_],g=n[m]||{},v=g[l],!jR(v));_++)nk(t,l,m,0,"number format");if(!jR(v)||!YR(m))return s?XP:l;let x=`${m}__${l}`;kR(u)||(x=`${x}__${JSON.stringify(u)}`);let y=o.get(x);return y||(y=new Intl.NumberFormat(m,OR({},v,u)),o.set(x,y)),d?y.formatToParts(h):y.format(h)}const bk=["localeMatcher","style","currency","currencyDisplay","currencySign","useGrouping","minimumIntegerDigits","minimumFractionDigits","maximumFractionDigits","minimumSignificantDigits","maximumSignificantDigits","compactDisplay","notation","signDisplay","unit","unitDisplay","roundingMode","roundingPriority","roundingIncrement","trailingZeroDisplay"];function wk(...t){const[e,n,s,i]=t,r={};let a={};if(!MR(e))throw hk(lk.INVALID_ARGUMENT);const o=e;return YR(n)?r.key=n:jR(n)&&Object.keys(n).forEach((t=>{bk.includes(t)?a[t]=n[t]:r[t]=n[t]})),YR(s)?r.locale=s:jR(s)&&(a=s),jR(i)&&(a=i),[r.key||"",o,r,a]}function Ek(t,e,n){const s=t;for(const i in n){const t=`${e}__${i}`;s.__numberFormatters.has(t)&&s.__numberFormatters.delete(t)}}"boolean"!=typeof __INTLIFY_PROD_DEVTOOLS__&&(LR().__INTLIFY_PROD_DEVTOOLS__=!1);const Tk="9.2.2";let Sk=$R.__EXTEND_POINT__;const Ak=()=>++Sk,Ck={UNEXPECTED_RETURN_TYPE:Sk,INVALID_ARGUMENT:Ak(),MUST_BE_CALL_SETUP_TOP:Ak(),NOT_INSLALLED:Ak(),NOT_AVAILABLE_IN_LEGACY_MODE:Ak(),REQUIRED_VALUE:Ak(),INVALID_VALUE:Ak(),CANNOT_SETUP_VUE_DEVTOOLS_PLUGIN:Ak(),NOT_INSLALLED_WITH_PROVIDE:Ak(),UNEXPECTED_ERROR:Ak(),NOT_COMPATIBLE_LEGACY_VUE_I18N:Ak(),BRIDGE_SUPPORT_VUE_2_ONLY:Ak(),MUST_DEFINE_I18N_OPTION_IN_ALLOW_COMPOSITION:Ak(),NOT_AVAILABLE_COMPOSITION_IN_LEGACY:Ak(),__EXTEND_POINT__:Ak()};function Ik(t,...e){return qR(t,null,void 0)}const Mk=AR("__transrateVNode"),Rk=AR("__datetimeParts"),Pk=AR("__numberParts"),kk=AR("__setPluralRules");AR("__intlifyMeta");const Fk=AR("__injectWithOption");function Ok(t){if(!zR(t))return t;for(const e in t)if(VR(t,e))if(e.includes(".")){const n=e.split("."),s=n.length-1;let i=t;for(let t=0;t<s;t++)n[t]in i||(i[n[t]]={}),i=i[n[t]];i[n[s]]=t[e],delete t[e],zR(i[n[s]])&&Ok(i[n[s]])}else zR(t[e])&&Ok(t[e]);return t}function Dk(t,e){const{messages:n,__i18n:s,messageResolver:i,flatJson:r}=e,a=jR(n)?n:UR(s)?{}:{[t]:{}};if(UR(s)&&s.forEach((t=>{if("locale"in t&&"resource"in t){const{locale:e,resource:n}=t;e?(a[e]=a[e]||{},Nk(n,a[e])):Nk(n,a)}else YR(t)&&Nk(JSON.parse(t),a)})),null==i&&r)for(const o in a)VR(a,o)&&Ok(a[o]);return a}const Lk=t=>!zR(t)||UR(t);function Nk(t,e){if(Lk(t)||Lk(e))throw Ik(Ck.INVALID_VALUE);for(const n in t)VR(t,n)&&(Lk(t[n])||Lk(e[n])?e[n]=t[n]:Nk(t[n],e[n]))}function Bk(t){return t.type}function Vk(t,e,n){let s=zR(e.messages)?e.messages:{};"__i18nGlobal"in n&&(s=Dk(t.locale.value,{messages:s,__i18n:n.__i18nGlobal}));const i=Object.keys(s);if(i.length&&i.forEach((e=>{t.mergeLocaleMessage(e,s[e])})),zR(e.datetimeFormats)){const n=Object.keys(e.datetimeFormats);n.length&&n.forEach((n=>{t.mergeDateTimeFormat(n,e.datetimeFormats[n])}))}if(zR(e.numberFormats)){const n=Object.keys(e.numberFormats);n.length&&n.forEach((n=>{t.mergeNumberFormat(n,e.numberFormats[n])}))}}function Uk(t){return oi(zs,null,t,0)}const Xk="__INTLIFY_META__";let Yk=0;function Wk(t){return(e,n,s,i)=>t(n,s,xi()||void 0,i)}const zk=()=>{const t=xi();let e=null;return t&&(e=Bk(t)[Xk])?{[Xk]:e}:null};function Gk(t={},e){const{__root:n}=t,s=void 0===n;let i=!WR(t.inheritLocale)||t.inheritLocale;const r=Ne(n&&i?n.locale.value:YR(t.locale)?t.locale:YP),a=Ne(n&&i?n.fallbackLocale.value:YR(t.fallbackLocale)||UR(t.fallbackLocale)||jR(t.fallbackLocale)||!1===t.fallbackLocale?t.fallbackLocale:r.value),o=Ne(Dk(r.value,t)),l=Ne(jR(t.datetimeFormats)?t.datetimeFormats:{[r.value]:{}}),h=Ne(jR(t.numberFormats)?t.numberFormats:{[r.value]:{}});let c=n?n.missingWarn:!WR(t.missingWarn)&&!PR(t.missingWarn)||t.missingWarn,u=n?n.fallbackWarn:!WR(t.fallbackWarn)&&!PR(t.fallbackWarn)||t.fallbackWarn,d=n?n.fallbackRoot:!WR(t.fallbackRoot)||t.fallbackRoot,f=!!t.fallbackFormat,p=XR(t.missing)?t.missing:null,m=XR(t.missing)?Wk(t.missing):null,g=XR(t.postTranslation)?t.postTranslation:null,v=n?n.warnHtmlMessage:!WR(t.warnHtmlMessage)||t.warnHtmlMessage,x=!!t.escapeParameter;const y=n?n.modifiers:jR(t.modifiers)?t.modifiers:{};let _,b=t.pluralRules||n&&n.pluralRules;_=(()=>{s&&QP(null);const e={version:Tk,locale:r.value,fallbackLocale:a.value,messages:o.value,modifiers:y,pluralRules:b,missing:null===m?void 0:m,missingWarn:c,fallbackWarn:u,fallbackFormat:f,unresolving:!0,postTranslation:null===g?void 0:g,warnHtmlMessage:v,escapeParameter:x,messageResolver:t.messageResolver,__meta:{framework:"vue"}};e.datetimeFormats=l.value,e.numberFormats=h.value,e.__datetimeFormatters=jR(_)?_.__datetimeFormatters:void 0,e.__numberFormatters=jR(_)?_.__numberFormatters:void 0;const n=ek(e);return s&&QP(n),n})(),sk(_,r.value,a.value);const w=Ci({get:()=>r.value,set:t=>{r.value=t,_.locale=r.value}}),E=Ci({get:()=>a.value,set:t=>{a.value=t,_.fallbackLocale=a.value,sk(_,r.value,t)}}),T=Ci((()=>o.value)),S=Ci((()=>l.value)),A=Ci((()=>h.value));const C=(t,e,i,c,u,f)=>{let p;if(r.value,a.value,o.value,l.value,h.value,__INTLIFY_PROD_DEVTOOLS__)try{qP(zk()),s||(_.fallbackContext=n?JP():void 0),p=t(_)}finally{qP(null),s||(_.fallbackContext=void 0)}else p=t(_);if(MR(p)&&p===XP){const[t,s]=e();return n&&d?c(n):u(t)}if(f(p))return p;throw Ik(Ck.UNEXPECTED_RETURN_TYPE)};function I(...t){return C((e=>Reflect.apply(dk,null,[e,...t])),(()=>mk(...t)),"translate",(e=>Reflect.apply(e.t,e,[...t])),(t=>t),(t=>YR(t)))}const M={normalize:function(t){return t.map((t=>YR(t)||MR(t)||WR(t)?Uk(String(t)):t))},interpolate:t=>t,type:"vnode"};function R(t){return o.value[t]||{}}Yk++,n&&TR&&(Cn(n.locale,(t=>{i&&(r.value=t,_.locale=t,sk(_,r.value,a.value))})),Cn(n.fallbackLocale,(t=>{i&&(a.value=t,_.fallbackLocale=t,sk(_,r.value,a.value))})));const P={id:Yk,locale:w,fallbackLocale:E,get inheritLocale(){return i},set inheritLocale(t){i=t,t&&n&&(r.value=n.locale.value,a.value=n.fallbackLocale.value,sk(_,r.value,a.value))},get availableLocales(){return Object.keys(o.value).sort()},messages:T,get modifiers(){return y},get pluralRules(){return b||{}},get isGlobal(){return s},get missingWarn(){return c},set missingWarn(t){c=t,_.missingWarn=c},get fallbackWarn(){return u},set fallbackWarn(t){u=t,_.fallbackWarn=u},get fallbackRoot(){return d},set fallbackRoot(t){d=t},get fallbackFormat(){return f},set fallbackFormat(t){f=t,_.fallbackFormat=f},get warnHtmlMessage(){return v},set warnHtmlMessage(t){v=t,_.warnHtmlMessage=t},get escapeParameter(){return x},set escapeParameter(t){x=t,_.escapeParameter=t},t:I,getLocaleMessage:R,setLocaleMessage:function(t,e){o.value[t]=e,_.messages=o.value},mergeLocaleMessage:function(t,e){o.value[t]=o.value[t]||{},Nk(e,o.value[t]),_.messages=o.value},getPostTranslationHandler:function(){return XR(g)?g:null},setPostTranslationHandler:function(t){g=t,_.postTranslation=t},getMissingHandler:function(){return p},setMissingHandler:function(t){null!==t&&(m=Wk(t)),p=t,_.missing=m},[kk]:function(t){b=t,_.pluralRules=b}};return P.datetimeFormats=S,P.numberFormats=A,P.rt=function(...t){const[e,n,s]=t;if(s&&!zR(s))throw Ik(Ck.INVALID_ARGUMENT);return I(e,n,OR({resolvedMessage:!0},s||{}))},P.te=function(t,e){const n=R(YR(e)?e:r.value);return null!==_.messageResolver(n,t)},P.tm=function(t){const e=function(t){let e=null;const n=LP(_,a.value,r.value);for(let s=0;s<n.length;s++){const i=o.value[n[s]]||{},r=_.messageResolver(i,t);if(null!=r){e=r;break}}return e}(t);return null!=e?e:n&&n.tm(t)||{}},P.d=function(...t){return C((e=>Reflect.apply(gk,null,[e,...t])),(()=>xk(...t)),"datetime format",(e=>Reflect.apply(e.d,e,[...t])),(()=>WP),(t=>YR(t)))},P.n=function(...t){return C((e=>Reflect.apply(_k,null,[e,...t])),(()=>wk(...t)),"number format",(e=>Reflect.apply(e.n,e,[...t])),(()=>WP),(t=>YR(t)))},P.getDateTimeFormat=function(t){return l.value[t]||{}},P.setDateTimeFormat=function(t,e){l.value[t]=e,_.datetimeFormats=l.value,yk(_,t,e)},P.mergeDateTimeFormat=function(t,e){l.value[t]=OR(l.value[t]||{},e),_.datetimeFormats=l.value,yk(_,t,e)},P.getNumberFormat=function(t){return h.value[t]||{}},P.setNumberFormat=function(t,e){h.value[t]=e,_.numberFormats=h.value,Ek(_,t,e)},P.mergeNumberFormat=function(t,e){h.value[t]=OR(h.value[t]||{},e),_.numberFormats=h.value,Ek(_,t,e)},P[Fk]=t.__injectWithOption,P[Mk]=function(...t){return C((e=>{let n;const s=e;try{s.processor=M,n=Reflect.apply(dk,null,[s,...t])}finally{s.processor=null}return n}),(()=>mk(...t)),"translate",(e=>e[Mk](...t)),(t=>[Uk(t)]),(t=>UR(t)))},P[Rk]=function(...t){return C((e=>Reflect.apply(gk,null,[e,...t])),(()=>xk(...t)),"datetime format",(e=>e[Rk](...t)),(()=>[]),(t=>YR(t)||UR(t)))},P[Pk]=function(...t){return C((e=>Reflect.apply(_k,null,[e,...t])),(()=>wk(...t)),"number format",(e=>e[Pk](...t)),(()=>[]),(t=>YR(t)||UR(t)))},P}function Hk(t={},e){{const e=Gk(function(t){const e=YR(t.locale)?t.locale:YP,n=YR(t.fallbackLocale)||UR(t.fallbackLocale)||jR(t.fallbackLocale)||!1===t.fallbackLocale?t.fallbackLocale:e,s=XR(t.missing)?t.missing:void 0,i=!WR(t.silentTranslationWarn)&&!PR(t.silentTranslationWarn)||!t.silentTranslationWarn,r=!WR(t.silentFallbackWarn)&&!PR(t.silentFallbackWarn)||!t.silentFallbackWarn,a=!WR(t.fallbackRoot)||t.fallbackRoot,o=!!t.formatFallbackMessages,l=jR(t.modifiers)?t.modifiers:{},h=t.pluralizationRules,c=XR(t.postTranslation)?t.postTranslation:void 0,u=!YR(t.warnHtmlInMessage)||"off"!==t.warnHtmlInMessage,d=!!t.escapeParameterHtml,f=!WR(t.sync)||t.sync;let p=t.messages;if(jR(t.sharedMessages)){const e=t.sharedMessages;p=Object.keys(e).reduce(((t,n)=>{const s=t[n]||(t[n]={});return OR(s,e[n]),t}),p||{})}const{__i18n:m,__root:g,__injectWithOption:v}=t,x=t.datetimeFormats,y=t.numberFormats;return{locale:e,fallbackLocale:n,messages:p,flatJson:t.flatJson,datetimeFormats:x,numberFormats:y,missing:s,missingWarn:i,fallbackWarn:r,fallbackRoot:a,fallbackFormat:o,modifiers:l,pluralRules:h,postTranslation:c,warnHtmlMessage:u,escapeParameter:d,messageResolver:t.messageResolver,inheritLocale:f,__i18n:m,__root:g,__injectWithOption:v}}(t)),n={id:e.id,get locale(){return e.locale.value},set locale(t){e.locale.value=t},get fallbackLocale(){return e.fallbackLocale.value},set fallbackLocale(t){e.fallbackLocale.value=t},get messages(){return e.messages.value},get datetimeFormats(){return e.datetimeFormats.value},get numberFormats(){return e.numberFormats.value},get availableLocales(){return e.availableLocales},get formatter(){return{interpolate:()=>[]}},set formatter(t){},get missing(){return e.getMissingHandler()},set missing(t){e.setMissingHandler(t)},get silentTranslationWarn(){return WR(e.missingWarn)?!e.missingWarn:e.missingWarn},set silentTranslationWarn(t){e.missingWarn=WR(t)?!t:t},get silentFallbackWarn(){return WR(e.fallbackWarn)?!e.fallbackWarn:e.fallbackWarn},set silentFallbackWarn(t){e.fallbackWarn=WR(t)?!t:t},get modifiers(){return e.modifiers},get formatFallbackMessages(){return e.fallbackFormat},set formatFallbackMessages(t){e.fallbackFormat=t},get postTranslation(){return e.getPostTranslationHandler()},set postTranslation(t){e.setPostTranslationHandler(t)},get sync(){return e.inheritLocale},set sync(t){e.inheritLocale=t},get warnHtmlInMessage(){return e.warnHtmlMessage?"warn":"off"},set warnHtmlInMessage(t){e.warnHtmlMessage="off"!==t},get escapeParameterHtml(){return e.escapeParameter},set escapeParameterHtml(t){e.escapeParameter=t},get preserveDirectiveContent(){return!0},set preserveDirectiveContent(t){},get pluralizationRules(){return e.pluralRules||{}},__composer:e,t(...t){const[n,s,i]=t,r={};let a=null,o=null;if(!YR(n))throw Ik(Ck.INVALID_ARGUMENT);const l=n;return YR(s)?r.locale=s:UR(s)?a=s:jR(s)&&(o=s),UR(i)?a=i:jR(i)&&(o=i),Reflect.apply(e.t,e,[l,a||o||{},r])},rt:(...t)=>Reflect.apply(e.rt,e,[...t]),tc(...t){const[n,s,i]=t,r={plural:1};let a=null,o=null;if(!YR(n))throw Ik(Ck.INVALID_ARGUMENT);const l=n;return YR(s)?r.locale=s:MR(s)?r.plural=s:UR(s)?a=s:jR(s)&&(o=s),YR(i)?r.locale=i:UR(i)?a=i:jR(i)&&(o=i),Reflect.apply(e.t,e,[l,a||o||{},r])},te:(t,n)=>e.te(t,n),tm:t=>e.tm(t),getLocaleMessage:t=>e.getLocaleMessage(t),setLocaleMessage(t,n){e.setLocaleMessage(t,n)},mergeLocaleMessage(t,n){e.mergeLocaleMessage(t,n)},d:(...t)=>Reflect.apply(e.d,e,[...t]),getDateTimeFormat:t=>e.getDateTimeFormat(t),setDateTimeFormat(t,n){e.setDateTimeFormat(t,n)},mergeDateTimeFormat(t,n){e.mergeDateTimeFormat(t,n)},n:(...t)=>Reflect.apply(e.n,e,[...t]),getNumberFormat:t=>e.getNumberFormat(t),setNumberFormat(t,n){e.setNumberFormat(t,n)},mergeNumberFormat(t,n){e.mergeNumberFormat(t,n)},getChoiceIndex:(t,e)=>-1,__onComponentInstanceCreated(e){const{componentInstanceCreatedListener:s}=t;s&&s(e,n)}};return n}}const jk={tag:{type:[String,Object]},locale:{type:String},scope:{type:String,validator:t=>"parent"===t||"global"===t,default:"parent"},i18n:{type:Object}};function $k(t){return Ws}const qk={name:"i18n-t",props:OR({keypath:{type:String,required:!0},plural:{type:[Number,String],validator:t=>MR(t)||!isNaN(t)}},jk),setup(t,e){const{slots:n,attrs:s}=e,i=t.i18n||iF({useScope:t.scope,__useComponent:!0});return()=>{const r=Object.keys(n).filter((t=>"_"!==t)),a={};t.locale&&(a.locale=t.locale),void 0!==t.plural&&(a.plural=YR(t.plural)?+t.plural:t.plural);const o=function({slots:t},e){if(1===e.length&&"default"===e[0])return(t.default?t.default():[]).reduce(((t,e)=>[...t,...UR(e.children)?e.children:[e]]),[]);return e.reduce(((e,n)=>{const s=t[n];return s&&(e[n]=s()),e}),{})}(e,r),l=i[Mk](t.keypath,o,a),h=OR({},s);return Ii(YR(t.tag)||zR(t.tag)?t.tag:$k(),h,l)}}};function Kk(t,e,n,s){const{slots:i,attrs:r}=e;return()=>{const e={part:!0};let a={};t.locale&&(e.locale=t.locale),YR(t.format)?e.key=t.format:zR(t.format)&&(YR(t.format.key)&&(e.key=t.format.key),a=Object.keys(t.format).reduce(((e,s)=>n.includes(s)?OR({},e,{[s]:t.format[s]}):e),{}));const o=s(t.value,e,a);let l=[e.key];UR(o)?l=o.map(((t,e)=>{const n=i[t.type],s=n?n({[t.type]:t.value,index:e,parts:o}):[t.value];var r;return UR(r=s)&&!YR(r[0])&&(s[0].key=`${t.type}-${e}`),s})):YR(o)&&(l=[o]);const h=OR({},r);return Ii(YR(t.tag)||zR(t.tag)?t.tag:$k(),h,l)}}const Zk={name:"i18n-n",props:OR({value:{type:Number,required:!0},format:{type:[String,Object]}},jk),setup(t,e){const n=t.i18n||iF({useScope:"parent",__useComponent:!0});return Kk(t,e,bk,((...t)=>n[Pk](...t)))}},Qk={name:"i18n-d",props:OR({value:{type:[Number,Date],required:!0},format:{type:[String,Object]}},jk),setup(t,e){const n=t.i18n||iF({useScope:"parent",__useComponent:!0});return Kk(t,e,vk,((...t)=>n[Rk](...t)))}};function Jk(t){if(YR(t))return{path:t};if(jR(t)){if(!("path"in t))throw Ik(Ck.REQUIRED_VALUE);return t}throw Ik(Ck.INVALID_VALUE)}function tF(t){const{path:e,locale:n,args:s,choice:i,plural:r}=t,a={},o=s||{};return YR(n)&&(a.locale=n),MR(i)&&(a.plural=i),MR(r)&&(a.plural=r),[e,o,a]}function eF(t,e,...n){const s=jR(n[0])?n[0]:{},i=!!s.useI18nComponentName;(!WR(s.globalInstall)||s.globalInstall)&&(t.component(i?"i18n":qk.name,qk),t.component(Zk.name,Zk),t.component(Qk.name,Qk)),t.directive("t",function(t){const e=e=>{const{instance:n,modifiers:s,value:i}=e;if(!n||!n.$)throw Ik(Ck.UNEXPECTED_ERROR);const r=function(t,e){const n=t;if("composition"===t.mode)return n.__getInstance(e)||t.global;{const s=n.__getInstance(e);return null!=s?s.__composer:t.global.__composer}}(t,n.$),a=Jk(i);return[Reflect.apply(r.t,r,[...tF(a)]),r]};return{created:(n,s)=>{const[i,r]=e(s);TR&&t.global===r&&(n.__i18nWatcher=Cn(r.locale,(()=>{s.instance&&s.instance.$forceUpdate()}))),n.__composer=r,n.textContent=i},unmounted:t=>{TR&&t.__i18nWatcher&&(t.__i18nWatcher(),t.__i18nWatcher=void 0,delete t.__i18nWatcher),t.__composer&&(t.__composer=void 0,delete t.__composer)},beforeUpdate:(t,{value:e})=>{if(t.__composer){const n=t.__composer,s=Jk(e);t.textContent=Reflect.apply(n.t,n,[...tF(s)])}},getSSRProps:t=>{const[n]=e(t);return{textContent:n}}}}(e))}function nF(t,e){t.locale=e.locale||t.locale,t.fallbackLocale=e.fallbackLocale||t.fallbackLocale,t.missing=e.missing||t.missing,t.silentTranslationWarn=e.silentTranslationWarn||t.silentFallbackWarn,t.silentFallbackWarn=e.silentFallbackWarn||t.silentFallbackWarn,t.formatFallbackMessages=e.formatFallbackMessages||t.formatFallbackMessages,t.postTranslation=e.postTranslation||t.postTranslation,t.warnHtmlInMessage=e.warnHtmlInMessage||t.warnHtmlInMessage,t.escapeParameterHtml=e.escapeParameterHtml||t.escapeParameterHtml,t.sync=e.sync||t.sync,t.__composer[kk](e.pluralizationRules||t.pluralizationRules);const n=Dk(t.locale,{messages:e.messages,__i18n:e.__i18n});return Object.keys(n).forEach((e=>t.mergeLocaleMessage(e,n[e]))),e.datetimeFormats&&Object.keys(e.datetimeFormats).forEach((n=>t.mergeDateTimeFormat(n,e.datetimeFormats[n]))),e.numberFormats&&Object.keys(e.numberFormats).forEach((n=>t.mergeNumberFormat(n,e.numberFormats[n]))),t}const sF=AR("global-vue-i18n");function iF(t={}){const e=xi();if(null==e)throw Ik(Ck.MUST_BE_CALL_SETUP_TOP);if(!e.isCE&&null!=e.appContext.app&&!e.appContext.app.__VUE_I18N_SYMBOL__)throw Ik(Ck.NOT_INSLALLED);const n=function(t){{const e=Sn(t.isCE?sF:t.appContext.app.__VUE_I18N_SYMBOL__);if(!e)throw Ik(t.isCE?Ck.NOT_INSLALLED_WITH_PROVIDE:Ck.UNEXPECTED_ERROR);return e}}(e),s=function(t){return"composition"===t.mode?t.global:t.global.__composer}(n),i=Bk(e),r=function(t,e){return kR(t)?"__i18n"in e?"local":"global":t.useScope?t.useScope:"local"}(t,i);if(__VUE_I18N_LEGACY_API__&&"legacy"===n.mode&&!t.__useComponent){if(!n.allowComposition)throw Ik(Ck.NOT_AVAILABLE_IN_LEGACY_MODE);return function(t,e,n,s={}){const i="local"===e,r=(a=null,Be(a,!0));var a;if(i&&t.proxy&&!t.proxy.$options.i18n&&!t.proxy.$options.__i18n)throw Ik(Ck.MUST_DEFINE_I18N_OPTION_IN_ALLOW_COMPOSITION);const o=!WR(s.inheritLocale)||s.inheritLocale,l=Ne(i&&o?n.locale.value:YR(s.locale)?s.locale:YP),h=Ne(i&&o?n.fallbackLocale.value:YR(s.fallbackLocale)||UR(s.fallbackLocale)||jR(s.fallbackLocale)||!1===s.fallbackLocale?s.fallbackLocale:l.value),c=Ne(Dk(l.value,s)),u=Ne(jR(s.datetimeFormats)?s.datetimeFormats:{[l.value]:{}}),d=Ne(jR(s.numberFormats)?s.numberFormats:{[l.value]:{}}),f=i?n.missingWarn:!WR(s.missingWarn)&&!PR(s.missingWarn)||s.missingWarn,p=i?n.fallbackWarn:!WR(s.fallbackWarn)&&!PR(s.fallbackWarn)||s.fallbackWarn,m=i?n.fallbackRoot:!WR(s.fallbackRoot)||s.fallbackRoot,g=!!s.fallbackFormat,v=XR(s.missing)?s.missing:null,x=XR(s.postTranslation)?s.postTranslation:null,y=i?n.warnHtmlMessage:!WR(s.warnHtmlMessage)||s.warnHtmlMessage,_=!!s.escapeParameter,b=i?n.modifiers:jR(s.modifiers)?s.modifiers:{},w=s.pluralRules||i&&n.pluralRules;function E(){return[l.value,h.value,c.value,u.value,d.value]}const T=Ci({get:()=>r.value?r.value.locale.value:l.value,set:t=>{r.value&&(r.value.locale.value=t),l.value=t}}),S=Ci({get:()=>r.value?r.value.fallbackLocale.value:h.value,set:t=>{r.value&&(r.value.fallbackLocale.value=t),h.value=t}}),A=Ci((()=>r.value?r.value.messages.value:c.value)),C=Ci((()=>u.value)),I=Ci((()=>d.value));function M(){return r.value?r.value.getPostTranslationHandler():x}function R(t){r.value&&r.value.setPostTranslationHandler(t)}function P(){return r.value?r.value.getMissingHandler():v}function k(t){r.value&&r.value.setMissingHandler(t)}function F(t){return E(),t()}function O(...t){return r.value?F((()=>Reflect.apply(r.value.t,null,[...t]))):F((()=>""))}function D(...t){return r.value?Reflect.apply(r.value.rt,null,[...t]):""}function L(...t){return r.value?F((()=>Reflect.apply(r.value.d,null,[...t]))):F((()=>""))}function N(...t){return r.value?F((()=>Reflect.apply(r.value.n,null,[...t]))):F((()=>""))}function B(t){return r.value?r.value.tm(t):{}}function V(t,e){return!!r.value&&r.value.te(t,e)}function U(t){return r.value?r.value.getLocaleMessage(t):{}}function X(t,e){r.value&&(r.value.setLocaleMessage(t,e),c.value[t]=e)}function Y(t,e){r.value&&r.value.mergeLocaleMessage(t,e)}function W(t){return r.value?r.value.getDateTimeFormat(t):{}}function z(t,e){r.value&&(r.value.setDateTimeFormat(t,e),u.value[t]=e)}function G(t,e){r.value&&r.value.mergeDateTimeFormat(t,e)}function H(t){return r.value?r.value.getNumberFormat(t):{}}function j(t,e){r.value&&(r.value.setNumberFormat(t,e),d.value[t]=e)}function $(t,e){r.value&&r.value.mergeNumberFormat(t,e)}const q={get id(){return r.value?r.value.id:-1},locale:T,fallbackLocale:S,messages:A,datetimeFormats:C,numberFormats:I,get inheritLocale(){return r.value?r.value.inheritLocale:o},set inheritLocale(t){r.value&&(r.value.inheritLocale=t)},get availableLocales(){return r.value?r.value.availableLocales:Object.keys(c.value)},get modifiers(){return r.value?r.value.modifiers:b},get pluralRules(){return r.value?r.value.pluralRules:w},get isGlobal(){return!!r.value&&r.value.isGlobal},get missingWarn(){return r.value?r.value.missingWarn:f},set missingWarn(t){r.value&&(r.value.missingWarn=t)},get fallbackWarn(){return r.value?r.value.fallbackWarn:p},set fallbackWarn(t){r.value&&(r.value.missingWarn=t)},get fallbackRoot(){return r.value?r.value.fallbackRoot:m},set fallbackRoot(t){r.value&&(r.value.fallbackRoot=t)},get fallbackFormat(){return r.value?r.value.fallbackFormat:g},set fallbackFormat(t){r.value&&(r.value.fallbackFormat=t)},get warnHtmlMessage(){return r.value?r.value.warnHtmlMessage:y},set warnHtmlMessage(t){r.value&&(r.value.warnHtmlMessage=t)},get escapeParameter(){return r.value?r.value.escapeParameter:_},set escapeParameter(t){r.value&&(r.value.escapeParameter=t)},t:O,getPostTranslationHandler:M,setPostTranslationHandler:R,getMissingHandler:P,setMissingHandler:k,rt:D,d:L,n:N,tm:B,te:V,getLocaleMessage:U,setLocaleMessage:X,mergeLocaleMessage:Y,getDateTimeFormat:W,setDateTimeFormat:z,mergeDateTimeFormat:G,getNumberFormat:H,setNumberFormat:j,mergeNumberFormat:$};function K(t){t.locale.value=l.value,t.fallbackLocale.value=h.value,Object.keys(c.value).forEach((e=>{t.mergeLocaleMessage(e,c.value[e])})),Object.keys(u.value).forEach((e=>{t.mergeDateTimeFormat(e,u.value[e])})),Object.keys(d.value).forEach((e=>{t.mergeNumberFormat(e,d.value[e])})),t.escapeParameter=_,t.fallbackFormat=g,t.fallbackRoot=m,t.fallbackWarn=p,t.missingWarn=f,t.warnHtmlMessage=y}return Xn((()=>{if(null==t.proxy||null==t.proxy.$i18n)throw Ik(Ck.NOT_AVAILABLE_COMPOSITION_IN_LEGACY);const n=r.value=t.proxy.$i18n.__composer;"global"===e?(l.value=n.locale.value,h.value=n.fallbackLocale.value,c.value=n.messages.value,u.value=n.datetimeFormats.value,d.value=n.numberFormats.value):i&&K(n)})),q}(e,r,s,t)}if("global"===r)return Vk(s,t,i),s;if("parent"===r){let i=function(t,e,n=!1){let s=null;const i=e.root;let r=e.parent;for(;null!=r;){const e=t;if("composition"===t.mode)s=e.__getInstance(r);else if(__VUE_I18N_LEGACY_API__){const t=e.__getInstance(r);null!=t&&(s=t.__composer,n&&s&&!s[Fk]&&(s=null))}if(null!=s)break;if(i===r)break;r=r.parent}return s}(n,e,t.__useComponent);return null==i&&(i=s),i}const a=n;let o=a.__getInstance(e);if(null==o){const n=OR({},t);"__i18n"in i&&(n.__i18n=i.__i18n),s&&(n.__root=s),o=Gk(n),function(t,e,n){Yn((()=>{}),e),Hn((()=>{t.__deleteInstance(e)}),e)}(a,e),a.__setInstance(e,o)}return o}const rF=["locale","fallbackLocale","availableLocales"],aF=["t","rt","d","n","tm"];var oF,lF;if(GP=function(t,e={}){{const n=(e.onCacheKey||ik)(t),s=rk[n];if(s)return s;let i=!1;const r=e.onError||KR;e.onError=t=>{i=!0,r(t)};const{code:a}=function(t,e={}){const n=OR({},e),s=uP(n).parse(t);return mP(s,n),vP(s,n)}(t,e),o=new Function(`return ${a}`)();return i?o:rk[n]=o}},oF=function(t,e){if(!zR(t))return null;let n=EP.get(e);if(n||(n=function(t){const e=[];let n,s,i,r,a,o,l,h=-1,c=0,u=0;const d=[];function f(){const e=t[h+1];if(5===c&&"'"===e||6===c&&'"'===e)return h++,i="\\"+e,d[0](),!0}for(d[0]=()=>{void 0===s?s=i:s+=i},d[1]=()=>{void 0!==s&&(e.push(s),s=void 0)},d[2]=()=>{d[0](),u++},d[3]=()=>{if(u>0)u--,c=4,d[0]();else{if(u=0,void 0===s)return!1;if(s=wP(s),!1===s)return!1;d[1]()}};null!==c;)if(h++,n=t[h],"\\"!==n||!f()){if(r=bP(n),l=yP[c],a=l[r]||l.l||8,8===a)return;if(c=a[0],void 0!==a[1]&&(o=d[a[1]],o&&(i=n,!1===o())))return;if(7===c)return e}}(e),n&&EP.set(e,n)),!n)return null;const s=n.length;let i=t,r=0;for(;r<s;){const t=i[n[r]];if(void 0===t)return null;i=t,r++}return i},HP=oF,jP=LP,"boolean"!=typeof __VUE_I18N_FULL_INSTALL__&&(LR().__VUE_I18N_FULL_INSTALL__=!0),"boolean"!=typeof __VUE_I18N_LEGACY_API__&&(LR().__VUE_I18N_LEGACY_API__=!0),"boolean"!=typeof __INTLIFY_PROD_DEVTOOLS__&&(LR().__INTLIFY_PROD_DEVTOOLS__=!1),__INTLIFY_PROD_DEVTOOLS__){const t=LR();t.__INTLIFY__=!0,lF=t.__INTLIFY_DEVTOOLS_GLOBAL_HOOK__,kP=lF}const hF={name:"English",message:{"modal-sound-header":"Do you want to activate the Sounds in the game?","modal-sound-subheader":"Choose whether to play with sound effects","modal-sound-active-sound":"Turn on sounds","modal-sound-active-music":"Turn on music",confirm:"Confirm","language-settings":"LANGUAGE SETTINGS","paytable-tab":"PAYTABLE","introduction-tab":"INTRODUCTION","features-tab":"FEATURES","info-tab":"MORE INFORMATION","settings-tab":"SETTINGS","sound-settings":"SOUND SETTINGS","volume-settings":"VOLUMNE SETTINGS",language:"Language","left-hand-mode":"LEFT-HANDED MODE","left-hand-desc":"Move the game buttons to the left","autoplay-header":"AUTOPLAY","autoplay-subheader":"Select the number of spins in autoplay mode","autoplay-stop":"Stop autoplay if:","autoplay-nonwinning":"Non-winning consecutive bets","autoplay-balance":"The balance decreases to under €","autoplay-stopBonus":"Stop when you get the bonus","autoplay-start":"Start autoplay","paytable-header":"CREDIT WINNING CASES","paytable-NoOfSymbol":"Number Of Symbols","paytable-wild":"The Wild symbol substitutes for all symbols except the Scatter. So far as if there were only Wild symbols on the payline then the Wild pay as below.","paytable-wild4":"(the fifth symbol on the line is a Scatter symbol)","paytable-wild3":"(the fourth symbol on the line is a Scatter symbol)","paytable-scatter1":"Scatter symbols do not pay on win lines.","paytable-scatter2":"With 3 or more scatter symbols on the grid the golden spin is activated.","paytable-rule1":"The value of a payline is equal to the value shown in the table multiplied by the game bet.","paytable-rule2":"Paylines are calculated at the end of each round. Winnings in different paylines are calculated altogether","paytable-rule3":"Winning lines pay left to right.","paytable-rule4":"In case of multiple wins on the same line the highest combination is paid.","paytable-rule5":"Malfunctions will void all plays and payouts.","intro-1":"Joe Joker Neon Blast is a 5 reel, 10 fixed line slot game. The theoretical game rtp is 96.5%.","intro-2":"You can play 10 fixed lines using the bets allowed at session start.","intro-3":" show current bet","intro-4":" show round win","intro-5":" show total credits in game.","intro-gameFunc":"Game Features: The following table illustrates the different features of the game interface.","intro-button":"Button","intro-func":"Function","intro-playButton":"Click to start a game at the current bet.","intro-autoplayButton":"Click to display the number of autoplay rounds available.","intro-leftMode":"Change the position of the spin button from right to left.","intro-maxBet":"Select the maximum bet.","intro-sound":"Click to enable or disable sound effects.","intro-music":"Click to enable or disable game music.","intro-minusPlus":"Click to change the bet to the desired value.","intro-turbo":'Click to enable "turbo" spin mode.',"features-mysToken":"at the end of each spin the player can randomly obtain a win that is directly proportional to the game bet. The maximum obtainable win is 985 times the game bet.","features-goldenSpin":"triggered when 3 or more scatter symbols appear in the grid. The joker calls on the player to collect an amount using Golden Spins.","features-pickValue":"Once the amount of Golden Spins has been collected the player will play the amounts on behalf of the joker.","features-pickNumber":"The sums collected during the Golden Spins are credited to a dedicated counter, the player will have to use the entire sum on behalf of the joker by playing spins at the same bet. The phase ends when the entire sum is been played.","features-scatters":"n. Scatters","features-picks":"Golden Spin(s)","features-freeSpin1":'The sum collected during the Golden Spins, "FREE COINS", can therefore be understood as "Free Spins".',"features-freeSpin2":"The FREE COINS total is shown at the top left of the grid.","features-freeSpin3":"The total of collected wins is visible in the upper right of the grid.","moreInfo-autoPlay":"Autoplay","moreInfo-general":"Autoplay allows the player to start one or more games automatically.","moreInfo-note1":"When autoplay is active you cannot change the game bet.","moreInfo-note2":"When autoplay mode is on the spin speed may be faster.",resetErrorMessage:"","no-Spin-Selected-Message":"You must select the number of spins to start",wesocketFail:"WebSocket Connection failed.",websocketCannotRetry:"WebSocket Connection retry: ",recInvalidObj:"Request received an invalid object"}},cF={name:"Italiano",message:{"modal-sound-header":"Vuoi attivare i Suoni nel gioco?","modal-sound-subheader":"Scegli se giocare con gli effetti sonori","modal-sound-active-sound":"Attiva i suoni","modal-sound-active-music":"Attiva musica",confirm:"Conferma","language-settings":"IMPOSTAZIONI LINGUA","paytable-tab":"PAYTABLE","introduction-tab":"INTRODUZIONE","features-tab":"FEATURES","info-tab":"ALTRE INFORMAZIONI","settings-tab":"IMPOSTAZIONI","sound-settings":"IMPOSTAZIONI AUDIO","volume-settings":"IMPOSTAZIONI DEL VOLUME",language:"IMPOSTAZIONI LINGUA","left-hand-mode":"MODALITÀ MANCINA","left-hand-desc":"Sposta i pulsanti di gioco a sinistra","autoplay-header":"AUTOPLAY","autoplay-subheader":"Seleziona il numero di spin in modalità autoplay","autoplay-stop":"Interrompi la riproduzione automatica se:","autoplay-nonwinning":"Puntate consecutive non vincenti","autoplay-balance":"Il saldo diminuisce di €","autoplay-stopBonus":"Fermati quando ricevi il bonus","autoplay-start":"Avvia la riproduzione automatica","paytable-header":"TABELLA DI PAGAMENTO","paytable-NoOfSymbol":"Numero di Simboli","paytable-wild":"II simbolo Wild sostituisce tutti i simboli eccetto lo Scatter. Qualora sulla linea di pagamento ci fossero solo simboli Wild allora il Wild paga come di seguito.","paytable-wild4":"(il quinto simbolo sulla linea é un simbolo Scatter)","paytable-wild3":"(il quarto simbolo sulla linea é un simbolo Scatter)","paytable-scatter1":"I simboli Scatter non pagano sulle linee di vincita.","paytable-scatter2":"Con 3 o piu simboli scatter sulla griglia viene attivato il golden spin.","paytable-rule1":"Il valore di una linea di vincita è uguale al valore mostrato in tabella moltiplicato per il bet di gioco.","paytable-rule2":"Le linee di vincita sono calcolate al termine di ogni round. Le vincite da linee di pagamento differenti vengono sommate alla stessa vincita al termine di ogni round","paytable-rule3":"Le linee di vincita pagano da sinistra verso destra.","paytable-rule4":"In caso di vincite multiple sulla stessa linea la combinazione più alta viene pagata.","paytable-rule5":"Eventuali malfunzionamenti annullano tutte le giocate e i pagamenti.","intro-1":"Joe Joker Neon Blast è un gioco slot a 5 rulli e 10 linee fisse. L'rtp teorico di gioco è 96.5%.","intro-2":"Puoi giocare a 10 linee fisse utilizzando i bet consentiti al momento di avvio sessione.","intro-3":" mostra il bet corrente","intro-4":" mostra la vincita del round","intro-5":" mostra il credito totale in gioco.","intro-gameFunc":"Funzioni di gioco: La seguente tabella illustra le differenti fuzionalità dell'interfaccia di gioco.","intro-button":"Pulsante","intro-func":"Funzione","intro-playButton":"Clicca per avviare una partita al bet corrente.","intro-autoplayButton":"Clicca per visualizzare il numero di rounds autoplay disponibili.","intro-leftMode":"Cambia la posizione del pulsante spin da destra a sinistra.","intro-maxBet":"Seleziona il bet massimo.","intro-sound":"Clicca per abilitare o disabilitare gli effetti sonori.","intro-music":"Clicca per abilitare o disabilitare le musiche di gioco","intro-minusPlus":"Clicca per cambiare il bet al valore desiderato.","intro-turbo":'Clicca per abilitare la modalita spin "turbo".',"features-mysToken":"al termine di ogni spin il giocatore può ottenere casualmente una vincita che è direttamente proporzionale al bet di gioco. La vincita massima ottenibile è di 985 volte il bet di gioco.","features-goldenSpin":"viene attivato quando nella griglia compaiono 3 o più simboli scatter. Joker chiama il giocatore a raccogliere una somma utilizzando i Golden Spin.","features-pickValue":"Una volta collezionata la somma dai Golden Spin il giocatore giocherà le somme per conto del joker.","features-pickNumber":"Le somme collezionate durante i Golden Spin vengono accreditate in un contatore dedicato, il giocatore dovrà utilizzare per conto del Joker l'intera somma giocando degli spin allo stesso bet. La fase termina quando l'intera somma è stata giocata.","features-scatters":"n. Scatters","features-picks":"Golden Spin(s)","features-freeSpin1":'La somma raccolta durante i Golden Spins, "FREE COINS", può essere quindi intesa come "Free Spins".',"features-freeSpin2":"Il totale FREE COINS è mostrato in alto a sinistra della griglia.","features-freeSpin3":"Il totale delle vincite raccolte è visibile in altro a destra della griglia.","moreInfo-autoPlay":"Autoplay","moreInfo-general":"Autoplay consente al giocatore di avviare automaticamente una o più partite.","moreInfo-note1":"Quando la modalità autoplay è attiva non puoi modificare il bet di gioco.","moreInfo-note2":"Quando la modalità autoplay è attiva la velocità degli spin potrebbe essere più veloce.",resetErrorMessage:"","no-Spin-Selected-Message":"È necessario selezionare il numero di giri per iniziare",wesocketFail:"Connessione al server fallita.",websocketCannotRetry:"Riconnessione: ",recInvalidObj:"Risposta dal server non valida"}},uF=Ne(""),dF=function(t={},e){const n=__VUE_I18N_LEGACY_API__&&WR(t.legacy)?t.legacy:__VUE_I18N_LEGACY_API__,s=!WR(t.globalInjection)||t.globalInjection,i=!__VUE_I18N_LEGACY_API__||!n||!!t.allowComposition,r=new Map,[a,o]=function(t,e,n){const s=new vt(i);var i;{const n=__VUE_I18N_LEGACY_API__&&e?s.run((()=>Hk(t))):s.run((()=>Gk(t)));if(null==n)throw Ik(Ck.UNEXPECTED_ERROR);return[s,n]}}(t,n),l=AR("");{const t={get mode(){return __VUE_I18N_LEGACY_API__&&n?"legacy":"composition"},get allowComposition(){return i},install(e,...i){return m(this,null,(function*(){e.__VUE_I18N_SYMBOL__=l,e.provide(e.__VUE_I18N_SYMBOL__,t),!n&&s&&function(t,e){const n=Object.create(null);rF.forEach((t=>{const s=Object.getOwnPropertyDescriptor(e,t);if(!s)throw Ik(Ck.UNEXPECTED_ERROR);const i=Le(s.value)?{get:()=>s.value.value,set(t){s.value.value=t}}:{get:()=>s.get&&s.get()};Object.defineProperty(n,t,i)})),t.config.globalProperties.$i18n=n,aF.forEach((n=>{const s=Object.getOwnPropertyDescriptor(e,n);if(!s||!s.value)throw Ik(Ck.UNEXPECTED_ERROR);Object.defineProperty(t.config.globalProperties,`$${n}`,s)}))}(e,t.global),__VUE_I18N_FULL_INSTALL__&&eF(e,t,...i),__VUE_I18N_LEGACY_API__&&n&&e.mixin(function(t,e,n){return{beforeCreate(){const s=xi();if(!s)throw Ik(Ck.UNEXPECTED_ERROR);const i=this.$options;if(i.i18n){const n=i.i18n;i.__i18n&&(n.__i18n=i.__i18n),n.__root=e,this===this.$root?this.$i18n=nF(t,n):(n.__injectWithOption=!0,this.$i18n=Hk(n))}else i.__i18n?this===this.$root?this.$i18n=nF(t,i):this.$i18n=Hk({__i18n:i.__i18n,__injectWithOption:!0,__root:e}):this.$i18n=t;i.__i18nGlobal&&Vk(e,i,i),t.__onComponentInstanceCreated(this.$i18n),n.__setInstance(s,this.$i18n),this.$t=(...t)=>this.$i18n.t(...t),this.$rt=(...t)=>this.$i18n.rt(...t),this.$tc=(...t)=>this.$i18n.tc(...t),this.$te=(t,e)=>this.$i18n.te(t,e),this.$d=(...t)=>this.$i18n.d(...t),this.$n=(...t)=>this.$i18n.n(...t),this.$tm=t=>this.$i18n.tm(t)},mounted(){},unmounted(){const t=xi();if(!t)throw Ik(Ck.UNEXPECTED_ERROR);delete this.$t,delete this.$rt,delete this.$tc,delete this.$te,delete this.$d,delete this.$n,delete this.$tm,n.__deleteInstance(t),delete this.$i18n}}}(o,o.__composer,t));const r=e.unmount;e.unmount=()=>{t.dispose(),r()}}))},get global(){return o},dispose(){a.stop()},__instances:r,__getInstance:function(t){return r.get(t)||null},__setInstance:function(t,e){r.set(t,e)},__deleteInstance:function(t){r.delete(t)}};return t}}({locale:uF.value,messages:{en:hF,it:cF}});let fF;Cn(uF,(t=>{dF.global.locale=t}));const pF={number0:function(t){if((t=Math.floor(t/100))<1e3)return`${t}`;{let e=t%1e3;if((t=Math.floor(t/1e3))<1e3)return`${t}.${e.pad0(3)}`;return`${t}.${(t%1e3).pad0(3)}.${e.pad0(3)}`}},number:function(t,e=!0){let n=t%100,s=this.number0(t);return e||n>0?`${s},${n.pad0(2)}`:s},currency0:function(t){return`€${this.number0(t)}`},currency:function(t,e=!0){return`€${this.number(t,e)}`}},mF={number0:function(t){if((t=Math.floor(t/100))<1e3)return`${t}`;{let e=t%1e3;if((t=Math.floor(t/1e3))<1e3)return`${t},${e.pad0(3)}`;return`${t},${(t%1e3).pad0(3)},${e.pad0(3)}`}},number:function(t,e=!0){let n=t%100,s=this.number0(t);return e||n>0?`${s}.${n.pad0(2)}`:s},currency0:function(t){return`$${this.number0(t)}`},currency:function(t,e=!0){return`$${this.number(t,e)}`}},gF={number0:function(t){if((t=Math.floor(t/100))<1e3)return`${t}`;{let e=t%1e3;if((t=Math.floor(t/1e3))<1e3)return`${t},${e.pad0(3)}`;return`${t},${(t%1e3).pad0(3)},${e.pad0(3)}`}},number:function(t,e=!0){let n=t%100,s=this.number0(t);return e||n>0?`${s}.${n.pad0(2)}`:s},currency0:function(t){return`DH ${this.number0(t)}`},currency:function(t,e=!0){return`DH ${this.number(t,e)}`}},vF={number0:function(t){if((t=Math.floor(t/100))<1e3)return`${t}`;{let e=t%1e3;if((t=Math.floor(t/1e3))<1e3)return`${t}.${e.pad0(3)}`;return`${t}.${(t%1e3).pad0(3)}.${e.pad0(3)}`}},number:function(t){return this.number0(t)},currency0:function(t){return`₺${this.number0(t)}`},currency:function(t){return`₺${this.number(t)}`}};globalThis.API={params:new URLSearchParams(window.location.search),conf:{supportedLocales:["en","it"],defaultLocale:"en",supportedCurrencies:["EUR"],defaultCurrency:"EUR"},locale:uF,volume:Ne(1),soundMuted:Ne(!0),musicMuted:Ne(!0),toggleCanvas:Ne(!1),isLandscape:Ne(!0)};{let t=null==(e=API.params.get("locale"))?void 0:e.toLowerCase(),s="";API.locale.value=t&&API.conf.supportedLocales.includes(t)?t:API.conf.supportedLocales.includes(s)?s:API.conf.defaultLocale;let i=null==(n=API.params.get("currency"))?void 0:n.toUpperCase();API.currency=i&&API.conf.supportedCurrencies.includes(i)?i:API.conf.defaultCurrency,xF=API.currency,fF={EUR:pF,USD:mF,MAD:gF,TRY:vF}[xF]}var xF;((...t)=>{const e=(or||(or=Vs(ar))).createApp(...t),{mount:n}=e;return e.mount=t=>{const s=function(t){if(j(t)){return document.querySelector(t)}return t}(t);if(!s)return;const i=e._component;H(i)||i.render||i.template||(i.template=s.innerHTML),s.innerHTML="";const r=n(s,!1,s instanceof SVGElement);return s instanceof Element&&(s.removeAttribute("v-cloak"),s.setAttribute("data-v-app","")),r},e})(ER).use(dF).mount("#app");export{Cn as $,Yx as A,ed as B,Lg as C,Dd as D,gx as E,Ox as F,Mg as G,zr as H,Gh as I,sS as J,Ux as K,nS as L,Dx as M,ha as N,ca as O,dF as P,iS as Q,Zl as R,Rx as S,Rg as T,eu as U,Gl as V,fF as W,_g as X,Xx as Y,_y as Z,WA as _,bg as a,wg as b,Eg as c,cv as d,ua as e,iv as f,rv as g,ev as h,tv as i,Bg as j,nv as k,sv as l,Cg as m,Ig as n,Ng as o,Jg as p,av as q,zx as r,Sg as s,mx as t,Gx as u,Lx as v,eS as w,Og as x,Wx as y,Bx as z};
